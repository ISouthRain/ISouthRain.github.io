[{"categories":null,"contents":"ğŸ‰WecomeğŸ‰ ","permalink":"http://isouthrain.github.io/about.en/","tags":null,"title":"About"},{"categories":null,"contents":"2022  You need to pay the price before getting it. No matter what the price is, it must be unforgettable! ğŸ”\n  People can\u0026rsquo;t make money beyond their knowledgeğŸ’´\n  Whatever doesn\u0026rsquo;t defeat you simply makes you strongerğŸ’ª\n ","permalink":"http://isouthrain.github.io/quotation.en/","tags":null,"title":"Quotation"},{"categories":null,"contents":"2022  éµå¾ªè‡ªå·±çš„å†…å¿ƒæ´»ä¸‹å», ä¸è¦å›é¦–å¾€äº‹, æ˜¨å¤©æ˜¯å†å², ä»Šå¤©æ˜¯ç¤¼ç‰©, æ˜å¤©æ˜¯æœªçŸ¥çš„, æœªçŸ¥çš„äº‹è€Œä¸åº”æ”¾åœ¨å½“ä¸‹æ‹…å¿§ !!\n  ç¾å¥½çš„äº‹æƒ…ç»ˆä¼šåˆ°æ¥ğŸ®\n  å¾—åˆ°ä¹‹å‰éƒ½æ˜¯éœ€è¦ä»˜å‡ºä»£ä»·çš„, æ— è®ºä»£ä»·æ˜¯ä»€ä¹ˆ, å¿…å®šè®©äººåˆ»éª¨é“­å¿ƒ!ğŸ”\n  äººæ˜¯ä¸èƒ½èµšå–è®¤çŸ¥ä»¥å¤–çš„é’±ğŸ’´\n  é‚£äº›æ‰“ä¸è´¥ä½ çš„åªä¼šä½¿ä½ æ›´åŠ å¼ºå¤§ğŸ’ª\n  æ²¡æœ‰ä»€ä¹ˆè°å¯ä»¥æ‰“è´¥ä½ ï¼Œèƒ½æ‰“è´¥çš„ä½ çš„åªæœ‰ä½ è‡ªå·±\n ","permalink":"http://isouthrain.github.io/quotation/","tags":null,"title":"è¯­å½•"},{"categories":[],"contents":"ä¸€ä¸ªæ··è¿¹äºå¸éƒ½çš„ç¨‹åºçŒ¿ï¼Œä¸»è¦ä»äº‹Javaã€Pythonå’ŒGolangç›¸å…³çš„å¼€å‘å·¥ä½œã€‚\nç¼–ç¨‹é¢†åŸŸ  Javaï¼Œä¸»è¦ç”¨å®ƒè¿›è¡Œwebå¼€å‘ Pythonï¼Œä¸»è¦ç”¨å®ƒè¿›è¡Œç½‘ç»œçˆ¬è™«å¼€å‘å’Œwebå¼€å‘ Golang,ä¸ªäººä¸šä½™çˆ±å¥½ MySQLã€MongoDB HTMLã€Javascriptã€jQueryã€CSS  \nä¸ªäººä¿¡æ¯ æ•™è‚²ä¿¡æ¯  ä¸­å›½çŸ¿ä¸šå¤§å­¦Â (2006.9-2010.6) è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯Â (æœ¬ç§‘)  è‡ªæˆ‘è¯„ä»·  çƒ­çˆ±å­¦ä¹ å’Œä½¿ç”¨æ–°æŠ€æœ¯ï¼› æœ‰ç€ååˆ†å¼ºçƒˆçš„ä»£ç æ´ç™–ï¼› å–œæ¬¢é‡æ„ä»£ç ï¼Œå–„äºåˆ†æå’Œè§£å†³é—®é¢˜ï¼›  ä¸ªäººçˆ±å¥½  ç¼–ç¨‹ è‹±è¯­ å­¦ä¹   è”ç³»æ–¹å¼  Email: lucumt@gmail.com,cumtlu@126.com Skype: lu.rosen QQ: 317801876 é¢†è‹±: å¢è¿å¼º  å‹æƒ…é“¾æ¥  Frantic log#1048 cold\u0026rsquo;s world é‚ªæ¶äºŒè¿›åˆ¶ Javmain\u0026rsquo;s Blog å°æ—Coding äº‘åŸç”Ÿå®éªŒå®¤  ","permalink":"http://isouthrain.github.io/about/","tags":[],"title":"å…³äºæˆ‘"},{"categories":[],"contents":" è®°å½•ä¸ªäººè§‰å¾—æœ‰æ„ä¹‰çš„å„ç§åšå®¢ã€å…¬ä¼—å·é¡µé¢ã€è§†é¢‘ç­‰ã€‚\n åšå®¢å›­    åœ°å€ å†…å®¹ å…¶å®ƒ     ç¨‹åºå‘˜è‡ªç”±ä¹‹è·¯ ä¸»è¦æ˜¯JavaEEå¼€å‘ï¼Œå…³äºJavaæ¡†æ¶çš„æ–‡ç« å¾ˆå¤š    Michaelç¿” ä¸»è¦æ˜¯JavaEEå¼€å‘ å¾®ä¿¡å…¬ä¼—å·Coder é­”æ³•é™¢   ç§‹é£é£’é£’å¹ è½¯ä»¶å¼€å‘çš„å„æ–¹é¢å‡æœ‰æ¶‰åŠ    Ccww ä¸»è¦æ˜¯Javaå’ŒSpringæ¡†æ¶     ç®€ä¹¦ å•ä¸ªåšæ–‡  dockerå®‰è£…Elasticsearch7.6é›†ç¾¤å¹¶è®¾ç½®å¯†ç   ","permalink":"http://isouthrain.github.io/links/","tags":[],"title":"å„ç§å¤–é“¾"},{"categories":["Javaç¼–ç¨‹"],"contents":"åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸï¼Œå¤§éƒ¨åˆ†æ—¶é—´ç²¾ç¡®åˆ°ç§’æˆ–æ¯«ç§’å³å¯æ»¡è¶³æ—¥å¸¸éœ€æ±‚ï¼Œä½†åœ¨æŸäº›å¯¹æ—¶é—´è¦æ±‚ä¸¥æ ¼çš„åœºæ™¯ä¸­éœ€è¦ä½¿ç”¨å¾®ç§’ã€çº³ç§’ç­‰æ›´ç²¾ç¡®çš„æ—¶é—´å€¼ï¼Œæœ¬æ–‡ç®€è¦è®°å½•å¦‚ä½•åœ¨Javaä¸­é€šè¿‡LocalDateTimeå®ç°å¯¹äºå¾®ç§’ã€çº³ç§’çš„ç²¾ç¡®è§£æä»¥åŠè½¬åŒ–ä¸ºlongå‹æ—¶é—´æˆ³ã€‚\njava.util.Dateä¸­ç›¸å…³å®ç° æ ¼å¼åŒ–æµ‹è¯• é¦–å…ˆé‡‡ç”¨é‡‡ç”¨å¦‚ä¸‹ä»£ç éªŒè¯java.util.Dateå’Œjava.text.SimpleDateFormatå¯¹äºæ—¶é—´æˆ³çš„æ”¯æŒæƒ…å†µã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53  public class TestDateConvert1 { public static void main(String[] args) { String text1 = \u0026#34;2023/01/04 17:54:38\u0026#34;; String text2 = \u0026#34;2023/01/04 17:54:38.610\u0026#34;; String text3 = \u0026#34;2023/01/04 17:54:38.610502\u0026#34;; String text4 = \u0026#34;2023/01/04 17:54:38.610502567\u0026#34;; try { testDate1(text1); testDate2(text2); testDate3(text3); testDate4(text4); } catch (ParseException e) { throw new RuntimeException(e); } } public static void testDate1(String text) throws ParseException { DateFormat df = new SimpleDateFormat(\u0026#34;yyyy/MM/dd HH:mm:ss\u0026#34;); //ç²¾ç¡®åˆ°ç§’  Date newDate = df.parse(text); System.out.println(\u0026#34;----------------ç²¾ç¡®åˆ°ç§’------------------------------\u0026#34;); System.out.println(\u0026#34;åŸå§‹æ—¶é—´:\\t\u0026#34; + text); System.out.println(\u0026#34;è§£æåçš„æ—¶é—´:\\t\u0026#34; + df.format(newDate)); System.out.println(); } public static void testDate2(String text) throws ParseException { DateFormat df = new SimpleDateFormat(\u0026#34;yyyy/MM/dd HH:mm:ss.SSS\u0026#34;); // ç²¾ç¡®åˆ°æ¯«ç§’  Date newDate = df.parse(text); System.out.println(\u0026#34;----------------ç²¾ç¡®åˆ°æ¯«ç§’----------------------------\u0026#34;); System.out.println(\u0026#34;åŸå§‹æ—¶é—´:\\t\u0026#34; + text); System.out.println(\u0026#34;è§£æåçš„æ—¶é—´:\\t\u0026#34; + df.format(newDate)); System.out.println(); } public static void testDate3(String text) throws ParseException { DateFormat df = new SimpleDateFormat(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSS\u0026#34;); //ç²¾ç¡®åˆ°å¾®ç§’  Date newDate = df.parse(text); System.out.println(\u0026#34;----------------ç²¾ç¡®åˆ°å¾®ç§’----------------------------\u0026#34;); System.out.println(\u0026#34;åŸå§‹æ—¶é—´:\\t\u0026#34; + text); System.out.println(\u0026#34;è§£æåçš„æ—¶é—´:\\t\u0026#34; + df.format(newDate)); System.out.println(); } public static void testDate4(String text) throws ParseException { DateFormat df = new SimpleDateFormat(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSSSSS\u0026#34;); //ç²¾ç¡®åˆ°å¾®ç§’  Date newDate = df.parse(text); System.out.println(\u0026#34;----------------ç²¾ç¡®åˆ°çº³ç§’----------------------------\u0026#34;); System.out.println(\u0026#34;åŸå§‹æ—¶é—´:\\t\u0026#34; + text); System.out.println(\u0026#34;è§£æåçš„æ—¶é—´:\\t\u0026#34; + df.format(newDate)); } }   è¿è¡Œç»“æœå¦‚ä¸‹ï¼š\nä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºæ—¶é—´ç²¾ç¡®åˆ°å¾®ç§’ä¹‹åï¼Œé‡‡ç”¨java.util.Dateå’Œjava.text.SimpleDateFormatè¿›è¡Œè¾“å‡ºæ—¶å‰åçš„ç»“æœå·²ç»ä¸ä¸€è‡´ã€‚åŒæ—¶ä¹Ÿå¯ä»¥å¤§è‡´çŒœæµ‹ï¼Œå½“ä½¿ç”¨java.util.Dateæ—¶ä¸èƒ½ç”¨å…¶è¿›è¡Œå¾®ç§’æˆ–çº³ç§’ç­‰é«˜ç²¾åº¦çš„æ—¶é—´å­˜å‚¨å±•ç¤ºï¼Œä½†æ­¤é—®é¢˜æ˜¯ç”±java.util.Dateè¿˜æ˜¯java.text.SimpleDateFormaté€ æˆçš„æš‚ä¸ç¡®å®šã€‚\nå¯¹æ¯”æ•°æ®æµ‹è¯• ä¸ºäº†æµ‹è¯•ç»“æœçš„å‡†ç¡®æ€§ï¼Œåœ¨www.timestamp-converter.comä¸­è·å–ä¸€ä¸ªå¯ç”¨äºéªŒè¯çš„æ—¶é—´æˆ³ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤º\nå…¶ä¸­åŸºäºæ¯«ç§’çš„æ—¶é—´æˆ³ä¸º1676628010725ï¼Œæ ¼å¼åŒ–åçš„æ˜¾ç¤ºä¸º2023-02-17T10:00:10.725Zï¼Œé‡‡ç”¨ä¸‹è¿°ä»£ç è¿›è¡ŒéªŒè¯ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  public static void testDateCreate() { DateFormat df1 = new SimpleDateFormat(\u0026#34;yyyy/MM/dd HH:mm:ss\u0026#34;); DateFormat df2 = new SimpleDateFormat(\u0026#34;yyyy/MM/dd HH:mm:ss.SSS\u0026#34;); DateFormat df3 = new SimpleDateFormat(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSS\u0026#34;); DateFormat df4 = new SimpleDateFormat(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSSSSS\u0026#34;); long timestamp1 = 1676628010725L;//å‰è¿°è·å–åˆ°çš„æ—¶é—´æˆ³  Date date = new Date(timestamp1); long timestamp2 = date.getTime(); System.out.println(\u0026#34;timestamp1:\\t\u0026#34; + timestamp1); System.out.println(\u0026#34;timestamp2:\\t\u0026#34; + timestamp2); System.out.println(\u0026#34;ç²¾ç¡®åˆ°ç§’:\\t\u0026#34; + df1.format(date)); System.out.println(\u0026#34;ç²¾ç¡®åˆ°æ¯«ç§’:\\t\u0026#34; + df2.format(date)); System.out.println(\u0026#34;ç²¾ç¡®åˆ°å¾®ç§’:\\t\u0026#34; + df3.format(date)); System.out.println(\u0026#34;ç²¾ç¡®åˆ°çº³ç§’:\\t\u0026#34; + df4.format(date)); }   è¿è¡Œç»“æœå¦‚ä¸‹\nä»ç»“æœä¸­å¯çŸ¥å¾®ç§’ä¸çº³ç§’çš„ç»“æœä¸ç½‘ç«™ä¸­å±•ç¤ºçš„ä¸ä¸€è‡´ï¼Œä½†æ˜¯ä»ç„¶æ— æ³•ç¡®å®šåˆ°åº•æ˜¯java.util.Dateè¿˜æ˜¯java.text.SimpleDateFormatçš„åŸå› ã€‚\nåœ¨java.util.Dateçš„å®˜æ–¹æ–‡æ¡£ä¸­å¯æ‰¾åˆ°å¦‚ä¸‹è¯´æ˜ï¼Œä»å›¾ä¸­å¯çŸ¥å½“é‡‡ç”¨æ—¶é—´æˆ³æ¥æ„é€ java.util.Dateæ—¶ï¼Œå…¶æ¥æ”¶çš„å‚æ•°ä¸ºæ¯«ç§’ç›¸å¯¹æ•°æ®å€¼ï¼Œä¸æ”¯æŒå¾®ç§’å’Œçº³ç§’ã€‚\nåœ¨java.text.SimpleDateFormateçš„å®˜æ–¹æ–‡æ¡£ä¸­æœ‰å¦‚ä¸‹è¯´æ˜ï¼ŒåŒæ ·å¯çŸ¥é“java.text.SimpleDateFormatä¸æ”¯æŒå¾®ç§’å’Œçº³ç§’çº§åˆ«çš„æ—¶é—´ç²¾åº¦ã€‚\nåˆæ­¥ç»“è®º:\n java.util.Dateå’Œjava.text.SimpleDateFormatå‡ä¸æ”¯æŒå¾®ç§’å’Œçº³ç§’çº§åˆ«çš„æ—¶é—´ç²¾åº¦ã€‚\n LocalDateTimeä¸­å®ç° ç”±äºJDK8ä¸­å¼•å…¥äº†LocalDateTimeï¼Œæ•…å°†æœ€å¼€å§‹çš„æµ‹è¯•ä»£ç éƒ½ä¿®æ”¹ä¸ºä½¿ç”¨java.time.LocalDateTimeå’Œjava.time.format.DateTimeFormatterè¿›è¡Œæµ‹è¯•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54  public class TestDateConvert3 { public static void main(String[] args) { String text1 = \u0026#34;2023/01/04 17:54:38\u0026#34;; String text2 = \u0026#34;2023/01/04 17:54:38.610\u0026#34;; String text3 = \u0026#34;2023/01/04 17:54:38.610502\u0026#34;; String text4 = \u0026#34;2023/01/04 17:54:38.610502567\u0026#34;; try { testDate1(text1); testDate2(text2); testDate3(text3); testDate4(text4); } catch (ParseException e) { throw new RuntimeException(e); } } public static void testDate1(String text) throws ParseException { DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\u0026#34;yyyy/MM/dd HH:mm:ss\u0026#34;); //ç²¾ç¡®åˆ°ç§’  LocalDateTime newDate = LocalDateTime.parse(text,formatter); System.out.println(\u0026#34;----------------ç²¾ç¡®åˆ°ç§’------------------------------\u0026#34;); System.out.println(\u0026#34;åŸå§‹æ—¶é—´:\\t\u0026#34; + text); System.out.println(\u0026#34;è§£æåçš„æ—¶é—´:\\t\u0026#34; + formatter.format(newDate)); System.out.println(); } public static void testDate2(String text) throws ParseException { DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\u0026#34;yyyy/MM/dd HH:mm:ss.SSS\u0026#34;); //ç²¾ç¡®åˆ°æ¯«ç§’  LocalDateTime newDate = LocalDateTime.parse(text,formatter); System.out.println(\u0026#34;----------------ç²¾ç¡®åˆ°æ¯«ç§’----------------------------\u0026#34;); System.out.println(\u0026#34;åŸå§‹æ—¶é—´:\\t\u0026#34; + text); System.out.println(\u0026#34;è§£æåçš„æ—¶é—´:\\t\u0026#34; + formatter.format(newDate)); System.out.println(); } public static void testDate3(String text) throws ParseException { DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSS\u0026#34;); //ç²¾ç¡®åˆ°å¾®ç§’  LocalDateTime newDate = LocalDateTime.parse(text,formatter); System.out.println(\u0026#34;----------------ç²¾ç¡®åˆ°å¾®ç§’----------------------------\u0026#34;); System.out.println(\u0026#34;åŸå§‹æ—¶é—´:\\t\u0026#34; + text); System.out.println(\u0026#34;è§£æåçš„æ—¶é—´:\\t\u0026#34; + formatter.format(newDate)); System.out.println(); } public static void testDate4(String text) throws ParseException { DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSSSSS\u0026#34;); //ç²¾ç¡®åˆ°çº³ç§’  LocalDateTime newDate = LocalDateTime.parse(text,formatter); System.out.println(\u0026#34;----------------ç²¾ç¡®åˆ°çº³ç§’----------------------------\u0026#34;); System.out.println(\u0026#34;åŸå§‹æ—¶é—´:\\t\u0026#34; + text); System.out.println(\u0026#34;è§£æåçš„æ—¶é—´:\\t\u0026#34; + formatter.format(newDate)); System.out.println(); } }   æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š\nä»ä¸­å¯çŸ¥å½“è”åˆé‡‡ç”¨java.time.LocalDateTimeå’Œjava.time.format.DateTimeFormatteræ—¶ï¼Œèƒ½å¤Ÿæ”¯æŒåˆ°çº³ç§’çº§åˆ«ï¼Œå¯æ»¡è¶³è¦æ±‚ã€‚\nåœ¨java.time.LocalDateTimeçš„å®˜æ–¹æ–‡æ¡£ä¸­æœ‰å¦‚ä¸‹è¯´æ˜ï¼Œä»å›¾ä¸­å¯çŸ¥java.time.LocalDateTimeæ”¯æŒåˆ°çº³ç§’çº§åˆ«çš„æ—¶é—´ç²¾åº¦\nåœ¨java.time.format.DateTimeFormatterçš„å®˜æ–¹æ–‡æ¡£ä¸­æœ‰å¦‚ä¸‹è¯´æ˜,ä»å›¾ä¸­å¯çŸ¥java.time.format.DateTimeFormatterä¹Ÿæ”¯æŒçº³ç§’çº§åˆ«çš„æ ¼å¼åŒ–ã€‚\næœ€ç»ˆç»“è®º:\n java.time.LocalDateTimeæ”¯æŒçº³ç§’çº§åˆ«çš„æ—¶é—´å­˜å‚¨ï¼Œæ”¯æŒjava.time.format.DateTimeFormatteræ”¯æŒçº³ç§’çº§åˆ«çš„æ—¶é—´æ˜¾ç¤ºã€‚\n LocalDateTimeä¸æ—¶é—´æˆ³äº’è½¬ åœ¨java.util.Dateä¸­å¯ä»¥å¾ˆå®¹æ˜“çš„é€šè¿‡Date().getTime()å’Œnew Date(long timestamp)æ¥åˆ†åˆ«è·å–æ—¶é—´æˆ³å’ŒåŸºäºæ—¶é—´æˆ³æ„é€ æ—¶é—´ï¼Œè€Œåœ¨java.time.LocalDateTimeä¸­è¦å®ç°ç±»ä¼¼åŠŸèƒ½åˆ™ç¨å¾®å¤æ‚ç‚¹ã€‚\nå½“è¦è·å–longç±»å‹çš„æ—¶é—´æˆ³æ—¶ï¼Œéœ€è¦å…ˆè·å–ç§’ï¼Œå†è·å–å¾®ç§’æˆ–çº³ç§’ï¼Œç„¶åæ ¹æ®ä»–ä»¬ä¹‹å‰çš„æ¢ç®—å…³ç³»è¿›è¡Œç´¯åŠ è¿”å›ï¼Œç›¸å…³å…¬å¼å¦‚ä¸‹ï¼š\n  $å¾®ç§’æ—¶é—´æˆ³=ç§’ \\times 10^6 +å¾®ç§’$ $çº³ç§’æ—¶é—´æˆ³=ç§’ \\times 10^9 +çº³ç§’$   æœ‰äº†æ—¶é—´æˆ³ä¹‹åæ ¹æ®ä¸Šè¿°å…¬å¼è¿›è¡Œåå‘æ“ä½œï¼Œåˆ†åˆ«è·å–ç§’ä¸å¾®ç§’(çº³ç§’)ï¼Œç„¶åæ ¹æ®è¿™2ä¸ªæ•°å€¼é€šè¿‡Instantæ„å»ºå³å¯ã€‚\nä¸å¾®ç§’äº’è½¬ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  public class TestDateConvert4 { public static void main(String[] args) { long time = convertTimeToMills(\u0026#34;2023/01/04 17:54:38.610502\u0026#34;); convertMillsToTime(time); } public static long convertTimeToMills(String originalText) { DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSS\u0026#34;); System.out.println(originalText); LocalDateTime dateTime = LocalDateTime.parse(originalText, formatter); ZoneId zoneId = ZoneId.systemDefault(); Instant instant = dateTime.atZone(zoneId).toInstant(); long seconds = instant.getEpochSecond(); int micros = instant.get(ChronoField.MICRO_OF_SECOND); long total = seconds * 1_000_000 + micros; return total; } public static LocalDateTime convertMillsToTime(long time) { long sec = time / 1_000_000; long mic = time % 1_000_000; Instant instant1 = Instant.ofEpochSecond(sec).plus(mic, ChronoUnit.MICROS); ZoneId zoneId = ZoneId.systemDefault(); LocalDateTime localDateTime = LocalDateTime.ofInstant(instant1, zoneId); DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSS\u0026#34;); System.out.println(formatter.format(localDateTime)); return localDateTime; } }   æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼Œç¬¦åˆé¢„æœŸ\nä¸çº³ç§’äº’è½¬ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  public class TestDateConvert5 { public static void main(String[] args) { long time = convertTimeToMills(\u0026#34;2023/01/04 17:54:38.610502987\u0026#34;); convertMillsToTime(time); } public static long convertTimeToMills(String originalText) { DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSSSSS\u0026#34;); System.out.println(originalText); LocalDateTime dateTime = LocalDateTime.parse(originalText, formatter); ZoneId zoneId = ZoneId.systemDefault(); Instant instant = dateTime.atZone(zoneId).toInstant(); long seconds = instant.getEpochSecond(); int micros = instant.get(ChronoField.NANO_OF_SECOND); long total = seconds * 1_000_000_000 + micros; return total; } public static LocalDateTime convertMillsToTime(long time) { long sec = time / 1_000_000_000; long mic = time % 1_000_000_000; Instant instant1 = Instant.ofEpochSecond(sec).plus(mic, ChronoUnit.NANOS); ZoneId zoneId = ZoneId.systemDefault(); LocalDateTime localDateTime = LocalDateTime.ofInstant(instant1, zoneId); DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\u0026#34;yyyy/MM/dd HH:mm:ss.SSSSSSSSS\u0026#34;); System.out.println(formatter.format(localDateTime)); return localDateTime; } }   æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼Œç¬¦åˆé¢„æœŸ\nå‚è€ƒæ–‡ç« ï¼š\n https://www.cnblogs.com/yangxunwu1992/p/5769533.html https://stackoverflow.com/questions/30135025/java-date-parsing-with-microsecond-or-nanosecond-accuracy ","permalink":"http://isouthrain.github.io/post/java-core/parse-and-store-microsecond-nanosecond-in-java/","tags":["Java"],"title":"åœ¨Javaä¸­è§£æå’Œå­˜å‚¨åŒ…å«å¾®ç§’ä¸çº³ç§’çš„æ—¶é—´"},{"categories":["å®¹å™¨åŒ–"],"contents":"å·¥ä½œä¸­æ¶‰åŠåˆ°Kubernetesç›¸å…³çŸ¥è¯†ï¼Œè‡ªå·±ä¹‹å‰ä¸€ç›´æ²¡æœ‰ç³»ç»Ÿæ€§çš„å­¦ä¹ Kubernetesï¼Œè¿‘æœŸåœ¨è…¾è®¯äº‘ä¸Šæƒ³å®‰è£…Kubernetesæ—¶ä¸€ç›´é‡åˆ°åœ¨æ‰§è¡Œkubeadm initæ—¶6443å’Œ10280ç«¯å£æ— æ³•è®¿é—®å¯¼è‡´æ“ä½œå¤±è´¥è¿›è€Œæ— æ³•é¡ºåˆ©å®‰è£…Kubernetesã€‚ä¸€ç•ªæ’æŸ¥åå‘ç°æ˜¯ç”±äºä»1.24.0ä¹‹åKubernetesé»˜è®¤é‡‡ç”¨containerdä½œä¸ºè¿è¡Œæ—¶å®¹å™¨ï¼Œå…¶é»˜è®¤é•œåƒä¸ºregistry.k8s.ioï¼Œè¯¥é•œåƒåœ¨å›½å†…æ— æ³•è®¿é—®å¯¼è‡´çš„ï¼Œç®€å•è®°å½•ä¸‹ã€‚\nå®‰è£…è¿‡ç¨‹ä¸»è¦å‚è€ƒ1ï¼Œç›¸å…³é…ç½®ä¸å®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š\nç³»ç»Ÿé…ç½®ä¸ä¾èµ– å…³é—­é˜²ç«å¢™ 1 2 3 4 5 6 7 8 9 10 11 12  # å…³é—­äº¤æ¢å†…å­˜ swapoff -a #å…³é—­selinux getenforce setenforce 0 sed -i \u0026#39;s/^SELINUX=enforcing$/SELINUX=disabled/\u0026#39; /etc/selinux/config #å…³é—­é˜²ç«å¢™ firewall-cmd --state systemctl stop firewalld.service systemctl disable firewalld.service   é…ç½®dockerå‚æ•° 1 2 3 4 5 6 7 8 9 10 11  mkdir /etc/docker/ vim /etc/docker/daemon.json { \u0026#34;storage-driver\u0026#34;: \u0026#34;overlay2\u0026#34;, \u0026#34;registry-mirrors\u0026#34;: [ \u0026#34;https://registry.docker-cn.com\u0026#34;, \u0026#34;http://hub-mirror.c.163.com\u0026#34; ], \u0026#34;exec-opts\u0026#34;: [\u0026#34;native.cgroupdriver=systemd\u0026#34;] }   é…ç½®å†…æ ¸å‚æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13  ## é…ç½®ç½‘å¡è½¬å‘,çœ‹å€¼æ˜¯å¦ä¸º1 sysctl -a |grep \u0026#39;net.ipv4.ip_forward = 1\u0026#39; sysctl -a |grep \u0026#39;net.bridge.bridge-nf-call-iptables = 1\u0026#39; sysctl -a |grep \u0026#39;net.bridge.bridge-nf-call-ip6tables = 1\u0026#39; ## è‹¥æœªé…ç½®ï¼Œéœ€è¦æ‰§è¡Œå¦‚ä¸‹ cat \u0026lt;\u0026lt;EOF \u0026gt; /etc/sysctl.d/k8s.conf net.ipv4.ip_forward=1 net.bridge.bridge-nf-call-ip6tables=1 net.bridge.bridge-nf-call-iptables=1 EOF sysctl -p /etc/sysctl.d/k8s.conf   å®‰è£…docker 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  #å®‰è£…ç›¸å…³ä¾èµ– yum install -y yum-utils device-mapper-persistent-data lvm2 epel-release #æ·»åŠ é˜¿é‡Œäº‘docker-ceæº yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo yum clean all yum install -y docker-ce containerd.io #è®¾ç½®dockerå¼€æœºè‡ªå¯ systemctl enable docker #å¯åŠ¨dockeræœåŠ¡ systemctl start docker #æŸ¥çœ‹dockerä¿¡æ¯ docker info   é…ç½®container 1 2 3  containerd config default \u0026gt; /etc/containerd/config.toml systemctl daemon-reload systemctl restart containerd   å®‰è£…Kubernetes æ·»åŠ k8sæº 1 2 3 4 5 6 7 8 9  cat \u0026lt;\u0026lt;EOF \u0026gt; /etc/yum.repos.d/kubernetes.repo [kubernetes] name=Kubernetes baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/ enabled=1 gpgcheck=1 repo_gpgcheck=1 gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg EOF   å®‰è£…kubeletå’Œkubeadm   æ‰§è¡Œä¸‹è¿°æŒ‡ä»¤ï¼Œå®‰è£…kubelet kubeadm\n1  yum -y install kubectl kubelet kubeadm     æ‰§è¡Œä¸‹è¿°æŒ‡ä»¤ï¼Œä¿®æ”¹kubeleté…ç½®**ï¼ˆæŠŠkubeleté©±åŠ¨æ–¹å¼æ”¹ä¸ºå’Œdockeré©±åŠ¨æ–¹å¼ä¸€è‡´ï¼Œå¦åˆ™ä¼šæœ‰æŠ¥é”™ï¼‰**\n1 2 3  cat \u0026lt;\u0026lt;EOF \u0026gt;/etc/sysconfig/kubelet KUBELET_CGROUP_ARGS=\u0026#34;--cgroup-driver=systemd\u0026#34; EOF     æ‰§è¡Œä¸‹è¿°æ‰§è¡Œæ·»åŠ è‡ªå¯åŠ¨\n1  systemctl enable kubelet     å‰åºæ­¥éª¤æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œkubectl versionè¾“å‡ºç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºå…¶æ— æ³•è®¿é—®8080ç«¯å£ï¼Œç»“æœè¾“å‡ºä¸å®Œæ•´ã€‚é€ æˆæ­¤ç°è±¡çš„åŸå› ä¸ºæ²¡æœ‰æ‰§è¡Œkubeadm init\n  æ‰§è¡Œkubeadm init   æ‰§è¡Œä¸‹è¿°å‘½ä»¤è¿›è¡Œåˆå§‹åŒ–\n1  kubeadm init --v=5 --upload-certs --image-repository k8s.m.daocloud.io     å‰è¿°å‘½ä»¤çš„è¾“å‡ºå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºåˆ›å»ºè¿‡ç¨‹ä¸€ç›´é˜»å¡\n  ç»è¿‡ä¸€æ®µæ—¶é—´çš„ç­‰å¾…ï¼Œæœ€ç»ˆåœ¨æ§åˆ¶å°ä¸­å‡ºç°å¦‚ä¸‹é”™è¯¯ä¿¡æ¯ï¼Œkubeadm initè¿‡ç¨‹å¤±è´¥!\n  é—®é¢˜åˆ†æ\u0026amp;è§£å†³   ç”±äºåŸå§‹çš„æŠ¥é”™ä¿¡æ¯æ²¡æœ‰æä¾›å¤ªå¤šæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ•…é€šè¿‡ä¸‹è¿°å‘½ä»¤æ¥è¾“å‡ºå…¶å®Œæ•´çš„æ—¥å¿—2\n1 2  systemctl status kubelet -l \u0026gt; logs.txt cat logs.txt     æŸ¥çœ‹logs.txtçš„å†…å®¹ï¼Œè¾“å‡ºå¦‚ä¸‹\n  ä»ä¸Šå›¾ä¸­å¯çŸ¥æŠ¥é”™ä¿¡æ¯æ˜¯ç”±äºæ— æ³•ä¸‹è½½registry.k8s.io/pause:3.6å¯¼è‡´çš„ï¼Œç”±äºregistry.k8s.ioåœ¨å›½å†…è¢«å¢™ï¼Œä½†æ˜¯è‡ªå·±åœ¨æ‰§è¡Œkubeadm initçš„æ—¶å€™å·²ç»é€šè¿‡--image-repository k8s.m.daocloud.ioåˆ¶å®šäº†å›½å†…çš„é•œåƒï¼Œä¸ºå•¥è¿˜ä¼šè®¿é—®æ—§çš„é•œåƒå‘¢ï¼Ÿå¥‡æ€ªï¼\n  ç½‘ä¸Šæœç´¢ä¸€ç•ªåï¼Œåœ¨å…¶å®˜ç½‘è¯´æ˜ä¸­3çš„é¦–é¡µæœ‰å¦‚ä¸‹è¯´æ˜\n After its deprecation in v1.20, the dockershim component has been removed from the kubelet. From v1.24 onwards, you will need to either use one of the other supported runtimes (such as containerd or CRI-O) or use cri-dockerd if you are relying on Docker Engine as your container runtime. For more information about ensuring your cluster is ready for this removal, please see this guide.\n è€Œåœ¨å‰é¢é€šè¿‡kubectl versionå‘½ä»¤å¯çŸ¥å½“å‰çš„ç‰ˆæœ¬ä¸ºv1.26.0ï¼Œå¾ˆæ˜æ˜¾å…¶ä½¿ç”¨çš„æ˜¯containerdï¼Œè€Œè‡ªå·±æ²¡æœ‰å¯¹å…¶è¿›è¡Œç›¸å…³é…ç½®ã€‚\n  æ‰§è¡Œcat /etc/containerd/config.toml|grep registry.k8s.ioåçš„ç»“æœå¦‚ä¸‹ï¼Œcontainerdä½¿ç”¨çš„è¿˜æ˜¯é»˜è®¤é•œåƒï¼Œè‡³æ­¤é—®é¢˜åŸå› æ‰¾å‡ºï¼\n  ä¾æ¬¡æ‰§è¡Œä¸‹è¿°å‘½ä»¤æ¥é‡æ–°é…ç½®containerd\n1 2 3  sed -i \u0026#39;s/registry.k8s.io/registry.aliyuncs.com\\/google_containers/\u0026#39; /etc/containerd/config.toml systemctl daemon-reload systemctl restart containerd     ä¹‹åé‡æ–°æ‰§è¡Œä¸‹è¿°å‘½ä»¤\n1 2 3 4 5  # ç§»é™¤ä¹‹å‰çš„æ—§é…ç½® kubeadm reset -f # åˆå§‹åŒ– kubeadm init --v=5 --upload-certs --image-repository k8s.m.daocloud.io     è¿è¡Œä¸Šè¿°å‘½ä»¤åçš„è¾“å‡ºç±»ä¼¼å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºkubeadm inité¡ºåˆ©æ‰§è¡ŒæˆåŠŸï¼Œæ•´ä¸ªè¿‡ç¨‹è€—æ—¶ä¸è¶…è¿‡1åˆ†é’Ÿï¼Œè‡³æ­¤é—®é¢˜è§£å†³!\n    https://www.cnblogs.com/cerberus43/p/15881294.html\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n ä¹‹æ‰€ä»¥è¦å†™å…¥æ–‡ä»¶æ˜¯ç”±äºç›´æ¥æ‰§è¡Œsystemctl status kubeletæ—¶å…¶è¾“å‡ºä¿¡æ¯è¾ƒå¤šï¼Œåœ¨å±å¹•ä¸­æ˜¾ç¤ºä¸å®Œæ•´ï¼Œä¸åˆ©äºåˆ†æ\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.24.md\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/k8s/kubeadm-init-not-working-due-to-default-registry-config/","tags":["kubernetes","linux"],"title":"åˆ©ç”¨kubeadm initåˆå§‹åŒ–æ—¶ç”±äºregistry.k8s.io/pause:3.6å¯¼è‡´åˆå§‹åŒ–å¤±è´¥"},{"categories":["æŠ€æœ¯"],"contents":"use-package æºç åœ°å€ GitHub - jwiegley/use-package: A use-package declaration for simplifying your\u0026hellip;\nä»€ä¹ˆæ˜¯ use-packaeg use-package æ˜¯ç®¡ç† Emacs åŒ…(æ’ä»¶) çš„ä¸€ä¸ªå®ç®¡ç†å™¨ å¯ä»¥ç®¡ç†æ¯ä¸ªåŒ…çš„è®¾ç½®ï¼Œå¹¶é…ç½®å’Œå®šä¹‰\nå®‰è£… use-package  å°†ä»¥ä¸‹æºç å¤åˆ¶åˆ°ä½ çš„ init.el æ–‡ä»¶ä¸­, ç„¶åé‡å¯ Emacs 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  ;; æ·»åŠ ä¸‹è½½åŒ…çš„æ¥æº (eval-and-compile (customize-set-variable \u0026#39;package-archives \u0026#39;( (\u0026#34;melpa\u0026#34; . \u0026#34;http://melpa.org/packages/\u0026#34;) (\u0026#34;org\u0026#34; . \u0026#34;http://orgmode.org/elpa/\u0026#34;) (\u0026#34;gnu\u0026#34; . \u0026#34;https://elpa.gnu.org/packages/\u0026#34;) (\u0026#34;nongnu\u0026#34; . \u0026#34;https://elpa.nongnu.org/nongnu/\u0026#34;) )) (package-initialize) ;; å¦‚æœEmacs æ£€æµ‹åˆ°ä½ æ²¡æœ‰å®‰è£… use-package, é‚£ä¹ˆè‡ªåŠ¨å®‰è£… use-package (unless (package-installed-p \u0026#39;use-package) (package-refresh-contents) (package-install \u0026#39;use-package)) )     ä½¿ç”¨ use-package  ä¾‹å¦‚: å®‰è£… doom-themes ä¸»é¢˜ 1 2 3 4 5  ;; å®‰è£… doom-themes ä¸»é¢˜ï¼Œå¹¶å¯ç”¨ doom-one ä¸»é¢˜ (use-package doom-themes :ensure t :config (load-theme \u0026#39;doom-one t))     use-package å…³é”®è¯è§£é‡Š  :ensure t/nil æ˜¯å¦ä»ç½‘ç»œæºå®‰è£…ï¼Ÿ t ä»£è¡¨ä»ç½‘ç»œå®‰è£…ï¼Œnil ä»£è¡¨ä» Emacs å†…ç½®åŒ…åŠ è½½(å¦‚æœEmacså†…ç½®äº†è¿™ä¸ªåŒ…ï¼ŒEmacså¦‚æœæ²¡æœ‰é‚£ä¹ˆå°†æŠ¥é”™) :config åŠ è½½/ä¸‹è½½ åŒ… ä¹‹åå†åŠ è½½çš„é…ç½® :init åŠ è½½/ä¸‹è½½ åŒ… ä¹‹å‰åŠ è½½çš„é…ç½® :defer num æ‡’åŠ è½½ï¼Œnum ä»£è¡¨æ•°å­—, åœ¨ Emacs å¯åŠ¨å®Œæˆ numç§’åå†åŠ è½½ :config çš„å†…å®¹, å¯ä»¥å‡å°‘ Emacs å¯åŠ¨æ—¶é—´ è¿˜æœ‰æ›´å¤šå…³é”®è¯ä½¿ç”¨ï¼Œå¯ä»¥è‡ªå·±åˆ°é¡¹ç›®åœ°å€æŸ¥çœ‹ æ¯”å¦‚ bind è‡ªå®šä¹‰æŒ‰é”®ï¼Œ commands è°ƒç”¨æŸä¸ªå‘½ä»¤åå†åŠ è½½ :config é…ç½®  ","permalink":"http://isouthrain.github.io/post/20221215-emacs-use-package/","tags":["Emacs"],"title":"Emacs use-package åŒ…ç®¡ç†å™¨"},{"categories":["æŠ€æœ¯"],"contents":"google-translate æºç åœ°å€  GitHub - atykhonov/google-translate: Emacs interface to Google Translate  å®‰è£… google-translate  å®‰è£… use-package , å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨ use-package   1 2 3 4 5 6 7 8 9 10 11 12 13  (eval-and-compile (customize-set-variable \u0026#39;package-archives \u0026#39;( (\u0026#34;melpa\u0026#34; . \u0026#34;http://melpa.org/packages/\u0026#34;) (\u0026#34;org\u0026#34; . \u0026#34;http://orgmode.org/elpa/\u0026#34;) (\u0026#34;gnu\u0026#34; . \u0026#34;https://elpa.gnu.org/packages/\u0026#34;) (\u0026#34;nongnu\u0026#34; . \u0026#34;https://elpa.nongnu.org/nongnu/\u0026#34;) )) (package-initialize) (unless (package-installed-p \u0026#39;use-package) (package-refresh-contents) (package-install \u0026#39;use-package)) )    å®‰è£… google-translate   1 2 3 4 5 6 7 8  (use-package google-translate :ensure t :config (setq google-translate-default-source-language \u0026#34;auto\u0026#34; google-translate-default-target-language \u0026#34;zh-CN\u0026#34;) (setq google-translate-translation-directions-alist \u0026#39;((\u0026#34;en\u0026#34; . \u0026#34;zh-CN\u0026#34;) (\u0026#34;zh-CN\u0026#34; . \u0026#34;en\u0026#34;) (\u0026#34;en\u0026#34; . \u0026#34;ru\u0026#34;))) )   é…ç½®è§£é‡Š   è¯­è¨€æ¥æº, é»˜è®¤è‡ªåŠ¨\n1  (setq google-translate-default-source-language \u0026#34;auto\u0026#34;)     ç›®æ ‡è¯­è¨€ï¼Œä¸­æ–‡ç®€ä½“\n1  (setq google-translate-default-target-language \u0026#34;zh-CN\u0026#34;)     ç¿»è¯‘æ–¹æ¡ˆ\n è‹±æ–‡ -\u0026gt; ä¸­æ–‡, ä¸­æ–‡ -\u0026gt; è‹±æ–‡, è‹±æ–‡ -\u0026gt; ä¿„è¯­, ä½¿ç”¨ C-n åˆ‡æ¢   1 2  (setq google-translate-translation-directions-alist \u0026#39;((\u0026#34;en\u0026#34; . \u0026#34;zh-CN\u0026#34;) (\u0026#34;zh-CN\u0026#34; . \u0026#34;en\u0026#34;) (\u0026#34;en\u0026#34; . \u0026#34;ru\u0026#34;)))     ä½¿ç”¨  å°†å…‰æ ‡æ”¾åˆ°ä½ è¦ç¿»è¯‘çš„æ–‡æœ¬ä¸Š M-x google-translate-smooth-translate å›è½¦ C-n åˆ‡æ¢ç¿»è¯‘æ–¹æ¡ˆ    #bilibili { width: 100%; height: 550px; } @media only screen and (min-device-width: 320px) and (max-device-width: 480px) { #bilibili { width: 100%; height: 250px; } }  ","permalink":"http://isouthrain.github.io/post/20221213-emacs-google-translate/","tags":["Emacs"],"title":"Emacs google-translate ç¿»è¯‘æ–‡æœ¬"},{"categories":["Javaç¼–ç¨‹"],"contents":"åœ¨é¡¹ç›®ä¸­æŸä¸ªè¯·æ±‚çš„å‚æ•°é‡‡ç”¨äº†è¾ƒä¸ºå¤æ‚çš„è§„åˆ™æ‹¼æ¥è€Œæˆï¼Œåœ¨æœåŠ¡å™¨ç«¯æŸ¥è¯¢æ—¶éœ€è¦å°†å…¶è§£ææˆç¬¦åˆè¦æ±‚çš„Mapä¸Listç»„åˆçš„æ ¼å¼ã€‚ä¸€å¼€å§‹è‡ªå·±é‡‡ç”¨çš„æ˜¯ä¼ ç»Ÿçš„éå†æ–¹å¼å®ç°ï¼Œåç»­å‘ç°ç”¨Java8ä¸­å¼•å…¥çš„lambdaè¡¨è¾¾å¼åä»£ç å˜çš„æ›´ç®€æ´ã€æ›´ä¼˜é›…ï¼Œæ•…ç®€å•è®°å½•ä¸‹ã€‚\né—®é¢˜æè¿° é¡¹ç›®ä¸­æœ‰ç±»ä¼¼å¦‚ä¸‹çš„å­—ç¬¦ä¸²è¾“å…¥å‚æ•°\n1  010$$fengtai,010$$chaoyang,010$$haidain,027$$wuchang,027$$hongshan,027$$caidan,021$$changnin,021$$xuhui,020$$tianhe   è°ƒç”¨æ–¹æœŸæœ›å°†è¾“å…¥å‚æ•°è½¬åŒ–ä¸ºå¦‚ä¸‹æ ¼å¼(å³é¦–å…ˆæ ¹æ®,è¿›è¡Œåˆ†å‰²ï¼Œç„¶ååœ¨æ ¹æ®$$è¿›è¡Œè¿›ä¸€æ­¥çš„æ‹†åˆ†ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯æŒ‰ç…§$$å‰é¢çš„æ•°æ®ä¸ºkeyï¼Œ$$åé¢çš„æ•°æ®åˆ†åˆ«æ”¾å…¥åŒä¸€ä¸ªæ•°ç»„ä¸­ï¼Œæœ€ç»ˆç»“æœä»¥Map\u0026lt;String, List\u0026lt;String\u0026gt;\u0026gt;çš„æ ¼å¼è¿”å›)ã€‚\n1  {027=[wuchang, hongshan, caidan], 020=[tianhe], 010=[fengtai, chaoyang, haidain], 021=[changnin, xuhui]}   ä¼ ç»Ÿæ–¹å¼ æœ€å¼€å§‹ç”±äºéœ€è¦å°½å¿«éƒ¨ç½²è°ƒè¯•ï¼Œè‡ªå·±æ‰ç”¨çš„æ˜¯ä¼ ç»Ÿçš„éå†æ–¹å¼ï¼Œæ­¤ç§æ–¹å¼ç¼–ç èµ·æ¥å¾ˆç®€å•ï¼Œå…·å¤‡ç®€å•çš„JavaåŸºç¡€å³å¯å®ç°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  public Map\u0026lt;String, List\u0026lt;String\u0026gt;\u0026gt; parseParametersByIterate(String sensors) { List\u0026lt;String[]\u0026gt; dataList = Arrays.stream(sensors.split(\u0026#34;,\u0026#34;)).map(s -\u0026gt; s.split(\u0026#34;\\\\$\\\\$\u0026#34;)).collect(Collectors.toList()); Map\u0026lt;String, List\u0026lt;String\u0026gt;\u0026gt; resultMap = new HashMap\u0026lt;\u0026gt;(); for (String[] d : dataList) { List\u0026lt;String\u0026gt; list = resultMap.get(d[0]); if (list == null) { list = new ArrayList\u0026lt;\u0026gt;(); list.add(d[1]); resultMap.put(d[0], list); } else { list.add(d[1]); } } return resultMap; }   åŸºäºLambdaå®ç° åœ¨Stack Overflowä¸Šå’¨è¯¢åï¼Œå‘ç°ç”¨lambdaå®ç°æ›´ç®€æ´ï¼Œåªç”¨ä¸€è¡Œä»£ç å°±èƒ½æå®š!\n1 2 3 4 5 6 7  public Map\u0026lt;String, List\u0026lt;String\u0026gt;\u0026gt; parseByLambda(String data) { Map\u0026lt;String, List\u0026lt;String\u0026gt;\u0026gt; resultMap = Arrays.stream(data.split(\u0026#34;,\u0026#34;)) .map(s -\u0026gt; s.split(\u0026#34;\\\\$\\\\$\u0026#34;)) .collect(Collectors.groupingBy(s -\u0026gt; s[0], Collectors.mapping(s -\u0026gt; s[1], Collectors.toList()))); return resultMap; }   ä¸Šè¿°ä»£ç çš„æ ¸å¿ƒæ˜¯é‡‡ç”¨Java8ä¸­å¼•å…¥çš„Collectorsç±»ï¼Œé‡‡ç”¨å…¶ä¸­çš„groupingByå’Œmappingæ–¹æ³•å®ç°ï¼Œè€Œè‡ªå·±ç”¨çš„æœ€å¤šçš„åªæ˜¯toListå’ŒtoMapï¼ŒåŸºæœ¬åŠŸæœ‰å¾…åŠ å¼ºï¼\n","permalink":"http://isouthrain.github.io/post/java-core/using-lambda-to-parse-and-group-data/","tags":["Java"],"title":"åˆ©ç”¨Java8ä¸­çš„lambdaæ¥å®ç°å­—ç¬¦ä¸²çš„è§£æä¸åˆ†ç»„"},{"categories":[],"contents":"","permalink":"http://isouthrain.github.io/search/","tags":[],"title":"æœç´¢ç»“æœå±•ç¤º"},{"categories":["æŒç»­é›†æˆ","å®¹å™¨åŒ–"],"contents":"è®°å½•ä¸‹è‡ªå·±åœ¨ä½¿ç”¨KubeSphereè¿‡ç¨‹ä¸­ç”±äºYAMLä¸­é”™è¯¯çš„é…ç½®å¯¼è‡´Kubernetesç»å¸¸èµ„æºç´§å¼ è€Œæ— æ³•åˆ›å»ºä¸éƒ¨ç½²æ–°èŠ‚ç‚¹çš„é—®é¢˜ã€‚\né—®é¢˜æè¿° éƒ¨é—¨åœ¨ä½¿ç”¨KubeSphereè¿‡ç¨‹ä¸­ç»å¸¸é‡åˆ°ç±»ä¼¼å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç”±äºkubernetesæ— æ³•è°ƒåº¦è€Œå¯¼è‡´çš„æ— æ³•éƒ¨ç½²çš„é—®é¢˜\nè¿›ä¸€æ­¥æŸ¥çœ‹æŠ¥é”™èŠ‚ç‚¹ä¿¡æ¯ä¼šå‘ç°æç¤ºCPUèµ„æºä¸è¶³ï¼Œä»è€Œå¯¼è‡´æ— æ³•éƒ¨ç½²ã€‚\nä¹‹å‰è‡ªå·±é‡‡å–çš„è§£å†³æ–¹æ¡ˆæ˜¯æš´åŠ›çš„åˆ é™¤ä¸€éƒ¨åˆ†èŠ‚ç‚¹æ¥é‡Šæ”¾CPUèµ„æºï¼Œä½†æ­¤ç§æ–¹å¼æ²»æ ‡ä¸æ²»æœ¬ï¼Œä¸”éšç€KubeSphereåœ¨éƒ¨é—¨å†…éƒ¨ä½¿ç”¨çš„æ™®åŠï¼Œæ­¤é—®é¢˜å‘ç”Ÿçš„é¢‘ç‡è¶Šæ¥è¶Šé«˜ï¼Œåªèƒ½æƒ³åŠæ³•ä»æ ¹æºä¸Šå¤„ç†ã€‚\nåˆ†æä¸è§£å†³ ç”±äºæç¤ºçš„æ˜¯CPUèµ„æºä¸è¶³ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦ä¸ºCPUçš„é—®é¢˜ï¼Œé‡‡ç”¨lscpu | egrep 'Model name|Socket|Thread|NUMA|CPU\\(s\\)'å’Œfree -gåˆ†åˆ«æŸ¥çœ‹CPUå’Œå†…å­˜ä¿¡æ¯ï¼Œç»“æœå¦‚ä¸‹\nä»æŸ¥è¯¢ç»“æœå¯çŸ¥ç³»ç»Ÿçš„CPUé…ç½®å’Œå†…å­˜é…ç½®éƒ½å¾ˆé«˜ï¼Œè€Œè‡ªå·±åœ¨KubeSphereä¸­éƒ¨ç½²çš„éƒ½æ˜¯ä¸€äº›æ™®é€šçš„Javaç¨‹åºï¼Œä¸å¯èƒ½å ç”¨ç‰¹åˆ«å¤šçš„CPUå’Œå†…å­˜èµ„æºï¼ŒLinuxæœåŠ¡å™¨æœ¬èº«çš„é…ç½®é—®é¢˜æ’é™¤ã€‚\næ¥ä¸‹æ¥åˆ©ç”¨kubectl describe nodeæŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹\nåœ¨ä¸Šå›¾ä¸­å¯å‘ç°ç›¸å…³èŠ‚ç‚¹æ±‡æ€»åçš„CPUå’Œå†…å­˜å ç”¨çš„ç™¾åˆ†æ¯”éå¸¸å¤§ï¼Œå…¶ä¸­CPUåœ¨Requestséƒ¨åˆ†å æ¯”ä¸º84%ï¼Œç”±äºLinuxç³»ç»Ÿè‡ªèº«è¿è¡Œå’Œè¿è¡ŒKubesphereä¸Kuberneteséƒ½éœ€è¦å ç”¨ä¸€å®šçš„CPUèµ„æºï¼Œä»è€Œå¯¼è‡´å½“Kubersphereä¸­éƒ¨ç½²çš„é¡¹ç›®è¶…è¿‡ä¸€å®šæ•°é‡æ—¶ï¼ŒLinuxç³»ç»Ÿæ— æ³•ç»™Kubernetesåˆ†é…è¶³å¤Ÿçš„CPUèµ„æºå¯¼è‡´éƒ¨ç½²å¤±è´¥ã€‚è‡³æ­¤ï¼Œé—®é¢˜çš„è¡¨é¢åŸå› æ‰¾å‡ºæ¥äº†ã€‚\nè¿›ä¸€æ­¥åˆ†æä¸Šé¢çš„é—®é¢˜ï¼Œè‡ªå·±è§‰å¾—å¾ˆå¥½å¥‡çš„æ˜¯ä¸ºå•¥Requestséƒ¨åˆ†å ç”¨çš„èµ„æºï¼Œè‡ªå·±åœ¨å¯¹åº”çš„YAMLæ–‡ä»¶ä¸­å‹æ ¹å°±æ²¡æŒ‡å®šRequestsç›¸å…³çš„å‚æ•°ï¼Œæ£€æŸ¥ä»£ç å‘ç°Limitsé…ç½®çš„å€¼æ¯”è¾ƒå¤§\n1 2 3 4  resources:limits:cpu:500mmemory:2000Mi  åŒæ—¶åŸºäºkubectl describe nodeå‘ç°ç›¸å…³èŠ‚ç‚¹çš„Requestså’ŒLimitsçš„å€¼éƒ½ç›¸åŒï¼ŒçŒœæµ‹æ˜¯å¦Kubernetesé»˜è®¤å°†Ruquestsçš„å€¼è®¾ç½®ä¸ºä¸Limitsçš„å€¼ç›¸åŒã€‚\nåœ¨Kuberneteså®˜ç½‘å‘ç°å¦‚ä¸‹è¯´æ˜\n Note: If you specify a limit for a resource, but do not specify any request, and no admission-time mechanism has applied a default request for that resource, then Kubernetes copies the limit you specified and uses it as the requested value for the resource.\n ä¸Šè¿°æ–‡å­—è¯´æ˜å½“æˆ‘ä»¬åœ¨YAMLæ–‡ä»¶ä¸­åªè®¾ç½®äº†Limitsä½†æ˜¯æ²¡æœ‰æŒ‡å®šRequestsï¼Œåˆ™Kubernetesä¼šå°†Requestçš„å€¼é»˜è®¤è®¾ç½®ä¸ºä¸Limitsç›¸åŒï¼Œä»è€Œå¯¼è‡´CPUå’Œå†…å­˜èµ„æºå ç”¨éƒ½å¾ˆé«˜ï¼Œè‡³æ­¤é—®é¢˜æ ¹æºæ‰¾åˆ°ï¼\nè§£å†³çš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œè¦ä¹ˆç§»é™¤æ‰Limitsï¼Œè®©Kubernetesæ ¹æ®Linuxç³»ç»Ÿèµ„æºå’ŒèŠ‚ç‚¹çŠ¶å†µç»™æˆ‘ä»¬åŠ¨æ€çš„åˆ†é…èŠ‚ç‚¹ï¼Œæˆ–è€…åŒæ—¶æŒ‡å®šRequestså’ŒLimitså³å¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  # å±è”½æ­¤éƒ¨åˆ†ä»£ç #resources: # limits: # cpu: 500m# memory: 2000Mi # æˆ–è€…æ˜¾ç¤ºé…ç½®requestå’Œlimitsresources:limits:cpu:500mmemory:2000Mirequests:cpu:20mmemory:64Mi  ç»éªŒæ•™è®­ï¼š éœ€è¦å¯¹è‡ªå·±é¡¹ç›®ä¸­çš„ä»£ç è¦æœ‰æ›´æ·±å…¥çš„ç†è§£ï¼Œå°¤å…¶æ˜¯é…ç½®æ–‡ä»¶ï¼Œè¦åšåˆ°ç†è§£æ¯ä¸€è¡Œçš„ä½œç”¨ï¼Œä¸èƒ½ç®€å•çš„å¤åˆ¶åˆ«äººçš„ä»£ç ã€‚\n å‚è€ƒæ–‡æ¡£ï¼š\n  https://kubesphere.io/zh/blogs/deep-dive-into-the-k8s-request-and-limit/\n  https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/\n ","permalink":"http://isouthrain.github.io/post/k8s/cpu-resource-not-enough-due-to-invalid-k8s-config/","tags":["kubernetes","kubesphere","linux"],"title":"ç”±äºk8sä¸­çš„é”™è¯¯é…ç½®å¯¼è‡´æ— æ³•åˆ›å»ºæ–°èŠ‚ç‚¹"},{"categories":["ä¸ªäººåšå®¢"],"contents":"è®°å½•ä¸‹ä¸ªäººHugoåšå®¢ä½¿ç”¨Evenä¸»é¢˜æ—¶çš„ä¸€äº›ä½¿ç”¨å¿ƒå¾—ä¸ä¸ªäººæ”¹è¿›ã€‚\nGitHub Actionsè‡ªåŠ¨éƒ¨ç½² å‚è§åˆ©ç”¨GitHub Actionå®ç°Hugoåšå®¢åœ¨GitHub Pagesè‡ªåŠ¨éƒ¨ç½²ã€‚\næ”¹è¿›Back to top èƒŒæ™¯ åŸå§‹çš„è¿”å›é¡¶éƒ¨æŒ‰é’®å¤ªå°ä¸”èƒŒæ™¯æç¤ºè‰²ä¸æ˜æ˜¾ï¼ŒæŸ¥çœ‹èµ·æ¥ä¸ç›´è§‚ã€‚\nä¿®æ”¹ä»£ç  åœ¨assets/sass/_partial/_back-to-top.scssä¸­ä¿®æ”¹å¦‚ä¸‹é…ç½®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  .back-to-top { display: none; transition-property: transform; transition-timing-function: ease-out; transition-duration: 0.3s; z-index: 10; background-color: $content-blockquote-backgroud; position: fixed; right: 10px; bottom: 10px; height: 30px; width: 50px; text-align: center; padding-top: 20px; border-radius: 20%; overflow: hidden; \u0026amp;:hover { transform: translateY(-5px); } .icon-up { vertical-align: top; } }   è¿è¡Œæ•ˆæœ æ”¹è¿›åçš„æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼Œä¸ä»…æŒ‰é’®å˜å¤§ï¼Œè€Œä¸”ä¹Ÿèƒ½æ ¹æ®ä¸åŒçš„ä¸»é¢˜é¢œè‰²åŠ¨æ€çš„è¿›è¡Œæ”¹å˜ã€‚\nå…¶å®ƒ åœ¨assets/sass/_partial/_back-to-top.scssä¸­æœ‰å¦‚ä¸‹ä»£ç ç”¨äºæ§åˆ¶æ­¤æŒ‰é’®åªæœ‰åœ¨éæ‰‹æœºæµè§ˆå™¨çš„ç¯å¢ƒä¸‹æ˜¾ç¤ºï¼Œæ­¤æ–¹å¼å¯ç”¨äºå…¶å®ƒéœ€è¦åœ¨æ‰‹æœºæµè§ˆå™¨ç¯å¢ƒç¦ç”¨çš„åœºæ™¯ã€‚\n1 2 3 4 5  @includemax-screen() { .back-to-top { display: none !important; } }   åŒºåˆ†Draftä¸éDraft èƒŒæ™¯   æœ‰æ—¶å€™ä¼šé‡åˆ°ä¸€äº›å…¸å‹åœºæ™¯æˆ–è€…çµæ„Ÿçªå‘ï¼Œæƒ³æŠŠå®ƒä»¬å†™å…¥åšå®¢ä¸­ï¼Œä½†ç”±äºæ—¶é—´é™åˆ¶ä¸€æ—¶åŠä¼šåˆéš¾ä»¥å®Œæˆï¼Œå¯åˆ›å»ºå¯¹åº”çš„markdownæ–‡ä»¶ï¼Œå°†draftè®¾ç½®ä¸ºtrueï¼Œç„¶ååœ¨æ­£å¸¸æ‰“åŒ…æ—¶å³å¯æ’é™¤è¿™äº›è‰ç¨¿æ–‡ç« ï¼Œåœ¨æœ¬åœ°ç¼–å†™æ—¶å¯ç”¨ç±»ä¼¼hugo server -w -Dçš„æŒ‡ä»¤æ¥åŒ…å«è‰ç¨¿æ–‡ç« ã€‚\n  å½“é‡‡ç”¨hugo server -w -Dæ—¶åœ¨æ–‡ç« åˆ—è¡¨ä¸­ä¸ä¼šæ˜¾ç¤ºæ˜¯å¦ä¸ºè‰ç¨¿æ–‡ç« ï¼Œä½¿ç”¨ä¸Šæœ‰äº›ä¸æ–¹ä¾¿\n  ä¿®æ”¹ä»£ç    æµ‹è¯•assets/sass/_partial/_archive.scssæ·»åŠ å¦‚ä¸‹ä»£ç \n1 2 3  .archive-post-status { color: $theme-color; }     layouts/_default/section.htmlä¸­æ·»åŠ å¦‚ä¸‹ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  \u0026lt;span class=\u0026#34;archive-post-time\u0026#34;\u0026gt; {{ $element.Date.Format \u0026#34;01-02\u0026#34; }} \u0026lt;/span\u0026gt; \u0026lt;!-- show draft status in none production environment --\u0026gt; {{- if not (in (slice (getenv \u0026#34;HUGO_ENV\u0026#34;) hugo.Environment) \u0026#34;production\u0026#34;) -}} \u0026lt;span class=\u0026#34;archive-post-status\u0026#34;\u0026gt; {{ if .Draft }} \u0026amp;#9711; {{ else }} \u0026amp;#9632; {{ end }} \u0026lt;/span\u0026gt; {{ end }} \u0026lt;span class=\u0026#34;archive-post-title\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;{{ $element.RelPermalink }}\u0026#34; class=\u0026#34;archive-post-link\u0026#34;\u0026gt; {{ .Title }} {{ .Title }} \u0026lt;/a\u0026gt; \u0026lt;/span\u0026gt;     layouts/_default/taxonomy.htmlä¸­æ·»åŠ å¦‚ä¸‹ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  \u0026lt;span class=\u0026#34;archive-post-time\u0026#34;\u0026gt; {{ .Date.Format (.Site.Params.dateFormatToUse | default \u0026#34;2006-01-02\u0026#34;) }} \u0026lt;/span\u0026gt; \u0026lt;!-- show draft status in none production environment --\u0026gt; {{- if not (in (slice (getenv \u0026#34;HUGO_ENV\u0026#34;) hugo.Environment) \u0026#34;production\u0026#34;) -}} \u0026lt;span class=\u0026#34;archive-post-status\u0026#34;\u0026gt; {{ if .Draft }} \u0026amp;#9711; {{ else }} \u0026amp;#9632; {{ end }} \u0026lt;/span\u0026gt; {{ end }} \u0026lt;span class=\u0026#34;archive-post-title\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;{{ .RelPermalink }}\u0026#34; class=\u0026#34;archive-post-link\u0026#34;\u0026gt; {{ .Title }} {{ .Title }} \u0026lt;/a\u0026gt; \u0026lt;/span\u0026gt;     è¿è¡Œæ•ˆæœ éƒ¨ç½²æ—¶æ‰æ·»åŠ è®¿é—®ç»Ÿè®¡ èƒŒæ™¯ åœ¨æœ¬åœ°ç¼–å†™åšå®¢æ—¶ï¼Œéœ€è¦å¤šæ¬¡è®¿é—®æœªå®Œæˆçš„é¡µé¢ï¼Œæ­¤ç§é¡µé¢æ²¡å¿…è¦æ·»åŠ è®°å½•åˆ°ç½‘ç«™è®¿é—®æ¬¡æ•°ç»Ÿè®¡ä¸­ã€‚\nä¿®æ”¹ä»£ç  åœ¨layouts/partials/scripts.htmlä¸­ä¿®æ”¹å¦‚ä¸‹ï¼Œåœ¨æœ€å¤–å±‚æ·»åŠ  if (in (slice (getenv \u0026quot;HUGO_ENV\u0026quot;) hugo.Environment) \u0026quot;production\u0026quot;)æ¥åˆ¤æ–­ç¯å¢ƒ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42  \u0026lt;!-- only work in production mode --\u0026gt; {{- if (in (slice (getenv \u0026#34;HUGO_ENV\u0026#34;) hugo.Environment) \u0026#34;production\u0026#34;) -}} \u0026lt;!-- Analytics --\u0026gt; {{- if .Site.GoogleAnalytics -}} {{ template \u0026#34;_internal/google_analytics_async.html\u0026#34; . }} {{- end -}} {{- with .Site.Params.baiduAnalytics -}} \u0026lt;script id=\u0026#34;baidu_analytics\u0026#34;\u0026gt; var _hmt = _hmt || []; (function() { if (window.location.hostname === \u0026#39;localhost\u0026#39;) return; var hm = document.createElement(\u0026#34;script\u0026#34;); hm.async = true; hm.src = \u0026#34;https://hm.baidu.com/hm.js?{{.}}\u0026#34;; var s = document.getElementsByTagName(\u0026#34;script\u0026#34;)[0]; s.parentNode.insertBefore(hm, s); })(); \u0026lt;/script\u0026gt; {{- end }} \u0026lt;!-- baidu push --\u0026gt; {{- if .Site.Params.baiduPush -}} \u0026lt;script id=\u0026#34;baidu_push\u0026#34;\u0026gt; (function(){ if (window.location.hostname === \u0026#39;localhost\u0026#39;) return; var bp = document.createElement(\u0026#39;script\u0026#39;); bp.async = true; var curProtocol = window.location.protocol.split(\u0026#39;:\u0026#39;)[0]; if (curProtocol === \u0026#39;https\u0026#39;) { bp.src = \u0026#39;https://zz.bdstatic.com/linksubmit/push.js\u0026#39;; } else { bp.src = \u0026#39;http://push.zhanzhang.baidu.com/push.js\u0026#39;; } var s = document.getElementsByTagName(\u0026#34;script\u0026#34;)[0]; s.parentNode.insertBefore(bp, s); })(); \u0026lt;/script\u0026gt; {{- end }} {{- end -}}   ä½¿ç”¨æ–¹å¼ åœ¨é¡¹ç›®éƒ¨ç½²æ—¶é€šè¿‡æ·»åŠ -e \u0026quot;production\u0026quot;æ¥æŒ‡å®šä¸ºç”Ÿäº§ç¯å¢ƒï¼Œå¦‚hugo -b \u0026quot;https://lucumt.info/\u0026quot; -e \u0026quot;production\u0026quot;ã€‚\nFork me on Github åŸå§‹ä»£ç æ¥æºhttps://github.com/olOwOlo/hugo-theme-even/pull/4121ï¼Œå‚è€ƒä»£ç è§å¦‚ä½•åœ¨åšå®¢å›­æ·»åŠ  Fork me on GitHub å½©å¸¦æ•ˆæœ\nä¿®æ”¹ä»£ç    config.tomlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œè‹¥ithubForkURLå€¼ä¸ºç©ºï¼Œåˆ™ä¸æ˜¾ç¤ºFork me on GitHub\n1 2 3  [params] githubForkURL = \u0026#34;\u0026#34; # Fork me on Github repository address # Fork me on Githubä»“åº“åœ°å€     layouts/_default/baseof.htmlä¸­æ·»åŠ å¦‚ä¸‹ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13  {{ with .Site.Params.githubForkURL }} \u0026lt;!-- fork me on github ---\u0026gt; \u0026lt;!-- see https://github.blog/2008-12-19-github-ribbons/ --\u0026gt; \u0026lt;a href=\u0026#34;{{ . }}\u0026#34; title=\u0026#34;{{ . }}\u0026#34; target=\u0026#34;_blank\u0026#34;\u0026gt; \u0026lt;img style=\u0026#34;position: fixed; top: 0; right: 0; border: 0; z-index:9999;\u0026#34; src=\u0026#34;/forkme_right_gray.png\u0026#34; alt=\u0026#34;Fork me on GitHub\u0026#34;\u0026gt; \u0026lt;/a\u0026gt; {{ end }} \u0026lt;!-- åœ¨æ­¤ä»£ç å—ä¹‹å‰æ·»åŠ  --\u0026gt; \u0026lt;main id=\u0026#34;main\u0026#34; class=\u0026#34;main\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;content-wrapper\u0026#34;\u0026gt;     staticç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªåä¸ºforkme_right_gray.pngçš„å›¾ç‰‡ï¼Œ\n  è¿è¡Œæ•ˆæœ ä»£ç å—å¯å¤åˆ¶ åŸå§‹ä»£ç æ¥æºhttps://github.com/olOwOlo/hugo-theme-even/pull/413\nä¿®æ”¹ä»£ç    config.tomlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œç”¨äºæ§åˆ¶æ˜¯å¦å¼€å¯ä»£ç å¤åˆ¶åŠŸèƒ½\n1 2  [params] enableCopyCode = true     assets/sass/_partial/_post/_code.scssæ·»åŠ å¦‚ä¸‹ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12  .copy-code { position: absolute; right: 0; z-index: 2; font-size: .9em !important; padding: 0px 1.5rem !important; color: #b1b1b1; font-family: Arial; font-weight: bold; cursor: pointer; user-select: none; }     åœ¨layouts/partials/scripts.htmlåº•éƒ¨æ·»åŠ å¦‚ä¸‹ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  \u0026lt;!-- copy to clipboard --\u0026gt; {{- if .Site.Params.enableCopyCode -}} \u0026lt;script\u0026gt; function createCopyButton(highlightDiv) { const div = document.createElement(\u0026#34;div\u0026#34;); div.className = \u0026#34;copy-code\u0026#34;; div.innerText = \u0026#34;Copy\u0026#34;; div.addEventListener(\u0026#34;click\u0026#34;, () =\u0026gt; copyCodeToClipboard(div, highlightDiv) ); addCopyButtonToDom(div, highlightDiv); } async function copyCodeToClipboard(button, highlightDiv) { const codeToCopy = highlightDiv.querySelector(\u0026#34;:last-child \u0026gt; .chroma \u0026gt; code\u0026#34;) .innerText; await navigator.clipboard.writeText(codeToCopy); button.blur(); button.innerText = \u0026#34;Copied!\u0026#34;; setTimeout(() =\u0026gt; button.innerText = \u0026#34;Copy\u0026#34;, 2000); } function addCopyButtonToDom(button, highlightDiv) { highlightDiv.insertBefore(button, highlightDiv.firstChild); const wrapper = document.createElement(\u0026#34;div\u0026#34;); wrapper.className = \u0026#34;highlight-wrapper\u0026#34;; highlightDiv.parentNode.insertBefore(wrapper, highlightDiv); wrapper.appendChild(highlightDiv); } var isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent); if(!isMobile){ document.querySelectorAll(\u0026#34;.highlight\u0026#34;).forEach((highlightDiv) =\u0026gt; createCopyButton(highlightDiv)); } \u0026lt;/script\u0026gt; {{ end }}     è¿è¡Œæ•ˆæœ åœ¨éæ‰‹æœºæµè§ˆå™¨ä¸­å½“å¼€å¯enableCopyCodeå¼€å…³åï¼Œåœ¨ä»£ç å·¦ä¾§ä¼šå‡ºç°å¦‚ä¸‹æ•ˆæœ2\næ·»åŠ æœç´¢åŠŸèƒ½ ä¿®æ”¹ä»£ç  æ­¤éƒ¨åˆ†çš„ä»£ç ä¸»è¦å‚è€ƒç»™hugoæ·»åŠ æœç´¢åŠŸèƒ½åŸºäºfuseå®ç°çš„ï¼Œç”±äºåŸºäºæ­¤åšæ–‡å®ç°çš„æœç´¢æ•ˆæœå±•ç¤ºæ¯”è¾ƒç®€é™‹ï¼Œæ•…ä¸ªäººåšäº†å¦‚ä¸‹æ”¹è¿›:\n  åœ¨layouts/_default/search.htmlä¸‹æ·»åŠ äº†ï¼Œç”¨äºå°†æœç´¢ç»“æœç”¨åšå®¢é»˜è®¤çš„é£æ ¼åŒ…è£…èµ·æ¥\n1  {{ define \u0026#34;main\u0026#34; }} â€¦ {{ end }}     åœ¨layouts/_default/baseof.htmlå®ç°å‰è¿°æ­¥éª¤ä¸­ç›¸å…³çš„å®šä¹‰\n1 2 3 4 5 6 7 8 9 10  {{ block \u0026#34;main\u0026#34; . }} \u0026lt;main id=\u0026#34;main\u0026#34; class=\u0026#34;main\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;content-wrapper\u0026#34;\u0026gt; \u0026lt;div id=\u0026#34;content\u0026#34; class=\u0026#34;content\u0026#34;\u0026gt; {{ block \u0026#34;content\u0026#34; . }}{{ end }} \u0026lt;/div\u0026gt; {{ partial \u0026#34;comments.html\u0026#34; . }} \u0026lt;/div\u0026gt; \u0026lt;/main\u0026gt; {{ end }}     åœ¨assets/sass/_base.scssæ·»åŠ ä¸‹è¿°æ ·å¼ï¼Œç”¨äºåˆ†éš”æ˜¾ç¤ºä¸åŒçš„æ£€ç´¢ç»“æœ\n1 2 3 4 5 6 7  #search-results-info { display: none; } .search_list { border-top: $post-border; }     è¿è¡Œæ•ˆæœ3   é»˜è®¤çš„æœç´¢ç•Œé¢\n  è¾“å…¥å…³é”®å­—åï¼Œæœ‰æ˜¾ç¤ºç»“æœçš„ç•Œé¢\n    æˆªè‡³æœ¬æ–‡ç¼–å†™æ—¶(2022å¹´9æœˆ)Evenä¸»é¢˜çš„ä½œè€…å°šæœªmergeè¿™äº›pull request\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n æ­¤éƒ¨åˆ†çš„æç¤ºæ–‡å­—é‡‡ç”¨ç¡¬ç¼–ç copyï¼Œå°šæœªåšæˆé€šç”¨çš„å›½é™…åŒ–ä»£ç \u0026#160;\u0026#x21a9;\u0026#xfe0e;\n ç”±äºåˆ†è¯çš„åŸå› ï¼Œä¸­æ–‡æ£€æµ‹ç»“æœå¯èƒ½å­˜åœ¨ä¸€å®šè¯¯å·®\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/hugo/share-experience-for-using-hugo-even-theme/","tags":["hugo","Go"],"title":"ä¸ªäººHugoåšå®¢å…³äºEvenä¸»é¢˜çš„ä¸€äº›ä½¿ç”¨æ”¹è¿›"},{"categories":["æŒç»­é›†æˆ"],"contents":"åŸºäºKubeSphereä½¿ç”¨å¿ƒå¾—ç»™éƒ¨é—¨æ­å»ºäº†devã€sitã€testã€prodè¿™4å¥—ç¯å¢ƒä¹‹åï¼Œä¸€å¼€å§‹ä½¿ç”¨è¾ƒä¸ºé¡ºåˆ©ï¼Œä½†éšç€é¡¹ç›®çš„æ¨è¿›ä»¥åŠå¼€å‘äººå‘˜çš„å¢å¤šï¼ŒåŒæ—¶æœ‰å¤šä¸ªåŠŸèƒ½æ¨¡å—éœ€è¦å¹¶è¡Œå¼€å‘ä¸æµ‹è¯•ï¼Œå¯¼è‡´åŸæœ‰çš„4å¥—ç¯å¢ƒä¸å¤Ÿç”¨ã€‚ç»è¿‡ä¸€ç•ªæ‘¸ç´¢åï¼Œå®ç°äº†ç»“åˆNacosåœ¨KubeSphereä¸­åŠ¨æ€é…ç½®å¤šå¥—ç¯å¢ƒåŠŸèƒ½ï¼Œé€šè¿‡ä¿®æ”¹Nacosä¸­çš„JSONé…ç½®æ–‡ä»¶å¯å¾ˆå®¹æ˜“çš„ä»4å¥—æ‰©å±•ä¸º16å¥—ç”šè‡³æ›´å¤šã€‚\nåŸå®ç°æ–¹å¼ æœ€å¼€å§‹è‡ªå·±åªå‡†å¤‡äº†devã€sitã€testã€prodè¿™4å¥—ç¯å¢ƒï¼Œç”±äºç¯å¢ƒæ•°é‡ä¸å¤šï¼Œå¯¹äºä¸åŒç¯å¢ƒçš„ç«¯å£é…ç½®è‡ªå·±æ˜¯åœ¨ä»£ç ä¸­ç›´æ¥å®ç°çš„1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  switch(PRODUCT_PHASE) { case \u0026#34;dev\u0026#34;: env.NODE_PORT = 12002 break case \u0026#34;sit\u0026#34;: env.NODE_PORT = 13002 break case \u0026#34;test\u0026#34;: env.NODE_PORT = 14002 break case \u0026#34;prod\u0026#34;: env.NODE_PORT = 15002 break }   æ­¤ç§æ–¹å¼å°†ç›¸å…³ç¯å¢ƒç›¸å…³çš„é…ç½®å…¨éƒ½é›†ä¸­åˆ°Jenkinsæµæ°´çº¿ä¸­ï¼Œåœ¨æœ€åˆçš„ä½¿ç”¨é˜¶æ®µå¯å‡å°‘é…ç½®æ–‡ä»¶æ•°é‡ï¼Œèƒ½å¤Ÿå¿«é€Ÿç¼–å†™æµæ°´çº¿ï¼Œå¿«é€Ÿäº¤ä»˜ä½¿ç”¨ã€‚ä½†éšç€é¡¹ç›®è§„æ¨¡ä¸äººå‘˜çš„æ‰©å¤§ï¼Œå½“éœ€è¦çµæ´»é…ç½®å¤šå¥—ç¯å¢ƒæ—¶ï¼Œæ­¤ç§æ–¹å¼é‡‡ç”¨ç¡¬ç¼–ç çš„æ–¹å¼ä¼šæ˜¾å¾—æ‰è¥Ÿè§è‚˜ã€‚\nä¿®æ”¹åçš„æ–¹å¼ ç»“åˆé¡¹ç›®å®é™…æƒ…å†µä»¥åŠé¿å…åç»­å†æ¬¡ä¿®æ”¹KubeSphereæµæ°´çº¿ï¼Œä¸ºäº†å®ç°çµæ´»çš„é…ç½®å¤šå¥—ç¯å¢ƒï¼Œè‡ªå·±åˆ¶å®šäº†å¦‚ä¸‹2ä¸ªè§„åˆ™ï¼š\n ç«¯å£ä¿¡æ¯å­˜æ”¾åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼ŒKubeSphereåœ¨æ„å»ºæ—¶å»æµæ°´çº¿è¯»å–ç›¸å…³é…ç½® å½“éœ€è¦æ‰©å±•ç¯å¢ƒæˆ–ä¿®æ”¹ç«¯å£æ—¶ï¼Œä¸éœ€è¦ä¿®æ”¹KubeSphereä¸­çš„æµæ°´çº¿ï¼Œåªéœ€è¦ä¿®æ”¹å¯¹åº”çš„ç«¯å£é…ç½®æ–‡ä»¶å³å¯2  ç”±äºé¡¹ç›®ä¸­é‡‡ç”¨Nacosä½œä¸ºé…ç½®ä¸­å¿ƒä¸æœåŠ¡ç®¡ç†å¹³å°ï¼Œæ•…å†³å®šé‡‡ç”¨Nacosä½œä¸ºç«¯å£çš„é…ç½®ä¸­å¿ƒï¼Œå®ç°æµç¨‹å¦‚ä¸‹ï¼š\nåŸºäºä¸Šè¿°æµç¨‹ï¼Œåœ¨ä¸ªäººé¡¹ç›®ä¸­é¢ä¸´å¦‚ä¸‹é—®é¢˜ï¼š\n åˆ©ç”¨Groovyä»£ç è·å–Nacosä¸­ç‰¹å®šçš„ç«¯å£JSONé…ç½®æ–‡ä»¶ï¼Œå¹¶èƒ½åŠ¨æ€è§£æ åˆ©ç”¨Groovyä»£ç æ ¹æ®è¾“å…¥è¾“å…¥å‚æ•°åŠ¨æ€çš„è·å–Nacosä¸­å¯¹åº”çš„namespace ç”±äºç¯å¢ƒçš„å¢å¤šï¼Œä¸å¯èƒ½æ¯å¥—ç¯å¢ƒéƒ½å‡†å¤‡ä¸€ä¸ªYAMLæ–‡ä»¶ï¼Œæ­¤æ—¶éœ€è¦åŠ¨æ€çš„è¯»å–å¹¶æ›´æ–°YAMLæ–‡ä»¶  å®‰è£…Pipeline Utility Stepsæ’ä»¶ Jenkinsé»˜è®¤ä¸æ”¯æŒJSONã€YAMLçš„è§£æï¼Œéœ€è¦åœ¨KubeSphereä¸­é¢„å…ˆå®‰è£…Pipeline Utility Stepsæ’ä»¶ï¼Œè¯¥æ’ä»¶æä¾›äº†å¯¹JSONã€YAMLã€CSVã€PROPERTIESç­‰å¸¸è§æ–‡ä»¶æ ¼å¼çš„è¯»å–ä¸ä¿®æ”¹æ“ä½œã€‚\nJSONæ–‡ä»¶è®¾è®¡ JSONæ–‡ä»¶è®¾è®¡å¦‚ä¸‹ï¼Œé€šè¿‡envã€serverã€dubboç­‰å±æ€§è®°å½•ç¯å¢ƒå’Œç«¯å£ä¿¡æ¯ï¼Œé€šè¿‡projectæ¥è®°å½•å…·ä½“çš„é¡¹ç›®åç§°ï¼Œç”±äºé…ç½®æ–‡ä»¶ä¸­çš„keyéƒ½æ˜¯å›ºå®šçš„ï¼Œåç»­Groovyè§£ææ—¶ä¼šè¾ƒä¸ºæ–¹ä¾¿ï¼Œåœ¨éœ€è¦æ‰©å±•ç¯å¢ƒæ—¶åªéœ€è¦æ›´æ–°æ­¤JSONæ–‡ä»¶å³å¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  { \u0026#34;portConfig\u0026#34;:[ { \u0026#34;project\u0026#34;:\u0026#34;lucumt-system\u0026#34;, \u0026#34;ports\u0026#34;:[ { \u0026#34;env\u0026#34;:\u0026#34;dev-1\u0026#34;, \u0026#34;server\u0026#34;:12001, \u0026#34;dubbo\u0026#34;:12002 }, { \u0026#34;env\u0026#34;:\u0026#34;dev-2\u0026#34;, \u0026#34;server\u0026#34;:12201, \u0026#34;dubbo\u0026#34;:12202 } ] }, { \u0026#34;project\u0026#34;:\u0026#34;lucumt-idp\u0026#34;, \u0026#34;ports\u0026#34;:[ { \u0026#34;env\u0026#34;:\u0026#34;dev-1\u0026#34;, \u0026#34;server\u0026#34;:13001, \u0026#34;dubbo\u0026#34;:13002 }, { \u0026#34;env\u0026#34;:\u0026#34;dev-2\u0026#34;, \u0026#34;server\u0026#34;:13201, \u0026#34;dubbo\u0026#34;:13202 } ] } ] }   è¯»å–namespace åœ¨Nacos Open Apiä¸­å¯çŸ¥æŸ¥è¯¢namespaceçš„è¯·æ±‚ä¸º/nacos/v1/console/namespacesï¼ŒåŸºäºGroovyçš„è¯»å–ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8  response = sh(script: \u0026#34;curl -X GET \u0026#39;http://xxx.xxx.xxx.xxx:8848/nacos/v1/console/namespaces\u0026#39;\u0026#34;, returnStdout: true) jsonData = readJSON text: response namespaces = jsonData.data for(nm in namespaces){ if(BUILD_TYPE==nm.namespaceShowName){ NACOS_NAMESPACE = nm.namespace } }   è¯»å–Nacosé…ç½®æ–‡ä»¶ åœ¨Nacos Open Apiä¸­å¯çŸ¥æŸ¥è¯¢é…ç½®æ–‡ä»¶çš„è¯·æ±‚ä¸º/nacos/v1/cs/configsï¼ŒåŸºäºGroovyçš„è¯»å–ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  response = sh(script: \u0026#34;curl -X GET \u0026#39;http://xxx.xxx.xxx.xxx:8848/nacos/v1/cs/configs?dataId=idp-custom-config.json\u0026amp;group=idp-custom-config\u0026amp;tenant=0f894ca6-4231-43dd-b9f3-960c02ad20fa\u0026#39;\u0026#34;, returnStdout: true) jsonData = readJSON text: response configs = jsonData.portConfig for(config in configs){ project = config.project if(project!=PROJECT_NAME){ continue } ports = config.ports for(port in ports){ if(port.env!=BUILD_TYPE){ continue } env.NODE_PORT = port.server } }   æ ¹æ®YAMLæ–‡ä»¶ ç”±äºè‡ªå·±å°†é¡¹ç›®ä¸­å˜åŒ–çš„éƒ¨åˆ†å·²ç»å•ç‹¬æŠ½å–ä¸ºäº†ä¸€ä¸ªYAMLæ–‡ä»¶ï¼Œæ•…åªéœ€è¦ä¿®æ”¹æ­¤å•ç‹¬é…ç½®æ–‡ä»¶å³å¯ï¼Œåœ¨ä¿®æ”¹è¿‡ç¨‹ä¸­ï¼Œå¤„äºç®€åŒ–è€ƒè™‘ï¼Œè‡ªå·±å…ˆå°†åŸæœ‰çš„YAMLæ–‡ä»¶åˆ é™¤ï¼Œä¹‹åé‡æ–°å†™å…¥ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8  yamlFile = \u0026#39;src/main/resources/bootstrap-dev.yml\u0026#39; yamlData = readYaml file: yamlFile yamlData.spring.cloud.nacos.discovery.group = BUILD_TYPE yamlData.spring.cloud.nacos.discovery.namespace = NACOS_NAMESPACE yamlData.spring.cloud.nacos.config.namespace = NACOS_NAMESPACE sh \u0026#34;rm $yamlFile\u0026#34; writeYaml file: yamlFile, data: yamlData   è¿è¡Œæ•ˆæœ ä¸Šè¿°çš„é…ç½®å‡éœ€è¦åœ¨é¡¹ç›®ç¼–è¯‘ä¹‹å‰è¿›è¡Œï¼Œé…ç½®å®Œæ¯•çš„æµæ°´çº¿è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼Œç¨‹åºå¯æ­£å¸¸è¿è¡Œï¼Œæ”¹é€ ç›®çš„å®ç°ã€‚\nå‚è€ƒä»£ç   å‰ç«¯Jenkinsæµæ°´çº¿ï¼Œå‚è§lucumt-system-web-new.groovy åç«¯Jenkinsæµæ°´çº¿ï¼Œå‚è§lucumt-system-new.groovy    å‚è§lucumt-system.groovy\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n åœ¨ä¸ªäººé¡¹ç›®ä¸­Jenkinsæµæ°´çº¿ä¸éœ€è¦ä¿®æ”¹ï¼Œä½†éœ€è¦ä¿®æ”¹Kubesphereä¸­çš„é»˜è®¤è¾“å…¥é…ç½®ï¼Œå°†æ–°å¢çš„ç¯å¢ƒåŠ åˆ°ä¸‹æ‹‰åˆ—è¡¨ä¸­ï¼Œä¾¿äºä½¿ç”¨\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/devops/using-nacos-and-kubesphere-to-create-multiple-environments/","tags":["kubesphere","jenkins","nacos"],"title":"åˆ©ç”¨Nacosä¸KubeSphereåˆ›å»ºå¤šå¥—å¼€å‘ä¸æµ‹è¯•ç¯å¢ƒ"},{"categories":["ä½æ“ä½œ","Javaç¼–ç¨‹"],"contents":"è¿‘æœŸåœ¨å·¥ä½œä¸­é‡åˆ°ç”±äºHTTPè¿”å›çš„å†…å®¹è¾ƒå¤šå¯¼è‡´ç³»ç»Ÿå“åº”å»¶è¿Ÿçš„é—®é¢˜ï¼Œæœ€ç»ˆè‡ªå·±ç»“åˆgzipã€Protocol Buffersã€ä½è¿ç®—ç­‰å°†HTTPå“åº”è¿”å›çš„æ•°æ®ä»15Må‡å°‘åˆ°1Mä»è€Œè§£å†³ç³»ç»Ÿæ— å¡é¡¿é—®é¢˜ã€‚å…¶ä¸­å¯¹äºä½è¿ç®—éƒ¨åˆ†è‡ªå·±æ˜¯ç»“åˆä¸šåŠ¡å®é™…ï¼Œå°†3ä¸ªå°å‹intè½¬åŒ–ä¸º1ä¸ªlongï¼Œå°†æ•°æ®é‡å‡å°‘ä¸‰åˆ†ä¹‹ä¸€ï¼Œç®€å•è®°å½•ä¸‹å…¶å®ç°(ä»¥Javaå®ç°ä¸ºä¾‹)ã€‚\nèƒŒæ™¯ æŸä¸ªé¡¹ç›®æ¨¡å—è¦å°†ä¸€ç³»åˆ—çš„åæ ‡æ•°æ®è¿”å›ç»™å‰ç«¯é¡µé¢ï¼Œåæ ‡æ•°æ®ç”±xã€yã€zè¿™3ä¸ªç»´åº¦æ¥å®šä¹‰ä¸”ç”¨floatè¡¨ç¤ºï¼Œå®ƒä»¬çš„çº¦æŸæ¡ä»¶å¦‚ä¸‹ï¼š\n $|x|$\u0026lt;150ã€$|y|$\u0026lt;50ã€$|z|$\u0026lt;50\n ç¤ºä¾‹æ–‡ä»¶å¦‚ä¸‹ï¼š\n1 2 3 4 5  123.45\t34.56\t23.78 111.35\t-32.56\t21.78 103.77\t24.83\t-13.78 #...å…±æœ‰è¶…è¿‡10ä¸‡è¡Œæ•°æ® 99.83\t21.35\t43.39   æœ€å¼€å§‹è‡ªå·±æ˜¯é‡‡ç”¨è‡ªå·±æ˜¯å°†å®ƒä»¬é€è¡Œè¯»å–å¹¶ä»¥Stringçš„å½¢å¼å°è£…åˆ°JSONä¸­è¿”å›ç»™å‰ç«¯ï¼Œæ­¤ç§åŸå§‹çš„æ–¹å¼å¾ˆæ˜æ˜¾ä¼šå¯¼è‡´è¿”å›ç»™å‰ç«¯çš„æ•°æ®é‡å·¨å¤§ä»è€Œä¸¥é‡å½±å“æ€§èƒ½ã€‚\næ¥ä¸‹æ¥è‡ªå·±ä»å¦‚ä¸‹å‡ ä¸ªæ–¹é¢ç€æ‰‹ä¼˜åŒ–\n å°†è¿”å›çš„æ•°æ®ä»Stringè½¬åŒ–ä¸ºfloatï¼Œå‡å°‘æ•´ä½“å“åº”çš„å­—èŠ‚æ•° é‡‡ç”¨gzipå‹ç¼©ï¼Œå°†å“åº”æ•°æ®çš„ä½“ç§¯ç¼©å°åˆ°åŸå§‹çš„ä¸‰åˆ†ä¹‹ä¸€ é‡‡ç”¨Protocol Buffersåœ¨åŠ å¿«è§£æé€Ÿåº¦çš„åŒæ—¶è¿›ä¸€æ­¥ç¼©å°è¯·æ±‚å“åº”çš„æ•°æ®åŒ…ä½“ç§¯  é€šè¿‡ä¸Šè¿°æ“ä½œä¹‹åï¼Œå“åº”é€Ÿåº¦ä»åŸæ¥çš„4-5sç¼©çŸ­åˆ°1sä¹‹å†…ï¼ŒåŸºæœ¬ä¸Šè¾¾åˆ°ä¼˜åŒ–ç›®çš„ï¼Œåœ¨åç»­çš„æ€»ç»“ä¸­å‘ç°è¯·æ±‚å“åº”æ…¢çš„ä¸»è¦åŸå› æ˜¯ç”±äºå“åº”å¤´çš„ä½“ç§¯è¿‡å¤§é€ æˆçš„ï¼Œäºæ˜¯ç»§ç»­å¯»æ‰¾å‡å°‘å“åº”ä½“ç§¯çš„åŠæ³•ã€‚\nåˆ†æ åœ¨Javaä¸­intå’Œfloatéƒ½å ç”¨4ä¸ªå­—èŠ‚å…±32bitä½ï¼Œå°†ä¸Šè¿°ç¤ºä¾‹æ–‡ä»¶ä¸­çš„åæ ‡æ•°æ®ä»floatè½¬åŒ–ä¸ºintå¹¶ä¸ä¼šé€ æˆå“åº”æ•°æ®çš„ä½“ç§¯å˜åŒ–ï¼Œä½†ç”±äºä¸šåŠ¡çš„ç‰¹æ®Šæ€§é™åˆ¶äº†xã€yã€zè¿™3ä¸ªåæ ‡çš„å–å€¼èŒƒå›´(æœ‰å‰è¿°æ‰€è¿°çš„èŒƒå›´é™åˆ¶)ï¼Œå°è¯•åˆ†æå®ƒä»¬çš„å ç”¨çš„æœ€å¤§bitä½æ•°ï¼š\n1 2 3  x = 14999 = 0b100100100111101111 // å ç”¨18bitä½ y = 4999 = 0b1100001101001111 // å ç”¨16bitä½ z = 4999 = 0b1100001101001111 // å ç”¨16bitä½   åœ¨ä¸è€ƒè™‘è´Ÿæ•°çš„æƒ…å†µä¸‹ï¼Œxã€yã€zç´¯è®¡å ç”¨çš„bitä½æ•°ä¸º50ï¼Œè€Œä¸€ä¸ªlongç±»å‹å ç”¨8ä¸ªå­—èŠ‚å…±64bitä½ï¼Œç†è®ºåˆ†ææ˜¯å¯ä»¥å°†3ä¸ªintåˆå¹¶ä¸º1ä¸ªlongå‹æ•°æ®ã€‚\nå­˜å‚¨è®¾è®¡ è€ƒè™‘åˆ°åæ ‡æ•°æ®å¯èƒ½æœ‰è´Ÿæ•°,å¯ç”¨1ä¸ªbitä½ä¸“é—¨è®°å½•å¯¹åº”çš„åæ ‡æ•°æ˜¯å¦ä¸ºè´Ÿæ•°ï¼Œæ­¤æ—¶åŠ ä¸Šæ­£è´Ÿæ•°çš„æ ‡è®°ä¹Ÿæ€»å…±åªå ç”¨53ä¸ªbitä½ï¼Œæ²¡æœ‰è¶…è¿‡å•ä¸ªlongå‹æ•°æ®çš„æœ€å¤§bitä½æ•°ã€‚\nä»ä¾¿äºç¼–ç çš„è§’åº¦å¯¹xã€yã€zåœ¨longå‹ä¸­çš„å­˜å‚¨åšå‡ºå¦‚ä¸‹åˆ’åˆ†:\n æ¯ä¸ªintå ç”¨20ä¸ªbitä½ï¼Œæœ€å‰é¢ä¸€ä¸ªbitä½è®°å½•æ­£è´Ÿæ•°(ä¸ºæ­£æ•°æ—¶è¯¥bitä½ä¸º0ï¼Œä¸ºè´Ÿæ•°æ—¶è¯¥bitä½ä¸º1)\n ç§»ä½æ“ä½œ å‰è¿°ç†è®ºåˆ†æå¯èƒ½ï¼Œä½†åœ¨å®é™…æ“ä½œè¿‡ç¨‹ä¸­ä¼šé‡åˆ°å¦‚ä¸‹2ä¸ªé—®é¢˜ï¼š\n å¦‚ä½•åœ¨å¯¹åº”çš„æ­£è´Ÿæ•°æ ‡è¯†bitä½ä¸Šå†™å…¥å’Œè¯»å–å€¼ å¦‚ä½•ç»™ç‰¹å®šçš„åæ ‡å€¼å‡†ç¡®å†™å…¥å¯¹åº”çš„bitä½ä¸”èƒ½å‡†ç¡®è¯»å–  ç»“åˆä½è¿ç®—æœ¬èº«ç‰¹æ€§ä»¥åŠå®é™…ä¸šåŠ¡éœ€æ±‚ï¼Œä¸Šè¿°é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n  è‹¥ç‰¹å®šåæ ‡ä¸ºè´Ÿæ•°ï¼Œå¯å°†ç¬¬20æˆ–40æˆ–60bitä½è®¾ç½®ä¸º1\n  ä¸ºäº†å‡†ç¡®è®°å½•å„åæ ‡æ•°çš„å€¼ï¼Œéœ€è¦å°†å®ƒä»¬ä¸ä¸€ä¸ªç±»ä¼¼0b1111111111111111111ï¼ˆåå…­è¿›åˆ¶è¡¨ç¤ºä¸º0x7ffffï¼‰çš„åŸºå‡†å€¼è¿›è¡Œ\u0026amp;è¿ç®—ï¼Œç”±äºè¦åœ¨å•ä¸ªlongä¸­è®°å½•ä¸‹3ä¸ªintçš„æ•°å€¼ï¼Œæ­¤æ—¶å°±æ¶‰åŠåˆ°å¯¹åæ ‡æ•°æ®è¿›è¡Œç§»ä½è¿ç®—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\n  å…·ä½“çš„åˆ†æå¦‚ä¸‹ï¼š\n xä¸ºç¬¬3ä¸ªå­˜å‚¨ï¼Œéœ€è¦ä¸0b10000000000000000000åš|è¿ç®—æ¥è®°å½•æ­£è´Ÿæ•°ï¼Œéœ€è¦ä¸0b01111111111111111111åš\u0026amp;æ¥è®°å½•å…·ä½“å€¼ yä¸ºç¬¬2ä¸ªå­˜å‚¨ï¼Œéœ€è¦ä¸0b1000000000000000000000000000000000000000åš|è¿ç®—æ¥è®°å½•æ­£è´Ÿæ•°ï¼Œéœ€è¦ä¸0b0111111111111111111111111111111111111111åš\u0026amp;æ¥è®°å½•å…·ä½“å€¼ zä¸ºç¬¬1ä¸ªå­˜å‚¨ï¼Œéœ€è¦ä¸0b100000000000000000000000000000000000000000000000000000000000åš|è¿ç®—æ¥è®°å½•æ­£è´Ÿæ•°ï¼Œéœ€è¦ä¸0b011111111111111111111111111111111111111111111111111111111111åš\u0026amp;æ¥è®°å½•å…·ä½“å€¼  ä¸Šè¿°æ¶‰åŠåˆ°çš„6ä¸ªåŸºå‡†æ•°æ®ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºå¤ªå¤æ‚ï¼Œå…¶ç²¾ç®€è¡¨ç¤ºå¦‚ä¸‹ï¼š\n 0b10000000000000000000 =\u0026gt; 1\u0026lt;\u0026lt;19 0b1000000000000000000000000000000000000000 =\u0026gt; 1L\u0026lt;\u0026lt;391 0b100000000000000000000000000000000000000000000000000000000000=\u0026gt; 1L\u0026lt;\u0026lt;59 0b01111111111111111111 =\u0026gt; 0x7ffff 0b0111111111111111111111111111111111111111 =\u0026gt; 0x7ffffL\u0026lt;\u0026lt;20 0b011111111111111111111111111111111111111111111111111111111111= \u0026gt;0x7ffffL\u0026lt;\u0026lt;40  è‹¥ç”¨position2è¡¨ç¤ºç¬¬å‡ ä¸ªåæ ‡æ•°ï¼Œåˆ™åŸºå‡†æ•°æ®å¯è¿›ä¸€æ­¥ç²¾ç®€å¦‚ä¸‹ï¼š\n æ­£è´Ÿæ•°çš„è®°å½•ä½1L \u0026lt;\u0026lt; (position * 20 - 1) æ•°æ®å€¼çš„è®°å½•ä½0x7ffffL \u0026lt;\u0026lt; ((position - 1) * 20)  å®ç° åŸºäºå‰è¿°åˆ†æè¿‡ç¨‹ï¼Œåæ ‡æ•°æ®å†™å…¥çš„ä»£ç å¦‚ä¸‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨å†™å…¥è¿‡ç¨‹ä¸­è¦ä¼ é€’ä¸€ä¸ªç±»å‹ä¸ºlongçš„target3å˜é‡ï¼Œé€šè¿‡targetå˜é‡æ¥è®°å½•å¯¹åº”çš„åæ ‡çš„å…·ä½“æ•°æ®å’Œæ­£è´Ÿæ•°æ ‡è¯†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  public static long bitWrite(int position, long original, long target) { // è®°å½•æ˜¯å¦ä¸ºæ­£è´Ÿæ•°çš„æ ‡è¯†ä½  long typeBase = 1L \u0026lt;\u0026lt; (position * 20 - 1); // è®°å½•å…·ä½“çš„åæ ‡æ•°å€¼  long valueBase = 0x7ffffL \u0026lt;\u0026lt; ((position - 1) * 20); // è‹¥ä¸ºè´Ÿæ•°ï¼Œåˆ™éœ€è¦å°†å¯¹åº”æ ‡è¯†ä½è®°ä¸º1ï¼ŒåŒæ—¶å°†å…¶å˜ä¸ºæ­£æ•°  if (original \u0026lt; 0) { target = target | typeBase; original = -original; } // åæ ‡æ•°ä¸æ•°æ®å€¼bitä½åšæˆ–æ“ä½œè®°å½•ä¸‹å…¶å€¼  original = original \u0026lt;\u0026lt; (position - 1) * 20; original = original \u0026amp; valueBase; // å°†åæ ‡æ•°å†™å…¥longå‹ç»“æœä¸­  target = target | original; return target; }   åæ ‡æ•°æ®çš„è¯»å–è¿‡ç¨‹åˆ™æ˜¯å†™å…¥æ“ä½œçš„åå‘æ“ä½œï¼Œéœ€è¦å°†\u0026amp;å˜ä¸º|ï¼Œå°†|å˜ä¸º\u0026amp;ï¼ŒåŒå†™å…¥æ“ä½œç±»ä¼¼ï¼Œéœ€è¦ä¼ å…¥ä¹‹å‰å†™å…¥çš„targetå˜é‡ï¼Œä»¥ä¾¿ç¨‹åºåå‘è¯†åˆ«å‡ºç›¸å…³æ•°æ®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  public static long bitRead(int position, long target) { long value; long typeBase = 1L \u0026lt;\u0026lt; (position * 20 - 1); //è¯†åˆ«æ˜¯å¦ä¸ºè´Ÿæ•°  boolean isNegative = (target \u0026amp; typeBase) == typeBase; // è¯»å–å…·ä½“çš„æ•°å€¼ï¼Œæ­¤æ—¶è¯»å–çš„å‡ä¸ºæ­£æ•°  long valueBase = 0x7ffffL \u0026lt;\u0026lt; ((position - 1) * 20); value = target \u0026amp; valueBase; value = value \u0026gt;\u0026gt; (position - 1) * 20; // è‹¥ä¸ºè´Ÿæ•°ï¼Œåˆ™è¦è¿›è¡Œæ¢å¤æ“ä½œ  if (isNegative) { value = -value; } return value; }   åŸºäºä¸Šè¿°æ–¹æ³•åˆ©ç”¨å¦‚ä¸‹ä»£ç è¿›è¡Œæµ‹è¯•\n1 2 3 4 5 6 7 8 9 10 11 12 13  public static void testData() { int x = -14997; int y = 3349; int z = -2377; long target = 0; target = bitWrite(1, x, target); target = bitWrite(2, y, target); target = bitWrite(3, z, target); System.out.println(Long.toBinaryString(target)); System.out.println(bitRead(1, target)); System.out.println(bitRead(2, target)); System.out.println(bitRead(3, target)); }   æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼Œç¨‹åºè¾“å‡ºç»“æœç¬¦åˆé¢„æœŸ\nå®Œæ•´ä»£ç å‚è§SmallIntBitCompressTest.java\n  ç”±äºintå‹æœ€å¤§çš„ä½æ•°ä¸º32ä½ï¼Œå·¦ç§»39ä½æ—¶è¶…è¿‡å…¶é™åˆ¶ä¼šç¼–è¯‘å‡ºé”™ï¼Œæ•…éœ€è¦ä½¿ç”¨1L\u0026lt;\u0026lt;39æ›¿ä»£1\u0026lt;\u0026lt;39\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n ä¸Javaä¸­çš„ä¸‹æ ‡è¡¨ç¤ºä¿æŒä¸€è‡´ï¼Œpositionä»0å¼€å§‹ï¼Œæ•…å…¶å€¼åªèƒ½ä¸º0ã€1ã€2ä¸‰è€…ä¹‹ä¸€\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n targetå˜é‡çš„ç±»å‹åˆå§‹å€¼éœ€è¦è®¾ç½®ä¸º0\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/bit/merge-three-int-number-into-a-long-number/","tags":["bit"],"title":"å°†3ä¸ªå°intæ•´æ•°åˆå¹¶åˆ°1ä¸ªlongä¸­ä»è€Œç¼©å°æ•°æ®é‡"},{"categories":["æŒç»­é›†æˆ"],"contents":"ä¹‹å‰åœ¨å…¬å¸å†…éƒ¨æ¨å¹¿KubeSphereç”¨äºæŒç»­é›†æˆå’Œéƒ¨ç½²ï¼Œå–å¾—äº†ä¸é”™çš„åé¦ˆï¼Œè€ƒè™‘åˆ°å¤§è§„æ¨¡ä½¿ç”¨çš„ä¾¿åˆ©æ€§ä»¥åŠä¹‹å‰å·²æœ‰LDAPæ•´åˆå…¶å®ƒç³»ç»Ÿçš„æˆç†Ÿç»éªŒï¼Œå¾ˆè‡ªç„¶çš„æƒ³å°†LDAPé›†æˆåˆ°KubeSphereä¸­ã€‚åŸä»¥ä¸ºä¼šå¾ˆå®¹æ˜“ï¼Œä¸€ç•ªæŠ˜è…¾ä¸‹æ¥è´¹äº†ä¸å¥½åŠŸå¤«(KubeSphereè¦æ±‚ä½¿ç”¨LDAPæ—¶å¿…é¡»è®¾ç½®ç®¡ç†å‘˜è´¦å·å’Œå¯†ç )ï¼Œç®€å•è®°å½•ä¸‹ã€‚\nå…¬å¸å†…éƒ¨çš„LDAPç³»ç»Ÿæ”¯æŒåŒ¿åç™»å½•ï¼Œåœ¨ç»™å…¶å®ƒç³»ç»Ÿ(å¦‚yapi)é›†æˆLDAPæ—¶ï¼Œåªéœ€è¦è¾“å…¥å¯¹åº”çš„hostã€uidã€searchDNå³å¯ï¼Œæ•´åˆèµ·æ¥ååˆ†ä¾¿æ·ï¼Œç±»ä¼¼å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7  \u0026#34;ldapLogin\u0026#34;:{ \u0026#34;enable\u0026#34;:\u0026#34;true\u0026#34;, \u0026#34;server\u0026#34;:\u0026#34;ldap://192.168.0.2:389\u0026#34;, \u0026#34;searchDn\u0026#34;:\u0026#34;dc=lucumt,dc=info\u0026#34;, \u0026#34;searchStandard\u0026#34;:\u0026#34;uid\u0026#34;, \u0026#34;usernameKey\u0026#34;:\u0026#34;uid\u0026#34; }   å…¬å¸å†…éƒ¨çš„KubeSphereç‰ˆæœ¬ä¸ºv3.1.1ï¼Œåœ¨é›†æˆLDAPä¹‹å‰å…ˆå»å®˜ç½‘æŸ¥çœ‹äº†ç›¸å…³è¯´æ˜ï¼Œåœ¨LDAPèº«ä»½æä¾›è€…ä¸­æœ‰å¦‚ä¸‹è¯´æ˜ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  spec:authentication:jwtSecret:\u0026#39;\u0026#39;maximumClockSkew:10smultipleLogin:trueoauthOptions:accessTokenMaxAge:1haccessTokenInactivityTimeout:30midentityProviders:- name:LDAPtype:LDAPIdentityProvidermappingMethod:autoprovider:host:192.168.0.2:389managerDN:uid=root,cn=users,dc=nasmanagerPassword:********userSearchBase:cn=users,dc=nasloginAttribute:uidmailAttribute:mail  å¯ä»¥çœ‹å‡ºå…¶é»˜è®¤å¤šäº†managerDNå’ŒmanagerPasswordè¿™ä¸¤ä¸ªç®¡ç†å‘˜å±æ€§ï¼Œä½†ç”±äºå…¬å¸çš„LDAPé»˜è®¤å¯¹å¤–ä¸æä¾›ç®¡ç†å‘˜è´¦å·å’Œå¯†ç ï¼Œåªèƒ½åŒ¿åç™»å½•è®¤è¯ï¼Œä¸”è‡ªå·±ä¹‹å‰åœ¨å…¶å®ƒç³»ç»Ÿä¸­åŒ¿åé…ç½®LDAPéƒ½å¾ˆé¡ºç•…ï¼Œäºæ˜¯é€šè¿‡åŒ¿åæ–¹å¼é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7  provider:host:192.168.1.22:389#managerDN: uid=root,cn=users,dc=nas#managerPassword: ********userSearchBase:dc=lucumt,dc=infologinAttribute:uidmailAttribute:mail  å°†å®˜æ–¹æ–‡æ¡£ä¸­è¦æ±‚çš„managerDNå’ŒmanagerPasswordå±è”½æ‰ï¼Œæ¥ç€é‡å¯KubeSphereç³»ç»Ÿï¼Œç™»å½•è¿‡ç¨‹å‡ºç°å¦‚ä¸‹æç¤ºï¼š\né”™è¯¯ä¿¡æ¯æç¤ºè¯´å¯†ç ä¸èƒ½ä¸ºç©ºï¼Œä½†æ˜¯æˆ‘ä»¬ç™»å½•çš„æ—¶å€™è‚¯å®šæœ‰è¾“å…¥å¯†ç çš„ï¼Œé‚£åªå¯èƒ½æ˜¯managerPasswordä¸ºç©ºå¯¼è‡´çš„ã€‚\næŸ¥æ‰¾KubeSphereå®˜ç½‘ç›¸å…³è¯´æ˜å‘ç°å…¶å¯¹äºmanagerDNå’ŒmanagerPasswordæ²¡æœ‰è¯´æ˜æ˜¯é€‰å¡«é¡¹ï¼Œç»“åˆå‰é¢çš„æŠ¥é”™ä¿¡æ¯ï¼Œå¯å¾—å‡ºå¦‚ä¸‹ç»“è®º\n KubeSphereä¸æ”¯æŒLDAPåŒ¿åç™»å½•\n äºæ˜¯åªèƒ½æ‰¾å…¬å¸ç›¸å…³éƒ¨é—¨ç”³è¯·LDAPå…·æœ‰åªè¯»è´¦å·çš„ç®¡ç†å‘˜æƒé™ï¼Œé…ç½®ç±»ä¼¼å¦‚ä¸‹ï¼Œä¹‹åé‡å¯KubeSphereå¯æ­£å¸¸é›†æˆLDAPç™»å½•ã€‚\n1 2 3 4 5 6 7  provider:host:192.168.1.22:389managerDN:admin=cn,dc=lucumt,dc=infomanagerPassword:********userSearchBase:dc=lucumt,dc=infologinAttribute:uidmailAttribute:mail  åªèƒ½è¯´KubeSphereåœ¨è¿™æ–¹é¢åšçš„ä¸å¤ªå¥½ï¼Œå·²ç»åœ¨å…¶å®˜ç½‘åé¦ˆæ­¤é—®é¢˜!\n","permalink":"http://isouthrain.github.io/post/devops/setting-ldap-for-kubesphere/","tags":["kubesphere","jenkins","LDAP"],"title":"Kubesphereé›†æˆLDAPè¸©å‘è®°å½•"},{"categories":["ä¸ªäººåšå®¢"],"contents":"ä½œä¸ºä¸€åITæ°‘å·¥ï¼Œå–„äºåˆ©ç”¨å„ç§å·¥å…·æå‡å·¥ä½œæ•ˆç‡æ‰ç®—åˆæ ¼ï¼Œæœ¬æ–‡ç®€å•è®°å½•è‡ªå·±å¦‚ä½•åˆ©ç”¨GitHub Actionså®ç°ä¸ªäººHugoåšå®¢åœ¨GitHub Pagesä¸­çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚\nä¼ ç»Ÿæ–¹å¼ è‡ªå·±çš„ä¸ªäººåšå®¢åˆ›å»ºäº2016å¹´ï¼Œåœ¨è¿™æœŸé—´è‡ªå·±ä¸€ç›´åŸºäºå¦‚ä¸‹æ–¹å¼åˆ›å»ºå¹¶éƒ¨ç½²æ›´æ–°åšå®¢ï¼š\n  åˆ©ç”¨hugoå‘½ä»¤åˆ›å»ºå¯¹åº”çš„åšå®¢markdownæ–‡ä»¶\nhugo new post/hugo/using-github-action-to-auto-build-deploy.md\n  åˆ©ç”¨ä¸‹è¿°å‘½ä»¤å¼€å¯hugoåšå®¢çš„åŠ¨æ€ç›‘å¬å±•ç¤ºï¼Œå¹¶è¿›è¡Œç¼–å†™\nhugo server -w -D\n  åšå®¢å†…å®¹ç¼–å†™å®Œæˆåï¼Œåˆ©ç”¨ä¸‹è¿°å‘½ä»¤å°†å…¶åˆ‡æ¢åˆ°å®é™…éƒ¨ç½²ç¯å¢ƒ\nhugo server --baseUrl=\u0026quot;https://lucumt.info/\u0026quot; --watch=false --appendPort=false --renderToDisk --environment production\n  æ‰§è¡Œä¸‹è¿°å‘½ä»¤æäº¤åˆ°masteråˆ†æ”¯\n git add -A git commit -a -m \u0026quot;xxxx\u0026quot; git push origin master    åˆ©ç”¨ä¸‹è¿°å‘½ä»¤å°†publicç›®å½•ä¸­çš„å†…å®¹ä»master åˆ†æ”¯åŒæ­¥åˆ°gh-pagesåˆ†æ”¯\ngit subtree push --prefix=public git@github.com:lucumt/ghblog.git gh-pages\n  ä¸Šè¿°è¿‡ç¨‹ä¸­çš„1,2,4é˜¶æ®µæ˜¯ç¼–å†™åšå®¢çš„å¿…ç»é˜¶æ®µï¼Œè€Œ3,5é˜¶æ®µå…¶å®æ²¡å¤ªå¤šå¿…è¦ï¼Œå®Œå…¨å¯ä»¥ç”¨å·¥å…·è‡ªåŠ¨åŒ–å®ç°ã€‚ä½œä¸ºITä»ä¸šè€…ï¼Œæˆ‘ä»¬éœ€è¦å°½å¯èƒ½çš„å‡å°‘ä¸å¿…è¦çš„æ“ä½œã€‚\næ”¹è¿›æ–¹å¼ ç»“åˆç½‘ç»œä¸Šçš„ç›¸å…³èµ„æ–™ï¼Œè‡ªå·±æŠŠå®ç°æ–¹æ¡ˆå®šåœ¨äº†GitHub Actionså’ŒTravis CIäºŒè€…ä¹‹ä¸€ï¼Œè€ƒè™‘åˆ°GitHubä¸­å·²ç»å†…ç½®äº†GitHub Actions ï¼Œæœ€ç»ˆè§£å†³é‡‡ç”¨å…¶ä½œä¸ºå®ç°æ–¹æ¡ˆã€‚\nåœ¨Hugoçš„å®˜æ–¹æ–‡æ¡£Build Hugo With GitHub Actionä¸­ä¹Ÿæ¨èé‡‡ç”¨GitHub Actionsä½œä¸ºæŒç»­é›†æˆéƒ¨ç½²æ–¹æ¡ˆï¼Œå¹¶æä¾›äº†ç›¸åº”çš„æµæ°´çº¿é…ç½®ä»£ç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  name:github pageson:push:branches:- main # Set a branch to deploypull_request:jobs:deploy:runs-on:ubuntu-20.04steps:- uses:actions/checkout@v2with:submodules:true# Fetch Hugo themes (true OR recursive)fetch-depth:0# Fetch all history for .GitInfo and .Lastmod- name:Setup Hugouses:peaceiris/actions-hugo@v2with:hugo-version:\u0026#39;latest\u0026#39;# extended: true- name:Buildrun:hugo --minify- name:Deployuses:peaceiris/actions-gh-pages@v3if:github.ref == \u0026#39;refs/heads/main\u0026#39;with:github_token:${{ secrets.GITHUB_TOKEN }}publish_dir:./public  è¯¥é…ç½®ä»£ç å·²ç»å¾ˆå®Œå–„ï¼Œä¸ªäººæ ¹æ®å®é™…æƒ…å†µå¯¹å…¶åšäº†å¦‚ä¸‹ä¿®æ”¹ï¼š\n åœ¨Buildé˜¶æ®µï¼Œå°†hugoå‘½ä»¤æ”¹ä¸ºé€‚åˆä¸ªäººç¯å¢ƒçš„hugo -b \u0026quot;https://lucumt.info/\u0026quot; -e \u0026quot;production\u0026quot; åœ¨ä¸ªäººGitHubä¸­è®¾ç½®github_token  å…¶ä¸­å…³äºgithub_tokençš„é…ç½®å¯æŒ‰å¦‚ä¸‹æ­¥éª¤é…ç½®ï¼š\n  åœ¨ä¸ªäººGitHubé¡µé¢ï¼Œä¾æ¬¡ç‚¹å‡»Settings-\u0026gt;Developer settings-\u0026gt;Personal access tokensè¿›å…¥å¦‚ä¸‹é¡µé¢ï¼š\n  ç‚¹å‡»Generate new tokenå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œåœ¨Noteä¸­è¾“å…¥åç§°ï¼Œåœ¨Select scopesé€‰æ‹©workflow\n  å°†ç”Ÿæˆçš„tokenå¤åˆ¶å‡ºæ¥ä¸ºåç»­åˆ›å»ºsecretåšå‡†å¤‡ï¼Œæ³¨æ„å¿…é¡»åŠæ—¶å¤åˆ¶ï¼Œä¸€æ—¦ç¦»å¼€æ­¤é¡µé¢åç»­å°±æ— æ³•æŸ¥çœ‹å…¶å€¼ï¼Œåªèƒ½é‡æ–°åˆ›å»ºæ–°tokenï¼š\n  è¿›å…¥å¯¹åº”çš„GitHubé¡¹ç›®ä¸‹ï¼Œä¾æ¬¡ç‚¹å‡»Settings-\u0026gt;Secrets-\u0026gt;Actionsè¿›å…¥æ·»åŠ Action secretsçš„ç•Œé¢ï¼Œç‚¹å‡»New repository secretæŒ‰é’®\n  åœ¨å‡ºç°çš„ç•Œé¢ä¸­nameéƒ¨åˆ†è¾“å…¥æˆ‘ä»¬è®¾ç½®çš„å€¼ï¼ŒSecretéƒ¨åˆ†è¾“å…¥æ­¥éª¤3ä¸­è®°å½•çš„tokenå€¼ï¼Œç„¶åç‚¹å‡»Add secretæŒ‰é’®\néœ€è¦æ³¨æ„çš„æ˜¯nameçš„å€¼ä¸èƒ½ä»¥GITHUB_å¼€å¤´ï¼Œå¦åˆ™åˆ›å»ºä¼šå‡ºé”™\n  åœ¨æµæ°´çº¿ä¸­å°†github_tokenå€¼è®¾ç½®ä¸ºæ­¥éª¤5ä¸­secretçš„åç§°ï¼Œç±»ä¼¼${{ secrets.GH_PAGE_ACTION_TOKEN }}sï¼Œè‡³æ­¤github_tokenè®¾ç½®è¿‡ç¨‹å®Œæ¯•ã€‚\n  é…ç½®åå®Œæ•´çš„æµæ°´çº¿ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  name:pages-auto-build-deployon:# workflow_dispatch: push:branches:- masterjobs:build-and-deploy:runs-on:ubuntu-lateststeps:- uses:actions/checkout@v2with:submodules:truefetch-depth:0- name:Setup Hugouses:peaceiris/actions-hugo@v2with:hugo-version:\u0026#39;0.100.2\u0026#39;extended:true- name:Build Hugorun:hugo -b \u0026#34;https://lucumt.info/\u0026#34; -e \u0026#34;production\u0026#34;- name:Deployuses:peaceiris/actions-gh-pages@v3with:github_token:${{ secrets.GH_PAGE_ACTION_TOKEN }}publish_dir:./publiccommit_message:${{ github.event.head_commit.message }}  å°†è¯¥yamlæ–‡ä»¶æ”¾åˆ°å¯¹åº”GitHubé¡¹ç›®ä¸‹çš„.github/workflowsç›®å½•ä¸‹å³å®Œæˆå…¨éƒ¨é…ç½®ã€‚\nå½“æ‰§è¡Œgit push origin masteråï¼ŒGitHub Actionsä¼šå¼€å¯è‡ªåŠ¨æ„å»ºéƒ¨ç½²ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ï¼Œè‡³æ­¤æ•´ä¸ªè®¾ç½®è¿‡ç¨‹å®Œæ¯•ï¼\nå…¶å®ƒ ç”±äºGitHub Actionæ”¯æŒå®šæ—¶è¯­æ³•ï¼Œå°†æµæ°´çº¿è§¦å‘æ¡ä»¶ä¿®æ”¹å¦‚ä¸‹\n1 2 3 4 5 6 7  on:push:branches:- masterschedule:# Runs everyday at 8:00 AM- cron:\u0026#34;0 8 * * *\u0026#34;  å¯å®ç°æ¯å¤©ä¸Šåˆ8ç‚¹è‡ªåŠ¨è§¦å‘æ„å»ºï¼Œç”±äºæ„å»ºè¿‡ç¨‹ä¸­ä¼šå¾€gh-pagesåˆ†æ”¯ä¸‹æäº¤ä»£ç ï¼Œä»è€Œé—´æ¥è¾¾æˆåœ¨GitHubä¸­æ¯å¤©æäº¤ä»£ç ï¼Œåœ¨GitHubä¸»é¡µé¢å±•ç¤ºæ—¶ä¿æŒå…¨ç»¿çš„åŠŸèƒ½ï¼1\nå‚è€ƒæ–‡æ¡£:\n https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html https://www.pseudoyu.com/zh/2022/05/29/deploy_your_blog_using_hugo_and_github_action/    ä¸ªäººè§‚ç‚¹è´¨é‡ä¼˜äºæ•°é‡ï¼Œä¸æ¨èè¿™ä¹ˆåš\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/hugo/using-github-action-to-auto-build-deploy/","tags":["hugo","github-pages","go"],"title":"åˆ©ç”¨GitHub Actionå®ç°Hugoåšå®¢åœ¨GitHub Pagesè‡ªåŠ¨éƒ¨ç½²"},{"categories":["Javaç¼–ç¨‹"],"contents":"å…¬å¸é¡¹ç›®é‡‡ç”¨MinIOä½œä¸ºæ•°æ®å­˜å‚¨ï¼Œæœ€è¿‘é‡åˆ°ä¸€ä¸ªéœ€æ±‚æ˜¯å°†å…¶ä¸­çš„æŸä¸ªæ–‡ä»¶å¤¹çš„æ•°æ®åŸºäºå…¶åŸæœ‰çš„ç»“æ„ä¸‹è½½ä¸ºZIPæ–‡ä»¶ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šä¸‹è½½ä¸ºZIPçš„ä»£ç ï¼Œä¸ªäººè§‰å¾—å…¶ä¸­å¥½å¤šä¸å¤Ÿç²¾ç®€ï¼Œç®€å•è®°å½•ä¸‹è‡ªå·±çš„å®ç°ã€‚\næ–‡ä»¶å¤¹ä¸‹è½½ è¯¥æ–‡ä»¶å¤¹åœ¨MinIOä¸­å­˜å‚¨çš„è·¯å¾„ä¸º2022-07/80/iodp-dataset-demoï¼Œå…¶ä¸‹åŒ…å«å¤šä¸ªæ–‡ä»¶å¤¹\nåœ¨ç‰¹å®šæ–‡ä»¶å¤¹ä¸‹åŒ…å«å¤šä¸ªæ•°æ®æ–‡ä»¶\nç”±äºåœ¨MinIOä¸­æ˜¯æŒ‰ç…§æ–‡ä»¶å¤¹å­˜å‚¨ï¼Œä¸€å¼€å§‹è‡ªå·±å¾ˆæ˜¾ç„¶çš„æ˜¯æƒ³ç”¨ç›´æ¥å»MinIOå®˜ç½‘æŸ¥çœ‹æœ‰æ²¡æœ‰ç›´æ¥ä¸‹è½½æ–‡ä»¶å¤¹çš„æ–¹å¼ï¼Œåœ¨å…¶å®˜ç½‘java-client-api-referenceä¸­æ²¡æœ‰æ‰¾åˆ°æ”¯æŒæ–‡ä»¶å¤¹ä¸‹è½½çš„æ–¹å¼ã€‚\næ¥ä¸‹æ¥è‡ªå·±é€šè¿‡ListObjectsArgsä¼ å…¥æ–‡ä»¶å¤¹åç§°2022-07/80/iodp-dataset-demoçš„æ–¹å¼æƒ³ä¸€æ¬¡æ€§æŠŠæ–‡ä»¶éƒ½è·å–åˆ°ï¼Œåœ¨æ­¤ç§æ–¹å¼ä¸‹ç¨‹åºæ‰§è¡Œç»“æœä¸ºç©ºã€‚\nè‡³æ­¤ï¼Œå¯çŸ¥é“ MinIOä¸æ”¯æŒåŸç”Ÿçš„æ–‡ä»¶å¤¹ä¸‹è½½ï¼Œåªèƒ½æŒ‰ç…§æ–‡ä»¶æŒ¨ä¸ªä¸‹è½½ï¼Œä¸ºäº†è·å–æ‰€æœ‰æ–‡ä»¶ï¼Œéœ€è¦é€šè¿‡é€’å½’ç¨‹åºå®ç°ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  @Log4j2 @Service public class MinioServiceImpl implements IMinioService { @Autowired private MinioClient mClient; @Override public InputStream downloadFile(String fileName, String bucket) { GetObjectArgs getArgs = GetObjectArgs.builder().bucket(bucket).object(fileName).build(); try { InputStream is = mClient.getObject(getArgs); return is; } catch (ErrorResponseException | InsufficientDataException | InternalException | InvalidKeyException | InvalidResponseException | IOException | NoSuchAlgorithmException | ServerException | XmlParserException e) { throw new RuntimeException(e); } } @Override public List\u0026lt;String\u0026gt; listFolderFiles(String folderName, String bucket) { List\u0026lt;String\u0026gt; fileList = new ArrayList\u0026lt;\u0026gt;(); listFolderFiles(folderName, bucket, fileList); return fileList; } private void listFolderFiles(String folderName, String bucket, List\u0026lt;String\u0026gt; fileList) { ListObjectsArgs listArgs = ListObjectsArgs.builder().bucket(bucket).prefix(folderName).build(); Iterable\u0026lt;Result\u0026lt;Item\u0026gt;\u0026gt; results = mClient.listObjects(listArgs); try { for (Result\u0026lt;Item\u0026gt; result : results) { Item item = result.get(); String objectName = item.objectName(); if (item.isDir()) { // é‡‡ç”¨é€’å½’çš„æ–¹å¼éå†æ–‡ä»¶å¤¹  listFolderFiles(objectName, bucket, fileList); } else { fileList.add(objectName); } } } catch (ErrorResponseException | InsufficientDataException | InternalException | InvalidKeyException | InvalidResponseException | IOException | NoSuchAlgorithmException | ServerException | XmlParserException e) { throw new RuntimeException(e); } } }   åŸºäºä¸Šè¿°ä»£ç ä»MinIOä¸­è¿”å›çš„æ–‡ä»¶ä¿¡æ¯ç±»ä¼¼å¦‚ä¸‹æ‰€ç¤ºï¼š\nå†™å…¥ZIPæ–‡ä»¶ ç”±äºMinIOä¸­è¿”å›çš„æ–‡ä»¶ä¿¡æ¯å·²ç»å…·æœ‰å±‚çº§ç»“æ„ï¼Œæ•…åœ¨è¿›è¡ŒZIPå‹ç¼©æ—¶å¯åŸºäºæ–‡ä»¶è·¯å¾„ç›´æ¥è®¾ç½®å…¶å­˜å‚¨ä½ç½®1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  @Override public void downloadDataset(int id, HttpServletResponse response) { DatasetModel dsModel = queryDataset(id); String path = dsModel.getPath(); int prefixLen = StringUtils.substringBeforeLast(path, \u0026#34;/\u0026#34;).length(); // è®¾ç½®æ–‡ä»¶å  String zipFileName = StringUtils.substringAfterLast(path, \u0026#34;/\u0026#34;) + \u0026#34;.zip\u0026#34;; response.setCharacterEncoding(\u0026#34;UTF-8\u0026#34;); response.setContentType(\u0026#34;application/octet-stream\u0026#34;); try { response.addHeader(\u0026#34;Content-Disposition\u0026#34;, \u0026#34;attachment;filename=\u0026#34; + URLEncoder.encode(zipFileName, \u0026#34;UTF-8\u0026#34;)); } catch (UnsupportedEncodingException e) { throw new RuntimeException(e); } List\u0026lt;String\u0026gt; fileList = minioService.listFolderFiles(path, collectFilesBucket); try (OutputStream out = response.getOutputStream(); ZipOutputStream zs = new ZipOutputStream(new BufferedOutputStream(out))) { for (String filePath : fileList) { String fileName = filePath.substring(prefixLen + 1); InputStream is = minioService.downloadFile(filePath, collectFilesBucket); ZipEntry entry = new ZipEntry(fileName); zs.putNextEntry(entry); IOUtils.copy(is, zs); zs.closeEntry(); } zs.setMethod(ZipOutputStream.DEFLATED); //è®¾ç½®å‹ç¼©æ–¹æ³•  } catch (Exception e) { e.printStackTrace(); } }   ä¸‹è½½åçš„ZIPæ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼Œå¯è§å…¶å±‚çº§ç»“æ„ä¸MinIOä¸­åŸå§‹å­˜å‚¨çš„å±‚çº§ç»“æ„ç›¸åŒï¼ŒåŠŸèƒ½æ­£å¸¸å®ç°ã€‚\n  é€šè¿‡new ZipEntry(fileName)åœ¨fileNameä¸­æŒ‡å®šå…¶å®Œæ•´è·¯å¾„å³å¯å®ç°\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/minio/download-minio-folder-as-zip-file/","tags":["MinIO","Java"],"title":"å°†MinIOä¸­çš„æ–‡ä»¶å¤¹ä¸‹è½½ä¸ºZIPæ–‡ä»¶"},{"categories":["æŒç»­é›†æˆ","å®¹å™¨åŒ–"],"contents":"è¿‘æœŸåœ¨å…¬å¸å†…éƒ¨æ­å»ºåŸºäºKubeSphereçš„æŒç»­é›†æˆå¹³å°æ—¶ï¼Œå‘ç°å…¶åº•å±‚çš„Kubernetesé»˜è®¤çš„ç«¯å£èŒƒå›´ä¸º30000-32767è€Œå…¬å¸æœ‰å¤šä¸ªé‡‡ç”¨å¾®æœåŠ¡æ¨¡å—çš„é¡¹ç›®åœ¨ä½¿ç”¨ï¼Œé»˜è®¤çš„ç«¯å£èŒƒå›´ä¸ä¾¿äºåˆ†é…ä½¿ç”¨ï¼Œåœ¨åŸºäºç½‘ä¸Šæ–‡æ¡£ä¿®æ”¹çš„è¿‡ç¨‹ä¸­è‡ªå·±è¸©åˆ°äº†ä¸€ä¸ªå‘ï¼Œç®€å•è®°å½•ä¸‹ã€‚\nä¸€å¼€å§‹æ—¶è‡ªå·±ä¹Ÿæ˜¯ä»ç½‘ä¸ŠæŸ¥æ‰¾ç›¸å…³èµ„æ–™ï¼ŒæŸ¥æ‰¾å‡ºæ¥çš„ç»“æœå’Œä¿®æ”¹NodePortçš„èŒƒå›´ä¸­çš„åŸºæœ¬éƒ½ç›¸åŒï¼Œè‡ªå·±ä¹Ÿæ˜¯æŒ‰ç…§å…¶å¯¹åº”çš„æ–¹æ³•è¿›è¡Œæ“ä½œ:\n  å°†/etc/kubernetes/manifests/ç›®å½•ä¸‹çš„kube-apiserver.yamlåœ¨å½“å‰ç›®å½•ä¸‹å¤‡ä»½ä¸€ä»½kube-apiserver.yaml.bakä½œä¸ºå¤‡ä»½æ–‡ä»¶\n  åœ¨kube-apiserver.yamlä¸­åŠ å…¥--service-node-port-range=1-65537\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  apiVersion:v1kind:Podmetadata:creationTimestamp:nulllabels:component:kube-apiservertier:control-planename:kube-apiservernamespace:kube-systemspec:containers:- command:- kube-apiserver- --service-node-port-range=1-65537# other config    ä¹‹åæ‰§è¡Œä¸‹è¿°å‘½ä»¤æ¥é‡å¯api-server\n1 2 3 4  # è·å¾— apiserver çš„ pod åå­— export apiserver_pods=$(kubectl get pods --selector=component=kube-apiserver -n kube-system --output=jsonpath={.items..metadata.name}) # åˆ é™¤ apiserver çš„ pod kubectl delete pod $apiserver_pods -n kube-system     ç„¶åæ‰§è¡Œkubectl describe pod $apiserver_pods -n kube-system | grep \u0026quot;service-node-port-range\u0026quot;å´å‘ç°è¾“å‡ºç»“æœä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯è¯´è‡ªå·±æ·»åŠ çš„åŠ¨æ€ç«¯å£é…ç½®å¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼\n  ä¹‹åæœç´¢ç½‘ä¸Šçš„å„ç§è§£å†³æ–¹æ¡ˆï¼Œéƒ½æ˜¯å’Œå‰è¿°çš„æ“ä½œç±»ä¼¼ï¼Œå°è¯•åéƒ½ä¸ç”Ÿæ•ˆï¼Œæ²¡åŠæ³•åªèƒ½ç»§ç»­æœç´¢ï¼Œç›´åˆ°å‘ç°https://www.modb.pro/db/146676è¿™ç¯‡æ–‡ç« ï¼Œåœ¨å…¶ä¸­æœ‰å¦‚ä¸‹è¯´æ˜\n  ä¹‹åæ£€æŸ¥è‡ªå·±ç³»ç»Ÿçš„/etc/kubernetes/manifests/ç›®å½•ï¼Œå‘ç°æœç„¶æœ‰å¤‡ä»½æ–‡ä»¶!\n  å°†å¤‡ä»½æ–‡ä»¶åˆ é™¤åï¼Œé‡æ–°æ‰§è¡Œkubectl delete pod $apiserver_pods -n kube-systemï¼Œç»è¿‡è‹¥å¹²ç§’çš„ç­‰å¾…åï¼Œå‘ç°service-node-port-rangeå·²ç»ç”Ÿæ•ˆï¼Œè‡³æ­¤é—®é¢˜è§£å†³!\n  æ€»ç»“ï¼š\n è™½ç„¶è¿™æ¬¡é—®é¢˜æ˜¯ç”±äºå¤‡ä»½æ–‡ä»¶å¼•èµ·çš„ï¼Œä½†æ˜¯åœ¨Linuxä¸­ä¿®æ”¹é‡è¦é…ç½®æ–‡ä»¶æ—¶æå‰è¿›è¡Œå¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼Œä»è¿™æ¬¡ä¿®æ”¹è¿‡ç¨‹ä¸­å­¦åˆ°çš„ç»éªŒæ˜¯ä¸è¦åœ¨åŒç›®å½•ä¸‹å¤‡ä»½ï¼Œè¦å»ä¸“é—¨çš„ç›®å½•ä¸‹å¤‡ä»½ã€‚ Kubernetesåº•å±‚çš„åŠ¨æ€åŠ è½½é…ç½®æ–‡ä»¶çš„åŸç†éœ€è¦è¿›ä¸€æ­¥å­¦ä¹ ï¼ æ„Ÿè°¢https://www.modb.pro/db/146676çš„ä½œè€…åŸ‹å¤´è¿‡åï¼Œç”±äºå…¶æ— ç§åˆ†äº«é¿å…äº†æˆ‘èµ°æ›´å¤šçš„å¼¯è·¯ã€‚ ","permalink":"http://isouthrain.github.io/post/k8s/service-node-port-range-config-not-working-in-k8s/","tags":["kubernetes"],"title":"åœ¨Kubernetesä¸­é…ç½®service-node-port-rangeä¸ç”Ÿæ•ˆçš„é—®é¢˜"},{"categories":["æŒç»­é›†æˆ"],"contents":"ç›®å‰å…¬å¸çš„å¼€å‘æ–¹å¼éƒ½æ˜¯æ‰‹å·¥ç¼–è¯‘\u0026amp;éƒ¨ç½²ï¼Œååˆ†ä½æ•ˆï¼Œæœ€è¿‘å°†Webå¼€å‘ç›¸å…³çš„é¡¹ç›®éƒ½åŸºäºKubeSphereé€šè¿‡åŸºäºJenkinsçš„æµæ°´çº¿æ–¹å¼å®ç°äº†è‡ªåŠ¨éƒ¨ç½²ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é˜»å¡ç‚¹ï¼Œç®€å•è®°å½•ä¸‹å®ƒä»¬çš„è§£å†³æ–¹æ¡ˆã€‚\nåœ¨KubeSphereçš„Githubä»“åº“ä¸­æœ‰å¦‚ä¸‹è¯´æ˜ï¼š\nKubeSphereæ˜¯ä»€ä¹ˆ\nKubeSphere æ„¿æ™¯æ˜¯æ‰“é€ ä¸€ä¸ªä»¥ Kubernetes ä¸ºå†…æ ¸çš„ äº‘åŸç”Ÿåˆ†å¸ƒå¼æ“ä½œç³»ç»Ÿï¼Œå®ƒçš„æ¶æ„å¯ä»¥éå¸¸æ–¹ä¾¿åœ°ä½¿ç¬¬ä¸‰æ–¹åº”ç”¨ä¸äº‘åŸç”Ÿç”Ÿæ€ç»„ä»¶è¿›è¡Œå³æ’å³ç”¨ï¼ˆplug-and-playï¼‰çš„é›†æˆï¼Œæ”¯æŒäº‘åŸç”Ÿåº”ç”¨åœ¨å¤šäº‘ä¸å¤šé›†ç¾¤çš„ç»Ÿä¸€åˆ†å‘å’Œè¿ç»´ç®¡ç†ã€‚ KubeSphere ä¹Ÿæ˜¯ä¸€ä¸ªå¤šç§Ÿæˆ·å®¹å™¨å¹³å°ï¼Œæä¾›å…¨æ ˆçš„ IT è‡ªåŠ¨åŒ–è¿ç»´çš„èƒ½åŠ›ï¼Œç®€åŒ–ä¼ä¸šçš„ DevOps å·¥ä½œæµ\n\rKubernetes DevOps\næä¾›å¼€ç®±å³ç”¨çš„åŸºäº Jenkins çš„ CI/CDï¼Œå¹¶å†…ç½®è‡ªåŠ¨åŒ–æµæ°´çº¿æ’ä»¶ï¼ŒåŒ…æ‹¬ Binary-to-Image (B2I) å’Œ Source-to-Image (S2I)\n\rä»ä¸Šè¿°æè¿°å¯çŸ¥KubeSphereçš„ä¸¤å¤§åº•å±‚æ”¯æŸ±ä¸ºKubernetesä¸Jenkinsï¼Œæœ¬æ–‡ä¹Ÿä¸»è¦åŸºäºè¿™ä¸¤éƒ¨åˆ†è¿›è¡Œè®°å½•ã€‚\næµæ°´çº¿è®¾è®¡ åŸºäºéƒ¨é—¨ç°çŠ¶ä»¥åŠå‚è€ƒç½‘ä¸Šèµ„æ–™ï¼Œå°†äº§å“éƒ¨ç½²ç¯å¢ƒåˆ’åˆ†ä¸ºå¦‚ä¸‹4ç§ç±»å‹:\n devï¼Œæœ¬åœ°å¼€å‘é˜¶æ®µ sitï¼Œå‰åç«¯å„æ¨¡å—è”è°ƒé˜¶æ®µ testï¼Œè½¯ä»¶åŠŸèƒ½æµ‹è¯•é˜¶æ®µ prodï¼Œæ­£å¼ä½¿ç”¨é˜¶æ®µ  è™½ç„¶é€šè¿‡ä¸Šè¿°åˆ’åˆ†æ–¹å¼å¯æœ‰æ•ˆçš„é¿å…ä¸åŒç¯å¢ƒçš„äº’ç›¸å¹²æ‰°ï¼Œä½†ç”±äºç›®å‰éƒ¨é—¨å¤§éƒ¨åˆ†äº§å“éƒ½é‡‡ç”¨äº†å¾®æœåŠ¡å®ç°ï¼Œè½¯ä»¶æ¶æ„ç±»ä¼¼ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªå¾®æœåŠ¡æ¨¡å—éƒ½æœ‰å•ç‹¬çš„ä»£ç ç®¡ç†ï¼Œå¯¼è‡´è‹¥ç»™å‰åç«¯çš„æ¯ä¸ªåŠŸèƒ½æ¨¡å—åœ¨ä¸åŒç¯å¢ƒä¸‹éƒ½é…ç½®ä¸€å¥—Jenkinsæµæ°´çº¿åˆ™å®é™…çš„æµæ°´çº¿æ•°ç›®ä¼šååˆ†åºå¤§ï¼Œä¸ä¾¿äºç®¡ç†å’Œç»´æŠ¤ã€‚\nè‹¥å¯¹äºæ¯ä¸ªåŠŸèƒ½æ¨¡å—åœ¨æ‰€æœ‰ä¸åŒç¯å¢ƒä¸­éƒ½åˆ†åˆ«ä½¿ç”¨ä¸€å¥—æµæ°´çº¿ï¼Œåˆ™å…¶æ•°é‡ä¸ºåŠŸèƒ½æ¨¡å—æ•°Xç¯å¢ƒç§ç±»æ•°ï¼Œé€ æˆæµæ°´çº¿æ•°ç›®è¿‡å¤§ï¼Œä½¿ç”¨ä¸ä¾¿åŒæ—¶ä¹Ÿä¸åˆ©äºåæœŸçš„ç»´æŠ¤ã€‚\nåŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯¹Jenkinsæµæ°´çº¿çš„æ„å»ºå’Œä½¿ç”¨æ–¹å¼æå‡ºäº†å¦‚ä¸‹è¦æ±‚ï¼š\n ä¸€å¥—Gitlabä»£ç åº“å¯¹åº”ä¸€æ¡Jenkinsæµæ°´çº¿ï¼Œå®é™…ä¸Šå°±æ˜¯å‰åç«¯çš„ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ï¼Œä½¿ç”¨æ—¶å¯åŠ¨æ€é€‰æ‹©åˆ†æ”¯ ä¸€å¥—Jenkinsæµæ°´çº¿å¯ä»¥æ ¹æ®ä½¿ç”¨éœ€æ±‚çµæ´»çš„å¾€devã€sitã€testã€prodè¿™4å¥—ç¯å¢ƒä¹‹ä¸€è¿›è¡Œéƒ¨ç½² devã€sitã€testã€prodå¯¹äºåŒä¸€å¥—ä»£ç è€Œè¨€æ˜¯åˆ†åˆ«éƒ¨ç½²çš„ï¼Œå³4å¥—ç¯å¢ƒäº’ä¸å½±å“  åŠ¨æ€å‚æ•° ä¸Šå›¾å±•ç¤ºäº†Jenkinsè¿›è¡Œè½¯ä»¶æ„å»ºçš„ä¸»è¦æµç¨‹ï¼Œä»ä¸­å¯çŸ¥è‹¥è¾¾åˆ°ä¸Šè¿°ç²¾ç®€æµæ°´çº¿æ¡ç›®çš„è¦æ±‚ï¼Œåˆ™éœ€è¦è¿›è¡ŒåŠ¨æ€å‚æ•°é…ç½®ï¼ŒåŸºäºé¡¹ç›®å®é™…æƒ…å†µï¼Œæ•´ç†å‡ºå¦‚ä¸‹åœºæ™¯ï¼š\n è½¯ä»¶ç‰ˆæœ¬ï¼Œä¸»è¦æ˜¯åç«¯åŸºäºMavençš„é¡¹ç›®éœ€è¦æ­£ç¡®çš„è·å–ç‰ˆæœ¬å· å®¹å™¨ç«¯å£ï¼ŒSpringBootåº”ç”¨ç¨‹åºå¯¹å¤–æš´éœ²çš„ç«¯å£ï¼Œæ­¤éƒ¨åˆ†éœ€è¦åœ¨ä½¿ç”¨Dockerfileæ„å»ºæ—¶åŠ¨æ€å¯¹å¤–æš´éœ²1 å®¹å™¨ç«¯å£ï¼ŒKubernetesä¸­åˆ›å»ºå®¹å™¨æ—¶å¯¹å¤–æš´éœ²çš„ç«¯å£ï¼Œä¸»è¦ç”¨äºç¨‹åºè®¿é—® é•œåƒç‰ˆæœ¬ï¼Œå‰åç«¯ç¨‹åºæ„å»ºé•œåƒæ—¶ï¼Œå¯¹åº”tagçš„åŠ¨æ€è®¾ç½®  åœ¨Jenkinsä¸­çš„è„šæœ¬ç±»å‹ä¸»è¦æœ‰shellè„šæœ¬å’Œscriptè„šæœ¬2ç§ç±»å‹ï¼Œå…¶ä¸­scriptæ˜¯åŸºäºGrovvyå®ç°çš„ï¼Œè€ŒGroovyæ˜¯åŸºäºJVMå®ç°çš„ï¼Œå…¶åœ¨æ—¶ä½¿ç”¨ä¸Šæ¯”shellæ›´çµæ´»ï¼Œæ•…åœ¨æµæ°´çº¿å®ç°æ—¶å¯¹äºå‚æ•°è®¾ç½®ä¸è·å–ç¡®å®šäº†ä¸€ä¸ªå¦‚ä¸‹çš„å¤§è‡´åŸåˆ™:\n èƒ½é€šè¿‡Groovyè„šæœ¬è·å–çš„å˜é‡ä¸å‚æ•°å°½é‡é€šè¿‡Grovvyè·å–ï¼ŒShellè„šæœ¬åªè´Ÿè´£ä½¿ç”¨\n scriptä¸­å®šä¹‰å‚æ•° åœ¨scriptä¸­è¾“å…¥ç¬¦åˆ Groovyè¯­æ³•çš„ä»£ç å³å¯ï¼Œä¸ºäº†åœ¨å¤šä¸ªstepsä¹‹é—´å®ç°å‚æ•°å…±äº«ï¼Œéœ€è¦åœ¨å®šä¹‰å‚æ•°æ—¶åŠ ä¸Šenv.å‰ç¼€2ï¼Œç±»ä¼¼å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  switch(PRODUCT_PHASE) { case \u0026#34;sit\u0026#34;: env.NODE_PORT = 13003 env.DUBBO_PORT = 13903 break case \u0026#34;test\u0026#34;: env.NODE_PORT = 14003 env.DUBBO_PORT = 14903 break case \u0026#34;prod\u0026#34;: env.NODE_PORT = 15003 env.DUBBO_PORT = 15903 break } env.DUBBO_IP = \u0026#34;10.30.5.170\u0026#34;   scriptä¸­è¯»å–å‚æ•° 1  print env.DUBBO_IP   shellä¸­è¯»å–å‚æ•° éœ€è¦é‡‡ç”¨$å‚æ•°å(å»æ‰env.å‰ç¼€)çš„æ–¹å¼ï¼Œç±»ä¼¼å¦‚ä¸‹\n1 2 3 4 5 6  docker build -f kubesphere/Dockerfile \\ -t idp-data:$BUILD_TAG \\ --build-arg PROJECT_VERSION=$PROJECT_VERSION \\ --build-arg NODE_PORT=$NODE_PORT \\ --build-arg DUBBO_PORT=$DUBBO_PORT \\ --build-arg PRODUCT_PHASE=$PRODUCT_PHASE .   yamlæ–‡ä»¶ä¸­è¯»å–å‚æ•° åœ¨Kubernetesä¸­éœ€è¦ä¸€ä¸ªyamlæ–‡ä»¶æ¥é…ç½®è¦ç”Ÿæˆçš„podï¼Œå…¶å‚æ•°çš„è·å–ä¹Ÿæ˜¯é‡‡ç”¨$å‚æ•°åçš„æ–¹å¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  spec:ports:- name:httpport:$NODE_PORTprotocol:TCPtargetPort:$NODE_PORTnodePort:$NODE_PORT- name:dubboport:$DUBBO_PORTprotocol:TCPtargetPort:$DUBBO_PORTnodePort:$DUBBO_PORTselector:app:lucumt-data-$PRODUCT_PHASEsessionAffinity:Nonetype:NodePort  Dockerfileä¸­è¯»å–å‚æ•° å½“åœ¨dockerçš„buildé˜¶æ®µä¼ é€’æ­£ç¡®çš„å‚æ•°åï¼Œåœ¨Dockerfileä¸­éœ€è¦é‡‡ç”¨${å‚æ•°å}çš„æ–¹å¼è·å–å‚æ•°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  # åŸºç¡€é•œåƒFROMopenjdk:8-jdk# authorLABEL maintainer=luyunqiang # åˆ›å»ºç›®å½•RUN mkdir -p /home/lucumt# æŒ‡å®šè·¯å¾„WORKDIR/home/lucumtARG PRODUCT_PHASEARG NODE_PORTARG DUBBO_PORTENV PARAMS=\u0026#34;--server.port=${NODE_PORT}--spring.application.name=lucumt-data --spring.profiles.active=${PRODUCT_PHASE}--dubbo.protocol.port=${DUBBO_PORT}\u0026#34;RUN /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \u0026amp;\u0026amp; echo \u0026#39;Asia/Shanghai\u0026#39; \u0026gt;/etc/timezone  ç¼–è¯‘ä¸éƒ¨ç½² ç”±äºå…¬å¸ç ”å‘ç¯å¢ƒä¸äº’è”ç½‘éš”ç¦»ï¼Œæ•…éœ€è¦åœ¨å‰åç«¯åˆ†åˆ«è®¾ç½®å¯ç”¨çš„é•œåƒæ‰èƒ½ç¡®ä¿ç¼–è¯‘æ­£å¸¸ã€‚\nå‰ç«¯   Nodejsç‰ˆæœ¬å·å‡çº§ï¼š\nç”±äºKubeSphereä¸­çš„Node.jsçš„ç‰ˆæœ¬è½åäºé¡¹ç›®ä¸­ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œæ•…éœ€è¦é€šè¿‡å¦‚ä¸‹å‘½ä»¤å‡çº§å…¶ç‰ˆæœ¬ï¼š\nnpm install node@16.13.1 --registry https://mirrors.xxx.com/repository/NPM/\n  Nginxé»˜è®¤çš„ç«¯å£ä¸º80ï¼Œä¸”å…¶é»˜è®¤çš„confæ–‡ä»¶è¾ƒä¸ºç®€é™‹ï¼Œä¸ºäº†å®ç°nginxçš„ä¸ªæ€§åŒ–é…ç½®ï¼Œå¯ä»¥è‡ªå·±é¢„å…ˆé…ç½®å¥½ä¸€ä¸ªconfæ–‡ä»¶ï¼Œç„¶ååœ¨dockeræ„å»ºæ—¶ï¼Œå°†å…¶è¦†ç›–å³å¯\n1 2 3 4 5 6 7 8 9 10  FROMnginxRUN mkdir -p /usr/share/nginx/html/lucumt-webCOPY dist /usr/share/nginx/html/lucumt-web# é‡‡ç”¨è‡ªå·±å®šä¹‰çš„é…ç½®æ–‡ä»¶COPY kubesphere/idp.conf /etc/nginx/conf.d/EXPOSE8080    åç«¯   è·å–Mavenç‰ˆæœ¬å·ï¼š\n1  mvn help:evaluate -Dexpression=project.version -q -DforceStdout     ç”±äºåœ¨shellä¸­ä¸æ–¹ä¾¿å®šä¹‰å…¨å±€å˜é‡ï¼Œè€ŒMavençš„ç‰ˆæœ¬å·åªèƒ½åœ¨æ‰§è¡Œç›¸å…³å‘½ä»¤æ—¶è·å–ï¼Œä¸ºäº†å®ç°ç‰ˆæœ¬å·çš„å…±äº«ï¼Œå¯å°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œåœ¨shellä¸­åˆ©ç”¨mavenå‘½ä»¤è·å–ç‰ˆæœ¬å·ï¼Œç„¶åå†ç”±Groovyè„šæœ¬å°†å…¶èµ‹å€¼ä¸ºå…¨å±€ç¯å¢ƒå˜é‡:\n1 2 3  env.PROJECT_VERSION = sh(script: \u0026#39;mvn help:evaluate -Dexpression=project.version -q -DforceStdout\u0026#39;, returnStdout: true) env.BUILD_TIME = new Date().format(\u0026#34;yyyyMMdd-HHmmss\u0026#34;) env.BUILD_TAG = PROJECT_VERSION + \u0026#34;-\u0026#34; + BUILD_TIME     K8Så®¹å™¨æ¢æ´» KubeSphereå¯¹äºå®¹å™¨çš„å¯åŠ¨ã€å°±ç»ªå’Œå­˜æ´»çš„æ¢æµ‹ä¾èµ–äºKubernetesçš„ç›¸å…³å®ç°ï¼Œå®é™…ä½¿ç”¨ä¸­KubeSphereåªéœ€è¦èƒ½æ­£å¸¸æ£€æµ‹åˆ°å°±ç»ªçŠ¶æ€å³å¯ï¼Œç°é˜¶æ®µé¡¹ç›®ä¸­ä¹ŸåªåŸºäºå°±ç»ªæ¢æµ‹æ¥å®ç°ã€‚\nåç«¯ SpringBootç¨‹åºå¯åŸºäºSpring Boot Actuatorä¸­æä¾›çš„actuator/healthè¿›è¡Œå°±ç»ªæ£€æµ‹ï¼Œç›¸å…³é…ç½®å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9  containers:- image:\u0026#39;$REGISTRY/$DOCKERHUB_NAMESPACE/lucumt-system:${BUILD_TAG}\u0026#39;readinessProbe:httpGet:path:lucumt-system/actuator/healthport:$NODE_PORTtimeoutSeconds:10failureThreshold:30periodSeconds:5  å‰ç«¯ ç”±äºå‰ç«¯æ²¡æœ‰å•ç‹¬çš„æ¥å£å¯¹å¤–æš´éœ²ï¼Œæ•…å¯é‡‡ç”¨åœ¨Dockerå®¹å™¨ä¸­æ‰§è¡Œlinuxå‘½ä»¤çš„æ–¹å¼æ¥æ£€æµ‹æ˜¯å¦å°±ç»ªï¼Œä¸ªäººé‡‡ç”¨unameï¼Œç›¸å…³é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9  containers:- image:\u0026#39;$REGISTRY/$DOCKERHUB_NAMESPACE/lucumt-system-web:${BUILD_TAG}\u0026#39;readinessProbe:exec:command:- unametimeoutSeconds:10failureThreshold:30periodSeconds:5  è¿è¡Œæ•ˆæœ è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼Œå¯å®ç°åŠ¨æ€çš„æŒ‡å®šæµ‹è¯•é˜¶æ®µå’Œä»£ç åˆ†æ”¯ï¼š\nå‚è€ƒä»£ç   å‰ç«¯éƒ¨åˆ†:  Dockerfileï¼Œå‚è§lucumt-common-web.dockerfile depoly.ymlï¼Œå‚è§lucumt-common-web.yaml Jenkinsæµæ°´çº¿ï¼Œå‚è§lucumt-common-web.groovy Nginxé…ç½®æ–‡ä»¶ï¼Œå‚è§lucumt-common-web-nginx.conf   åç«¯éƒ¨åˆ†:  Dockerfileï¼Œå‚è§lucumt-system.dockerfile depoly.ymlï¼Œå‚è§lucumt-system.yaml Jenkinsæµæ°´çº¿ï¼Œå‚è§lucumt-system.groovy    å‚è€ƒ:\n https://askubuntu.com/questions/76808/how-do-i-use-variables-in-a-sed-command    ç†è®ºä¸Šæ¥è¯´æ­¤å¤„çš„ç«¯å£ä¸ç”¨æš´éœ²ï¼Œåªéœ€è¦åœ¨å®¹å™¨åˆ›å»ºæ—¶è¿›è¡Œå¯¹åº”çš„ç«¯å£æ˜ å°„å³å¯ï¼Œä¸è¿‡ç”±äºå…¬å¸é¡¹ç›®é‡‡ç”¨nacosè¿›è¡ŒåŠ¨æ€é…ç½®ä¸æœåŠ¡å‘ç°ï¼Œä¸ºäº†æ–¹ä¾¿ç»Ÿä¸€ç®¡ç†ï¼Œæ•…ä¹Ÿå°†æ­¤å¤„çš„ç«¯å£åšæˆåŠ¨æ€é…ç½®\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n å®é™…æµ‹è¯•å‘ç°ä¸åŠ env.ä¹Ÿèƒ½åœ¨å…¶å®ƒçš„æ­¥éª¤ä¸­æ­£å¸¸è·å–\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/devops/share-experiences-for-using-kubesphere/","tags":["kubesphere","jenkins"],"title":"KubeSphereä½¿ç”¨å¿ƒå¾—"},{"categories":["å®¹å™¨åŒ–"],"contents":"ç”±äºå…¬å¸çš„dockerå®¹å™¨åœ¨è¿è¡Œä¸€æ®µæ—¶é—´åæ—¥å¿—å˜å¾—å¾ˆå¤§ï¼Œé€šè¿‡shellè„šæœ¬æˆ–è€…ç»“åˆdocker stopã€docker rmå’Œdocker runæ¥é‡æ–°åˆ›å»ºå®ä¾‹æ–¹å¼éƒ½è§‰å¾—å¤ªéº»çƒ¦ï¼ŒæŒ‰ç…§ç½‘ç»œä¸Šçš„å»ºè®®åœ¨/etc/docker/daemon.jsonä¸­è¿›è¡Œç›¸å…³ä¿®æ”¹åå´ä¸€ç›´æ— æ³•å¯åŠ¨ï¼ŒåŒæ—¶é”™è¯¯ä¿¡æ¯ä¸€ç›´æç¤ºunable to configure the Docker daemon with file /etc/docker/daemon.json: the following directives are specified both as a flag and in the configâ€¦e: json-file)ï¼Œç»è¿‡ä¸€ç•ªæ’æŸ¥åç»ˆäºæ‰¾åˆ°åŸå› ï¼Œæ•…è®°å½•ä¸‹ã€‚\né—®é¢˜å¤ç° ç³»ç»Ÿç¯å¢ƒ   æ“ä½œç³»ç»Ÿï¼Œuname -aè¾“å‡ºå¦‚ä¸‹ï¼š\n1  Linux AEHPD 3.10.0-693.el7.x86_64 #1 SMP Tue Aug 22 21:09:27 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux     docker infoè¾“å‡ºçš„ä¸»è¦ä¿¡æ¯å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  Containers: 0 Running: 0 Paused: 0 Stopped: 0 Images: 0 Server Version: 1.13.1 Storage Driver: overlay2 Backing Filesystem: xfs Supports d_type: true Native Overlay Diff: true Logging Driver: journald Cgroup Driver: systemd Plugins: Volume: local Network: bridge host macvlan null overlay Swarm: inactive Runtimes: docker-runc runc Default Runtime: docker-runc     æ“ä½œè¿‡ç¨‹   åœ¨/etc/docker/daemon.jsonçš„é…ç½®å¦‚ä¸‹:\n1 2 3 4 5 6 7 8  { \u0026#34;registry-mirrors\u0026#34;:[\u0026#34;https://docker.hirain.com\u0026#34;], \u0026#34;log-driver\u0026#34;: \u0026#34;json-file\u0026#34;, \u0026#34;log-opts\u0026#34;: { \u0026#34;max-size\u0026#34;: \u0026#34;50m\u0026#34;, \u0026#34;max-file\u0026#34;:\u0026#34;3\u0026#34; } }     ä¹‹åæ‰§è¡Œsystemctl daemon-reload \u0026amp;\u0026amp; systemctl restart dockerä¼šæç¤ºdockerå¯åŠ¨å¤±è´¥ï¼Œæ ¹æ®è¾“å‡ºæç¤ºåˆ©ç”¨systemctl status docker.serviceè·å–è¯¦ç»†çš„è¾“å‡ºä¿¡æ¯å¦‚ä¸‹:\nä»è¾“å‡ºä¸­å¯çœ‹è§ç³»ç»Ÿæç¤ºå¦‚ä¸‹æŠ¥é”™ä¿¡æ¯:\n unable to configure the Docker daemon with file /etc/docker/daemon.json: the following directives are specified both as a flag and in the config\u0026hellip;e: json-file)\n   åŸºäºå‰è¿°æ­¥éª¤çš„æç¤ºä¿¡æ¯ï¼Œåœ¨/etc/docker/daemon.jsonç§»é™¤\u0026quot;log-driver\u0026quot;: \u0026quot;json-file\u0026quot;è¿™è¡Œé…ç½®ç„¶åæ‰§è¡Œç›¸å…³å‘½ä»¤é‡å¯ä¼šå‘ç° dockerä¾æ—§å¯åŠ¨å¤±è´¥ï¼\nä»è¾“å‡ºä¸­å¯çœ‹è§å¦‚ä¸‹æç¤ºä¿¡æ¯:\n dockerd-current[14912]: Failed to set log opts: unknown log opt \u0026lsquo;max-size\u0026rsquo; for journald log driver\n   åœ¨/etc/docker/daemon.jsonå°†log-optsç›¸å…³é…ç½®ç§»é™¤åï¼Œå‘ç°dockerèƒ½å¯åŠ¨æˆåŠŸï¼è‡³æ­¤å¯ä»¥å¾—å‡ºå¦‚ä¸‹2æ¡ç»“è®º:\n log-driveré…ç½®ç”±äºä¸å…¶å®ƒæŒ‡ä»¤å†²çªäº†ï¼Œå¯¼è‡´dockeræœåŠ¡æ— æ³•å¯åŠ¨ï¼Œåç»­å»dockerå®˜ç½‘æŸ¥è¯¢ä¹Ÿç¡®å®æœ‰æ­¤è¯´æ˜1 log-optså•ç‹¬åœ¨/etc/docker/daemon.jsonä¹Ÿä¸ç”Ÿæ•ˆ    æ’æŸ¥ä¸è§£å†³   åœ¨å¯æ­£å¸¸å¯åŠ¨dockeræœåŠ¡çš„ç¯å¢ƒä¸‹åˆ©ç”¨docker info --format '{{.LoggingDriver}}'å‘½ä»¤å‘ç°å…¶è¾“å‡ºä¸ºjournaldï¼Œæ˜¾ç„¶ä¹‹å‰çš„log-driveré…ç½®ä¸å…¶å†²çªäº†ï¼Œä»è€Œå¯¼è‡´docker`æœåŠ¡æ— æ³•å¯åŠ¨\n  å‰é¢çš„æ­¥éª¤ä¸­æç¤ºæœ‰/etc/docker/seccomp.json ï¼ŒæŸ¥çœ‹å…¶ä¸­çš„å†…å®¹æ²¡æœ‰å‘ç°æœ‰ä»·å€¼çš„ä¿¡æ¯\n  é€šè¿‡systemctl status docker.service -lè¾“å‡ºå¦‚ä¸‹ï¼Œåœ¨å…¶ä¸­å‘ç°å…³é”®ä¿¡æ¯--log-driver=journald ï¼Œå¾ˆæ˜æ˜¾æ˜¯å…¶å®ƒåœ°æ–¹æœ‰å¯¹åº”è®¾ç½®\n  æŸ¥æ‰¾ç½‘ç»œèµ„æ–™ï¼Œåˆ©ç”¨cat /lib/systemd/system/docker.serviceæŸ¥çœ‹æ˜¯ç”±æœ‰å…¶å®ƒé…ç½®æ–‡ä»¶ï¼Œå‘ç°é…ç½®æ–‡ä»¶ /etc/sysconfig/docker\n  è¾“å‡º /etc/sysconfig/dockerç»“æœå¦‚ä¸‹ï¼Œå‘ç°å…³é”®ä¿¡æ¯--log-driver=journald ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬ä¹‹å‰ä¿®æ”¹/etc/docker/daemon.jsonåä¸€ç›´æ— æ³•å¯åŠ¨çš„ç½ªé­ç¥¸é¦–ï¼\n  æ¥ä¸‹æ¥åœ¨/etc/sysconfig/dockerä¸­çš„ç›¸å…³ä½ç½®å°†--log-driver=journald è¿™æ¡æŒ‡ä»¤å»æ‰ï¼Œç„¶ååœ¨/etc/docker/daemon.jsonä¸­é‡æ–°åŠ ä¸Šç›¸å…³ä¹‹åådockerå®¹å™¨å¯æ­£å¸¸å¯åŠ¨ï¼Œé—®é¢˜è§£å†³ï¼\n    Troubleshoot conflicts between the daemon.json and startup scripts\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/docker/can-not-set-log-driver-and-log-opts-in-docker-daemon-json/","tags":["docker"],"title":"ç”±äºdaemon.jsonä¸­çš„é…ç½®ä¸å…¶å®ƒå¯åŠ¨é¡¹å†²çªå¯¼è‡´dockeræœåŠ¡æ— æ³•å¯åŠ¨"},{"categories":["ä¸ªäººåšå®¢"],"contents":"è‡ªå·±ä¸€ç›´ç‰¹åˆ«ç¾¡æ…•åšå®¢å›­ä¸ŠæŸäº›åšä¸»çš„åšæ–‡æ ·å¼ï¼ˆå¦‚æ­¦åŸ¹è½©,JavaGuide)ï¼Œè¿™äº›åšæ–‡æ ·å¼ç¬¬ä¸€çœ¼çœ‹èµ·æ¥å°±å¾ˆæ¸…çˆ½,è®©äººå¾ˆæœ‰é˜…è¯»çš„æ¬²æœ›ï¼Œè€Œæˆ‘æ€»æ„Ÿè§‰è‡ªå·±åšå®¢çš„æ ·å¼ç‰¹ä¸‘é™‹ã€‚å³ä½¿ä¸å…³æ³¨å†…å®¹ï¼Œåªçœ‹æ’ç‰ˆå¸ƒå±€å’Œæ ·å¼ï¼Œæœ‰æ—¶å€™è‡ªå·±å†™å®Œä¸€ç¯‡æ–‡ç« è‡ªå·±éƒ½ä¸æƒ³å»çœ‹ï¼Œä½•å†µåˆ«äººï¼\nç»ˆäºæœ‰ä¸€å¤©æˆ‘å—ä¸äº†è‡ªå·±çš„åšå®¢æ ·å¼ï¼Œå†³å®šå¯¹å…¶å‡çº§ä¸€ç‰ˆï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‘ç°ä¸ªäººé‡‡ç”¨çš„åšå®¢ä¸»é¢˜EvenåŠŸèƒ½å¾ˆå¼ºå¤§ï¼ŒåŸºäºä¸Šæ²¡åšå•¥ä¿®æ”¹å°±è¾¾åˆ°äº†è‡ªå·±æƒ³è¦çš„æ•ˆæœï¼Œç‰¹æ­¤è®°å½•ä¸‹ã€‚\né£æ ¼å¯¹æ¯” ä¸ªäººåšå®¢åŸºäºGolangè¯­è¨€å¼€å‘çš„Hugoæœ€å¼€å§‹æ˜¯é‡‡ç”¨hugo-redloungeä¸»é¢˜æ¥å®ç°çš„ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´çš„ä½¿ç”¨ä¹‹åæ„Ÿè§‰hugo-redloungeä¸»é¢˜åŠŸèƒ½ä¸ä¸°å¯Œä¸”å·¦ä¾§ä¼šå›ºå®šå ç”¨ä¸€éƒ¨åˆ†å®½åº¦æ¥å±•ç¤ºä¸ªäººä¿¡æ¯ï¼Œè€Œè¿™éƒ¨åˆ†å…¶å®å¹¶æ— å¤ªå¤§æ„ä¹‰ï¼Œæ•…åæ¥å°†å…¶åˆ‡æ¢ä¸ºå¦‚ä»Šçš„Evenæ ·å¼ã€‚\n  hugo-redloungeä¸»é¢˜çš„åšå®¢ï¼š\n  Evenä¸»é¢˜çš„åšå®¢\n  Evenä¸»é¢˜çš„ä»£ç å’Œå¼•ç”¨æ ·å¼\n  åˆ‡æ¢åè™½ç„¶ç›¸å¯¹äºä¸hugo-redloungeä¸»é¢˜å½“å‰åšå®¢çš„åŠŸèƒ½å’Œç•Œé¢ç¾è§‚æ€§æœ‰ä¸€å®šæå‡ï¼Œä½†æ˜¯å’Œåšå®¢å›­ä¸­çš„åšæ–‡æ ·å¼æ¯”èµ·æ¥ç›´è§‚æ„Ÿè§‰è¿˜æ˜¯æœ‰ä¸€å®šå·®è·ï¼Œå°¤å…¶æ˜¯åœ¨åŒ…å«ä»£ç æ®µæ—¶æ·¡é»„è‰²çš„èƒŒæ™¯çœ‹èµ·æ¥ç•¥å¾®ä¸èˆ’æœ(å¦‚ä¸Šå›¾)ã€‚\næºç åˆ†æ ä¸ªäººå¯¹äºEvenä¸»é¢˜æœ€ä¸æ»¡æ„çš„æ˜¯åœ¨æ˜¾ç¤ºä»£ç æ®µæ—¶å…¶æ ·å¼ä¸å¤ªç¬¦åˆè‡ªå·±é¢„æœŸï¼Œåœ¨æµè§ˆå™¨ä¸­åˆ†æä»£ç æ®µå¯¹åº”çš„CSSæ ·å¼ï¼Œå¯çœ‹å‡ºæ˜¯ç”±å¦‚ä¸‹CSSä»£ç æ§åˆ¶çš„ï¼š\n1 2 3 4 5 6  .post .post-content code, .post .post-content pre { padding: 7px; font-size: .9em; font-family: Consolas,Monaco,Menlo,dejavu sans mono,bitstream vera sans mono,courier new,monospace; background: #f8f5ec; }   åˆ†æEvenä¸»é¢˜çš„æºç åå‘ç°å…¶ä¸»è¦æ˜¯åŸºäºSassæ¡†æ¶é€šè¿‡_code.scsså’Œ_content.scssè”åˆå®ç°çš„ï¼Œå…¶ä¸­èƒŒæ™¯è®¾ç½®æ˜¯é€šè¿‡background: $code-background;å®ç°\nç”±äºSassæ”¯æŒé€šè¿‡å˜é‡æ¥åŠ¨æ€çš„è®¾ç½®CSSå±æ€§å€¼ï¼Œæ•…$code-backgroundæ˜¾ç„¶ä¹Ÿæ˜¯ä¸€ä¸ªå˜é‡ï¼ŒæŸ¥çœ‹æºç åå‘ç°å…¶åœ¨_variables.scssä¸­æœ‰å¦‚ä¸‹å®šä¹‰:\n1 2  // Color of the code background. $code-background: $deputy-color !default;   åœ¨_variables.scssä¸­ç»§ç»­æŸ¥æ‰¾$deputy-colorçš„å®šä¹‰ï¼Œå¯æ‰¾å‡ºåœ¨è¯¥æ–‡ä»¶å¼€å¤´æœ‰å¦‚ä¸‹ä»£ç ï¼Œå…¶ä¸­$deputy-coloræ˜¯é€šè¿‡$theme-color-configåœ¨$theme-color-mapä¸­æŸ¥æ‰¾ç›¸å…³çš„é¢œè‰²è®¾ç½®ï¼Œè‡ªå·±åšå®¢ä¹‹å‰é»˜è®¤æ·¡é»„è‰²çš„ä»£ç å—æ ·å¼å°±æ˜¯é€šè¿‡Defaultæ ·å¼è®¾ç½®çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  // ============================== // Variables // ==============================  // ========== Theme Color ========== // // Config here to change theme color // Default | Mint Green | Cobalt Blue | Hot Pink | Dark Violet $theme-color-config: \u0026#39;Mint Green\u0026#39;; // Default theme color map $theme-color-map: ( \u0026#39;Default\u0026#39;: #c05b4d #f8f5ec, \u0026#39;Mint Green\u0026#39;: #16982B #f5f5f5, \u0026#39;Cobalt Blue\u0026#39;: #0047AB #f0f2f5, \u0026#39;Hot Pink\u0026#39;: #FF69B4 #f8f5f5, \u0026#39;Dark Violet\u0026#39;: #9932CC #f5f4fa ); // Check theme color config. // if it does not exist, use default theme color. @if not(map-has-key($theme-color-map, $theme-color-config)) { $theme-color-config: \u0026#39;Default\u0026#39;; } $theme-color-list: map-get($theme-color-map, $theme-color-config); // Default theme color of the site. $theme-color: nth($theme-color-list, 1) !default; // Deputy theme color of the site. $deputy-color: nth($theme-color-list, 2) !default;   è¿›ä¸€æ­¥åˆ†æåå‘ç°$deputy-coloråœ¨_variables.scssä¸­çš„å¤šä¸ªåœ°æ–¹éƒ½æœ‰ä½¿ç”¨ï¼Œä»è€Œå¯ä»¥ç¡®å®šé€šè¿‡ä¿®æ”¹$theme-color-configçš„å€¼å°±èƒ½è¾¾åˆ°åŠ¨æ€æ›´æ”¹åšå®¢ä¸»é¢˜æ ·å¼çš„ç›®çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11  // Deputy theme color of the site. $deputy-color: nth($theme-color-list, 2) !default; // Backgroud color of the post toc. $post-toc-backgroud: rgba($deputy-color, 0.6) !default; // Border color of the table. $content-table-border-color: darken($deputy-color, 3%) !default; // Color of the code background. $code-background: $deputy-color !default;   æ ·å¼ä¿®æ”¹ ç”±äºSCSSæ–‡ä»¶éœ€è¦ç¼–è¯‘æˆCSSæ–‡ä»¶åæ‰èƒ½è¢«ä½¿ç”¨ï¼Œè€ŒHugoé»˜è®¤ç‰ˆæœ¬æ˜¯ä¸æ”¯æŒSCSSç¼–è¯‘çš„ï¼Œæ•…éœ€è¦ä¸‹è½½Hugo Extendedç‰ˆæœ¬\nä¸‹è½½å®Œæ¯•åï¼Œéœ€å°†å…¶æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ï¼Œå…¶å„ç§æŒ‡ä»¤çš„ç”¨æ³•ä¸é»˜è®¤ç‰ˆHugoçš„ç”¨æ³•ç›¸åŒï¼Œæ ¹æ®å®é™…æƒ…å†µåœ¨_variables.scssä¸­ä¿®æ”¹$theme-color-configçš„å€¼ï¼Œç„¶åè°ƒç”¨hugo server -w -Dç­‰å‘½ä»¤å³å¯å®æ—¶å±•ç¤ºä¿®æ”¹æ•ˆæœã€‚\nç»“æœå±•ç¤º Defaultæ ·å¼ Mint Greenæ ·å¼ Cobalt Blueæ ·å¼ Hot Pinkæ ·å¼ Dark Violetæ ·å¼ æ‰©å±• å¯æ ¹æ®ä¸ªäººå–œå¥½åœ¨_variables.scssåŠ¨æ€çš„æ·»åŠ è‡ªå·±å–œæ¬¢çš„é¢œè‰²é…ç½®\n1 2 3 4 5 6 7 8 9 10 11 12 13  // ========== Theme Color ========== // // Config here to change theme color // Default | Mint Green | Cobalt Blue | Hot Pink | Dark Violet $theme-color-config: \u0026#39;Mint Green\u0026#39;; // Default theme color map $theme-color-map: ( \u0026#39;Default\u0026#39;: #c05b4d #f8f5ec, \u0026#39;Mint Green\u0026#39;: #16982B #f5f5f5, \u0026#39;Cobalt Blue\u0026#39;: #0047AB #f0f2f5, \u0026#39;Hot Pink\u0026#39;: #FF69B4 #f8f5f5, \u0026#39;Dark Violet\u0026#39;: #9932CC #f5f4fa );   è‡´è°¢  https://github.com/olOwOlo/hugo-theme-even https://github.com/ahonn/hexo-theme-even ","permalink":"http://isouthrain.github.io/post/hugo/change-hugo-style-in-even-theme/","tags":["hugo","Go"],"title":"åœ¨Hugoç”Ÿæˆçš„åšå®¢ä¸­åŠ¨æ€çš„ä¿®æ”¹æ ·å¼"},{"categories":["æŠ€æœ¯"],"contents":"å‰è¨€ ç”±äº Windows çš„æŸäº›åŸå› ä½¿ç”¨ Emacs æ€»ä¼šé‚£ä¹ˆçš„ä¸æ–¹ä¾¿æˆ–è€…ä¸å¥½ç”¨,\næœ‰çš„äººæ˜¯åœ¨ MSYS2 ä¸‹ä½¿ç”¨, ä½†ç”±äº MYSYS2 è½¯ä»¶åŒ…ä¸å¤š, è¿˜æ˜¯å·®äº†ç‚¹\næ‰€ä»¥æœ¬æ–‡å€ŸåŠ© Windows WSL è¿›è¡Œä½¿ç”¨ Emacs ä¹ˆ, åƒåœ¨ Linux ä¸‹ä½¿ç”¨, ç›®å‰ä½“éªŒåŸºæœ¬ä¸Linuxä¸‹ä½“éªŒä¸€è‡´, ä¸è¿‡ EAF ä¸æ”¯æŒ\næ•ˆæœ  å®‰è£… WSL, æœ¬æ–‡æ˜¯ä½¿ç”¨ WSL2 Ubuntu22.04  å¦‚æœä½ æƒ³æŠŠ Ubuntu22.04 å®‰è£…åˆ°è‡ªå·±æŒ‡å®šç›˜ç¬¦, å¯ä»¥è§‚çœ‹æ­¤æ–‡ç«  å¦‚ä½•å°†WSLå®‰è£…åˆ°å…¶å®ƒé©±åŠ¨å™¨æˆ–è€…æ–‡ä»¶å¤¹ä¸­ | myfreax  å¯ç”¨ WSL åŠŸèƒ½  Win + s æ‰“å¼€æœç´¢, è¾“å…¥ å¯ç”¨æˆ–å…³é—­ Windows åŠŸèƒ½, å¹¶æ‰“å¼€  å°†çº¢çº¿ä¸¤ä¸ªåŠŸèƒ½æ‰“å‹¾âœ”, å¯ç”¨åé‡å¯ç”µè„‘  ä»¥ ç®¡ç†å‘˜æƒé™ æ‰“å¼€ Powershell, è®¾ç½®é»˜è®¤ä¸º wsl2 1  wsl --set-default-version 2    å®‰è£… Ubuntu22.04, wsl.exe \u0026ndash;install -d Ubuntu22.04  å¦‚æœå®‰è£…ä¸æˆåŠŸ, è¯·å‚è€ƒæ–‡ç«  å¦‚ä½•å°†WSLå®‰è£…åˆ°å…¶å®ƒé©±åŠ¨å™¨æˆ–è€…æ–‡ä»¶å¤¹ä¸­ | myfreax   è¿è¡Œ wsl, ç›´æ¥åœ¨ Powershell è¾“å…¥ wsl è¿è¡Œ  WSL æ–‡ä»¶æ‰€åœ¨ç›®å½• \\\\wsl$ è‡ªè§‰å®‰è£… Emacs å®‰è£… GUI æ”¯æŒ ä¸‹è½½å¹¶å®‰è£… MobaXterm MobaXterm Xserver with SSH, telnet, RDP, VNC and X11 - Download\né…ç½® GUI æ”¯æŒ   Ubuntu ä¸‹ ç¼–å†™ ~/.bashrc æˆ–è€… ~/.zshrc æœ«å°¾å¤„æ·»åŠ \n1 2 3 4 5 6 7  # ~/.bashrc æˆ–è€… ~/.zshrc æ–‡ä»¶ # è·å– Windows WSL IP host_ip=$(cat /etc/resolv.conf |grep \u0026#34;nameserver\u0026#34; |cut -f 2 -d \u0026#34; \u0026#34;) # å°† GUI æ˜¾ç¤ºè®© mobaxterm æ˜¾ç¤ºä»£æ›¿ export DISPLAY=\u0026#34;$host_ip:0\u0026#34; # å¦‚æœä½ è¦ä½¿ç”¨ windows ä»£ç† # export ALL_PROXY=\u0026#34;http://$host_ip:7890\u0026#34;     æ‰“å¼€ MobaXterm, æŒ‚åœ¨åå°, æœ‰é¢œè‰²ä¸ºå¯åŠ¨   åˆ·æ–° shell, source ~/.zshrc æˆ–è€… source ~/.bashrc\n  Ubuntu å¯åŠ¨ emacs è¯•è¯•, å¼¹å‡ºçš„çª—å£ä¸€ç›´ç‚¹ æ˜¯ å³å¯\n  GUI é…ç½® MobaXterm æ¨¡ç³Šè§£å†³, ä¿®æ”¹ DIP  Ubuntu Emacs å­—ä½“è¡¥å……  å½“ä½ æ‰“å¼€ emacs æ—¶å€™ä¼šä¹±ç ä¹‹ç±»çš„, æ˜¯å› ä¸ºç¼ºå°‘å­—ä½“ å°† C:\\Windows\\Fonts ç›®å½•ä¸‹çš„å­—ä½“å…¨éƒ¨å¤åˆ¶åˆ° \\\\wsl$\\Ubuntu22.04\\root\\.local\\share\\fonts  å¢å¼º emacs ç¾åŒ–   emasc å¯åŠ¨å±å¹•å°ºå¯¸å¤ªå°, ä¿®æ”¹æ•°å­—\n(set-face-attribute \u0026lsquo;default nil :height 150)\n  å»ºè®® emasc å®‰è£…ä»¥ä¸‹åŒ…\n cnfonts ç”¨æ¥è°ƒæ•´ emacs å­—ä½“å¤§å° all-the-icons ä¸º emacs æä¾› å›¾æ ‡æ”¯æŒ emojfyi ä¸º emacs æä¾› è¡¨æƒ…ç¬¦å·æ”¯æŒ    ","permalink":"http://isouthrain.github.io/post/2022-07-03-windowsemacsforwsl/","tags":["Emacs"],"title":"åƒ Linux Emacs ä¸€æ ·ä½¿ç”¨ WSL Emacs"},{"categories":["æŠ€æœ¯"],"contents":"ä»€ä¹ˆæ˜¯ GnuPG ? GPG å…¨åå« GNU Privacy Guard, æ˜¯ä¸€ä¸ªåŠ å¯†å‰ç«¯, å¯ä»¥ä½¿ç”¨ RSA ã€ESCDA ç­‰ç®—æ³•å»åŠ å¯†\nä¸‹è½½ GnuPG  GnuPGå®˜ç½‘  è·å–å¯†é’¥(Windows ä½¿ç”¨ç»ˆç«¯å‘½ä»¤) è¯·è®°ä½, å¯†é’¥ç»ä¸è¦ç»™ä»»ä½•äºº\n1  gpg --gen-key   é»˜è®¤é€‰é¡¹å³å¯\nåŠ å¯†è§£å¯†æ–‡ä»¶  åŠ å¯†ä¹‹å‰  åŠ å¯†åˆ†ä¸ºä¸¤ç§  å¯¹ç§°åŠ å¯†è§£å¯†(åŒæ–¹åªè¦è¾“å…¥å¯¹å¯†ç å°±å¯ä»¥æŸ¥çœ‹å’ŒåŠ å¯†) éå¯¹ç§°åŠ å¯†è§£å¯†(å¯¹æ–¹ä½¿ç”¨ ä½ ç»™çš„å…¬é’¥åŠ å¯†, åªæœ‰ä½¿ç”¨ ä½ è‡ªå·±çš„å¯†é’¥ èƒ½è§£å¯†æŸ¥çœ‹)     è¯¦ç»†è§£é‡Š  å¯¹ç§°åŠ å¯†è§£å¯†  åŠ å¯†(è¾“å…¥ä¸¤æ¬¡ç›¸åŒå¯†ç )   1  gpg --symmetric filename    è§£å¯†(è¾“å…¥é…å¯¹å¯†ç , ä¸ä¸Šé¢çš„å¯†ç ç›¸åŒ) 1 2 3 4  # ä»…ä»…è§£å¯†å†…å®¹ gpg -d filename.gpg # è§£å¯†å¹¶è¾“å‡ºåŸæ–‡ä»¶ gpg -o fileame -d filename.gpg     éå¯¹ç§°åŠ å¯†è§£å¯†(ä¸ªäººå¸¸ç”¨)  åŠ å¯† 1 2  # -r è¡¨ç¤º gpg ç”¨æˆ·, å°±åˆšæ‰åˆ›å»ºå¯†é’¥çš„ç”¨æˆ·å gpg -e -r User filename    è§£å¯† 1 2 3 4  # ä»…ä»…è§£å¯†å†…å®¹ gpg -d filename.gpg # è§£å¯†å¹¶è¾“å‡ºåŸæ–‡ä»¶ gpg -o fileame -d filename.gpg     å¯¼å‡º(è¯·ä¸è¦å°†å¯†é’¥å‘é€ç»™ä»»ä½•äºº,è‡ªå·±å¯¼å‡ºå¯†é’¥ä¿å­˜å°±å¥½) 1  gpg -o filename.asc --export keyID   å¯¼å…¥(ä¸ªäººä½¿ç”¨å¯¼å…¥å¯†é’¥å°±å¥½) 1  gpg --imort filename.asc   FAQâ“   æ˜¯ä¸æ˜¯åœ¨æˆ‘çš„ç”µè„‘ä¸Šï¼Œä½¿ç”¨åˆ«äººAçš„å…¬é’¥åŠ å¯†äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œæˆ‘æ²¡æœ‰åˆ«äººAçš„å¯†é’¥ï¼Œæˆ‘ä¹Ÿæ— æ³•è¯»å–æŸ¥çœ‹ã€‚æ˜¯å—ï¼Ÿï¼Ÿ\næ˜¯çš„\n  æ˜¯ä¸æ˜¯ä½¿ç”¨ éå¯¹ç§°åŠ å¯†(ä¸éœ€è¦å¯†ç )ï¼Œåˆ«äººæ²¡æœ‰å…¬é’¥å’Œç§é’¥å°±æ— æ³•ç ´è§£è¯»å–æ•°æ®ï¼Ÿ\nå…¬é’¥å¤§å®¶éƒ½å¯ä»¥æœ‰ï¼Œå¯ä»¥ç”¨æ¥åŠ å¯†(æ¯”å¦‚åœ¨å…¬å…±å¹³å°å‘ä¸€ä¸ªåªæœ‰ä½ èƒ½è§£å¯†çš„æ¶ˆæ¯)ä½†ä¸å¯ä»¥ç”¨æ¥è§£å¯†ã€‚ç§é’¥åªæœ‰ä½ æœ‰ï¼Œå¯ä»¥ç”¨æ¥è§£å¯†\nä¹Ÿå°±æ˜¯åªæœ‰ç§é’¥æ‰èƒ½æŸ¥çœ‹æ•°æ®ï¼Ÿï¼Ÿåœ¨å±äºè‡ªå·±çš„æœºå™¨ï¼Œåªéœ€è¦å¯¼å…¥ç§é’¥å°±å¥½äº†ï¼Œæ˜¯å§(æ˜¯çš„)\n  é‚£ç°åœ¨çš„GPGåŠ å¯†åœ¨æ²¡æœ‰ç§é’¥çš„æƒ…å†µä¸‹æœ‰æ²¡æœ‰å¯èƒ½è¢«ç ´è§£ï¼Ÿï¼Ÿ\né¦–å…ˆï¼ŒGPGåªæ˜¯ä¸€ä¸ªå‰ç«¯ï¼ŒèƒŒåç”¨çš„ä¸€èˆ¬æ˜¯RSAã€‚å¯†é’¥ä½æ•°å¤Ÿçš„è¯ï¼Œä½ å¯ä»¥è®¤ä¸ºæ²¡æœ‰å¯èƒ½\n  Emacs ä½¿ç”¨ GPG  åªè¦åç«¯æ­£å¸¸ä½¿ç”¨ GPG, Emacs æ‰“å¼€ .gpg æ–‡ä»¶ä¼šè‡ªåŠ¨è§£å¯†, åœ¨ç¼–è¾‘ä¿å­˜åè‡ªåŠ¨åŠ å¯†  org-mode ä½¿ç”¨ GPG åŠ å¯†  é…ç½® EPG(Emacsçš„ä¸€ä¸ªåŒ…, è°ƒç”¨ GPG) 1 2 3 4 5 6  (require \u0026#39;org-crypt) (org-crypt-use-before-save-magic) (setq org-tags-exclude-from-inheritance \u0026#39;(\u0026#34;crypt\u0026#34;)) ;; GPG ID, è§£å¯†ä¸€ä¸ªæ–‡ä»¶å¯ä»¥çŸ¥é“è¿™ä¸ªID, æ¯ä¸ªäººéƒ½ä¸åŒ (setq org-crypt-key \u0026#34;0PVT4708DD97889B\u0026#34;) (setq auto-save-default nil)        åŠ å¯† åœ¨æ ‡é¢˜åé¢å†™ä¸Š :crypt: , ä¿å­˜æ–‡ä»¶å°†ä¼šè‡ªåŠ¨åŠ å¯†æ­¤æ ‡é¢˜å†…å®¹\nè­¦å‘Š: Windows ç³»ç»Ÿ åŠ å¯†ä¼šå¯¼è‡´ ^M æ¢è¡Œè€Œæ— æ³•è§£å¯†ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°è§£å¯†\n1 2 3 4 5 6 7  ;; è§£å†³ ^M è§£å¯†é—®é¢˜ (defun freedom/org-decrypt-entry () \u0026#34;Replace DOS eolns CR LF with Unix eolns CR\u0026#34; (interactive) (goto-char (point-min)) (while (search-forward \u0026#34;\\r\u0026#34; nil t) (replace-match \u0026#34;\u0026#34;)) (org-decrypt-entry))     è§£å¯† å°† å…‰æ ‡æ”¾åœ¨å…·æœ‰ :crypt: æ ‡é¢˜ä¸Š, å‘½ä»¤ org-decrypt-entry\n  ","permalink":"http://isouthrain.github.io/post/2022-06-25-gpg/","tags":["Emacs"],"title":"GnuPG(GPG) åŠ å¯†"},{"categories":["Javaç¼–ç¨‹","ç¿»è¯‘"],"contents":"æœ¬æ–‡ç¿»è¯‘è‡ªSame-threadingã€‚\nåŒçº¿ç¨‹ç³»ç»Ÿ(Same-threading)1 æ˜¯ç”±ä¸€ä¸ªå•çº¿ç¨‹æ¨ªå‘æ‰©å±•ä¸ºNä¸ªçº¿ç¨‹ç³»ç»Ÿå¹¶è¡Œæ‰§è¡Œçš„å¹¶å‘æ¨¡å‹ã€‚\nåŒçº¿ç¨‹ç³»ç»Ÿä¸æ˜¯çº¯ç²¹çš„å•çº¿ç¨‹ç³»ç»Ÿï¼Œå› ä¸ºå®ƒåŒ…å«å¤šä¸ªçº¿ç¨‹ã€‚ ä½†å…¶ä¸­æ¯ä¸ªçº¿ç¨‹éƒ½åƒå•çº¿ç¨‹ç³»ç»Ÿä¸€æ ·è¿ï¼Œå› æ­¤é‡‡ç”¨æœ¯è¯­åŒçº¿ç¨‹è€Œä¸æ˜¯å•çº¿ç¨‹ã€‚\nå•çº¿ç¨‹å’ŒåŒçº¿ç¨‹è®¾è®¡è§†é¢‘æ•™ç¨‹ å¦‚æœä½ æ›´å–œæ¬¢çœ‹è§†é¢‘ï¼Œæˆ‘ä¹Ÿå‡†å¤‡äº†ä¸€ä¸ªç›¸åº”çš„è§†é¢‘å•çº¿ç¨‹å’ŒåŒçº¿ç¨‹è®¾è®¡ã€‚\n  ä¸ºä»€ä¹ˆé€‰æ‹©å•çº¿ç¨‹ç³»ç»Ÿ ä½ å¯èƒ½ä¼šå¾ˆå¥½å¥‡ä¸ºä»€ä¹ˆä»Šå¤©è¿˜æœ‰äººè®¾è®¡å¹¶ä½¿ç”¨å•çº¿ç¨‹ç³»ç»Ÿï¼Œå•çº¿ç¨‹ç³»ç»Ÿä¹‹æ‰€ä»¥å—æ¬¢è¿ï¼Œæ˜¯å› ä¸ºå®ƒçš„å¹¶å‘æ¨¡å‹æ¯”å¤šçº¿ç¨‹ç³»ç»Ÿç®€å•çš„å¤šï¼Œå•çº¿ç¨‹ç³»ç»Ÿå¹¶ä¸åŒå…¶å®ƒçº¿ç¨‹å…±äº«çŠ¶æ€(æ•°æ®/å¯¹è±¡)ï¼Œè¿™ä½¿å¾—å•çº¿ç¨‹ç³»ç»Ÿå¯ä»¥æ›´å¥½çš„åˆ©ç”¨éå¹¶å‘æ•°æ®ç»“æ„ã€CPUä»¥åŠCPUç¼“å­˜ã€‚\nä¸å¹¸çš„æ˜¯å•çº¿ç¨‹ç³»ç»Ÿæ²¡æœ‰é‡å¤åˆ©ç”¨ç°ä»£CPUçš„ç‰¹æ€§ï¼Œä¸€é¢—ç°ä»£CPUé€šå¸¸å¸¦æœ‰ 2, 4, 6, 8æˆ–æ›´å¤šçš„å†…æ ¸ï¼Œæ¯ä¸ªå†…æ ¸åœ¨åŠŸèƒ½ä¸Šéƒ½å¯ä»¥å½“åšä¸€ä¸ªå•ç‹¬çš„CPUï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå•çº¿ç¨‹ç³»ç»Ÿåªèƒ½åˆ©ç”¨è¿™äº›å†…æ ¸ä¸­çš„ä¸€ä¸ªã€‚\nåŒçº¿ç¨‹ç³»ç»Ÿ\u0026ndash;å•çº¿ç¨‹çš„æ¨ªå‘æ‰©å±• ä¸ºäº†åˆ©ç”¨CPUä¸­çš„æ‰€æœ‰å†…æ ¸ï¼Œå¯ä»¥é€šè¿‡æ¨ªå‘æ‰©å±•å•çº¿ç¨‹ç³»ç»Ÿæ¥è¾¾åˆ°æ­¤ç›®çš„ã€‚\næ¯ä¸ªCPUä¸€ä¸ªçº¿ç¨‹ åŒçº¿ç¨‹ç³»ç»Ÿï¼Œé€šå¸¸åœ¨æ¯ä¸ªCPUä¸­è¿è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœä¸€å°è®¡ç®—æœºåŒ…å«4ä¸ªCPUæˆ–è€…ä¸€ä¸ªCPUåŒ…å«4ä¸ªå†…æ ¸ï¼Œé‚£ä¹ˆè¿è¡Œ4ä¸ªç›¸åŒçš„çº¿ç¨‹å®ä¾‹(4ä¸ªå•çº¿ç¨‹ç³»ç»Ÿ)æ˜¯æ­£å¸¸çš„ï¼Œä¸‹å›¾å±•ç¤ºäº†è¿™ä¸€åŸç†ï¼š\næ— å…±äº«çŠ¶æ€ ç”±äºä¸€ä¸ªåŒçº¿ç¨‹ç³»ç»Ÿæœ‰å¤šä¸ªçº¿ç¨‹åœ¨å…¶ä¸­æ‰§è¡Œï¼Œå…¶çœ‹èµ·æ¥ä¸ä¼ ç»Ÿçš„å•çº¿ç¨‹ç³»ç»Ÿå¾ˆç›¸ä¼¼ï¼Œå®é™…ä¸Šå®ƒä»¬æœ‰ä¸€äº›ç»†å¾®çš„å·®åˆ«ã€‚\nåŒçº¿ç¨‹ç³»ç»Ÿå’Œä¼ ç»Ÿå¤šçº¿ç¨‹ç³»ç»Ÿçš„ä¸»è¦åŒºåˆ«æ˜¯åŒçº¿ç¨‹ç³»ç»Ÿä¸­ä¸åŒçº¿ç¨‹é—´ä¸å…±äº«çŠ¶æ€ï¼Œæ²¡æœ‰å¹¶å‘è®¿é—®çš„å…±äº«å†…å­˜ï¼Œä¹Ÿæ²¡æœ‰å¹¶å‘æ•°æ®ç»“æ„ç­‰å¯ä»¥ç”¨æ¥å®ç°çº¿ç¨‹é—´çš„æ•°æ®å…±äº«ï¼Œä¸‹å›¾å±•ç¤ºäº†è¿™ç§åŒºåˆ«\nç¼ºä¹å…±äº«çŠ¶æ€å¯¼è‡´åŒçº¿ç¨‹ç³»ç»Ÿçš„ä¸­æ¯ä¸ªçº¿ç¨‹çœ‹èµ·æ¥éƒ½åƒä¸€ä¸ªå•çº¿ç¨‹ç³»ç»Ÿï¼Œä½†æ˜¯ï¼Œç”±äºä¸€ä¸ªåŒçº¿ç¨‹ç³»ç»Ÿå¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ä½¿å¾—å®ƒä»¬å¹¶ä¸æ˜¯çœŸæ­£çš„â€œå•çº¿ç¨‹ç³»ç»Ÿâ€ã€‚ç”±äºæ²¡æœ‰æ›´å¥½çš„åç§°ï¼Œæˆ‘è®¤ä¸ºå°†è¿™æ ·çš„ç³»ç»Ÿç§°ä¹‹ä¸ºåŒçº¿ç¨‹ç³»ç»Ÿ(Same-threading )æ›´å‡†ç¡®ï¼Œè€Œä¸æ˜¯â€œé‡‡ç”¨å•çº¿ç¨‹è®¾è®¡çš„å¤šçº¿ç¨‹ç³»ç»Ÿâ€ã€‚\nåŒçº¿ç¨‹ç³»ç»Ÿåœ¨æœ¬è´¨ä¸Šæ„å‘³ç€æ•°æ®éƒ½åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­å¤„ç†ï¼Œå¹¶ä¸”æ²¡æœ‰çº¿ç¨‹å¹¶å‘çš„å…±äº«æ•°æ®ï¼Œè¿™ç§åœºæ™¯æœ‰æ—¶ç§°ä¹‹ä¸ºæ— å…±äº«çŠ¶æ€å¹¶å‘æˆ–è€…éš”ç¦»çš„çŠ¶æ€å¹¶å‘ã€‚\nè´Ÿè½½åˆ†é… å¾ˆæ˜¾ç„¶ï¼ŒåŒçº¿ç¨‹ç³»ç»Ÿéœ€è¦åœ¨è¿è¡Œçš„å•ä¸ªçº¿ç¨‹ä¹‹é—´åˆ†é…å·¥ä½œè´Ÿè½½ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹è¢«åˆ†é…å·¥ä½œè´Ÿè½½ï¼Œé‚£ä¹ˆæ­¤ç³»ç»Ÿå®é™…ä¸Šå˜æˆäº†ä¸€ä¸ªå•çº¿ç¨‹ç³»ç»Ÿã€‚\nå¦‚ä½•åœ¨ä¸åŒçš„çº¿ç¨‹é—´ç²¾å‡†çš„åˆ†é…å·¥ä½œè´Ÿè½½å–å†³äºä½ çš„ç³»ç»Ÿè®¾è®¡ï¼Œä»¥ä¸‹éƒ¨åˆ†å°†ä»‹ç»ä¸€äº›ç›¸å…³å†…å®¹ã€‚\nå•çº¿ç¨‹å¾®æœåŠ¡ å¦‚æœç³»ç»Ÿç”±å¤šä¸ªå¾®æœåŠ¡ç»„æˆï¼Œåˆ™æ¯ä¸ªå¾®æœåŠ¡éƒ½èƒ½ä»¥å•çº¿ç¨‹æ¨¡å¼è¿è¡Œï¼Œå½“å°†å¤šä¸ªå¾®æœåŠ¡ç³»ç»Ÿéƒ¨ç½²åˆ°ä¸€å°æœåŠ¡å™¨ä¸Šæ—¶ï¼Œå…¶ä¸­çš„æ¯ä¸ªå¾®æœåŠ¡éƒ½èƒ½ä»¥å•çº¿ç¨‹çš„æ–¹å¼åœ¨å•ä¸ªCPUä¸Šæ‰§è¡Œã€‚\nå¾®æœåŠ¡ç³»ç»Ÿæœ¬è´¨ä¸Šä¸å…±äº«ä»»ä½•æ•°æ®ï¼Œå› è€Œæ˜¯åŒçº¿ç¨‹ç³»ç»Ÿçš„ä¸€ä¸ªå¾ˆå¥½çš„å®ä¾‹ã€‚\næœåŠ¡é—´æ•°æ®åˆ†ç‰‡ å¦‚æœç³»ç»Ÿé—´ç¡®å®éœ€è¦å…±äº«æ•°æ®æˆ–è€…å…±äº«æ•°æ®åº“ï¼Œåˆ™å¯ä»¥å¯¹å…¶è¿›è¡Œåˆ†ç‰‡ï¼Œå®ƒæ„å‘³ç€å°†æ•°æ®åœ¨å¤šä¸ªæ•°æ®åº“ä¹‹é—´è¿›è¡Œåˆ’åˆ†ã€‚æ•°æ®é€šå¸¸éƒ½è¢«åˆ’åˆ†ï¼Œä»¥ä¾¿å½¼æ­¤ç›¸å…³çš„æ•°æ®éƒ½ä½äºç»Ÿä¸€æ•°æ®åº“ä¸­ã€‚ä¾‹å¦‚ï¼Œæ‰€æœ‰å±äºæŸä¸ªâ€œæ‰€æœ‰è€…â€çš„æ•°æ®éƒ½å°†è¢«æ’å…¥åŒä¸€ä¸ªæ•°æ®åº“ä¸­ã€‚ä¸è¿‡ï¼Œæ•°æ®åˆ†ç‰‡è¶…å‡ºäº†æœ¬ç¯‡çš„èŒƒå›´ï¼Œä½ éœ€è¦è‡ªå·±å»æœç´¢ç›¸å…³æ•™ç¨‹ã€‚\nçº¿ç¨‹é—´é€šä¿¡ è‹¥åŒçº¿ç¨‹ç³»ç»Ÿä¸­çš„çº¿ç¨‹é—´éœ€è¦é€šä¿¡ï¼Œå¯é€šè¿‡ä¼ é€’æ¶ˆæ¯æ¥å®ç°ã€‚å¦‚æœçº¿ç¨‹ A æƒ³è¦å‘çº¿ç¨‹ B å‘é€æ¶ˆæ¯ï¼Œçº¿ç¨‹ A å¯ä»¥é€šè¿‡ç”Ÿæˆæ¶ˆæ¯ï¼ˆå­—èŠ‚åºåˆ—ï¼‰æ¥å®ç°ã€‚ ç„¶åçº¿ç¨‹ B å¯ä»¥å¤åˆ¶è¯¥æ¶ˆæ¯ï¼ˆå­—èŠ‚åºåˆ—ï¼‰å¹¶è¯»å–å®ƒã€‚ é€šè¿‡å¤åˆ¶æ¶ˆæ¯ï¼Œçº¿ç¨‹ B ç¡®ä¿çº¿ç¨‹ A åœ¨çº¿ç¨‹ B è¯»å–æ¶ˆæ¯æ—¶ä¸èƒ½ä¿®æ”¹æ¶ˆæ¯ï¼Œå¤åˆ¶åçº¿ç¨‹ A æ— æ³•è®¿é—®æ¶ˆæ¯å‰¯æœ¬ã€‚\nä¸‹å›¾å±•ç¤ºäº†çº¿ç¨‹é—´é€šè¿‡æ¶ˆæ¯ä¼ é€’å®ç°é€šä¿¡\nçº¿ç¨‹é—´é€šä¿¡å¯ä»¥é€šè¿‡é˜Ÿåˆ—ã€ç®¡é“ã€unix å¥—æ¥å­—ã€TCP å¥—æ¥å­—ç­‰è¿›è¡Œï¼Œåªè¦é€‚åˆæ‚¨çš„ç³»ç»Ÿã€‚\næ›´ç®€å•çš„å¹¶å‘æ¨¡å‹ åœ¨åŒçº¿ç¨‹ç³»ç»Ÿä¸­æ¯ä¸ªçº¿ç¨‹ä¸­è¿è¡Œçš„ç³»ç»Ÿéƒ½å¯ä»¥åƒå•çº¿ç¨‹ä¸€æ ·å®ç°ï¼Œè¿™æ„å‘³ç€å…¶å†…éƒ¨çš„çº¿ç¨‹å…±äº«æ¨¡å‹æ¯”å¹¶å‘çŠ¶æ€è¦æ›´ç®€å•ï¼Œå› æ­¤ä¹Ÿä¸ç”¨æ‹…å¿ƒå¹¶å‘æ•°æ®ç»“æ„ä»¥åŠç”±æ­¤å¯¼è‡´çš„å„ç§é—®é¢˜ã€‚\nå›¾ç¤ºè¯´æ˜ ä»¥ä¸‹æ˜¯å•çº¿ç¨‹ã€å¤šçº¿ç¨‹å’ŒåŒçº¿ç¨‹çš„ç¤ºä¾‹å›¾è§£ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ›´å®¹æ˜“çš„äº†è§£å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ã€‚\né¦–å…ˆå±•ç¤ºçš„æ˜¯å•çº¿ç¨‹ç³»ç»Ÿ\nç¬¬äºŒå¹…å›¾å±•ç¤ºçš„æ˜¯çº¿ç¨‹é—´å…±äº«æ•°æ®çš„å¤šçº¿ç¨‹ç³»ç»Ÿ\nç¬¬ä¸‰å¹…å›¾å±•ç¤ºäº†ç”±2ä¸ªåŒ…å«éš”ç¦»æ•°æ®çº¿ç¨‹ç»„æˆçš„åŒçº¿ç¨‹ç³»ç»Ÿï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡ä¼ é€’æ¶ˆæ¯è¿›è¡Œé€šä¿¡\nåœ¨Javaä¸­ä½¿ç”¨Thread Ops Thread Ops for Java æ˜¯ä¸€ä¸ªå¼€æºå·¥å…·åŒ…ï¼Œæ—¨åœ¨å¸®åŠ©æ‚¨æ›´è½»æ¾åœ°å®ç°ä¸åŒçŠ¶æ€çš„åŒçº¿ç¨‹ç³»ç»Ÿã€‚ Thread Ops åŒ…å«ç”¨äºå¯åŠ¨å’Œåœæ­¢å•ä¸ªçº¿ç¨‹ä»¥åŠåœ¨å•ä¸ªçº¿ç¨‹ä¸­å®ç°æŸç§ç¨‹åº¦çš„å¹¶å‘çš„å·¥å…·ã€‚ å¦‚æœæ‚¨å¯¹ä½¿ç”¨ç›¸åŒçº¿ç¨‹çš„åº”ç”¨ç¨‹åºè®¾è®¡æ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆçœ‹çœ‹ Thread Ops å¯èƒ½ä¼šå¾ˆæœ‰è¶£ã€‚ æ‚¨å¯ä»¥åœ¨æˆ‘çš„ Thread Ops for Java æ•™ç¨‹ä¸­é˜…è¯»æœ‰å…³ Thread Ops çš„æ›´å¤šä¿¡æ¯ã€‚\n  æ³¨ï¼šåŸæ–‡ä¸ºSame-threadingï¼Œç”±äºä¸­æ–‡ç½‘ç»œä¸­æ²¡æœ‰åˆé€‚çš„åè¯ï¼Œæ•…å°†å…¶ç¿»è¯‘ä¸ºåŒçº¿ç¨‹ç³»ç»Ÿï¼Œè¡¨ç¤ºåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­çš„ç›¸åŒç›¸ä¼¼çš„çº¿ç¨‹ã€‚\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/translate/java-concurrency/same-threading/","tags":["Java","Java Concurrency"],"title":"5.[è¯‘]åŒçº¿ç¨‹ç³»ç»Ÿ"},{"categories":["æŠ€æœ¯"],"contents":"ä»‹ç» Xinetd æ˜¯ä¸€ä¸ªäº’è”ç½‘å¤šåŠŸèƒ½çš„å·¥å…·, åœ¨æ­¤è¿™é‡Œåªä½¿ç”¨å®ƒçš„ ç«¯å£è½¬å‘ åŠŸèƒ½\nç«¯å£è½¬å‘ æ˜¯å°†æœåŠ¡å™¨ç«¯å£è¿›è¡Œæ•°æ®è½¬æ¥, ä¾‹å¦‚: å½“ä½ ä½¿ç”¨æœåŠ¡ç«¯å£é…ç½®å¥½äº† imap.gmail.com + ç«¯å£, å®¢æˆ·ç«¯å£å°±å¯ä»¥ç›´æ¥è®¿é—® æœåŠ¡å™¨IP + ç«¯å£ å°±ç›¸å½“äºä½ è®¿é—®çš„æ˜¯ imap.gmail.com + ç«¯å£ çš„æ•°æ®, è¿™æ ·å°±å¯ä»¥é¿å…æ— æ³•è®¿é—®gmail\nè¦æ±‚ ä¸€å°å¯ä»¥è®¿é—® gmail çš„æœåŠ¡å™¨\nå®‰è£… Xinetd 1  apt install xinetd   ç¼–è¾‘ Xinetd é…ç½®æ–‡ä»¶, è®©gmailå·¥ä½œ 1  vim /etc/xinetd.d/gmail   /etc/xinetd.d/gmail æ–‡ä»¶å†…å®¹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37  # /etc/xinetd.d/gmail service imap { type = UNLISTED port = 993 bind = 0.0.0.0 socket_type = stream wait = no user = nobody redirect = imap.gmail.com 993 per_source = UNLIMITED cps = 100 2 } service smtp-465 { type = UNLISTED port = 465 bind = 0.0.0.0 socket_type = stream wait = no user = nobody redirect = smtp.gmail.com 465 per_source = UNLIMITED cps = 100 2 } service smtp-587 { type = UNLISTED port = 587 bind = 0.0.0.0 socket_type = stream wait = no user = nobody redirect = smtp.gmail.com 587 per_source = UNLIMITED cps = 100 2 }   è¿è¡ŒæœåŠ¡ 1  service xinetd start   Hacker Enjoy æŠŠä½ çš„Gnusé…ç½®æ¥å—æœåŠ¡ `imap.gmail.com` æ”¹æˆ å¯¹åº”äºä½ çš„ æœåŠ¡å™¨IP å‘é€é‚®ä»¶è®¾ç½®ä¹Ÿä¸€æ ·æ”¹æˆä½ çš„æœåŠ¡å™¨IP  ","permalink":"http://isouthrain.github.io/post/2022-06-04-gnus-use-gmail.zh-ch/","tags":["Emacs Gnus"],"title":"Emacs Gnus ä½¿ç”¨ Gmail"},{"categories":["æŠ€æœ¯"],"contents":"å‰è¨€ Hugo æ·»åŠ  Algolia æœç´¢, æœ¬æ–‡ä»¥ LoveIt ä¸»é¢˜ä¸ºä¾‹\nLoveIt å¯ç”¨ Algolia æœç´¢  æ·»åŠ ä»¥ä¸‹ä»£ç åœ¨ä½ çš„ config.toml, æ ¹æ®è‡ªå·±æƒ…å†µå¡«å†™   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  [params] [params.search] enable = true # æœç´¢å¼•æ“çš„ç±»å‹ (\u0026#34;lunr\u0026#34;, \u0026#34;algolia\u0026#34;) type = \u0026#34;algolia\u0026#34; # æ–‡ç« å†…å®¹æœ€é•¿ç´¢å¼•é•¿åº¦ contentLength = 4000 # æœç´¢æ¡†çš„å ä½æç¤ºè¯­ placeholder = \u0026#34;\u0026#34; # LoveIt æ–°å¢ | 0.2.1 æœ€å¤§ç»“æœæ•°ç›® maxResultLength = 10 # LoveIt æ–°å¢ | 0.2.3 ç»“æœå†…å®¹ç‰‡æ®µé•¿åº¦ snippetLength = 50 # LoveIt æ–°å¢ | 0.2.1 æœç´¢ç»“æœä¸­é«˜äº®éƒ¨åˆ†çš„ HTML æ ‡ç­¾ highlightTag = \u0026#34;em\u0026#34; # LoveIt æ–°å¢ | 0.2.4 æ˜¯å¦åœ¨æœç´¢ç´¢å¼•ä¸­ä½¿ç”¨åŸºäº baseURL çš„ç»å¯¹è·¯å¾„ absoluteURL = false [params.search.algolia] index = \u0026#34;\u0026#34; appID = \u0026#34;\u0026#34; searchKey = \u0026#34;\u0026#34; [outputs] home = [\u0026#34;HTML\u0026#34;, \u0026#34;RSS\u0026#34;, \u0026#34;JSON\u0026#34;]   è·å– Algolia ç›¸å…³é…ç½®  Algoliaå®˜ç½‘ æ³¨å†Œç™»é™†  åˆ›å»ºå±äº Hugo çš„ Application   åç§°éšä¾¿å¡«ä¸€ä¸ª, ä¾‹å¦‚ Hugo CHOOSE YOUR SUBSCRIPTION \u0026ndash;\u0026gt; é€‰æ‹©å…è´¹çš„ FREE ç‚¹å‡»å³ä¾§ \u0026mdash;\u0026gt; Next Step:Data Center é€‰æ‹©ä¸€ä¸ªç¦»ä½ ç½‘ç«™åœ°æ–¹è¿›çš„åœ°æ–¹  è·å– index   å›åˆ°ä¸»é¡µ\n ç‚¹å‡»å·¦ä¸‹è§’çš„ Data sources é€‰æ‹©ä½ åˆšæ‰æ³¨å†Œçš„ Application    ç‚¹å‡»å·¦ä¸Šè§’ Indices ç‚¹å‡»å³ä¸Šè§’ Greate Index å¡«ä¸€ä¸ªåç§°, ä¾‹å¦‚ Hugo, ä¹‹ååœ¨ config.toml é…ç½® index    è·å– appID  è·å– searchKey   ä¸Šä¼ åˆ° Algolia   åœ¨ä½ çš„Hugoä¸»ç›®å½•ä¸‹è¿è¡Œ:\n1  hugo     public ç›®å½•ä¸‹ä¼šç”Ÿæˆ index.json\n  å°† index.json ä¸Šä¼ åˆ°ä½ çš„ Algolia index ä¸­\n  è‡ªåŠ¨åŒ–ä¸Šä¼  index.json  éœ€è¦å®‰è£… npm, nodejs Nodejs  ä½ çš„ Hugo ç›®å½•ä¸‹å®‰è£… atomc-algolia 1  npm install atomic-algolia --save   ä½ çš„ Hugo ç›®å½•ä¸‹æ–°å»º .env æ–‡ä»¶  å†…å®¹ä¸º, è¯·æ ¹æ®è‡ªå·±ä¿¡æ¯å¡«å†™, æ¯ä¸€é¡¹ç¼ºä¸€ä¸å¯   1 2 3 4  ALGOLIA_APP_ID= ALGOLIA_INDEX_NAME=\u0026#34;\u0026#34; ALGOLIA_INDEX_FILE=\u0026#34;public/index.json\u0026#34; ALGOLIA_ADMIN_KEY=   å¼€å§‹è‡ªåŠ¨ä¸Šä¼   hugo è‡ªåŠ¨ç”Ÿæˆ public ç›®å½• npm run algolia  æ·»åŠ ä¸åŒè¯­è¨€çš„æœç´¢   åœ¨ Algolia åŒä¸ª Application åˆ›å»ºä¸¤ä¸ª index\n  ä¸åŒè¯­è¨€æœ‰ä¸åŒçš„ index.json\n  è¯·åœ¨ä¸‹æ–¹æ‰¾åˆ°å¯¹åº”çš„ search é…ç½®\n  å‚è€ƒé…ç½®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107  # [en, zh-cn, fr, pl, ...] è®¾ç½®é»˜è®¤çš„è¯­è¨€ defaultContentLanguage = \u0026#34;zh-cn\u0026#34; [languages] [languages.en] weight = 1 title = \u0026#34;ISouthRain\u0026#34; languageCode = \u0026#34;en\u0026#34; languageName = \u0026#34;English\u0026#34; [[languages.en.menu.main]] identifier = \u0026#34;posts\u0026#34; pre = \u0026#34;\u0026#34; post = \u0026#34;\u0026#34; name = \u0026#34;Posts\u0026#34; url = \u0026#34;/posts/\u0026#34; title = \u0026#34;\u0026#34; weight = 1 [[languages.en.menu.main]] identifier = \u0026#34;tags\u0026#34; pre = \u0026#34;\u0026#34; post = \u0026#34;\u0026#34; name = \u0026#34;Tags\u0026#34; url = \u0026#34;/tags/\u0026#34; title = \u0026#34;\u0026#34; weight = 2 [[languages.en.menu.main]] identifier = \u0026#34;categories\u0026#34; pre = \u0026#34;\u0026#34; post = \u0026#34;\u0026#34; name = \u0026#34;Categories\u0026#34; url = \u0026#34;/categories/\u0026#34; title = \u0026#34;\u0026#34; weight = 3 [languages.en.params.search] enable = true # æœç´¢å¼•æ“çš„ç±»å‹ (\u0026#34;lunr\u0026#34;, \u0026#34;algolia\u0026#34;) type = \u0026#34;algolia\u0026#34; # æ–‡ç« å†…å®¹æœ€é•¿ç´¢å¼•é•¿åº¦ contentLength = 4000 # æœç´¢æ¡†çš„å ä½æç¤ºè¯­ placeholder = \u0026#34;\u0026#34; # LoveIt æ–°å¢ | 0.2.1 æœ€å¤§ç»“æœæ•°ç›® maxResultLength = 10 # LoveIt æ–°å¢ | 0.2.3 ç»“æœå†…å®¹ç‰‡æ®µé•¿åº¦ snippetLength = 50 # LoveIt æ–°å¢ | 0.2.1 æœç´¢ç»“æœä¸­é«˜äº®éƒ¨åˆ†çš„ HTML æ ‡ç­¾ highlightTag = \u0026#34;em\u0026#34; # LoveIt æ–°å¢ | 0.2.4 æ˜¯å¦åœ¨æœç´¢ç´¢å¼•ä¸­ä½¿ç”¨åŸºäº baseURL çš„ç»å¯¹è·¯å¾„ absoluteURL = false [languages.en.params.search.algolia] index = \u0026#34;\u0026#34; # æ ¹æ®ä½ åˆ›å»ºçš„ index å, ä¾‹å¦‚ Hugo-en appID = \u0026#34;\u0026#34; # æ·»åŠ è‡ªå·±çš„ searchKey = \u0026#34;\u0026#34; # æ·»åŠ è‡ªå·±çš„ [languages.zh-cn] weight = 2 title = \u0026#34;ISouthRain\u0026#34; # ç½‘ç«™è¯­è¨€, ä»…åœ¨è¿™é‡Œ CN å¤§å†™ languageCode = \u0026#34;zh-CN\u0026#34; languageName = \u0026#34;ç®€ä½“ä¸­æ–‡\u0026#34; # æ˜¯å¦åŒ…æ‹¬ä¸­æ—¥éŸ©æ–‡å­— hasCJKLanguage = true [[languages.zh-cn.menu.main]] identifier = \u0026#34;posts\u0026#34; pre = \u0026#34;\u0026#34; post = \u0026#34;\u0026#34; name = \u0026#34;æ–‡ç« \u0026#34; url = \u0026#34;/posts/\u0026#34; title = \u0026#34;\u0026#34; weight = 1 [[languages.zh-cn.menu.main]] identifier = \u0026#34;tags\u0026#34; pre = \u0026#34;\u0026#34; post = \u0026#34;\u0026#34; name = \u0026#34;æ ‡ç­¾\u0026#34; url = \u0026#34;/tags/\u0026#34; title = \u0026#34;\u0026#34; weight = 2 [[languages.zh-cn.menu.main]] identifier = \u0026#34;categories\u0026#34; pre = \u0026#34;\u0026#34; post = \u0026#34;\u0026#34; name = \u0026#34;åˆ†ç±»\u0026#34; url = \u0026#34;/categories/\u0026#34; title = \u0026#34;\u0026#34; weight = 3 [languages.zh-cn.params.search] enable = true # æœç´¢å¼•æ“çš„ç±»å‹ (\u0026#34;lunr\u0026#34;, \u0026#34;algolia\u0026#34;) type = \u0026#34;algolia\u0026#34; # æ–‡ç« å†…å®¹æœ€é•¿ç´¢å¼•é•¿åº¦ contentLength = 4000 # æœç´¢æ¡†çš„å ä½æç¤ºè¯­ placeholder = \u0026#34;\u0026#34; # LoveIt æ–°å¢ | 0.2.1 æœ€å¤§ç»“æœæ•°ç›® maxResultLength = 10 # LoveIt æ–°å¢ | 0.2.3 ç»“æœå†…å®¹ç‰‡æ®µé•¿åº¦ snippetLength = 50 # LoveIt æ–°å¢ | 0.2.1 æœç´¢ç»“æœä¸­é«˜äº®éƒ¨åˆ†çš„ HTML æ ‡ç­¾ highlightTag = \u0026#34;em\u0026#34; # LoveIt æ–°å¢ | 0.2.4 æ˜¯å¦åœ¨æœç´¢ç´¢å¼•ä¸­ä½¿ç”¨åŸºäº baseURL çš„ç»å¯¹è·¯å¾„ absoluteURL = false [languages.zh-cn.params.search.algolia] index = \u0026#34;\u0026#34; # æ ¹æ®ä½ åˆ›å»ºçš„ index å, ä¾‹å¦‚ Hugo-zh appID = \u0026#34;\u0026#34; # æ·»åŠ è‡ªå·±çš„ searchKey = \u0026#34;\u0026#34; # æ·»åŠ è‡ªå·±çš„     è¯·äº«å—ğŸ”ğŸŸ FAQâ“  é‡åˆ°äº†é—®é¢˜?  è¯·åœ¨ä¸‹æ–¹å›å¤    ","permalink":"http://isouthrain.github.io/post/2022-05-04-hugo%E6%B7%BB%E5%8A%A0algolia/","tags":["Hugo"],"title":"Hugoæ·»åŠ Algoliaæœç´¢"},{"categories":["æŠ€æœ¯"],"contents":" å¦„æƒ³é€ƒè„±å¤§æ•°æ®çš„èƒŒå›ğŸ¤¨\n RSS  è‡ªå·±ç®¡ç†è‡ªå·±çš„è®¢é˜…ï¼ŒæŒæ§è‡ªå·±çš„çˆ±å¥½!!  è¦æ±‚  ä¸€å°æµ·å¤– VPS ä¸€ç‚¹ç‚¹ Linux æŠ€æœ¯  Flowerss-bot  ä¸€ä¸ªå›½äººå¼€æºçš„ Telegra bot RSS è®¢é˜…æœºå™¨äºº æ­å»ºéå¸¸ç®€å•, åŠŸèƒ½éå¸¸å¤š åªéœ€è¦å¡«å†™ bot Token å°±å¯ä»¥ä½¿ç”¨ æ”¯æŒ Telegram Instart view å³æ—¶é¢„è§ˆ flowerrss-bot  ä¸‹è½½ Flowerss-bot  ä¸‹è½½å¯¹åº”ç‰ˆæœ¬  è·å–æœºå™¨äºº  @BotFather /newbot éšä¾¿å‘½åä¸€ä¸ª ç§°å‘¼ å‘½åæœºå™¨äººï¼Œå¿…é¡» Bot æˆ–è€… _bot ç»“å°¾, ä¾‹å¦‚: MyrssBot å¤åˆ¶ token  ä¿®æ”¹ config.ynl  ä¿®æ”¹ç¬¬ä¸€è¡Œ, å°† token å¤åˆ¶è¿›å» æ ¹æ®è‡ªå·±æƒ…å†µä¿®æ”¹éœ€è¦ï¼Œé»˜è®¤åªéœ€è¦ä¿®æ”¹äº† token å°±å¯ä»¥ä½¿ç”¨äº† è¯¦ç»†ä¿®æ”¹  å…³äºä½¿ç”¨ Telegraph å³ä½¿é¢„è§ˆ  é»˜è®¤è·å– token å°±å¯ä»¥ä½¿ç”¨ è·å–æ–¹æ³• Telegtaph å®˜æ–¹æœºå™¨äºº @telegraph  æ­¥éª¤  å…³æ³¨ Telegraph æœºå™¨äºº åœ¨æµè§ˆå™¨è¾“å…¥, è‡ªåŠ¨ç”Ÿæˆ token  1  https://api.telegra.ph/createAccount?short_name=ç§°å‘¼å\u0026amp;author_name=ç”¨æˆ·å   è¿è¡Œ 1 2  chmod 755 flowerss-bot ./flowerss-bot   æˆåŠŸäº†å°±è¯·äº«å—ğŸŒ æ„Ÿè°¢ä½œè€…å¤§å¤§çš„å¼€æºï¼Œè®©æˆ‘ä»¬ç”¨ä¸Šè¿™ä¹ˆå¥½çš„ä½œå“ğŸŒ¹  flowerss-bot  FAQâ“ é‡åˆ°é—®é¢˜å¯ä»¥åœ¨ä¸‹é¢å›å¤\n","permalink":"http://isouthrain.github.io/post/2022-05-02-telegrambotrss/","tags":["Telegram"],"title":"æ­å»º Telegram Bot RSS è®¢é˜…"},{"categories":["æŠ€æœ¯"],"contents":"ä»€ä¹ˆæ˜¯å†…ç½‘ç©¿é€? é€šä¿—çš„è¯´: æŠŠ å±€åŸŸç½‘ å˜æˆ å…¬ç½‘ é‚£æ ·å¯ä»¥è®©å¤–é¢çš„äººè®¿é—®\nå†…ç½‘ç©¿é€å·¥å…·  Frp ngrok èœ»èœ“æ˜ å°„ natapp ä»¥åŠä¸€äº›å…¶å®ƒçš„, ä¸ä¸€ä¸€åˆ—å‡ºäº†, å¤§å®¶å¯ä»¥ä¸Šç½‘æŸ¥æŸ¥ æ¨èå¤§å®¶ä½¿ç”¨ Frp , å› ä¸ºå…è´¹ä¸”å¼€æº, æ˜“é…ç½®, ç®€å•ä½¿ç”¨  Frp ä¸ºä¾‹  Frpé¡¹ç›®åœ°å€  æœåŠ¡å™¨ç«¯ ä¸‹è½½ frp   æ ¹æ®è‡ªå·±çš„ç³»ç»Ÿä¸‹è½½å¯¹äºç‰ˆæœ¬\n  Frpåœ°å€\n  Linux ç”¨æˆ·å¯ä»¥ä½¿ç”¨ wget å·¥å…·ä¸‹è½½\n ä¾‹å¦‚: wget https://github.com/fatedier/frp/releases/download/v0.42.0/frp_0.42.0_linux_amd64.tar.gz    è§£å‹  tar -zxvf frpxxxxxx.tar.gz  å‰å¾€åˆ°è§£å‹ç›®å½•  cd frpxxxxxx  ç¼–è¾‘ frps.ini  æ ¹æ®è‡ªå·±æƒ…å†µæ·»åŠ   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  [common] bind_addr = 0.0.0.0 # frp ç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤æ˜¯7000 bind_port = 7000 # æˆæƒç , éšä¾¿å¡«ä¸€ä¸ª token = xxxxx # frpç®¡ç†åå°ç«¯å£ï¼Œè¯·æŒ‰è‡ªå·±éœ€æ±‚æ›´æ”¹ dashboard_port = 7100 # frpç®¡ç†åå°ç”¨æˆ·åå’Œå¯†ç  dashboard_user = xxxx dashboard_pwd = xxxx enable_prometheus = true # frpæ—¥å¿—é…ç½® log_file = /var/log/frps.log log_level = info log_max_days = 3   è¿è¡Œ frps 1 2 3 4 5 6  # Linux ç”¨æˆ· chomd +x frps ./frps -c frps.ini # windowsç”¨æˆ· ./frps.exe -c frps.ini   å®¢æˆ·ç«¯(ä½ çš„å±€åŸŸç½‘ç«¯)  ç›¸åŒæ–¹æ³•ä¸‹è½½  è§£å‹å ç¼–è¾‘ frpc.ini 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  # æœåŠ¡ç«¯é…ç½® [common] server_addr = æœåŠ¡å™¨ip # è¯·æ¢æˆè®¾ç½®çš„æœåŠ¡å™¨ç«¯å£ server_port = 7000 token = ä¸ä¸Šé¢frps.iniçš„ç›¸åŒ # é…ç½®sshæœåŠ¡ [ssh] type = tcp local_ip = 127.0.0.1 local_port = 8022 remote_port = ä¾‹å¦‚8022 [web] type = http local_ip = 127.0.0.1 local_port = 8080 remote_port = ä¾‹å¦‚8080 # å¤šç«¯å£ [range:Test] [web] type = http local_ip = 127.0.0.1 local_port = 9000-9010 remote_port = ä¾‹å¦‚9000-9010   å¯åŠ¨ frpc 1 2 3 4  # Linuxç”¨æˆ· ./frpc -c frpc.ini # Windowsç”¨æˆ· ./frpc.exe -c frpc.ini   æµ‹è¯• åœ¨ä½ çš„å…¬ç½‘ç«¯, è¿›è¡Œæµ‹è¯•\n ä¾‹å¦‚, æœåŠ¡å™¨ç«¯é“¾æ¥å±€åŸŸç½‘ç«¯ ssh  1 2 3  ssh -p ç«¯å£ root@æœåŠ¡å™¨IP # ä¾‹å¦‚ ssh -p 8022 root@192.13.33.6   æœåŠ¡å™¨ç«¯å£å¿…é¡»è¦å¼€æ”¾å¯¹åº”ç«¯å£\næ³¨æ„, å½“ä½ æƒ³è®¿é—®å±€åŸŸç½‘ç«¯æ—¶, å±€åŸŸç½‘ç«¯å£çš„æœ¬åœ°ç«¯å£ä¸€å®šæ˜¯å¼€çš„, å¹¶å¯¹åº”äºä½ è®¾ç½®frpc.iniçš„ç«¯å£\næœåŠ¡å™¨ç«¯ frps, å±€åŸŸç½‘ç«¯ frpc, å¿…é¡»åŒæ—¶å¼€å¯æ‰å¯æ­£å¸¸ä½¿ç”¨\nFAQâ“ å¯ä»¥è®©æœåŠ¡å™¨ç«¯å¼€æœºå¯åŠ¨, ä¸å¤ªéº»çƒ¦ 1 2 3 4 5 6 7  cd frpç›®å½• mkdir -p /etc/frp cp frps.ini /etc/frp cp frps /usr/bin cp systemd/frps.service /usr/lib/systemd/system/ systemctl enable frps systemctl start frps   ","permalink":"http://isouthrain.github.io/post/2022-05-01-frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/","tags":["ç½‘ç»œ"],"title":"Frpå†…ç½‘ç©¿é€"},{"categories":["æŠ€æœ¯"],"contents":"ç²—ä½“ 1  **ç²—ä½“**   æ–œä½“ 1  *æ–œä½“*   ç²—æ–œä½“ 1  ***ç²—æ–œä½“***   ç²—æ–œä½“ 1  ***ç²—æ–œä½“***   é“¾æ¥ğŸ”— 1  [å¤‡æ³¨](é“¾æ¥)   æ–‡ä»¶é“¾æ¥ 1  ![å¤‡æ³¨](é“¾æ¥)   å†…éƒ¨æ–‡ä»¶è·³è½¬ 1 2 3  \u0026lt;span id = \u0026#34;ç„ç‚¹\u0026#34;\u0026gt;è·³è½¬è‡³ç„ç‚¹\u0026lt;/span\u0026gt; [è·³è½¬è‡³ç„ç‚¹](#ç„ç‚¹)   æ•ˆæœå¦‚ä¸‹ æ•ˆæœå¦‚ä¸‹ğŸ‘‡\n åµŒå…¥è§†é¢‘ 1 2 3  \u0026lt;video poster=\u0026#34;æ•ˆæœåŠ¨å›¾\u0026#34; width=\u0026#34;360\u0026#34; height=\u0026#34;240\u0026#34; controls\u0026gt; \u0026lt;source src=\u0026#34;è§†é¢‘é“¾æ¥é“¾æ¥ï¼Œæ”¯æŒå…¶ä»–æ ¼å¼ï¼Œå½“ä½¿ç”¨å…¶ä»–æ ¼å¼æ—¶ï¼Œä¸è¦æ›¿æ¢åé¢çš„ video/mp4\u0026#34; type=\u0026#34;video/mp4\u0026#34;\u0026gt; \u0026lt;/video\u0026gt;   æŠ˜å åˆ—è¡¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14  \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;è¿™æ˜¯ä¸€ä¸ªæŠ˜å åˆ—è¡¨\u0026lt;/summary\u0026gt; æŠ˜å å†…å®¹, ä¸Šé¢ç©ºä¸€è¡Œ ä¸‹ä¸€è¡Œ \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;è¿™æ˜¯ä¸€ä¸ªåµŒå¥—æŠ˜å åˆ—è¡¨\u0026lt;/summary\u0026gt; åµŒå¥—æŠ˜å å†…å®¹, ä¸Šé¢ç©ºä¸€è¡Œ ä¸‹ä¸€è¡Œ \u0026lt;/details\u0026gt; \u0026lt;/details\u0026gt;   æ•ˆæœå¦‚ä¸‹  è¡¨æ ¼ 1 2 3  |1 | 2 | 3| |:- | :-: | -:| |å±…å³| å±…ä¸­ |å±…å·¦|   ä»£ç å— ç”¨6ä¸ª ` åŒ…è£¹\nå—çŠ¶ 1  `å—çŠ¶`   ä¸‹åˆ’çº¿ 1  \u0026lt;u\u0026gt;ä¸‹åˆ’çº¿\u0026lt;/u\u0026gt;   åˆ é™¤çº¿ 1  ~~åˆ é™¤çº¿~~   ä½¿ç”¨è¡¨æƒ… 1 2 3  éœ²è¥ â›º çœŸå¥½ç¬‘ ğŸ˜‚   éœ²è¥â›º\nçœŸå¥½ç¬‘ğŸ˜‚\nè¡¨æƒ…ç¬¦å·ç è¡¨\n","permalink":"http://isouthrain.github.io/post/2022-04-30-markdown%E8%AF%AD%E6%B3%95/","tags":["Markdwon"],"title":"Markdownè¯­æ³•"},{"categories":["æŠ€æœ¯"],"contents":"git push æ¨é€/ä¸Šä¼ åˆ° GitHub git push è¾“å…¥è´¦å·å¯†ç åæ¨é€ä¸äº†? å› ä¸º Github çš„æ¨é€/ä¸Šä¼ æœºåˆ¶æ”¹äº†\nä¹‹å‰å¯ä»¥è¾“å…¥ è´¦å·å¯†ç  å°±å¯ä»¥ push, ç°åœ¨åªèƒ½ä½¿ç”¨ github token ä»£æ›¿ å¯†ç  æ‰èƒ½æ¨é€/ä¸Šä¼ \nç”³è¯· token Settings \u0026ndash;\u0026gt; Developer settings \u0026ndash;\u0026gt; Personal access tokens \u0026ndash;\u0026gt; Generate new token\n Note \u0026ndash;\u0026gt; éšä¾¿å¡«ä¸€ä¸ªåç§° Expiration \u0026ndash;\u0026gt; é€‰æ‹©è¯¥ token æœ‰æ•ˆæœŸï¼Œä¸ªäººå»ºè®®å¦‚æœæ˜¯ä½¿ç”¨æ¨é€/ä¸Šä¼ åŠŸèƒ½ï¼Œå»ºè®®é€‰ No expiration å…¶ä½™ æ‰“å‹¾ æŒ‰ç…§ä½ è‡ªå·±éœ€æ±‚ï¼Œæ–°æ‰‹å»ºè®®å…¨éƒ¨æ‰“å‹¾ Generate token ç‚¹å‡»åˆ›å»º  å°†ä½ åˆ›å»ºåˆšåˆšåˆ›å»º token å¤åˆ¶ å†æ¬¡ä½¿ç”¨ git push  è¾“å…¥ä½ çš„ç”¨æˆ·å,å›è½¦ å°† token ç²˜è´´ä¸Šå», å›è½¦  å¦‚æœæˆåŠŸ ä¸Šä¼ /æ¨é€ ï¼Œè¯·äº«å—ğŸ‰ğŸ‰ğŸ‰ æ¯æ¬¡ æ¨é€/ä¸Šä¼  éƒ½è¦è¾“å…¥ è´¦å·å¯†ç ?? å¦‚æœä½ ä¸æƒ³æ¯æ¬¡ ä¸Šä¼ /æ¨é€ éƒ½è¦è¾“å…¥ è´¦å·å¯†ç ï¼Œå¯ä»¥çœ‹æˆ‘çš„å¦ä¸€ä¸ªæ–‡ç«  æ¯æ¬¡éƒ½è¦è¾“å…¥è´¦å·å¯†ç å¤ªéº»çƒ¦äº†\nğŸ‘‰ æ°¸ä¹…å…è´¦å·å¯†ç  æ¨é€/ä¸Šä¼  GitHub\nFAQâ“ å¦‚æœä½ é‡åˆ°äº†é—®é¢˜ï¼Œå¯ä»¥åœ¨ä¸‹é¢è¯„è®ºå»æé—®ï¼ŒåŸºæœ¬éƒ½ä¼šå›å¤çš„\n","permalink":"http://isouthrain.github.io/post/2022-04-29-%E6%8E%A8%E9%80%81github/","tags":["Git"],"title":"å¦‚ä½•ä¸Šä¼ /æ¨é€åˆ° Github"},{"categories":["æŠ€æœ¯"],"contents":"ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å git push å†ä¹Ÿä¸ç”¨ä¸€ç›´è¾“å…¥ è´¦å·å¯†ç äº†! git push æ¯æ¬¡éƒ½è¦è¾“å…¥è´¦å·å¯†ç ? ä»æ­¤è§£å†³ æ­£æ–‡ğŸ‘‡ é¦–å…ˆé…ç½® Git ä¸ªäººä¿¡æ¯ ä¾æ­¤è¾“å…¥ä»¥ä¸‹ä¸¤ä¸ªå‘½ä»¤: é…ç½®ä½ çš„ GitHub é‚®ç®±ğŸ“¬ 1  git config --global user.email \u0026#34;ä½ åœ¨ GitHub æ³¨å†Œçš„é‚®ç®±\u0026#34;   é…ç½®ä½ çš„ GitHub ç”¨æˆ·å 1  git config --global user.name \u0026#34;ä½ çš„ GitHub ç”¨æˆ·å\u0026#34;   è¾“å…¥ä»¥ä¸‹å‘½ä»¤åï¼Œå°†ä¼šä¿å­˜ä½  git push æ—¶ç™»å½•çš„ä¿¡æ¯ å½“ä¸‹ä¸€æ¬¡ git push æ—¶å°±ä¸ç”¨å†è¾“å…¥ç™»å½•ä¿¡æ¯äº†! 1  git config --global credential.helper store   å¦‚ä½•æ¨é€/ä¸Šä¼ åˆ°GitHub FAQâ“ ç”±äºGitHubå·²ç»æ›´æ”¹äº† git push æœºåˆ¶ git push æ—¶å¯†ç æ”¹ç”¨ token å·²å®Œæˆæ‰€æœ‰å·¥ä½œ, è¯· git push ä¸€æ¬¡è¯•è¯• å¦‚æœæˆåŠŸäº†ï¼Œè¯·äº«å—ğŸ‰ğŸ‰ğŸ‰ ","permalink":"http://isouthrain.github.io/post/2022-04-28-%E6%B0%B8%E4%B9%85%E5%85%8D%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%8E%A8%E9%80%81git/","tags":["Git"],"title":"æ°¸ä¹…å…è´¦å·å¯†ç æ¨é€Github"},{"categories":["æŠ€æœ¯"],"contents":"2022-08-30 æ›´æ–° ğŸ“ğŸ“å…¨éƒ¨å¸å·å¯ç”¨, ä¸æ”¯æŒç½‘é¡µç‰ˆçš„ä¹Ÿå¯ä»¥ä½¿ç”¨äº†, ä½¿ç”¨æœ¬æ•™ç¨‹å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ ğŸ“ğŸ“ Telegramæ”¶å‘å¾®ä¿¡æ¶ˆæ¯(å¯ä»¥ä¸éœ€è¦è´­ä¹°æœåŠ¡å™¨ï¼Œå•çº¯æ‰‹æœºä¹Ÿå¯ä»¥) ğŸ“ğŸ“ åœ¨å¼€å§‹æœ¬æ•™ç¨‹ä¹‹å‰ï¼Œè¯·ä½ ç¡®è®¤ä½ çš„å¾®ä¿¡å·æ˜¯å¦æ”¯æŒç½‘é¡µç«¯ç™»å½•ï¼Œå¦‚æœä¸æ”¯æŒè¯·ç¦»å¼€  å¾®ä¿¡ç½‘é¡µç‰ˆå…¥å£ ä¹Ÿå¯ä»¥è¯•è¯• å…ˆç™»å½• å¾®ä¿¡æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹ç½‘é¡µç‰ˆ å†å»ç™»å½•ç½‘é¡µç‰ˆ  æ¦‚è¿° å¾®ä¿¡æµªè´¹ç”µæ˜¯å¤§å®¶éƒ½çŸ¥é“çš„ï¼Œä½†å¥ˆä½•äº²æœ‹å¥½å‹éƒ½åœ¨ç”¨æ²¡æ³•æ¢ï¼Œåªèƒ½è‡ªå·±å¦æœ‰ä»–å¯»äº†ï¼Œæ‰€ä»¥æœ‰äº†æœ¬æ•™ç¨‹ã€‚ä½¿ç”¨TGçš„å¥½å¤„æ‡‚å¾—éƒ½æ‡‚\néœ€è¦ä½¿ç”¨ç§‘å­¦ä¸Šç½‘æ‰èƒ½è¿›è¡Œç™»å½•ï¼ŒAndroidç”¨æˆ·ç›´æ¥æŒ‚VPNå°±å¯ä»¥ï¼Œè´­ä¹°æœåŠ¡å™¨çš„å¯ä»¥ä½¿ç”¨å¤–å›½æœåŠ¡å™¨ï¼Œæˆ–è€…å›½å†…çš„æœåŠ¡å™¨ç»™æœåŠ¡å™¨ä¸Šä»£ç†å°±å¯ä»¥äº†   æœ¬æ•™ç¨‹å£°æ˜ Androidæ‰‹æœºä¸éœ€è¦è´­ä¹°æœåŠ¡å™¨\næ­¤æ•™ç¨‹æ²¡æœ‰ä»¥ä¸‹åŠŸèƒ½\n æ²¡æœ‰æœ‹å‹åœˆ æ²¡æœ‰çº¢åŒ… ä¸èƒ½å‘è¯­éŸ³ï¼ˆå¯ä»¥æ”¶å¬ï¼‰ ä¸èƒ½å‘ä½ç½® ç±»ä¼¼Webå¾®ä¿¡ éƒ¨åˆ†æ–‡ä»¶ã€å›¾ç‰‡ã€è¡¨æƒ…ç­‰å¤šåª’ä½“æ–‡ä»¶ä¼šè¢«ç½‘é¡µç‰ˆå¾®ä¿¡æˆªæ–­ï¼Œå³æ”¶ä¸åˆ°ä»»ä½•æ•°æ®ï¼Œ å°¤ä»¥è¡¨æƒ…ä¸ºç”šã€‚å› æ­¤é€ æˆçš„å¶å‘ç°è±¡ï¼Œä¼šæé†’ç”¨æˆ·ä½¿ç”¨ç§»åŠ¨å®¢æˆ·ç«¯æŸ¥çœ‹ã€‚  ç›®å‰åªæœ‰Ubuntuç³»ç»Ÿèƒ½æŠŠåŠŸèƒ½éƒ½å®ç°ï¼Œæ‰€ä»¥æœ¬æ•™ç¨‹ä½¿ç”¨Ubuntuç³»ç»Ÿ  éœ€è¦ä¸€ç‚¹ç‚¹LinuxçŸ¥è¯†ï¼Œä¸ä¼šä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œè€å¿ƒçœ‹è·Ÿç€åšå°±å¥½äº†  Androidç”¨æˆ·å¯ä»¥ä½¿ç”¨Termuxå®‰è£…ä¸€ä¸ªUbuntuç³»ç»Ÿå°±å¯ä»¥äº†,åœ¨Ubuntuè¿›è¡Œé…ç½®å°±å¥½äº†ï¼Œå¾ˆå®Œç¾äº†ï¼ å…³äº Termux å¯ä»¥ç›´æ¥å»ä¸‹è½½ï¼Œå®Œå…¨å…è´¹ï¼Œå¾ˆçœç”µï¼Œè€—ç”µé‡å¯ä»¥å¿½ç•¥ä¸è®¡   Termuxå®‰è£…Ubuntu æ›´æ–°ä¸‹è½¯ä»¶åŒ…ï¼š\n1  pkg update   æ‰“å¼€è½¯ä»¶ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç æŒ‰å›è½¦ï¼š\n1  pkg install wget openssl-tool proot -y \u0026amp;\u0026amp; hash -r \u0026amp;\u0026amp; wget https://raw.githubusercontent.com/EXALAB/AnLinux-Resources/master/Scripts/Installer/Ubuntu/ubuntu.sh \u0026amp;\u0026amp; bash ubuntu.sh    è¾“å…¥ä»¥ä¸‹ä»£ç è¿›å…¥Ubuntuç³»ç»Ÿï¼š\n1  ./start-ubuntu.sh    å›åˆ°æœ¬æ•™ç¨‹ï¼Œå¼€å§‹æ­å»ºTGæ”¶å‘å¾®ä¿¡æ¶ˆæ¯  å…ˆæ›´æ–°ç³»ç»Ÿè½¯ä»¶ï¼š  1  apt update \u0026amp;\u0026amp; apt upgrade -y    ä¸‹è½½å¿…è¦ä¾èµ–ï¼š  1  apt install ffmpeg python3-pip python3-dev python3-setuptools libtiff5-dev libjpeg8-dev zlib1g-dev libfreetype6-dev liblcms2-dev libwebp-dev libmagic-dev -y    å®‰è£…EHè½¬å‘æœºå™¨äººå’Œä¸»ä»é€šé“:   å®‰è£…EFBï¼š  1  pip3 install ehforwarderbot    å®‰è£…TGæœºå™¨äºº  1  pip3 install efb-telegram-master    å¾®ä¿¡ç«¯ï¼š  1  pip3 install git+https://github.com/ehForwarderBot/efb-wechat-slave   ç°åœ¨åšå®Œäº†æœåŠ¡å™¨å·¥ä½œï¼Œå†å»ç”³è¯·ä¸€ä¸ªæœºå™¨äºº  æ‰“å¼€TGæœç´¢ @botfather å‘é€ /newbot åˆ›å»ºè‡ªå·²çš„æœºå™¨äºº ç»™è‡ªå·²çš„æœºå™¨äººå–ä¸ªç§°å‘¼ï¼ˆéšä¾¿å–ï¼‰ ç»™è‡ªå·²çš„æœºå™¨äººå–ä¸ªç”¨æˆ·åï¼Œå¿…é¡»æ˜¯ä»¥ bot ç»“å°¾ï¼ˆä¾‹å¦‚Wechatbotï¼‰æ³¨æ„å¯èƒ½è¢«äººå–äº†å°±å¦å¤–å†æ‰“ä¸ªbotç»“å°¾çš„åç§°ï¼Œå¿…é¡»æ˜¯è‹±æ–‡ åˆ›å»ºåä½ ä¼šå¾—åˆ°ä¸€ä¸ªAPIï¼ˆä¹Ÿå¯ä»¥ç§° tokenï¼‰ï¼Œå¤åˆ¶ä¸‹æ¥ é…ç½®æœºå™¨äººï¼š   è¾“å…¥ /setprivacy å‘é€ï¼Œé€‰æ‹©ä½ çš„æœºå™¨äººï¼Œç‚¹Disable è¾“å…¥ /setjoingroups å‘é€ï¼Œé€‰æ‹©ä½ çš„æœºå™¨äººï¼Œç‚¹Enable è¾“å…¥ /setcommands å‘é€ï¼Œé€‰æ‹©ä½ çš„æœºå™¨äººï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹(å…¨éƒ¨ä¸€èµ·å‘ï¼Œä¸æ˜¯ä¸€æ¡æ¡å‘)è¿˜æœ‰å…¶ä»–åŠŸèƒ½è‡ªå·±å¯ä»¥å»æ‘¸ç´¢:  1 2  link - å°†ä¼šè¯ç»‘å®šåˆ° Telegram ç¾¤ç»„ chat - ç”Ÿæˆä¼šè¯å¤´    è¿”å›telegramä¸»ç•Œé¢ï¼Œæœç´¢æŒ‰æ‰­ğŸ”ï¼Œæœç´¢@get_id_botï¼Œè¿›å…¥ç‚¹å¼€å§‹ä¼šå¾—åˆ°ä½ çš„telegram id    æœåŠ¡å™¨ä¸Šæ“ä½œæˆ–è€…Termuxæ“ä½œï¼ˆAndroidç”¨æˆ·ä¸€å®šè¦åœ¨Ubuntuä¸Šæ“ä½œï¼‰   ä¸‹è½½ç¼–è¾‘è½¯ä»¶vimï¼š  1  apt install vim    ç¼–è¾‘æ–‡ä»¶ï¼š  1  vim ~/.ehforwarderbot/profiles/default/config.yaml   è¿›å…¥åç‚¹ä¸€ä¸‹é”®ç›˜ i\n æŠŠä»¥ä¸‹ä»£ç å¤åˆ¶è¿›å»ï¼š  1 2 3  master_channel: blueset.telegram slave_channels: - blueset.wechat    æŒ‰ä¸‹é”®ç›˜çš„ ESC å†è¾“å…¥è‹±æ–‡çŠ¶æ€ä¸‹çš„ : è¾“å…¥ wq åå›è½¦ï¼Œå°±è¿™æ ·ä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºäº† ç»§ç»­è¾“å…¥ï¼š  1  vim ~/.ehforwarderbot/profiles/default/blueset.telegram/config.yaml    æŒ‰ä¸Šé¢çš„æ–¹æ³•å¤åˆ¶ä¸€ä¸‹ä»£ç è¿›å»ï¼š  1 2  token: \u0026#34;æœºå™¨äººçš„API\u0026#34; admins: [ç”¨æˆ·ID]   æŠŠä¸Šé¢çš„ æœºå™¨äººAPI å’Œ ç”¨æˆ·ID æ¢æˆä½ åˆšæ‰åœ¨TGç”¨é‚£ä¸¤ä¸ªæœºå™¨äººå¾—åˆ°çš„ï¼ˆç¬¦å·ä¸è¦æ”¹ï¼‰\n æŠŠ VPN æŒ‚åœ¨åå°æ‰å¯ä»¥ç™»å½• è¿è¡Œç™»å½•ä½ çš„å¾®ä¿¡ 1  ehforwarderbot   ä¸€å®šè¦ç”¨æ‰«ç ç™»å½•ï¼Œä¸èƒ½ç”¨å›¾ç‰‡å¯¼å…¥ç™»å½• ","permalink":"http://isouthrain.github.io/post/2022-03-20-telegram%E6%94%B6%E5%8F%91%E5%BE%AE%E4%BF%A1%E6%B6%88%E6%81%AF/","tags":["TelegramBot","å¾®ä¿¡"],"title":"Telegram æ”¶å‘å¾®ä¿¡æ¶ˆæ¯"},{"categories":["webç¼–ç¨‹"],"contents":"é¡¹ç›®ä¸­æœ‰ä¸ªæ¨¡å—æ”¯æŒæŒ‰æ–‡ä»¶å¤¹é€‰ä¸­æ‰¹é‡ä¸Šä¼ ï¼Œç”¨æˆ·å¸Œæœ›åœ¨çœŸæ­£ä¸Šä¼ ä¹‹å‰èƒ½å¤Ÿåœ¨æµè§ˆå™¨ä¸­å®æ—¶é¢„è§ˆé€‰ä¸­çš„æ–‡ä»¶å¤¹å±‚çº§ç»“æ„ï¼Œæœ¬æ–‡åŸºäºChromeæµè§ˆå™¨ä¸ºä¾‹ï¼Œç®€è¦è¯´æ˜è¿™ä¸€å®ç°ã€‚\nè‹¥è¦Chromeæµè§ˆå™¨ä¸­æ”¯æŒæ‰¹é‡ä¸Šä¼ æ–‡ä»¶å¤¹ï¼Œéœ€è¦åœ¨inputæ§ä»¶ä¸­æ·»åŠ webkitdirectoryå±æ€§ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\n1 2 3  \u0026lt;body\u0026gt; ä¸Šä¼ æ–‡ä»¶å¤¹ \u0026lt;input type=\u0026#34;file\u0026#34; webkitdirectory onchange=\u0026#34;getfolder(event)\u0026#34;\u0026gt; \u0026lt;/body\u0026gt;   ä»¥ä¸€ä¸ªå…¸å‹çš„MavenåŠŸèƒ½åšä¸ºæµ‹è¯•ç›®å½•ï¼Œå…¶æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼Œç”¨æˆ·å¸Œæœ›é€‰ä¸­SpringTestæ–‡ä»¶å¤¹ååœ¨å‰ç«¯ä¸Šä¼ ä¹‹å‰å°±èƒ½å¤Ÿåœ¨ç½‘é¡µä¸Šå±•ç¤ºå‡ºç±»ä¼¼çš„ç»“æ„\nå½“åŸºäºå‰è¿°çš„HTMLä»£ç é€‰ä¸­ä¸Šé¢çš„å·¥ç¨‹ç›®å½•ä¸Šä¼ æ—¶ï¼ŒChromeæµè§ˆå™¨ä¼šæç¤ºå¦‚ä¸‹è­¦å‘Šæ¡†ï¼Œæ­¤è­¦å‘Šæ¡†æ˜¯æµè§ˆå™¨å‡ºäºå®‰å…¨åŸå› æç¤º1ï¼Œå¯ä¸ç”¨ç†ä¼šã€‚\nç»“æ„åˆ†æ åœ¨getfolderæ–¹æ³•ä¸­åˆ†æeventå˜é‡æ—¶ï¼Œå¯å‘ç°event.target.fileså±æ€§ä¸‹åŒ…å«æˆ‘ä»¬æ‰€ä¸Šä¼ çš„å…¨éƒ¨æ–‡ä»¶ï¼Œå°†å…¶æ‰“å°è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š\nè¿›ä¸€æ­¥è§‚å¯Ÿå¯å‘ç°å…¶ä¸­çš„webkitRelativePathä¸­åŒ…å«æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œç±»ä¼¼SpringTest/target/classes/com/lucumt/bean/User.classï¼Œè¿™ä¸ªè·¯å¾„è™½ç„¶åŒ…å«äº†ä¸Šä¼ æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œä½†å…¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ— æ³•ç›´æ¥ç”¨äºå±•ç¤ºå±‚çº§ç»“æ„ï¼Œè¿›ä¸€æ­¥åˆ†æeventå˜é‡çš„å…¶å®ƒå±æ€§ä¹Ÿæ²¡æœ‰æ‰¾åˆ°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œçœ‹æ¥åªèƒ½ä»webkitRelativePathç€æ‰‹æ›´æ”¹ã€‚\nä¿®æ”¹æ€è·¯ ä¸ºäº†å±•ç¤ºå±‚çº§ç»“æ„ï¼Œé¦–å…ˆéœ€è¦å®šä¹‰ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„Nodeç»“æ„ï¼Œå…¶ä¸­pathç”¨äºå­˜å‚¨å¯¹åº”çš„æ–‡ä»¶å(ä¸å«çˆ¶è·¯å¾„)ï¼Œchildrenåœ¨ä¸ºæ–‡ä»¶å¤¹æ—¶å­˜å‚¨å­æ–‡ä»¶(æ–‡ä»¶å¤¹)çš„ä¿¡æ¯ï¼š\n1 2 3 4  function Node(path){ this.path = path; this.children = []; }   æœ€ç»ˆçš„ç»“æœéƒ½æ˜¯åŸºäºNodeè¿›è¡Œç»„åˆå¤„ç†ã€‚\né€å±‚å¤„ç† å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç”±äºé€šè¿‡JavaScriptè·å–çš„éƒ½æ˜¯èŠ‚ç‚¹çš„å®Œæ•´è·¯å¾„ï¼Œä»ç®€åŒ–å®ç°çš„è§’åº¦è€ƒè™‘ï¼Œç³»ç»ŸæŒ‰ç…§æ–‡ä»¶å¤¹å±‚çº§è‡ªåº•å‘ä¸Šé€çº§è§£æï¼Œè§£æåˆ°æ ¹ç›®å½•æ—¶åˆ™åœæ­¢ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œè·å–åˆ°çš„æ–‡ä»¶è·¯å¾„ä¸æ–­ç¼©å°ï¼Œç›´è‡³å¤„ç†åˆ°æ ¹èŠ‚ç‚¹ï¼Œä»¥SpringTest/target/test-classes/com/lucumt/TestGetBean.classä¸ºä¾‹ï¼Œå…¶è§£æè¿‡ç¨‹è¯´æ˜å¦‚ä¸‹ï¼š\n åˆå§‹è·¯å¾„ä¸ºSpringTest/target/test-classes/com/lucumt/TestGetBean.class å°†å‰è¿°è·¯å¾„æ‹†åˆ†ä¸ºTestGetBean.class(ä¸ºå…¶åˆ›å»ºèŠ‚ç‚¹node1)å’ŒSpringTest/target/test-classes/com/lucumt(ä¸ºå…¶åˆ›å»ºèŠ‚ç‚¹node2)ï¼Œnode2çš„å­èŠ‚ç‚¹åŒ…å«node1 å°†node2çš„è·¯å¾„æ‹†åˆ†ä¸ºlucumt(æ›´æ–°node2èŠ‚ç‚¹çš„è·¯å¾„)å’ŒSpringTest/target/test-classes/com(ä¸ºå…¶åˆ›å»ºnode3èŠ‚ç‚¹)ï¼Œnode3èŠ‚ç‚¹çš„å­èŠ‚ç‚¹åŒ…å«node2 å°†node3èŠ‚ç‚¹çš„è·¯å¾„æ‹†åˆ†ä¸ºcom(æ›´æ–°node3èŠ‚ç‚¹çš„è·¯å¾„)å’ŒSpringTest/target/test-classes(ä¸ºå…¶åˆ›å»ºèŠ‚ç‚¹node4) å°†node4èŠ‚ç‚¹çš„è·¯å¾„æ‹†åˆ†ä¸ºtest-classes(æ›´æ–°node4èŠ‚ç‚¹çš„è·¯å¾„)å’ŒSpringTest/target(ä¸ºå…¶åˆ›å»ºèŠ‚ç‚¹node5) å°†node5èŠ‚ç‚¹çš„è·¯å¾„æ‹†åˆ†ä¸ºtarget(æ›´æ–°node5èŠ‚ç‚¹è·¯å¾„)å’ŒSpringTest(ä¸ºå…¶åˆ›å»ºèŠ‚ç‚¹node6) èŠ‚ç‚¹node6å·²ç»æ˜¯æ ¹èŠ‚ç‚¹ï¼Œæ•´ä¸ªè¿‡ç¨‹å®Œæ¯•ï¼Œè‡³æ­¤ä»node6åŸºäºchildrenå±æ€§å¯ä¸€ç›´å¾€ä¸‹æ‹›åˆ°node1æ–‡ä»¶èŠ‚ç‚¹ã€‚  å¤„ç†é‡å¤ åŸºäºä¸Šè¿°å®ç°æ–¹æ¡ˆæ—¶æœ‰ä¸€ä¸ªé—®é¢˜å¾…è§£å†³ï¼Œå¦‚SpringTest/target/test-classes/com/lucumt/TestGetBean.classå’ŒSpringTest/target/classes/com/lucumt/TestApplication.classåœ¨æ‹†åˆ†åˆ°ç¬¬2å±‚çº§æ—¶ï¼Œéƒ½ä¼šè¯†åˆ«åˆ°lucumtæ–‡ä»¶å¤¹ï¼Œè‹¥éƒ½å»åˆ›å»ºè¯¥æ–‡ä»¶å¤¹èŠ‚ç‚¹æ•°æ®åˆ™ä¼šå¯¼è‡´é‡å¤ã€‚\nå›é¡¾å‰é¢çš„é€å±‚å¤„ç†å®ç°æ–¹æ¡ˆå¯çŸ¥ï¼Œå½“å¤„ç†SpringTest/target/classes/com/lucumt/TestApplication.classæ—¶ï¼ŒSpringTest/target/test-classes/com/lucumt/TestGetBean.classå·²ç»è¢«å¤„ç†å®Œæ¯”ï¼Œåœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ä¼šç»™æˆ‘ä»¬åˆ›å»ºå¥½lucumtç›®å½•ï¼Œåœ¨æ¥ä¸‹æ¥å¤„ç†SpringTest/target/test-classes/com/lucumt/TestGetBean.classæ—¶æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°lucumtå¯¹åº”çš„çˆ¶èŠ‚ç‚¹ï¼Œç„¶åæ£€æŸ¥çˆ¶èŠ‚ç‚¹ä¸‹æœ‰æ²¡æœ‰è¯¥ç›®å½•å³å¯ã€‚\nåŸºäºä¸Šè¿°åˆ†æï¼Œè¦åœ¨é€çº§éå†çš„è¿‡ç¨‹ä¸­æ·»åŠ å¦‚ä¸‹å¤„ç†ï¼š\n éå†åˆ°å½“å‰æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹èŠ‚ç‚¹æ—¶ï¼Œéœ€è¦æŸ¥æ‰¾å…¶çˆ¶èŠ‚ç‚¹ï¼Œè‹¥çˆ¶èŠ‚ç‚¹ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼ŒåŒæ—¶å°†å½“å‰èŠ‚ç‚¹åŠ å…¥åˆ°çˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹é›†åˆä¸­å» è‹¥å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å­˜åœ¨ï¼Œåˆ™éœ€è¦è·å–å…¶æ‰€æœ‰çš„å­èŠ‚ç‚¹ï¼Œå¹¶ä¸å½“å‰èŠ‚ç‚¹è¿›è¡Œé¿å…ï¼Œåˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™ä¸éœ€è¦é‡å¤åˆ›å»º  ä¸ºäº†è®°å½•å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œå¯åœ¨JavaScriptä¸­é‡‡ç”¨Mapæ•°æ®ç»“æ„ï¼Œå…¶ä¸­keyä¸ºèŠ‚ç‚¹çš„è·¯å¾„ï¼Œvalueä¸ºNodeèŠ‚ç‚¹è‡ªèº«ã€‚\nä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59  function getfolder(event) { let files = event.target.files; let map = {}; var rootPath = files[0].webkitRelativePath.split(\u0026#39;/\u0026#39;)[0]; // å¾ªç¯éå†ï¼Œæ£€æµ‹æ‰€æœ‰çš„æ–‡ä»¶è·¯å¾„  for (var i in files) { var node = files[i]; var path = node.webkitRelativePath; if (!path) { continue; } while (true) { // å¤„ç†åˆ°æœ€é¡¶å±‚æ–‡ä»¶å¤¹æ—¶ï¼Œå°±ä¸ç”¨å¾€ä¸Šç»§ç»­å¤„ç†  if (!path || path.indexOf(\u0026#34;/\u0026#34;) == -1) { break; } var index = path.lastIndexOf(\u0026#34;/\u0026#34;); var parentPath = path.substring(0, index); var file = path.substring(index + 1); var node; if (!map[path]) { node = new Node(file); map[path] = node; } else { node = map[path]; } // çˆ¶èŠ‚ç‚¹æ²¡æœ‰åˆ™åˆ›å»º  if (!map[parentPath]) { var parentFile = parentPath.substring(parentPath.lastIndexOf(\u0026#34;/\u0026#34;) + 1) var pNode = new Node(parentFile); // åŠ¨æ€çš„æ›´æ–°çˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œä¸ºåç»­æ£€æŸ¥é‡å¤èŠ‚ç‚¹åšå‡†å¤‡  pNode.children.push(node); map[parentPath] = pNode; } else { var pNode = map[parentPath]; var children = pNode.children; var addNode = true; // é€šè¿‡æ£€æŸ¥çˆ¶èŠ‚ç‚¹ä¸‹çš„å­èŠ‚ç‚¹æ¥é¿å…é‡å¤åˆ›å»º  for (var k in children) { if (children[k].path == file) { addNode = false; break; } } if (addNode) { pNode.children.push(node); } } // é€çº§ç¼©çŸ­çˆ¶èŠ‚ç‚¹çš„è·¯å¾„ï¼Œç›´åˆ°å›åˆ°æœ€é¡¶å±‚  path = parentPath; } } console.log(map[rootPath]); }   æ‰§è¡Œä¸Šè¿°ä»£ç ååœ¨Chromeæ§åˆ¶å°çš„è¾“å‡ºå¦‚ä¸‹ï¼Œå¯è§rootä¸­å·²èƒ½å¤Ÿæ­£ç¡®çš„è¾“å‡ºå±‚çº§ç»“æ„ï¼Œè¿›è¡Œåˆ°è¿™ä¸€æ­¥åç»­åœ¨é¡µé¢ä¸Šå±•ç¤ºå°±å¾ˆå®¹æ˜“äº†ï¼Œæ­¤å¤„ä¸å†å™è¿°ã€‚\nJavaç‰ˆæœ¬å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104  public class TestFilePathConvert { public static void main(String[] args) { String[] paths = { \u0026#34;a/b1/c1/d1.txt\u0026#34;, \u0026#34;a/b1/c1/d2.txt\u0026#34;, \u0026#34;a/b1/c1/d2/e1/f.txt\u0026#34;, \u0026#34;a/b2/c2/d1\u0026#34;, \u0026#34;a/b3/c1\u0026#34;, \u0026#34;a/b4/c1/d1/e1/f1\u0026#34;, \u0026#34;a/b4/c1/d1/e1/f2/g1.png\u0026#34;, \u0026#34;a/b5/c1\u0026#34; }; convertPathToTreeNode(paths); } public static void convertPathToTreeNode(String[] paths) { Map\u0026lt;String, Node\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); for (String path : paths) { while (true) { Node node, pNode; String nodeName; if (map.containsKey(path)) { node = map.get(path); nodeName = node.getName(); } else { int index = path.lastIndexOf(\u0026#34;/\u0026#34;); nodeName = path.substring(index + 1); node = new Node(nodeName); map.put(path, node); } String parentPath = StringUtils.substringBeforeLast(path, \u0026#34;/\u0026#34;); if (path.equals(parentPath)) { break; } // å¤„ç†çˆ¶èŠ‚ç‚¹  if (map.containsKey(parentPath)) { pNode = map.get(parentPath); } else { int index = parentPath.lastIndexOf(\u0026#34;/\u0026#34;); String pName = parentPath.substring(index + 1); pNode = new Node(pName); map.put(parentPath, pNode); } //æ£€æŸ¥å½“å‰èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨  boolean add = true; for (Node n : pNode.getChildren()) { if (nodeName.equals(n.getName())) { add = false; break; } } // é¿å…å½“å‰èŠ‚ç‚¹çš„é‡å¤æ·»åŠ   if (add) { pNode.getChildren().add(node); } path = parentPath; } } String root = StringUtils.substringBefore(paths[0], \u0026#34;/\u0026#34;); Node rootNode = map.get(root); Gson gson = new Gson(); System.out.println(gson.toJson(rootNode)); } static class Node { private String name; private List\u0026lt;Node\u0026gt; children = new ArrayList\u0026lt;\u0026gt;(); public String getName() { return name; } public void setName(String name) { this.name = name; } public List\u0026lt;Node\u0026gt; getChildren() { return children; } public void setChildren(List\u0026lt;Node\u0026gt; children) { this.children = children; } public Node(String name) { this.name = name; } @Override public String toString() { return \u0026#34;Node{\u0026#34; + \u0026#34;name=\u0026#39;\u0026#34; + name + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, children=\u0026#34; + children.size() + \u0026#39;}\u0026#39;; } } }     https://stackoverflow.com/questions/50225019/how-to-remove-warning-message-in-chrome-when-uploading-a-directory\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/web/convert-folder-upload-data-to-tree-node-in-chrome/","tags":["html5","JavaScript"],"title":"åœ¨Chromeä¸­å°†ä¸Šä¼ çš„æ–‡ä»¶å¤¹æ•°æ®è½¬åŒ–ä¸ºæŒ‰æ ‘ç»“æ„å±•ç¤º"},{"categories":["Springç³»åˆ—"],"contents":"BeanFactoryå’ŒFactoryBeançš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯æ˜¯Springé¢è¯•ä¸­çš„é«˜é¢‘é¢˜ä¹‹ä¸€ï¼Œæœ¬æ–‡åŸºäºç½‘ä¸Šèµ„æ–™å’Œä¸ªäººç†è§£ï¼Œç®€è¦è¯´æ˜ä»–ä»¬ä¹‹é—´çš„å¼‚åŒä»¥åŠä½¿ç”¨åœºæ™¯ã€‚\nç»„ä»¶è¯´æ˜ BeanFactory åœ¨BeanFactoryçš„APIä¸­ï¼Œä¸€å¼€å§‹å°±æœ‰å¦‚ä¸‹ä¸€å¥æè¿°\n The root interface for accessing a Spring bean container\n è¿™å¥è¯æŒ‡æ˜äº†BeanFactoryåœ¨Springå®¶æ—ä¸­çš„åœ°ä½ï¼Œå®ƒæ˜¯æ“ä½œSpringå®¹å™¨ã€è·å–Spring Beançš„æ ¹æ¥å£ã€‚ä»å­—é¢æ„æ€å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ä¸€ä¸ªBeanå·¥å‚ï¼Œå…¶å†…éƒ¨é‡‡ç”¨äº†å·¥å‚æ¨¡å¼ï¼Œé€šè¿‡å®ƒä»¬æˆ‘ä»¬å¯è¿›è¡Œåˆ›å»ºBeanã€è·å–Beanç­‰æ“ä½œ1ã€‚\nåœ¨å­¦ä¹ ä¸ä½¿ç”¨Springè¿‡ç¨‹ä¸­æ¥è§¦åˆ°çš„ApplicaitonContextã€AnnotationConfigApplicastionContextã€ClassPathXmlApplicationContextç­‰éƒ½æ˜¯å…¶å­æ¥å£å’Œå…·ä½“çš„å®ç°ç±»ï¼Œå®ƒæ˜¯æˆ‘ä»¬åœ¨Springæ¡†æ¶ä¸­æ¥è§¦æœ€å¤šçš„ç³»ç»Ÿæ¥å£ï¼Œä¸‹å›¾ä¸­çš„UMLå±•ç¤ºäº†BeanFactoryåŠå…¶å­æ¥å£å’Œå®ç°ç±»ä¹‹é—´çš„å…³ç³»2\nä¸‹è¿°ä»£ç å±•ç¤ºäº†BeanFactoryæ‰€åŒ…å«çš„å…¨éƒ¨15ä¸ªæ¥å£æ–¹æ³•ï¼Œå®ƒä»¬æ¶µç›–äº†Springä¸­å¯¹Beanå¯¹è±¡çš„å„ç§è¯»å–æ“ä½œï¼Œè‹¥ç»å¸¸ä½¿ç”¨Springè¿™äº›æ¥å£æ–¹æ³•çœ‹èµ·æ¥å°±ä¼šå¾ˆç†Ÿæ‚‰ã€‚\n BeanFactoryæ¥å£(ç‚¹å‡»å¯å±•å¼€) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  public interface BeanFactory { String FACTORY_BEAN_PREFIX = \u0026#34;\u0026amp;\u0026#34;; Object getBean(String name) throws BeansException; \u0026lt;T\u0026gt; T getBean(String name, Class\u0026lt;T\u0026gt; requiredType) throws BeansException; Object getBean(String name, Object... args) throws BeansException; \u0026lt;T\u0026gt; T getBean(Class\u0026lt;T\u0026gt; requiredType) throws BeansException; \u0026lt;T\u0026gt; T getBean(Class\u0026lt;T\u0026gt; requiredType, Object... args) throws BeansException; \u0026lt;T\u0026gt; ObjectProvider\u0026lt;T\u0026gt; getBeanProvider(Class\u0026lt;T\u0026gt; requiredType); \u0026lt;T\u0026gt; ObjectProvider\u0026lt;T\u0026gt; getBeanProvider(ResolvableType requiredType); boolean containsBean(String name); boolean isSingleton(String name) throws NoSuchBeanDefinitionException; boolean isPrototype(String name) throws NoSuchBeanDefinitionException; boolean isTypeMatch(String name, ResolvableType typeToMatch) throws NoSuchBeanDefinitionException; boolean isTypeMatch(String name, Class\u0026lt;?\u0026gt; typeToMatch) throws NoSuchBeanDefinitionException; @Nullable Class\u0026lt;?\u0026gt; getType(String name) throws NoSuchBeanDefinitionException; @Nullable Class\u0026lt;?\u0026gt; getType(String name, boolean allowFactoryBeanInit) throws NoSuchBeanDefinitionException; String[] getAliases(String name); }    ç”±äºBeanFactoryæ˜¯æ“ä½œSpringå®¹å™¨å’Œå¯¹è±¡çš„æ ¹æ¥å£ï¼ŒSpringå®˜æ–¹è¦æ±‚å®ƒå°½å¯èƒ½çš„æ”¯æŒBeanç”Ÿå‘½å‘¨æœŸçš„å„ç§æ¥å£ï¼ŒåŸºäºSpringå®˜æ–¹APIçš„æè¿°ï¼Œå…¶å®Œæ•´çš„æ–¹æ³•é“¾å’Œé¡ºåºå¦‚ä¸‹ï¼š\n BeanNameAware\u0026rsquo;s setBeanName BeanClassLoaderAware\u0026rsquo;s setBeanClassLoader BeanFactoryAware\u0026rsquo;s setBeanFactory EnvironmentAware\u0026rsquo;s setEnvironment EmbeddedValueResolverAware\u0026rsquo;s setEmbeddedValueResolver ResourceLoaderAware\u0026rsquo;s setResourceLoader (only applicable when running in an application context) ApplicationEventPublisherAware\u0026rsquo;s setApplicationEventPublisher (only applicable when running in an application context) MessageSourceAware\u0026rsquo;s setMessageSource (only applicable when running in an application context) ApplicationContextAware\u0026rsquo;s setApplicationContext (only applicable when running in an application context) ServletContextAware\u0026rsquo;s setServletContext (only applicable when running in a web application context) postProcessBeforeInitialization methods of BeanPostProcessors InitializingBean\u0026rsquo;s afterPropertiesSet a custom init-method definition postProcessAfterInitialization methods of BeanPostProcessors  ä¸Šè¿°åˆå§‹åŒ–é“¾å¯å¾ˆå¥½çš„å¸®æˆ‘ä»¬å›ç­”é¢è¯•ä¸­å¦å¤–å‡ ä¸ªå¸¸è§çš„é—®é¢˜ï¼š\n Springä¸­Beanå¦‚ä½•åˆå§‹åŒ– æè¿°Springä¸­Beançš„ç”Ÿå‘½å‘¨æœŸ  FactoryBean FactoryBeanä»åå­—å°±èƒ½çœ‹å‡ºæ¥æ˜¯ä¸€ä¸ªBeanï¼Œä½†ä¸æ˜¯æ™®é€šçš„Beanï¼Œå¦åˆ™Springä½œè€…ä¸ºå•¥è¦å•ç‹¬çš„åˆ›å»ºè¿™ä¸ªæ¥å£å‘¢ï¼ŸFactoryBeanä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…¶æºç å¦‚ä¸‹ï¼Œä»ä¸­å¯ä»¥çœ‹å‡ºè¯¥æ¥å£åªæœ‰3ä¸ªæ–¹æ³•ï¼Œä¸BeanFactoryç›¸æ¯”æ•°é‡å¤§ä¸ºå‡å°‘ï¼ŒåŒæ—¶è¿™3ä¸ªæ¥å£æ–¹æ³•çš„ä½œç”¨ä¹ŸåŒBeanFactoryä¸­çš„ç›¸å…³æ–¹æ³•ç±»ä¼¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  public interface FactoryBean\u0026lt;T\u0026gt; { String OBJECT_TYPE_ATTRIBUTE = \u0026#34;factoryBeanObjectType\u0026#34;; @Nullable T getObject() throws Exception; @Nullable Class\u0026lt;?\u0026gt; getObjectType(); default boolean isSingleton() { return true; } }   é€šè¿‡ä¸Šè¿°ä»£ç èƒ½å¤Ÿè·å–çš„ä¿¡æ¯ä¾æ—§æœ‰é™ï¼Œåœ¨FactoryBeançš„å®˜æ–¹APIä¸­æœ‰å¦‚ä¸‹æè¿°\n Interface to be implemented by objects used within a BeanFactory which are themselves factories for individual objects. If a bean implements this interface, it is used as a factory for an object to expose, not directly as a bean instance that will be exposed itself.\nNB: A bean that implements this interface cannot be used as a normal bean. A FactoryBean is defined in a bean style, but the object exposed for bean references (getObject()) is always the object that it creates.\n ä¸Šè¿°æ–‡æ¡£çš„ä¸»è¦ç»“è®ºå¦‚ä¸‹ï¼š\n FactoryBeanä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„Beanï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºç‰¹å®šbeançš„å·¥å‚ é€šè¿‡å®ç°FactoryBeanæ¥å£ï¼Œå¯é€šè¿‡æš´éœ²å¯¹è±¡çš„æ–¹å¼åˆ›å»ºç‰¹å®šbeanå¯¹è±¡ï¼Œè€Œè¿™ä¸ªbeanå¯¹è±¡æœ¬èº«ä¸ä¼šæš´éœ²  åˆ°è¿™é‡Œè™½ç„¶äºŒè€…çš„åŒºåˆ«æ¸…æ¥šäº†ï¼Œä½†æ˜¯FactoryBeançš„ä½¿ç”¨åœºæ™¯è¿˜æ˜¯ä¸æ¸…æ™°ï¼Œåœ¨https://spring.io/blog/2011/08/09/what-s-a-factorybeanè¿™ç¯‡æ–‡ç« ä¸­ï¼ŒSpringçš„ä½œè€…ä¹‹ä¸€JOSH LONGç”¨å¦‚ä¸‹æ–‡å­—é˜è¿°äº†FactoryBeançš„ä½¿ç”¨åœºæ™¯\n A FactoryBean is a pattern to encapsulate interesting object construction logic in a class. It might be used, for example, to encode the construction of a complex object graph in a reusable way. Often this is used to construct complex objects that have many dependencies. It might also be used when the construction logic itself is highly volatile and depends on the configuration. A FactoryBean is also useful to help Spring construct objects that it couldnâ€™t easily construct itself.\n ä»ä¸Šè¿°æ–‡å­—ä¸­å¯ä»¥çœ‹å‡ºFactoryBeanä¸»è¦ç”¨äºæ„å»ºä¸€äº›å®ä¾‹åŒ–è¿‡ç¨‹è¾ƒä¸ºå¤æ‚æˆ–æœ‰é…ç½®ä¾èµ–çš„å¯¹è±¡(å³éæ™®é€šPOJO)ï¼Œå¹¶å°†å…¶äº¤ç»™Springå®¹å™¨ç®¡ç†ã€‚\nSpringæ¡†æ¶æœ¬èº«å°±è‡ªå¸¦äº†å®ç°FactoryBeançš„70å¤šä¸ªæ¥å£ï¼Œå¦‚ProxyFactoryBeanã€MapFactoryBeanã€PropertiesFactoryBeanç­‰ï¼Œä»ä¸ªäººè§’åº¦æ¥çœ‹å®ƒä»¬è¦ä¹ˆç†è§£èµ·æ¥è¾ƒä¸ºå¤æ‚ï¼Œè¦ä¹ˆä½¿ç”¨è¾ƒå°‘ä¸å…·æœ‰ä»£è¡¨æ€§ï¼Œä¸‹é¢ä»¥MyBatis-Springä¸­çš„SqlSessionFactoryBeanä¸ºä¾‹æ¥äº†è§£å…¶ç”¨æ³•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  @Override public SqlSessionFactory getObject() throws Exception { if (this.sqlSessionFactory == null) { afterPropertiesSet(); } return this.sqlSessionFactory; } // å‚æ•°æ ¡éªŒä¸å¯¹è±¡åˆ›å»º  public void afterPropertiesSet() throws Exception { notNull(dataSource, \u0026#34;Property \u0026#39;dataSource\u0026#39; is required\u0026#34;); notNull(sqlSessionFactoryBuilder, \u0026#34;Property \u0026#39;sqlSessionFactoryBuilder\u0026#39; is required\u0026#34;); state((configuration == null \u0026amp;\u0026amp; configLocation == null) || !(configuration != null \u0026amp;\u0026amp; configLocation != null), \u0026#34;Property \u0026#39;configuration\u0026#39; and \u0026#39;configLocation\u0026#39; can not specified with together\u0026#34;); this.sqlSessionFactory = buildSqlSessionFactory(); } // åŸºäºé…ç½®æ–‡ä»¶åˆ›å»ºå…·ä½“çš„SqlSessionFactory protected SqlSessionFactory buildSqlSessionFactory() throws Exception { // å„ç§æ£€æŸ¥ä»£ç   return this.sqlSessionFactoryBuilder.build(targetConfiguration); }   åœ¨åˆ›å»ºSqlSessionFactoryæ—¶éœ€è¦ä¾èµ–æ•°æ®åº“çš„é…ç½®ç­‰ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œä½†è¿™äº›é…ç½®ä¿¡æ¯è‹¥é€šè¿‡BeanFactoryä»¥ä¼ ç»Ÿçš„å®ä¾‹åŒ–-\u0026gt;åˆå§‹åŒ–çš„æ–¹å¼åˆ›å»ºæ—¶æ˜¯å¾ˆéš¾åŠåˆ°çš„ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡BeanPostProcessorsçš„æ¥å£ä¸­çš„å›è°ƒæ–¹æ³•æ¥å®ç°ï¼Œä½†ä¼šå¯¼è‡´ä»£ç å¤æ‚å¹¶ä¸”ä¸èƒ½æ»¡è¶³æŸäº›ç‰¹æ®Šåœºæ™¯ä¸‹çš„éœ€æ±‚ï¼Œè€Œé€šè¿‡FactoryBeanæˆ‘ä»¬åªéœ€è¦æ ¹æ®å®é™…ä¸šåŠ¡é€»è¾‘åœ¨getObject()æ–¹æ³•ä¸­åˆ›å»ºå¯¹åº”çš„å¯¹è±¡å¹¶è¿”å›å³å¯ï¼Œç”±äºå¯¹è±¡çš„åˆ›å»ºç”±æˆ‘ä»¬è‡ªå·±æŠŠæ§ï¼Œåœ¨è¾¾åˆ°ä»£ç ç®€æ´çš„åŒæ—¶ï¼Œåˆ›å»ºçš„å¯¹è±¡ä¹Ÿèƒ½è¢«Springå®¹å™¨ç®¡ç†ã€‚\nä½¿ç”¨ç¤ºä¾‹ å‡è®¾æœ‰å¦‚ä¸‹æ‰€ç¤ºçš„Groupç±»\n1 2 3 4 5 6 7  @Service public class Group { private String groupName; // getter setter }   åœ¨ä½¿ç”¨BeanFactoryè·å–å¯¹è±¡çš„æ–¹æ³•å¦‚ä¸‹\n1 2 3 4 5  public static void main(String[] args) { AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class); Group group = context.getBean(Group.class); System.out.println(group.hashCode()); }   è¾“å‡ºç»“æœä¸ºGroup@25d250c6ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ­£ç¡®çš„è·å–åˆ°äº†Beanå¯¹è±¡ã€‚\nå®šä¹‰ä¸€ä¸ªå®ç°äº†FactoryBeanæ¥å£çš„GroupFactoryBeanï¼Œå…¶ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  public class GroupFactoryBean implements FactoryBean\u0026lt;Group\u0026gt; { @Override public Group getObject() throws Exception { return new Group(); } @Override public Class\u0026lt;?\u0026gt; getObjectType() { return Group.class; } }   æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5  public static void main(String[] args) { AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(GroupFactoryBean.class); Object object = context.getBean(\u0026#34;groupFactoryBean\u0026#34;); System.out.println(object); }   è¾“å‡ºç»“æœä¸ºGroup@fdefd3fï¼Œå¦‚å‰é¢é€šè¿‡BeanFactory åˆ›å»ºçš„å¯¹è±¡ç±»ä¼¼ï¼Œæ¥ä¸‹æ¥å°†groupFactoryBeanæ·»åŠ ä¸€ä¸ª\u0026amp;å‰ç¼€ï¼Œå˜ä¸º\u0026amp;groupFactoryBeanåå†æ¬¡è¿›è¡Œæµ‹è¯•\n1 2 3 4 5  public static void main(String[] args) { AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(GroupFactoryBean.class); Object object = context.getBean(\u0026#34;\u0026amp;groupFactoryBean\u0026#34;); System.out.println(object); }   è¾“å‡ºç»“æœä¸ºGroupFactoryBean@1990a65eï¼Œç”±æ­¤å¯å¾—å‡ºå¦‚ä¸‹ç»“è®º ï¼š\n å½“ç›´æ¥é€šè¿‡FactoryBeanå®ç°ç±»çš„æ¥å£åç§°è·å–å¯¹è±¡æ—¶ï¼Œå¾—åˆ°çš„æ˜¯è¯¥FactoryBeanå®ç°ç±»ä¸­åˆ›å»ºçš„å¯¹è±¡æœ¬èº«ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æ­£å¸¸çš„ä½¿ç”¨æ–¹å¼ å½“åœ¨FactoryBeanæ¥å£å¯¹è±¡åå‰é¢åŠ ä¸Š\u0026amp;å‰ç¼€æ—¶ï¼Œå¾—åˆ°çš„æ˜¯FactoryBeanå®ç°ç±»æœ¬èº«ï¼Œä¸€èˆ¬ç”¨äºè°ƒè¯•åˆ†æã€‚  äºŒè€…ä¹‹é—´çš„åŒºåˆ«  ç›¸åŒç‚¹ï¼š  éƒ½æ˜¯æ¥å£ç±»ï¼Œéœ€è¦ä½¿ç”¨è€…è‡ªå·±å®ç°ç›¸åº”çš„æ–¹æ³• æ¥å£ä¸­åˆ›å»ºbeanå¯¹è±¡éƒ½èƒ½è¢«Springå®¹å™¨ç®¡ç†   ä¸åŒç‚¹:  BeanFactoryæä¾›çš„æ¥å£æ–¹æ³•æ›´å¤šï¼Œæ›´å…·æœ‰çµæ´»æ€§ï¼Œå¦‚èƒ½è·å–åˆ«åã€beanå¯¹è±¡ç±»å‹ç­‰ BeanFactoryåŸºäºSpringè§„èŒƒå®ç°ï¼Œå…¶åˆ›å»ºçš„beanä¼šåœ¨Springå®¹å™¨ä¸­ç»å†å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸï¼Œèƒ½å¤Ÿè°ƒç”¨@PostConstructã€BeanPostProcessorsç­‰æ¥å£å’Œæ–¹æ³• Springå®¹å™¨åªè´Ÿè´£FactoryBeanåˆ›å»ºçš„beanå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œä¸è´Ÿè´£beanå¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯(å› ä¸ºç”±æˆ‘ä»¬è‡ªå·±å®ç°äº†å˜›!)ï¼Œæ‰€ä»¥è°ƒç”¨@PostConstructå’Œ@PreDestroyæ–¹æ³•ä¸ä¼šç”Ÿæ•ˆï¼Œéœ€è¦å®ç°DisposableBeanç­‰æ¥å£æ¥è¾¾åˆ°è¯¥ç›®çš„    ç›¸å…³ä½¿ç”¨åœºæ™¯  BeanFactory:  é¡¹ç›®ä¸­å„ç§å¸¸è§„çš„POJOã€Daoã€Serviceç­‰ä¸æ¶‰åŠå¤æ‚æ„é€ çš„åœºæ™¯   FactoryBean:  å¯¹è±¡çš„æ„é€ (å®ä¾‹åŒ–)è¾ƒä¸ºå¤æ‚ï¼Œé€šå¸¸æ˜¯ç³»ç»Ÿä¸­çš„ä¸€äº›åº•å±‚ç»„ä»¶ï¼Œå¦‚SqlSessionFactoryBeanã€ProxyFactoryBeanç­‰    å‚è€ƒæ–‡æ¡£   https://www.cnblogs.com/aspirant/p/9082858.html\n  https://spring.io/blog/2011/08/09/what-s-a-factorybean\n  https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/beans/factory/FactoryBean.html\n    å®é™…ä¸ŠBeançš„åˆ›å»ºã€é”€æ¯éƒ½æ˜¯ç”±å®¹å™¨æ¥è´Ÿè´£çš„ï¼Œä½¿ç”¨æ—¶æ›´å¤šå…³æ³¨çš„æ˜¯Beanå¯¹è±¡çš„é…ç½®ä»¥åŠå¦‚ä½•è·å–Beanå¯¹è±¡\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n å‡ºäºç¯‡å¹…çš„è€ƒè™‘ï¼Œå®é™…ä¸Šè¿™å¼ UMLç±»å›¾å±•ç¤ºçš„å¹¶ä¸å®Œæ•´ï¼Œå¯åœ¨IDEAä¸­åŸºäºBeanFactoryè‡ªå·±ç”Ÿæˆå®Œæ•´çš„UMLå›¾\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/spring/spring-core/difference-between-factorybean-and-beanfactory/","tags":["Spring"],"title":"Springä¸­BeanFactoryå’ŒFactoryBeançš„åŒºåˆ«ä»¥åŠä½¿ç”¨åœºæ™¯"},{"categories":["æŠ€æœ¯"],"contents":"æ¦‚è¿° Notion å’Œ Obsidian éƒ½æœ‰æ”¶é›†ç½‘é¡µçš„åŠŸèƒ½, Org-mode è‡ªç„¶ä¹Ÿæœ‰, Org-mode æ˜¯è°ƒç”¨ Org-protocol åè®®ä½¿ç”¨çš„, è€Œæ’ä»¶ Org-protocol-capture-html æ˜¯å…¶ä¸­èƒ½ä½¿ Org-protocol æ”¶é›†çš„ç½‘é¡µæ›´åŠ ç¾è§‚å’Œå¯è§†åŒ–\nå› ä¸ºå¾ˆå¤šäººéƒ½ä¸ä¼šéƒ½ä¸ç†è§£ Org-protocol å’Œæ€ä¹ˆå»ä½¿ç”¨, ä»¥åŠOrg-protocol-capture-html, è¯´å¾—åªæ˜¯æ€ä¹ˆç”¨è¿™ä¸ªæ’ä»¶, å´æ²¡æœ‰è¯´æ€ä¹ˆé…ç½®, æ‰€ä»¥æ‰æœ‰äº†æœ¬æ•™ç¨‹.\nç›¸å…³é“¾æ¥  Org-protocol-capture-html å®˜ç½‘ Org-protocol åè®®å®˜ç½‘  æ•ˆæœå¦‚ä¸‹ æ•ˆæœå¦‚ä¸‹ğŸ‘‡ \nå®‰è£… Org-protocol-capture-html è¿™ä¸ªæ’ä»¶æ˜¯ä¸éœ€è¦é…ç½®, ç›´æ¥å®‰è£…æ­¤æ’ä»¶å°±å¯ä»¥è°ƒç”¨\nè¯·è‡ªå·±æŒ‰è£…æ­¤æ’ä»¶\n ä½¿ç”¨ use-package å®‰è£… æ‰‹åŠ¨å®‰è£…  é…ç½® Org-protocol-capture-html æ­¤æ’ä»¶æ˜¯è°ƒç”¨ org-capture åŠŸèƒ½, è¯·è‡ªè§‰æ£€æŸ¥å¦‚ä¸‹é…ç½®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  (server-start) ;; å¦‚æœä½ çŸ¥é“è¿™æ„å‘³ç€ä»€ä¹ˆï¼Œå¯ä»¥ä¸ä½¿ç”¨è¿™å¥ï¼Œ è¿™å¥æ˜¯ä¸ºäº†èƒ½è°ƒç”¨ emacsclientw (require \u0026#39;org-protocol) (require \u0026#39;s) ;;ä¾èµ– ;; å®‰è£… org-protocol-capture-html ;; å¦‚æœè·Ÿæˆ‘çš„ä¸åŒ, è¯·å°†ä¸‹é¢ä¸¤è¡Œåˆ é™¤ (add-to-list \u0026#39;load-path \u0026#34;~/.emacs.d/plugins/org-protocol-capture-html/\u0026#34;) ;; (require \u0026#39;org-protocol-capture-html) (setq org-capture-templates \u0026#39;( ;;Org-protocolç½‘é¡µæ”¶é›†, æŒ‰é”® w è°ƒç”¨ (\u0026#34;w\u0026#34; \u0026#34;ç½‘é¡µæ”¶é›†\u0026#34; entry (file \u0026#34;~/Org/ç½‘é¡µæ”¶é›†.org\u0026#34;) \u0026#34;* [[%:link][%:description]] \\n %U \\n %:initial \\n\u0026#34;) ))   ç³»ç»Ÿå®‰è£… org-protocol å¦‚æœä¸‹é¢çš„æ–¹æ³•æ— æ³•å®‰è£…, è¯·è§å®˜ç½‘ ğŸ‘‡\n å®˜ç½‘å®‰è£… org-protocol æ•™ç¨‹  Windows ç”¨æˆ·ğŸ‘‡  æ¡Œé¢æ–°å»º org-protocol.reg æ–‡ä»¶, ä½¿ç”¨ è®°äº‹æœ¬ è½¯ä»¶æ‰“å¼€ , å¹¶å°†ä»¥ä¸‹ğŸ‘‡ä»£ç æ”¾è¿›å»å¹¶ä¿å­˜, ç„¶åè¿è¡Œå®‰è£…å¹¶ç»™æƒé™ è¯·æŠŠä¸‹é¢çš„ emacsclientw.exe è·¯å¾„æ¢æˆä½ è‡ªå·±çš„è·¯å¾„  1 2 3 4 5 6 7 8 9  REGEDIT4 [HKEY_CLASSES_ROOT\\org-protocol] @=\u0026#34;URL:Org Protocol\u0026#34; \u0026#34;URL Protocol\u0026#34;=\u0026#34;\u0026#34; [HKEY_CLASSES_ROOT\\org-protocol\\shell] [HKEY_CLASSES_ROOT\\org-protocol\\shell\\open] [HKEY_CLASSES_ROOT\\org-protocol\\shell\\open\\command] @=\u0026#34;\\\u0026#34;C:\\\\Programme\\\\Emacs\\\\emacs\\\\bin\\\\emacsclientw.exe\\\u0026#34; \\\u0026#34;%1\\\u0026#34;\u0026#34;   Linux ç”¨æˆ·è¯·è§ ğŸ‘‰ Linux ä½¿ç”¨ org-protocl æ ¹æ®è‡ªå·±ä½¿ç”¨çš„æµè§ˆå™¨æ·»åŠ ä¹¦ç­¾ å…³äº org-protocol-capture-html å¯¹ä¸åŒçš„ æµè§ˆä¹¦ç­¾ è§\n Org-protocol-capture-html å®˜ç½‘  ä¾‹å¦‚ Chrome åœ¨ Chrome æ–°å»º ä¹¦ç­¾  ä¹¦ç­¾åç§°éšä¾¿å– ä¹¦ç­¾åœ°å€å¦‚ä¸‹ğŸ‘‡  1 2 3  javascript:location.href = \u0026#39;org-protocol:///capture-html?template=w\u0026amp;url=\u0026#39; + encodeURIComponent(location.href) + \u0026#39;\u0026amp;title=\u0026#39; + encodeURIComponent(document.title || \u0026#34;[untitled page]\u0026#34;) + \u0026#39;\u0026amp;body=\u0026#39; + encodeURIComponent(function () {var html = \u0026#34;\u0026#34;; if (typeof window.getSelection != \u0026#34;undefined\u0026#34;) {var sel = window.getSelection(); if (sel.rangeCount) {var container = document.createElement(\u0026#34;div\u0026#34;); for (var i = 0, len = sel.rangeCount; i \u0026lt; len; ++i) {container.appendChild(sel.getRangeAt(i).cloneContents());} html = container.innerHTML;}} else if (typeof document.selection != \u0026#34;undefined\u0026#34;) {if (document.selection.type == \u0026#34;Text\u0026#34;) {html = document.selection.createRange().htmlText;}} var relToAbs = function (href) {var a = document.createElement(\u0026#34;a\u0026#34;); a.href = href; var abs = a.protocol + \u0026#34;//\u0026#34; + a.host + a.pathname + a.search + a.hash; a.remove(); return abs;}; var elementTypes = [[\u0026#39;a\u0026#39;, \u0026#39;href\u0026#39;], [\u0026#39;img\u0026#39;, \u0026#39;src\u0026#39;]]; var div = document.createElement(\u0026#39;div\u0026#39;); div.innerHTML = html; elementTypes.map(function(elementType) {var elements = div.getElementsByTagName(elementType[0]); for (var i = 0; i \u0026lt; elements.length; i++) {elements[i].setAttribute(elementType[1], relToAbs(elements[i].getAttribute(elementType[1])));}}); return div.innerHTML;}()); javascript:location.href = \u0026#39;org-protocol:///capture-eww-readable?template=w\u0026amp;url=\u0026#39; + encodeURIComponent(location.href) + \u0026#39;\u0026amp;title=\u0026#39; + encodeURIComponent(document.title || \u0026#34;[untitled page]\u0026#34;);   Firefox å¦‚ä¸‹ åœ¨ Firefox æ–°å»º ä¹¦ç­¾  ä¹¦ç­¾åç§°éšä¾¿å– ä¹¦ç­¾åœ°å€å¦‚ä¸‹ğŸ‘‡  1  javascript:location.href = \u0026#39;org-protocol://capture-html?template=w\u0026amp;url=\u0026#39; + encodeURIComponent(location.href) + \u0026#39;\u0026amp;title=\u0026#39; + encodeURIComponent(document.title || \u0026#34;[untitled page]\u0026#34;) + \u0026#39;\u0026amp;body=\u0026#39; + encodeURIComponent(function () {var html = \u0026#34;\u0026#34;; if (typeof document.getSelection != \u0026#34;undefined\u0026#34;) {var sel = document.getSelection(); if (sel.rangeCount) {var container = document.createElement(\u0026#34;div\u0026#34;); for (var i = 0, len = sel.rangeCount; i \u0026lt; len; ++i) {container.appendChild(sel.getRangeAt(i).cloneContents());} html = container.innerHTML;}} else if (typeof document.selection != \u0026#34;undefined\u0026#34;) {if (document.selection.type == \u0026#34;Text\u0026#34;) {html = document.selection.createRange().htmlText;}} var relToAbs = function (href) {var a = document.createElement(\u0026#34;a\u0026#34;); a.href = href; var abs = a.protocol + \u0026#34;//\u0026#34; + a.host + a.pathname + a.search + a.hash; a.remove(); return abs;}; var elementTypes = [[\u0026#39;a\u0026#39;, \u0026#39;href\u0026#39;], [\u0026#39;img\u0026#39;, \u0026#39;src\u0026#39;]]; var div = document.createElement(\u0026#39;div\u0026#39;); div.innerHTML = html; elementTypes.map(function(elementType) {var elements = div.getElementsByTagName(elementType[0]); for (var i = 0; i \u0026lt; elements.length; i++) {elements[i].setAttribute(elementType[1], relToAbs(elements[i].getAttribute(elementType[1])));}}); return div.innerHTML;}());   äº«å—ä½¿ç”¨ ğŸ‘‡ ä½¿ç”¨ä¹‹å‰ è¯·æŠŠä½ çš„ Chrome æˆ–è€… Firefox çš„ ä¹¦ç­¾ å§‹ç»ˆå¯è§(æ¯”å¦‚åœ¨ä½ æµè§ˆç½‘é¡µé€‰ä¸­æ–‡å­—æ—¶å¯ä»¥ç‚¹å‡»ä½ çš„ä¹¦ç­¾)\nå¼€å§‹ä½¿ç”¨  æ‰“å¼€ Emacs ä½¿ç”¨æµè§ˆå™¨æµè§ˆç½‘é¡µ åœ¨ç½‘é¡µ é€‰æ‹©ä½ æƒ³æ”¶é›†çš„æ–‡æœ¬ ç‚¹å‡»ä½ åˆšæ‰æ–°å»ºçš„ä¹¦ç­¾, ç‚¹å‡»ç¡®å®šæˆæƒä¹‹ç±»çš„ å›åˆ° Emacs ä½ ä¼šçœ‹åˆ°ä½ å·²ç»æ”¶é›†åˆ°çš„ Capture è‡ªå·±è®°å¾—ä¿å­˜ ä½ æ”¶é›†åˆ°çš„ä¼š ä¿å­˜åˆ° ~/Org/ç½‘é¡µæ”¶é›†.org æ–‡ä»¶ä¸­(å› ä¸ºä¸Šé¢çš„é…ç½®ä¿å­˜åˆ°è¿™æ–‡ä»¶ï¼Œ è¯·æŒ‰è‡ªå·±éœ€æ±‚æ›´æ”¹)  å¦‚æœä½ æœ‰æ›´å¤šçš„éœ€æ±‚, è¯·è‡ªå·±å­¦ä¹ , å› ä¸ºç½‘ä¸Šå¹¶æ²¡æœ‰è¯¦ç»†çš„æ•™ç¨‹ä½¿ç”¨ org-protocol æ‰€ä»¥æ‰æœ‰äº†æœ¬æ•™ç¨‹ ç¥ä½ ä½¿ç”¨æ„‰å¿«ğŸ¤“âš¡ğŸ‘‰â™¥ï¸ğŸŒ¹\n","permalink":"http://isouthrain.github.io/post/2022-01-12-org-protocol-capture-html/","tags":["Emacs"],"title":"Org-mode ä½¿ç”¨ Org-protocol-capture-html ç½‘é¡µæ”¶é›†(Org-protocol ä½¿ç”¨)"},{"categories":["æŠ€æœ¯"],"contents":"å‰è¨€ è¿™ç¯‡æ–‡ç« å¹¶ä¸æ˜¯æƒ³å¼•æˆ˜, è€Œæ˜¯è¯•ç€å»è¯´æ˜è¿™ä¸¤è€…çš„åŒºåˆ«, ç„¶åæ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹© Vim è¿˜æ˜¯ Emacs Vin å’Œ Emacs å„æœ‰è‡ªå·±çš„ç‰¹ç‚¹, æˆ‘åªæƒ³æŠŠè¿™ä¸¤è€…çš„ç‰¹ç‚¹è¯´æ˜ä»¥ä¸‹, è®©è¯»è€…æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹© Vim è¿˜æ˜¯ Emacs\nç¼–è¾‘ä¹ æƒ¯   Vim åœ¨äºæŒ‰é”®çš„ç»„åˆ,æ¯”å¦‚ä½ å¯ä»¥é…ç½®ä»»ä½•æŒ‰é”®ç»„åˆå»è§¦å‘æŸäº›åŠ¨ä½œ,(e.g ä½ å¯ä»¥åœ¨ I æ¨¡å¼ é…ç½® jk å»è§¦å‘æŒ‰é”®  è¿›å…¥ N æ¨¡å¼,ç„¶åç›¸å½“äºä½ æ²¡æœ‰è¾“å…¥è¿‡ jk), è¿™åªæ˜¯ä¸€ä¸ªä¾‹å­,åæ­£ä½ èƒ½åšåˆ°å…¨éƒ¨Vim èƒ½åšçš„,ç”šè‡³è°ƒç”¨æ’ä»¶ä»¥åŠå‘½ä»¤.\n  Emacs åšä¸åˆ°ä¸Šé¢ä¾‹å­,Emacs æ˜¯é å‡½æ•°è§¦å‘çš„æˆ–è€…è¯´ä½ å¿…é¡» Ctrl+æ‰èƒ½å®ç°æŸäº›åŠŸèƒ½(ç±»ä¼¼Vim çš„ä¾‹å­), Emacs å°±æ˜¯ä¸€ä¸ª Elisp è¯­è¨€çš„è¿è¡Œå™¨, ä½ åšçš„æ¯ä¸€ä¸ªåŠ¨ä½œéƒ½æ˜¯åœ¨è§¦å‘æŸä¸ªå‡½æ•°(e.g Ctrl+n è§¦å‘ next-line å‡½æ•°å°†å…‰æ ‡ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œ)\n  åœ¨è¿™ä¸€ç‚¹ä¸Šæ˜¾ç„¶æ˜¯ Vim æ›´æ–¹ä¾¿,å› ä¸ºæŒ‰é”®ç»„åˆçœŸçš„éå¸¸å¥½ç”¨,è¿˜ä¸å½±å“è¾“å…¥,å¯¹äº Emacs å°±å¿…é¡»ç”¨ä¸¤ä¸ªæŒ‰é”®åŒæ—¶æŒ‰ä¸‹, è¿™éå¸¸éº»çƒ¦, æ‰€ä»¥åœ¨æŒ‰é”®ç»„åˆä¸­ Vim æœ‰ç€éå¸¸å¥½çš„ä¼˜åŠ¿, å› ä¸º Emacs è¦æŒ‰ Ctrl é”®, å·¦è¾¹å°æ‹‡æŒ‡çœŸçš„éš¾å—, ä¸è¿‡ Emacs ä¹Ÿæœ‰æ¨¡æ‹Ÿ Vim çš„æ’ä»¶, ä½†ä»…ä»…æ˜¯åªèƒ½æ¨¡æ‹Ÿæ§åˆ¶å…‰æ ‡å’Œä¸€äº›å‘½ä»¤, åšä¸åˆ°å¯ä»¥è®¾ç½®æŒ‰é”®ç»„åˆè§¦å‘æŸäº›åŠŸèƒ½!\n  Vim å’Œ Emacs è®¾ç½®ç†å¿µ   Vim ç±»ä¼¼ä¸€æŠŠçŸ­åˆ€, åªåšå¥½ä¸€ä»¶äº‹, ä»–ä»…ä»…æ˜¯ä¸€ä¸ªç¼–è¾‘å™¨\n  Emacs ç±»ä¼¼ä¸€ä¸ªæ­¦å™¨åº“, å¯ä»¥åšéå¸¸å¤šçš„äº‹, ä½†éƒ½ä¸ç²¾, Emacs æœ‰æ—¶å€™è¢«äººè¯´åšæ˜¯ä¸€ä¸ª ç¼–è¾‘å™¨ç³»ç»Ÿ æˆ‘ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æŒºç¬¦åˆçš„\n  æ€»ä¹‹ Emacs æ¯” Vim åšçš„äº‹å¤šå¾—å¤š, Emacs æ˜¯å¯ä»¥æŸ¥çœ‹å›¾ç‰‡çš„, è€Œä¸”ç°åœ¨ Emacs å·²ç»å‘å±•åˆ°é€šè¿‡æ’ä»¶å¯ä»¥åœ¨Emacsè¿›è¡Œç½‘é¡µæµè§ˆå’Œæ’­æ”¾è§†é¢‘äº† [ç±»ä¼¼ Chrome é‚£ç§æµè§ˆå™¨ ] (e.g EAF æ¡†æ¶)\n  Emacs çš„ä¸ªäººç¬”è®°ç®¡ç†   å¦‚æœä½ æœ‰å†™ç¬”è®°çš„ä¹ æƒ¯, é‚£ä¹ˆä½ ä¸€å®šå¬è¯´è¿‡ Markdown çš„è¯­æ³•, æˆ‘è¦è¯´çš„ä¸æ˜¯Markdown è€Œæ˜¯Emacså†…ç½®çš„ä¸€ä¸ªç¬”è®°ç³»ç»Ÿ Org-mode.\n  Org-mode åªæœ‰åœ¨ Emacs æœ‰ç€éå¸¸å¥½çš„ä½“éªŒ, è€Œåœ¨å…¶å®ƒç¼–è¾‘è½¯ä»¶åŸºæœ¬æ— æ³•å‘æŒ¥ org-mode çš„å¼ºå¤§\n  Org-mode çš„è¡¨æ ¼å¯ä»¥è¿ç®—, ä»£ç å—å¯ä»¥ç›´æ¥è¿›è¡Œè¿è¡Œå¹¶è¿”å›ç»“æœ, æ•è·(Capture)åŠŸèƒ½, GTDç®¡ç†ç³»ç»Ÿ(æ¯”å¦‚ æ—¥ç¨‹å®‰æ’(å¯ä»¥é‡å¤æé†’), TODO, è®¡æ—¶å™¨, å¯¼å‡ºä¸ºå…¶å®ƒæ ¼å¼)\n  æ‰€ä»¥è¯´, å¦‚æœä½ æ‰“ç®—ä½¿ç”¨ Emacs çœŸçš„éå¸¸å¤šä¼˜ç‚¹, org-mode æœ‰ç‚¹éš¾å­¦ä¹ (å’Œè®¾ç½®), å› ä¸ºä½¿ç”¨ org ä¹‹å‰ä½ çš„ä¼š Emacs ä»¥åŠ ELispè¯­è¨€åŸºç¡€\n  å¦‚ä½•é€‰æ‹© Vim å’Œ Emacs ? å¦‚æœä½ éœ€è¦å¾ˆå¤šçš„åŠŸèƒ½, å»ºè®®ä½ é€‰æ‹© Emacs , å› ä¸º Emacs æ˜¯å¯å‘å±•çš„, ä»¥åŠå¯ä»¥è¿è¡Œå›¾å½¢ç•Œé¢, ä½¿ GUI åŠŸèƒ½ åœ¨Emacsæˆä¸ºäº†å¯èƒ½\nVim åªèƒ½æŸ¥çœ‹æ–‡æœ¬ä¹‹ç±»çš„, å›¾ç‰‡è¿™äº›æ— æ³•å¤„ç†, åªèƒ½é€šè¿‡è°ƒç”¨ç¬¬ä¸‰æ–¹åº”ç”¨æ‰èƒ½å¤„ç†æŸ¥çœ‹ å¦‚æœä½ éå¸¸éœ€è¦ GTD ç³»ç»Ÿä¹‹ç±»çš„, é‚£ä¹ˆ Emacs æ˜¯ä¸äºŒæ™ºé€‰, å¦‚æœ ä½ åªæ˜¯éœ€è¦å‡ºæ¥æ–‡æœ¬çš„,é‚£ä¹ˆVimæ›´å¥½\nEmacs å¦‚æœä½ ä½¿ç”¨çš„éå¸¸å¥½, éå¸¸6, é‚£ä¹ˆä½ å°†éå¸¸ç‰›é€¼, è€Œä¸”æˆ‘ä¼°è®¡ä½ æœªæ¥æ—¶ä¸ä¼šå†æ›´æ¢ç¼–è¾‘å™¨äº†\næˆ‘ä¸ªäººæ˜¯ Vim \u0026mdash;\u0026gt; Emacs \u0026mdash;\u0026gt; Vim è¿˜æ˜¯å›åˆ°äº† Vim\n","permalink":"http://isouthrain.github.io/post/2021-12-27-vim%E5%92%8Cemacs%E7%9A%84%E9%80%89%E6%8B%A9/","tags":["Vim","Emacs","Neovim"],"title":"Vimå’ŒEmacsçš„é€‰æ‹©"},{"categories":["æŠ€æœ¯"],"contents":"æ¦‚è¿° ä½¿ç”¨ Vim æ¯å½“æˆ‘ä»¬åˆ‡æ¢ä¸­æ–‡è¾“å…¥æ—¶éƒ½è¦åˆ‡æ¢ä¸­è‹±æ–‡,è¿™éå¸¸ç¹çè¿˜å¥½æœ‰Vim æ’ä»¶äº†æ¥å¼¥è¡¥è¿™ä¸ªç¼ºç‚¹ è¿™ä¸ªæ’ä»¶å°±æ˜¯ ZFVimIM, è¿™æ’ä»¶æ”¯æŒäº‘è¾“å…¥(äº‘è¯åº“), éå¸¸çš„å¥½ç”¨, è€Œä¸”ä¸å½±å“ä½ ä½¿ç”¨ jk åˆ‡æ¢çš„åˆ° Normal æ¨¡å¼, é…ç½®ä¹Ÿéå¸¸ç®€å•\nå®‰è£… ZFVimIM å®‰è£…å¿…è¦æ’ä»¶ ä½¿ç”¨Vim Plug å®‰è£… 1 2 3 4  Plug \u0026#39;ZSaberLv0/ZFVimIM\u0026#39; Plug \u0026#39;ZSaberLv0/ZFVimJob\u0026#39; \u0026#34; å¯é€‰, ç”¨äºæå‡è¯åº“åŠ è½½æ€§èƒ½ Plug \u0026#39;ZSaberLv0/ZFVimIM_openapi\u0026#39; \u0026#34;äº‘è¯åº“ Plug \u0026#39;ZSaberLv0/ZFVimIM_pinyin\u0026#39; \u0026#34;dbæ–‡ä»¶   æˆ‘æ˜¯ä½¿ç”¨ Neovim ä»¥ä¸‹æ˜¯æˆ‘çš„é…ç½®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  \u0026#34; äº‘è¯åº“æ”¯æŒ let g:ZFVimIM_openapi_enable=1 \u0026#34; ä½¿ç”¨æœ¬åœ° db çš„é…ç½® function! s:zfvimim_init() abort let db = ZFVimIM_dbInit({\u0026#39;name\u0026#39; : \u0026#39;ä¸­æ–‡è¾“å…¥æ³•\u0026#39;}) call ZFVimIM_cloudRegister({ \\ \u0026#39;mode\u0026#39; : \u0026#39;local\u0026#39;, \\ \u0026#39;dbId\u0026#39; : db[\u0026#39;dbId\u0026#39;], \\ \u0026#39;repoPath\u0026#39; : expand(\u0026#39;~/.config/nvim/plugged/ZFVimIM_pinyin/misc/\u0026#39;), \u0026#34; è¯åº“è·¯å¾„,å°±æ˜¯æ”¾ä¸‹é¢ä¸¤ä¸ªæ–‡ä»¶çš„è·¯å¾„ \\ \u0026#39;dbFile\u0026#39; : \u0026#39;pinyin.txt\u0026#39;, \u0026#34; è¯åº“æ–‡ä»¶, ç›¸å¯¹ repoPath çš„è·¯å¾„ \\ \u0026#39;dbCountFile\u0026#39; : \u0026#39;pinyin_count.txt\u0026#39;, \u0026#34; éå¿…é¡», è¯é¢‘æ–‡ä»¶, ç›¸å¯¹ repoPath çš„è·¯å¾„ \\ }) endfunction augroup zfvim_conf autocmd! autocmd VimEnter * call s:zfvimim_init() augroup END   å®‰è£…åä½¿ç”¨  ;; å¼€å¯æˆ–å…³é—­è¾“å…¥æ³•, ;: åˆ‡æ¢è¯åº“ - å’Œ = ç¿»é¡µ ç©ºæ ¼ å’Œ 0~9 é€‰è¯æˆ–ç»„è¯ [ å’Œ ] å¿«é€Ÿä»è¯ç»„é€‰å­— è¾“å…¥è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨ç»„è‡ªé€ è¯, ä¹Ÿå¯ä»¥ç”¨ ;, æˆ– :IMAdd æ‰‹åŠ¨æ·»åŠ è‡ªé€ è¯, ;. æˆ– :IMRemove åˆ é™¤è‡ªé€ è¯ è§‰å¾—å¥½ç”¨, è®°å¾—ç»™å¼€å‘è€…ä¹°ä¸ªç…é¥¼, è´«ç©·ç å†œåœ¨çº¿ä¹è®¨ _(:Ğ·ã€âˆ )_  æ›´å¤šç»†èŠ‚è¯·åˆ°å®˜æ–¹ ZFVimIM\nå¦‚æœä½ è§‰å¾—å¥½ç”¨, å¸Œæœ›æ‚¨èƒ½ç»™å¼€å‘è€… ä¹°ä¸ªç…é¥¼ å¼€å‘è€…ä¸æ˜¯æˆ‘æœ¬äºº\n","permalink":"http://isouthrain.github.io/post/2021-12-26-vim%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%B3%95/","tags":["Vim","Neovim"],"title":"(Neo)Vim ä¸­è‹±æ–‡è¾“å…¥æ³•"},{"categories":["æŠ€æœ¯"],"contents":"æ¦‚è¿° åœ¨å¦‚ä»Šè¿™ä¸ªæ—¶ä»£æ¯ä¸ªäººéƒ½éœ€è¦åšç¬”è®°ï¼Œç”¨æ¥è®°å½•ä¸€äº›ç”Ÿæ´»çäº‹ï¼Œä»¥åŠä¸€äº›é‡è¦çš„äº‹æƒ…ï¼Œé¿å…å¿˜è®°ï¼Œ å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´\né‚£ä¹ˆç”¨ä»€ä¹ˆè½¯ä»¶è®°ç¬”è®°å‘¢?ä¸€ä¸ªå¥½çš„ç¬”è®°è½¯ä»¶å¯ä»¥å¿«é€Ÿè®©ç¬”è®°å¿«é€Ÿè®°å½•ã€‚\nç¬”è®°è½¯ä»¶ç›®å‰æœ€å¥½ç”¨çš„æ— éå°±æ˜¯é‚£å‡ ä¸ªï¼Œæ¯”å¦‚:\n Notion Obsidian Logseq Emacs Org-mode RoamResearch  æ¯ä¸ªç¬”è®°éƒ½æœ‰è‡ªå·±çš„ä¼˜ç¼ºç‚¹ï¼Œçœ‹è‡ªå·±çš„é€‰æ‹©ï¼Œä¸Šé¢è¿™å‡ æ¬¾é™¤äº† RoamResearch æ²¡ç”¨è¿‡ï¼Œå…¶ä»–çš„æˆ‘éƒ½æœ‰ç”¨è¿‡ï¼Œæ‰€ä»¥åœ¨æ­¤è®¨è®ºä¸‹ã€‚\nä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ï¼Œä»…ä¾›å‚è€ƒï¼Œæ— å®é™…æ„ä¹‰\nNotion Notion ä¼˜ç‚¹  å…è´¹ æ— é™Page å¤§é‡çš„æ¨¡æ¿æä¾›ä½¿ç”¨ éå¸¸çš„çµæ´» åˆ—è¡¨databaseçš„ä½¿ç”¨(e.g. ç±»ä¼¼ Excel çš„åˆ—è¡¨ï¼Œå¯ä»¥è‡ªåŠ¨è¿›è¡Œè¿ç®—) å…¨å¹³å°æ”¯æŒ(ä¸»è¦æ˜¯Webï¼ŒWindowï¼ŒMacOSï¼ŒLiuxï¼ŒAndroidï¼ŒIOS) Task ä½¿ç”¨ æ—¥ç¨‹çš„å®‰æ’(æœ‰æ—¥å†ï¼Œå¹¶è¿›è¡Œæé†’) æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªå—(éå¸¸æ–¹ä¾¿) å¯ä»¥è¿›è¡Œç®€å•çš„GTDç®¡ç† æ”¯æŒMarkdownè¯­æ³• æ‰€è§æ—¢æ‰€å¾— èƒ½å¯¼å‡º(Markdown,PDF,CSV) çº¯æ–‡æœ¬  Notion ç¼ºç‚¹  éƒ½æ˜¯éœ€è¦è”ç½‘çš„ï¼Œæ²¡æœ‰ç¦»çº¿ç‰ˆ(å¯ä»¥ç¦»çº¿ä½¿ç”¨ï¼Œè”ç½‘åè‡ªåŠ¨åŒæ­¥ï¼Œä½†æ˜¯ä¸Šä¼ å›¾ç‰‡ä¸è¡Œ) æ•°æ®éƒ½æ˜¯ä¿å­˜åœ¨Notionå®˜æ–¹é‡Œ å¯¼å‡ºåŠŸèƒ½å¯¹ä¸­æ–‡ä¸å‹å¥½(ä¸­æ–‡è·¯å¾„ä¹±ç )  å¯¹äº Notion ä¸ªäººå»ºè®® å¦‚æœä½ éœ€è¦ å¤šäººååŒå·¥ä½œ å’Œ åˆ—è¡¨æ•°æ®çš„è®¡ç®—ï¼ŒNotion å°†ä¼šå¾ˆé€‚åˆä½ \nå¦‚æœä½ éœ€è¦æŠŠèµ„æ–™æŒæ¡åœ¨æ‰‹äº†ï¼Œè€Œä¸”æ˜¯è®°å½•ä¸€äº›æ°¸ä¹…æ•°æ®ï¼Œä¸å»ºè®®ä½¿ç”¨\nè¿™äº›å…¬å¸ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å€’é—­ï¼Œå¦‚æœä½ æŠŠä¸€äº›æ°¸ä¹…ä¿å­˜çš„èµ„æ–™æ”¾ä¸Šå»å¾ˆä¸å¥½ï¼Œå¯¼å‡ºçš„æ—¶å€™å°±å¾ˆéš¾å—äº†\nä¸è¿‡ Notion è‡³å°‘å¯ä»¥ç†¬10å¹´ï¼Œå®åœ¨æ˜¯Notionå¤ªæ£’äº†, åŠŸèƒ½å¼ºå¤§ï¼Œç•Œé¢ç¾è§‚ï¼Œéå¸¸ä¸æ»‘ï¼Œä»¤äººä¸€ä¸Šæ‰‹å°±ä¸èˆå¾—ç¦»å¼€ï¼Œè¯·è°¨æ…ä½¿ç”¨\nObsidian Obsidian ä¼˜ç‚¹  å…è´¹ å…¨å¹³å°æ”¯æŒ(Windowï¼ŒMacOSï¼ŒLiuxï¼ŒAndroidï¼ŒIOS) æœ¬åœ°å­˜å‚¨(ä¹Ÿå¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„åœ¨çº¿å­˜å‚¨) æ”¯æŒMarkdownè¯­æ³• æ‰€è§å³æ‰€å¾—(Mobile ç«¯ç›®å‰æ²¡æœ‰å®ç°ï¼Œå°†æ¥å¯èƒ½å®ç°) ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€ ç¬”è®°åŒé“¾ å¯ä»¥é…åˆæ’ä»¶è¿›è¡Œç»˜å›¾ Gitè¿›è¡Œç‰ˆæœ¬ç®¡ç†(æ’ä»¶æä¾›) æ¨¡æ¿æ•è· é…ç½®å¯è¿ç§»ï¼Œå¤åˆ¶é…ç½®ç›®å½•å°±å¯ä»¥åœ¨å…¨å¹³å°ä½¿ç”¨  Obsidian ç¼ºç‚¹  æ²¡æœ‰åƒNotioné‚£æ ·çš„databaseä½¿ç”¨ è¡¨æ ¼çš„ç¼–è¾‘è¦å®‰è£…æ’ä»¶æ‰å‹‰å¼ºå¥½ç”¨ æ— æ³•è¿›è¡ŒGTDä½¿ç”¨ è¦å®‰è£…ä¸€äº›æ’ä»¶æ‰èƒ½ä½¿Obsidianæ›´å¥½ç”¨  å¯¹äº Obsidian ä¸ªäººå»ºè®® ä¸ªäººç›®å‰ä½¿ç”¨çš„æ˜¯Obsidianï¼Œå› ä¸ºé…åˆæ’ä»¶çš„ä½¿ç”¨çœŸçš„éå¸¸å¥½ç”¨ï¼Œè€Œä¸”å¯ä»¥æŒæ§è‡ªå·±çš„æ•°æ®ï¼Œæƒ³ä¿å­˜åœ¨é‚£å°±ä¿å­˜åœ¨å“ªã€‚\n å¦‚æœä½ éœ€è¦è‡ªå·±æŒæ§æ•°æ®çš„è¯è¿™æ¬¾æˆ‘è§‰å¾—æ˜¯æœ€å¥½çš„ï¼Œè™½ç„¶å°‘äº†databaseçš„ä½¿ç”¨ï¼Œä½†å¤§é‡çš„æ’ä»¶å¯èƒ½ä»¥åä¼šæœ‰äººåšå‡ºæ¥ å¦‚æœä½ ç»å¸¸éœ€è¦æ•è·æŸä¸ªæƒ³æ³•çš„è¯è¿™ä¸ªæŒºå¥½çš„ ç¼ºç‚¹çš„è¯å°±æ˜¯æ²¡æœ‰databaseäº†ï¼Œè‡ªå·±çœ‹è‡ªå·±éœ€æ±‚å§  ä»¥ä¸‹æ˜¯æˆ‘ä¸ªäººåœ¨Obsidianä½¿ç”¨çš„æ’ä»¶  Calender \u0026mdash; ç±»ä¼¼æ—¥å†ï¼Œç‚¹å‡»æ—¥å†çš„æŸå¤©ä¼šåˆ›å»ºå½“å¤©çš„ç¬”è®°(ç¬”è®°åæ˜¯å½“å¤©çš„æ—¥æœŸ) Advance Table \u0026mdash; è¡¨æ ¼çš„å¿«é€Ÿç¼–è¾‘ Dataview \u0026mdash; è¿™ä¸ªæŒºå¥½çš„ï¼Œç±»ä¼¼ä¸€ä¸ªæ•°æ®åº“ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„ç­›é€‰æ‰€æœ‰æ–‡ä»¶å’Œæƒ³è¦çš„è®°å½• Excaldram \u0026mdash; ç»˜å›¾æ’ä»¶ Mind Map \u0026mdash; ç±»ä¼¼æ€ç»´å¯¼å›¾ï¼Œè‡ªåŠ¨æŠŠå½“å‰ç¬”è®°å½¢æˆæ€ç»´å¯¼å›¾è§‚çœ‹ Kanban \u0026mdash; å°±æ˜¯çœ‹æ¿ Remember cursor position \u0026mdash; è®°å½•ä½ æŸ¥çœ‹ç¬”è®°çš„ä½ç½® Templater \u0026mdash; æ¨¡æ¿çš„æ•è·ï¼Œè¿™ä¸ªéœ€è¦è‡ªå·±çš„é…ç½® Dayplany \u0026mdash; æŸ¥çœ‹è‡ªå·±çš„ä»»åŠ¡æ—¶é—´çº¿  Emacs Org-mode å¤§åé¼é¼çš„Emacsï¼ŒOrg-modeæ˜¯çœŸçš„éå¸¸å¼ºå¤§ï¼ŒOrg-modeç±»ä¼¼Markdownä¹Ÿæ˜¯ä¸€ç§è¯­æ³•ï¼ŒOrg-modeå¯ä»¥åšGTDç®¡ç†ä¸ªäººçš„ä»»åŠ¡\nOrg-modeçš„å¼ºå¤§æ˜¯èƒŒé Emacsçš„ç”Ÿæ€ï¼Œç¼ºç‚¹ä¹Ÿå› ä¸ºæ˜¯èƒŒé Emacséš¾ä»¥åœ¨å…¶ä»–åœ°æ–¹å¾ˆå¥½çš„ä½¿ç”¨\nå¦‚æœä½ å–œæ¬¢æŠ˜è…¾ï¼Œé‚£ä¹ˆOrg-modeçœŸçš„æ˜¯éå¸¸å¥½çš„ï¼Œä¸è¿‡å­¦ä¹ Org-modeä¹‹å‰ä½ å°±è¦ä¼šç®€å•ä½¿ç”¨Emacs\nå¦‚æœä½ æ˜¯æ™®é€šäººï¼Œå¯ä»¥å¿½ç•¥Org-modeï¼Œå› ä¸ºOrg-modeæ˜¯çœŸçš„éš¾ä»¥ç†Ÿç»ƒï¼Œå› ä¸ºä½ è¦é…ç½®Emacså’ŒOrg-modeçš„æ’ä»¶ï¼Œå¹¶ä¸”org-modeåªæœ‰åœ¨Emacsæœ‰æ¯”è¾ƒå¥½çš„ä½“éªŒï¼Œå½“ç„¶å¦‚æœä½ çœŸçš„ä¼šäº†ä½ å°±ä¼šçœ‹ä¸ä¸Šå…¶ä»–çš„äº†ã€‚å…¶ä»–ç¬”è®°èƒ½åšçš„ï¼ŒOrg-modeä¹Ÿèƒ½åšï¼Œå…¶ä»–ç¬”è®°ä¸èƒ½åšçš„ï¼ŒOrg-modeä¹Ÿèƒ½åš\nOrg-mode ä¼˜ç‚¹  å…¨å¹³å°æ”¯æŒ(Windowï¼ŒMacOSï¼ŒLiuxï¼Œæ²¡æœ‰Androidï¼ŒIOSã€‚Androidå¯ä»¥åœ¨Termuxä½¿ç”¨) GTDç®¡ç†(æ—¥ç¨‹ï¼ŒTasks) \u0026mdash; è¿™æ–¹é¢çœŸçš„å¾ˆå¼ºå¾ˆå¼ºå¾ˆå¼º è¡¨æ ¼å¯ä»¥è‡ªå·±ä½¿ç”¨ç®—æ³•è¿›è¡Œè®¡ç®— æ–‡æœ¬ç¼–ç¨‹(å¯ä»¥ç›´æ¥æ‰§è¡Œä»£ç å¹¶è¿”å›ç»“æœ) çº¯æ–‡æœ¬ ä¸°å¯Œçš„ç”Ÿæ€æ’ä»¶ åŒé“¾(æ’ä»¶ Org-Roam æä¾›) ä¸ä¼šè½ä¼ï¼Œå› ä¸ºEmacsæ˜¯å¯æ‰©å±•çš„ï¼ŒåƒåŒé“¾ä¸€æ ·Org-modeæ˜¯æ²¡æœ‰åŒé“¾çš„ï¼Œæ˜¯ç”±å¼€æºç¤¾åŒºçš„äººå¼€å‘çš„æ’ä»¶è¡¥ä¸Šçš„ åŠ å¯†æ–‡æœ¬ æ•è·æ¨¡æ¿(å¯èƒ½æ˜¯åœ¨ç¬”è®°è½¯ä»¶ä¸­åŠŸèƒ½æœ€å¼ºå¤§å’ŒåŠŸèƒ½æœ€å…¨å¾—äº†) å¯¼å‡ºåŠŸèƒ½å¥½(PDF,html,Latx,Markdown)  Org-mode ç¼ºç‚¹  ç§»åŠ¨ç«¯æ²¡æœ‰å¥½çš„ä½“éªŒ åªåœ¨Emacsæœ‰å¥½çš„ä½“éªŒ  å¯¹äºEmacs Org-mode ä¸ªäººå»ºè®® å¦‚æœä½ éœ€è¦åœ¨ç§»åŠ¨ç«¯ä½¿ç”¨å°±ä¸å»ºè®®äº†ï¼Œç”µè„‘çš„ä¼šæ˜¯éå¸¸å¥½çš„ä½“éªŒ\nä½†æ˜¯å°†æ¥ä¼šä¸ä¼šå®Œç¾çš„è¿ç§»åˆ°ç§»åŠ¨ç«¯ä¸å¥½è¯´ å¼ºå¤§çš„äººä¼šéå¸¸é€‚åˆï¼Œä¼šæ”¶ç›Šç»ˆèº«çš„ï¼Œå› ä¸ºä½ ä»¥åä¸ä¼šå†æ‰¾å…¶ä»–ç¬”è®°è½¯ä»¶äº†\nLogseq Logseq ä¼˜ç‚¹  æ”¯æŒOrg-modeï¼ŒMarkdownè¯­æ³• Windowsï¼ŒMacOSï¼ŒLinux ç§»åŠ¨ç«¯(æ­£åœ¨å¼€å‘) åŒé“¾  å¯¹äº Logseq ä¸ªäººå»ºè®® ç”±äºä¸ªäººå¹¶æ²¡æœ‰æ·±å…¥ä½¿ç”¨ï¼Œä¸è¿‡å¤šè¯„ä»·ï¼Œä¸è¿‡çœ‹è§å¾ˆå¤šäººéƒ½è¯´å¥½ï¼Œä¼°è®¡æ˜¯ä¸é”™çš„ï¼Œå› ä¸ºLogseqå’ŒNotionï¼ŒObsidianï¼ŒEmacså¯ä»¥ç›¸äº’å¯¹æ¯”çš„\nRoamResearch æœ€è¿‘éå¸¸çƒ­é—¨ï¼Œæœ¬äººæ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œå› ä¸ºä»˜è´¹çš„ï¼Œå¬è¯´åŒé“¾ä¹‹ç±»çš„åšçš„å¾ˆå¥½ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸‹\næ€»ç»“ å¸Œæœ›å¤§å®¶æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©ï¼Œæœ¬äººåªæ˜¯ç»™å‡ºä¸€äº›åŠŸèƒ½å‚è€ƒ\n","permalink":"http://isouthrain.github.io/post/2021-12-25-%E7%AC%94%E8%AE%B0%E8%BD%AF%E4%BB%B6%E7%9A%84%E9%80%89%E6%8B%A9/","tags":["Emacs","ç¬”è®°"],"title":"Notion,Obsidian,Org-mode,Logseq,RoamResearch,ç¬”è®°è½¯ä»¶çš„é€‰æ‹©"},{"categories":["Javaç¼–ç¨‹","MyBatisç³»åˆ—"],"contents":"ç®€å•è®°å½•ä¸‹å¦‚ä½•åœ¨MyBatisä¸­æ’å…¥JSONï¼Œä»¥å¤‡å‚è€ƒã€‚\nåŸºæœ¬ä¿¡æ¯ å®Œæ•´ä»£ç å‚è§spring-mybatis-exampleï¼Œæ ¸å¿ƒä»£ç ä¸ºJsonNodeTypeHandleré…ç½®ç±»ã€‚\né¡¹ç›®ç»“æ„ è¡¨ç»“æ„ 1 2 3 4 5 6  CREATETABLE`user_info`(`id`int(11)NOTNULLAUTO_INCREMENT,`name`varchar(100)COLLATEutf8_binNOTNULL,`info`jsonNOTNULL,PRIMARYKEY(`id`))ENGINE=InnoDBDEFAULTCHARSET=utf8COLLATE=utf8_bin  pomæ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;project xmlns=\u0026#34;http://maven.apache.org/POM/4.0.0\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\u0026#34;\u0026gt; \u0026lt;modelVersion\u0026gt;4.0.0\u0026lt;/modelVersion\u0026gt; \u0026lt;groupId\u0026gt;com.lucumt\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-mybatis-test\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0-SNAPSHOT\u0026lt;/version\u0026gt; \u0026lt;name\u0026gt;SpringTest\u0026lt;/name\u0026gt; \u0026lt;url\u0026gt;https://lucumt.info\u0026lt;/url\u0026gt; \u0026lt;properties\u0026gt; \u0026lt;project.build.sourceEncoding\u0026gt;UTF-8\u0026lt;/project.build.sourceEncoding\u0026gt; \u0026lt;maven.compiler.source\u0026gt;1.8\u0026lt;/maven.compiler.source\u0026gt; \u0026lt;maven.compiler.target\u0026gt;1.8\u0026lt;/maven.compiler.target\u0026gt; \u0026lt;spring.boot.version\u0026gt;2.7.3\u0026lt;/spring.boot.version\u0026gt; \u0026lt;/properties\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.mybatis.spring.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mybatis-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.2\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;mysql\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;mysql-connector-java\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;8.0.30\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;${spring.boot.version}\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-test\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;${spring.boot.version}\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-web\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;${spring.boot.version}\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.junit.platform\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;junit-platform-launcher\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.9.0\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.18.24\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;provided\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.fasterxml.jackson.core\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;jackson-databind\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.13.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; \u0026lt;/project\u0026gt;   æ¨¡å‹ç±» 1 2 3 4 5 6 7 8 9 10 11  @Data @AllArgsConstructor @NoArgsConstructor public class UserModel { private Integer id; private String name; private JsonNode info; }   Handlerç±» 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69  @MappedTypes(JsonNode.class) public class JsonNodeTypeHandler extends BaseTypeHandler\u0026lt;JsonNode\u0026gt; { /** * è®¾ç½®éç©ºå‚æ•° * * @param ps * @param i * @param parameter * @param jdbcType * @throws SQLException */ @Override public void setNonNullParameter(PreparedStatement ps, int i, JsonNode parameter, JdbcType jdbcType) throws SQLException { ps.setString(i, parameter.toString()); } /** * æ ¹æ®åˆ—åï¼Œè·å–å¯ä»¥ä¸ºç©ºçš„ç»“æœ * * @param rs * @param columnName * @return * @throws SQLException */ @Override public JsonNode getNullableResult(ResultSet rs, String columnName) throws SQLException { String sqlJson = rs.getString(columnName); return getResultFromJSON(sqlJson); } /** * æ ¹æ®åˆ—ç´¢å¼•ï¼Œè·å–å¯ä»¥ä¸ºå†…æ§çš„æ¥å£ * * @param rs * @param columnIndex * @return * @throws SQLException */ @Override public JsonNode getNullableResult(ResultSet rs, int columnIndex) throws SQLException { String sqlJson = rs.getString(columnIndex); return getResultFromJSON(sqlJson); } /** * @param cs * @param columnIndex * @return * @throws SQLException */ @Override public JsonNode getNullableResult(CallableStatement cs, int columnIndex) throws SQLException { String sqlJson = cs.getNString(columnIndex); return getResultFromJSON(sqlJson); } private JsonNode getResultFromJSON(String sqlJson) { if (sqlJson == null) { return null; } try { return new ObjectMapper().readTree(sqlJson); } catch (JsonProcessingException e) { throw new RuntimeException(e); } } }   é…ç½®æ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  server:port:8081logging:level:root:infospring:datasource:driver-class-name:com.mysql.cj.jdbc.Driverurl:jdbc:mysql://10.10.2.98:3316/db_test?serverTimezone=UTC\u0026amp;useUnicode=true\u0026amp;characterEncoding=utf-8username:rootpassword:654321mybatis:mapper-locations:classpath:mapper/*.xmlconfiguration:map-underscore-to-camel-case:truetype-aliases-package:com.lucumt.model,com.lucumt.votype-handlers-package:com.lucumt.handler.mybatis  Mapperç±» 1 2 3 4 5 6 7 8  public interface UserMapper { void addUser(UserModel userModel); UserModel findById(Integer id); void deleteUser(Integer id); }   Mapperæ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.lucumt.mapper.UserMapper\u0026#34;\u0026gt; \u0026lt;select id=\u0026#34;findById\u0026#34; parameterType=\u0026#34;Integer\u0026#34; resultType=\u0026#34;userModel\u0026#34;\u0026gt; SELECT id,name,info FROM user_info WHERE id=#{id} \u0026lt;/select\u0026gt; \u0026lt;insert id=\u0026#34;addUser\u0026#34; parameterType=\u0026#34;userModel\u0026#34; useGeneratedKeys=\u0026#34;true\u0026#34; keyProperty=\u0026#34;id\u0026#34; keyColumn=\u0026#34;id\u0026#34;\u0026gt; INSERT INTO user_info(name,info) VALUES (#{name},#{info}) \u0026lt;/insert\u0026gt; \u0026lt;delete id=\u0026#34;deleteUser\u0026#34; parameterType=\u0026#34;Integer\u0026#34;\u0026gt; DELETE FROM user_info WHERE id= #{id} \u0026lt;/delete\u0026gt; \u0026lt;/mapper\u0026gt;   Serviceç±» 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  @Service public class UserService { @Autowired private UserMapper userMapper; public void addUser(UserModel userModel) { userMapper.addUser(userModel); } public UserModel getUser(Integer id) { return userMapper.findById(id); } public void deleteUser(Integer id) { userMapper.deleteUser(id); } }   æµ‹è¯• æµ‹è¯•ç±» 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43  @SpringBootTest @TestMethodOrder(MethodOrderer.OrderAnnotation.class) public class TestUserService { @Autowired private UserService userService; private static Integer userId; @Order(1) @Test public void testAddUser() throws JsonProcessingException { String time = LocalDateTime.now().format(DateTimeFormatter.ofPattern(\u0026#34;yyyy-MM-dd_HH:mm:ss:SSS\u0026#34;)); String info = \u0026#34;{\\\u0026#34;city\\\u0026#34;:\\\u0026#34;beijing\\\u0026#34;,\\\u0026#34;location\\\u0026#34;:\\\u0026#34;jiuxianqiao__\u0026#34; + time + \u0026#34;\\\u0026#34;,\\\u0026#34;skills\\\u0026#34;:[\\\u0026#34;Java\\\u0026#34;,\\\u0026#34;Golang\\\u0026#34;,\\\u0026#34;Python\\\u0026#34;]}\u0026#34;; ObjectMapper mapper = new ObjectMapper(); JsonNode node = mapper.readTree(info); UserModel userModel = new UserModel(); userModel.setName(\u0026#34;lucumt\u0026#34;); userModel.setInfo(node); userService.addUser(userModel); userId = userModel.getId(); assertTrue(userId \u0026gt; 0); } @Order(2) @Test public void testGetUser() { UserModel user = userService.getUser(userId); JsonNode info = user.getInfo(); assertNotNull(info); System.out.println(info); } @Order(3) @Test public void testDeleteUser() { userService.deleteUser(userId); } }   æµ‹è¯•ç»“æœ ","permalink":"http://isouthrain.github.io/post/mybatis/insert-json-data-in-mybatis/","tags":["Java","MyBatis"],"title":"MyBatisä¸­æ’å…¥JSONæ ¼å¼æ•°æ®"},{"categories":["Javaç¼–ç¨‹"],"contents":"åœ¨å¤šç§æ–¹å¼å®ç°åœ¨Javaä¸­ç”¨çº¿ç¨‹è½®æµæ‰“å°ABCä¸­è‡ªå·±æœ¬æƒ³ç”¨å•ä¸ªé”é€šè¿‡è°ƒç”¨wait()å®ç°è½®æµæ‰“å°ï¼Œä½†ä¸€ç›´é‡åˆ°å…¨éƒ¨ç­‰å¾…å¹¶åœæ­¢æ‰§è¡Œçš„æ­»é”é—®é¢˜ï¼Œç»è¿‡ç½‘ä¸Šæ±‚åŠ©å’Œè‡ªå·±åˆ†æï¼Œæœ€ç»ˆæ‰¾åˆ°é—®é¢˜åŸå› ï¼Œç®€å•è®°å½•ä¸‹ã€‚\nåŸå§‹ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48  public class ThreadPrint4Test { public static void main(String[] args) { new ThreadPrint4Test().testPrint(); } public void testPrint() { Object lock = new Object(); new Thread(new PrintThread(\u0026#34;A\u0026#34;,lock),\u0026#34;thread-A\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;B\u0026#34;,lock),\u0026#34;thread-B\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;C\u0026#34;,lock),\u0026#34;thread-C\u0026#34;).start(); try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new RuntimeException(e); } new Thread(() -\u0026gt; { synchronized (lock) { lock.notifyAll(); } }).start(); } class PrintThread implements Runnable { private Object lock; private String value; public PrintThread(String value, Object lock) { this.value = value; this.lock = lock; } public void run() { while (true) { try { synchronized (lock) { lock.wait(); System.out.println(LocalTime.now() + \u0026#34;\\t\u0026#34; + value); lock.notifyAll(); } } catch (InterruptedException e) { throw new RuntimeException(e); } } } } }   æ‰§è¡Œç»“æœ\u0026amp;çŠ¶æ€æŸ¥çœ‹ è¿è¡Œä¸Šè¿°ç¨‹åºï¼Œå¯å‘ç°åœ¨è¾“å‡ºè‹¥å¹²å­—ç¬¦åï¼Œç¨‹åºå¤„äºé˜»å¡çŠ¶æ€ï¼Œè¾“å‡ºåœæ­¢ï¼š\nåˆ©ç”¨jpså’Œjstackå‘½ä»¤æŸ¥çœ‹ï¼Œå¯å‘ç°3ä¸ªè¿›ç¨‹éƒ½å¤„äºWAITINGçŠ¶æ€å½¢æˆç±»ä¼¼æ­»é”çš„ç°è±¡ï¼Œç”±æ­¤å¯¼è‡´ç¨‹åºåœæ­¢è¾“å‡ºã€‚\nç”±äºå¤šæ¬¡è¿è¡Œä¸Šè¿°ä»£ç ï¼Œå‡èƒ½å‡ºç°æ­¤é—®é¢˜(åªä¸è¿‡å‡ºç°çš„æ—¶é—´é—´éš”ä¸åŒ)ï¼Œå¯çŸ¥ç¨‹åºä»£ç è‚¯å®šç¼–å†™ä¸æ­£ç¡®ã€‚\nåŸå› åˆ†æ æœ€å¼€å§‹æ£€æŸ¥ä»£ç æ—¶çœ‹èµ·æ¥ä¸€åˆ‡æ­£å¸¸:\n æŸçº¿ç¨‹é¦–å…ˆé€šè¿‡wait()è¿›å…¥ç­‰å¾…çŠ¶æ€ åªæœ‰è¢«å”¤é†’åæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œè¾“å‡ºä»£ç  è¾“å‡ºå®Œæ¯•åé€šè¿‡notifyAll() è¢«notifyAll()å”¤é†’çš„çº¿ç¨‹ä»æ­¥éª¤2å¼€å§‹å¾€ä¸‹æ‰§è¡Œ ä¹‹åè¯¥çº¿ç¨‹è°ƒç”¨wait()è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œé‡å¤æ­¥éª¤1å®ç°ä¸é—´æ–­çš„æ‰“å°  1 2 3 4 5 6 7 8 9 10 11 12 13  public void run() { while (true) { try { synchronized (lock) { lock.wait(); System.out.println(LocalTime.now() + \u0026#34;\\t\u0026#34; + value); lock.notifyAll(); } } catch (InterruptedException e) { throw new RuntimeException(e); } } }   ä¸Šè¿°æ¨ç†ä¸ä»£ç çœ‹èµ·æ¥å¾ˆå®Œç¾ï¼Œæ— æ‡ˆå¯å‡»ï¼Œä½†ç¨‹åºæ‰§è¡Œæ—¶å°±æ˜¯æ¯æ¬¡éƒ½ä¸èƒ½ä¸€ç›´æ‰“å°ä¸‹å»ï¼Œè‚¯å®šæ˜¯è‡ªå·±çš„ç†è§£æœ‰é—®é¢˜ã€‚\nä¸ºäº†ä¾¿äºå®šä½é—®é¢˜ï¼Œå°†run()æ–¹æ³•ä¿®æ”¹ä¸ºå¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  public void run() { while (true) { try { synchronized (lock) { String name = Thread.currentThread().getName(); System.out.println(name + \u0026#34;\\t\u0026#34; + LocalTime.now() + \u0026#34;\\t\u0026#34; + \u0026#34; will invoke wait\u0026#34;); lock.wait(); System.out.println(name + \u0026#34;\\t\u0026#34; + LocalTime.now() + \u0026#34;\\t\u0026#34; + \u0026#34; is notified\u0026#34;); System.out.println(name + \u0026#34;\\t\u0026#34; + LocalTime.now() + \u0026#34;\\t\u0026#34; + value); lock.notifyAll(); } } catch (InterruptedException e) { throw new RuntimeException(e); } } } }   ä¹‹åå¤šæ¬¡é‡æ–°æ‰§è¡Œè¯¥ç¨‹åºï¼Œæ‰§è¡Œç»“æœç±»ä¼¼å¦‚ä¸‹ï¼š\nä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºä¸­æ— æ³•æ‰¾å‡ºå…·ä½“çš„é—®é¢˜å¤ç°è§„å¾‹ï¼ŒæŸ¥çœ‹wait()çš„å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰å¦‚ä¸‹è¯´æ˜\n The current thread must own this object\u0026rsquo;s monitor. The thread releases ownership of this monitor and waits until another thread notifies threads waiting on this object\u0026rsquo;s monitor to wake up either through a call to the notify method or the notifyAll method. The thread then waits until it can re-obtain ownership of the monitor and resumes execution.\n æŸ¥çœ‹notifyAll()çš„å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰å¦‚ä¸‹è¯´æ˜ï¼š\n The awakened threads will not be able to proceed until the current thread relinquishes the lock on this object. The awakened threads will compete in the usual manner with any other threads that might be actively competing to synchronize on this object;\n ä»ä¸Šè¿°è¯´æ˜ä¸­å¯è·å¾—å¦‚ä¸‹ä¿¡æ¯ï¼š\n è°ƒç”¨wait()æ–¹æ³•åï¼Œç¨‹åºä¼šå¤„äºç­‰å¾…çŠ¶æ€ï¼ŒåŒæ—¶é‡Šæ”¾é” è¢«notifyAll()å”¤é†’çš„çº¿ç¨‹å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œéœ€è¦ç­‰å½“å‰è°ƒç”¨notifyAll()çš„çº¿ç¨‹é‡Šæ”¾å¯¹åº”çš„é” è¢«notfiyAll()å”¤é†’çš„çº¿ç¨‹éœ€è¦ä¸å…¶å®ƒæ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ä¸€å¹¶å»ç«äº‰è·å–é”ï¼Œå¹¶æ²¡æœ‰åŒºåˆ«å¯¹å¾…  è‡³æ­¤ï¼Œå¯ä»¥å¤§è‡´æ‰¾å‡ºé—®é¢˜åŸå› \n ä¸‰ä¸ªçº¿ç¨‹åœ¨æŸä¸ªæ—¶é—´æ®µå…ˆåè°ƒç”¨äº†wait()æ–¹æ³•éƒ½è¿›å…¥äº†WAITINGçŠ¶æ€ï¼ŒåŒæ—¶æ²¡æœ‰å…¶å®ƒçº¿ç¨‹æ¥å”¤é†’å®ƒä»¬ï¼Œå¯¼è‡´æœ€ç»ˆç¨‹åºåœæ­¢è¾“å‡ºã€‚\n ä»¥çº¿ç¨‹Aé€ æˆæ­»é”ä¸ºä¾‹ï¼Œå…¶è¿‡ç¨‹å¦‚ä¸‹:\n çº¿ç¨‹Aè°ƒç”¨wait()æ–¹æ³•è¿›å…¥WAITINGçŠ¶æ€å¹¶é‡Šæ”¾é” çº¿ç¨‹Bè·å¾—é”ï¼Œè¿›å…¥synchronizedä»£ç å— çº¿ç¨‹Bæ‰§è¡Œwait()æ–¹æ³•è¿›è¡ŒWAITINGçŠ¶æ€å¹¶é‡Šæ”¾é” çº¿ç¨‹Cè·å¾—é”ï¼Œè¿›å…¥synchronizedä»£ç å— çº¿ç¨‹Cæ‰§è¡Œwait()æ–¹æ³•è¿›è¡ŒWAITINGçŠ¶æ€å¹¶é‡Šæ”¾é” è‡³æ­¤çº¿ç¨‹Aã€çº¿ç¨‹Bã€çº¿ç¨‹Cå‡å¤„äºWAITINGçŠ¶æ€ï¼Œç¨‹åºåœæ­¢è¾“å‡º  å›¾ç¤ºè¯´æ˜å¦‚ä¸‹ï¼š\næ”¹è¿›ä»£ç  æ‰¾åˆ°é—®é¢˜åŸå› åï¼Œè¦ä¿®å¤æ­¤é—®é¢˜ä¹Ÿå¾ˆå®¹ï¼Œåªéœ€è¦é¿å…æ‰€æœ‰çš„çº¿ç¨‹åŒæ—¶è°ƒç”¨wait()æ–¹æ³•å³å¯ï¼Œå¯åœ¨è°ƒç”¨wait()å‰åŠ ä¸ªåˆ¤æ–­ï¼Œç¡®ä¿å§‹ç»ˆæœ‰ä¸€ä¸ªçº¿ç¨‹ä¸ç”¨è¿›å…¥WAITINGçŠ¶æ€ï¼Œèƒ½å¤Ÿé‡Šæ”¾é”ã€‚\næ¶ˆé™¤æ­»å¾ªç¯ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54  public class ThreadPrint4Test { public static void main(String[] args) { new ThreadPrint4Test().testPrint(); } private volatile String runThread; public void testPrint() { Object lock = new Object(); new Thread(new PrintThread(\u0026#34;A\u0026#34;, lock), \u0026#34;thread-A\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;B\u0026#34;, lock), \u0026#34;thread-B\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;C\u0026#34;, lock), \u0026#34;thread-C\u0026#34;).start(); try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { throw new RuntimeException(e); } new Thread(() -\u0026gt; { synchronized (lock) { lock.notifyAll(); } }).start(); } class PrintThread implements Runnable { private Object lock; private String value; public PrintThread(String value, Object lock) { this.value = value; this.lock = lock; } public void run() { while (true) { try { synchronized (lock) { boolean process = value.equals(runThread); if (!process) { lock.wait(); System.out.println(LocalTime.now() + \u0026#34;\\t\u0026#34; + value); runThread = value; } lock.notifyAll(); } } catch (InterruptedException e) { throw new RuntimeException(e); } } } } }   å®ç°è½®æµæ‰“å° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51  public class ThreadPrint4Test { public static void main(String[] args) { new ThreadPrint4Test().testPrint(); } private volatile int count = 0; public void testPrint() { Object lock = new Object(); new Thread(new PrintThread(\u0026#34;A\u0026#34;, lock), \u0026#34;thread-A\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;B\u0026#34;, lock), \u0026#34;thread-B\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;C\u0026#34;, lock), \u0026#34;thread-C\u0026#34;).start(); } class PrintThread implements Runnable { private Object lock; private String value; public PrintThread(String value, Object lock) { this.value = value; this.lock = lock; } public void run() { while (true) { try { synchronized (lock) { boolean process = \u0026#34;A\u0026#34;.equals(value) \u0026amp;\u0026amp; count % 3 == 0; if (process) { count = 0; } process = process || (\u0026#34;B\u0026#34;.equals(value) \u0026amp;\u0026amp; count % 3 == 1); process = process || (\u0026#34;C\u0026#34;.equals(value) \u0026amp;\u0026amp; count % 3 == 2); if (process) { lock.wait(); System.out.println(value); count++; Thread.sleep(500); } lock.notifyAll(); } } catch (InterruptedException e) { throw new RuntimeException(e); } } } } }   ","permalink":"http://isouthrain.github.io/post/java-concurrency/analysis-deadlock-in-multiple-threads-caused-by-wait/","tags":["Java","Java Concurrency"],"title":"ä¸€æ¬¡ç”±waité€ æˆçš„æ­»é”é—®é¢˜åˆ†æ"},{"categories":["Javaç¼–ç¨‹"],"contents":"åœ¨Javaä¸­é‡‡ç”¨3ä¸ªçº¿ç¨‹ä¸åœçš„è½®æµæ‰“å°ABCè¿™3ä¸ªå­—ç¬¦ï¼Œé‡‡ç”¨ä¸åŒçš„æ–¹å¼å®ç°ã€‚\nåŸç†åˆ†æ å®ç°æ€è·¯å¦‚ä¸‹ï¼š\n è¦åœ¨ä¸€ä¸ªwhileå¾ªç¯ä¸­ï¼Œå®ç°ä¸åœçš„æ‰“å° å¤šä¸ªçº¿ç¨‹é—´éœ€è¦ä¾æ¬¡å”¤é†’ä¸‹ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ç°ä¾æ¬¡æ‰“å°ï¼Œæ­¤æ—¶ä¼šå½¢æˆæ­»å¾ªç¯ ä¸ºäº†æ‰“ç ´æ­»å¾ªç¯ï¼Œè¿˜éœ€è¦ä¸€ä¸ªå¯åŠ¨çº¿ç¨‹å»¶åè°ƒç”¨  ä»£ç å®ç° åŸºäºwait\u0026amp;notify 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56  public class ThreadPrint1Test { public static void main(String[] args) { new ThreadPrint1Test().testPrint(); } public void testPrint() { Object lockA = new Object(); Object lockB = new Object(); Object lockC = new Object(); new PrintThread(\u0026#34;A\u0026#34;, lockA, lockB).start(); new PrintThread(\u0026#34;B\u0026#34;, lockB, lockC).start(); new PrintThread(\u0026#34;C\u0026#34;, lockC, lockA).start(); try { Thread.sleep(500); } catch (InterruptedException e) { throw new RuntimeException(e); } new Thread(() -\u0026gt; { synchronized (lockA) { lockA.notify(); } }).start(); } class PrintThread extends Thread { private Object waitLock; private Object notifyLock; private String value; public PrintThread(String value, Object waitLock, Object notifyLock) { this.value = value; this.waitLock = waitLock; this.notifyLock = notifyLock; } public void run() { while (true) { synchronized (waitLock) { try { waitLock.wait(); Thread.sleep(500); System.out.println(value); } catch (InterruptedException e) { throw new RuntimeException(e); } synchronized (notifyLock) { notifyLock.notify(); } } } } } }   åŸºäºReentrantLock\u0026amp;Condition 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57  public class ThreadPrint2Test { public static void main(String[] args) { new ThreadPrint2Test().testPrint(); } public void testPrint() { Lock lock = new ReentrantLock(); Condition conditionA = lock.newCondition(); Condition conditionB = lock.newCondition(); Condition conditionC = lock.newCondition(); new Thread(new PrintThread(\u0026#34;A\u0026#34;, lock, conditionA, conditionB), \u0026#34;thread-a\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;B\u0026#34;, lock, conditionB, conditionC), \u0026#34;thread-b\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;C\u0026#34;, lock, conditionC, conditionA), \u0026#34;thread-c\u0026#34;).start(); try { Thread.sleep(500); } catch (InterruptedException e) { throw new RuntimeException(e); } new Thread(() -\u0026gt; { lock.lock(); conditionA.signal(); lock.unlock(); }, \u0026#34;init\u0026#34;).start(); } class PrintThread implements Runnable { private Lock lock; private Condition ca; private Condition cb; private String value; public PrintThread(String value, Lock lock, Condition ca, Condition cb) { this.value = value; this.lock = lock; this.ca = ca; this.cb = cb; } public void run() { while (true) { try { lock.lock(); ca.await(); System.out.println(value); Thread.sleep(500); cb.signal(); lock.unlock(); } catch (InterruptedException e) { throw new RuntimeException(e); } } } } }   åŸºäºSemaphore 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  public class ThreadPrint3Test { public static void main(String[] args) { new ThreadPrint3Test().testPrint(); } public void testPrint() { Semaphore sa = new Semaphore(1); Semaphore sb = new Semaphore(1); Semaphore sc = new Semaphore(1); try { sb.acquire(); sc.acquire(); Thread.sleep(500); } catch (InterruptedException e) { throw new RuntimeException(e); } new PrintThread(\u0026#34;A\u0026#34;, sa, sb).start(); new PrintThread(\u0026#34;B\u0026#34;, sb, sc).start(); new PrintThread(\u0026#34;C\u0026#34;, sc, sa).start(); } class PrintThread extends Thread { private Semaphore sa; private Semaphore sb; private String value; public PrintThread(String value, Semaphore sa, Semaphore sb) { this.value = value; this.sa = sa; this.sb = sb; } public void run() { while (true) { try { sa.acquire(); System.out.println(value); Thread.sleep(500); sb.release(); } catch (InterruptedException e) { throw new RuntimeException(e); } } } } }   å•ä¸ªé”\u0026amp;volatileå˜é‡ æ­¤ç§æ–¹å¼ä¸éœ€è¦å”¤é†’çº¿ç¨‹ï¼ŒåŒæ—¶ä¾¿äºå¾ˆæ–¹ä¾¿çš„ä¿®æ”¹çº¿ç¨‹æ•°ç›®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51  public class ThreadPrint4Test { public static void main(String[] args) { new ThreadPrint4Test().testPrint(); } private volatile int count = 0; public void testPrint() { Object lock = new Object(); new Thread(new PrintThread(\u0026#34;A\u0026#34;, lock), \u0026#34;thread-A\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;B\u0026#34;, lock), \u0026#34;thread-B\u0026#34;).start(); new Thread(new PrintThread(\u0026#34;C\u0026#34;, lock), \u0026#34;thread-C\u0026#34;).start(); } class PrintThread implements Runnable { private Object lock; private String value; public PrintThread(String value, Object lock) { this.value = value; this.lock = lock; } public void run() { while (true) { try { synchronized (lock) { boolean process = \u0026#34;A\u0026#34;.equals(value) \u0026amp;\u0026amp; count % 3 == 0; if (process) { count = 0; } process = process || (\u0026#34;B\u0026#34;.equals(value) \u0026amp;\u0026amp; count % 3 == 1); process = process || (\u0026#34;C\u0026#34;.equals(value) \u0026amp;\u0026amp; count % 3 == 2); if (process) { lock.wait(); System.out.println(value); count++; Thread.sleep(500); } lock.notifyAll(); } } catch (InterruptedException e) { throw new RuntimeException(e); } } } } }   ","permalink":"http://isouthrain.github.io/post/java-concurrency/print-a-b-c-in-turn-by-threads/","tags":["Java","Java Concurrency"],"title":"å¤šç§æ–¹å¼å®ç°åœ¨Javaä¸­ç”¨çº¿ç¨‹è½®æµæ‰“å°ABC"},{"categories":["Javaç¼–ç¨‹","MyBatisç³»åˆ—"],"contents":"åœ¨è¿›è¡ŒJavaå¼€å‘æ—¶ï¼ŒNullPointerExceptionæ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„å¼‚å¸¸ï¼Œåœ¨Java8ä¸­æä¾›äº†Optionalæ¥é¿å…æ­¤é—®é¢˜ï¼Œè€Œåœ¨MyBatis 3.5.0ä¸­ä¹Ÿæä¾›äº†å¯¹Optionalçš„æ”¯æŒï¼Œæœ¬æ–‡ç®€è¦å™è¿°å¦‚ä½•åœ¨MyBatisä¸­ä½¿ç”¨Optionalã€‚\nå®Œæ•´ä»£ç å‚è§spring-mybatis-example\næŸ¥è¯¢å•æ¡è®°å½• ç”±äºåœ¨æŸ¥è¯¢å•æ¡è®°å½•æ—¶ï¼Œè‹¥æ•°æ®åº“ä¸­ä¸å­˜åœ¨è¯¥è®°å½•ï¼Œåˆ™ä¼šé»˜è®¤è¿”å›nullï¼Œæ­¤æ—¶å¯ç”¨Optionalè¿›è¡Œé¿å…ã€‚\né¦–å…ˆç¡®ä¿MyBatisçš„ç‰ˆæœ¬ä¸ä½äº3.5.0ï¼Œåœ¨mapperä¸­å¯ä»¥ä»¿ç…§å¦‚ä¸‹å®šä¹‰æ¥å£\n1 2 3 4  public interface BookMapper { Optional\u0026lt;BookModel\u0026gt; findById(Integer id); }   ä¹‹ååœ¨å¯¹åº”çš„serviceç±»ä¸­å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼ä½¿ç”¨\n1 2 3 4 5 6 7 8 9 10 11 12  @Service public class BookService { @Autowired private BookMapper bookMapper; public BookModel getBook(Integer id) { Optional\u0026lt;BookModel\u0026gt; result = bookMapper.findById(id); BookModel book = result.orElse(new BookModel()); return book; } }   æ‰§è¡Œä¸‹è¿°å•å…ƒæµ‹è¯•ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13  @SpringBootTest public class TestBookService { @Autowired private BookService bookService; @Test public void testGetBook() { BookModel book = bookService.getBook(3); Assertions.assertNotNull(book); System.out.println(book); } }   å…¶æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯è§Optionalåœ¨Mapperæ¥å£ä¸­ç”Ÿæ•ˆã€‚\næŸ¥è¯¢å¤šæ¡è®°å½• å½“æŸ¥è¯¢çš„ç»“æœä¸ºListæ—¶ï¼Œå³ä½¿æ²¡æœ‰æ•°æ®MyBatisä¹Ÿä¼šè¿”å›ä¸€ä¸ªç©ºçš„Listï¼Œå…¶sizeä¸º0ä½†ä¸ä¸ºnullï¼Œæ­¤æ—¶ä¸éœ€è¦æˆ‘ä»¬è¿›è¡Œéç©ºåˆ¤æ–­ã€‚\nå®šä¹‰å¦‚ä¸‹æ¥å£\n1 2 3 4  public interface BookMapper { List\u0026lt;BookModel\u0026gt; selectByType(Integer type); }   mapperæ–‡ä»¶å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.lucumt.mapper.BookMapper\u0026#34;\u0026gt; \u0026lt;select id=\u0026#34;findById\u0026#34; parameterType=\u0026#34;Integer\u0026#34; resultType=\u0026#34;bookModel\u0026#34;\u0026gt; SELECT id,name,price,type FROM book WHERE id=#{id} \u0026lt;/select\u0026gt; \u0026lt;select id=\u0026#34;selectByType\u0026#34; parameterType=\u0026#34;integer\u0026#34; resultType=\u0026#34;bookModel\u0026#34;\u0026gt; SELECT id,name,price FROM book WHERE type=#{type} \u0026lt;/select\u0026gt; \u0026lt;/mapper\u0026gt;   ä¸šåŠ¡ç±»ä»£ç \n1 2 3 4 5 6 7 8 9 10 11  @Service public class BookService { @Autowired private BookMapper bookMapper; public List\u0026lt;BookModel\u0026gt; selectByType(Integer type){ List\u0026lt;BookModel\u0026gt; bookList = bookMapper.selectByType(type); return bookList; } }   æ‰§è¡Œä¸‹è¿°å•å…ƒæµ‹è¯•ä»£ç æ—¶èƒ½æµ‹è¯•é€šè¿‡ï¼Œå¯è§åœ¨æŸ¥è¯¢é›†åˆåˆ—è¡¨æ˜¯ä¸éœ€è¦åˆ¤æ–­æ˜¯å¦ä¸ºç©ºã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13  @SpringBootTest public class TestBookService { @Autowired private BookService bookService; @Test public void testSelectByType() { List\u0026lt;BookModel\u0026gt; bookList = bookService.selectByType(3); Assertions.assertTrue(bookList != null); Assertions.assertTrue(bookList.size() == 0); } }   ä»ä¸Šè¿°è¯•éªŒå¯çŸ¥ï¼Œå½“è·å–çš„ç»“æœä¸ºListæ—¶ï¼Œä¸ä½¿ç”¨Optinalå…³é”®å­—ä¹Ÿèƒ½é¿å…ç©ºæŒ‡é’ˆé—®é¢˜ã€‚\n","permalink":"http://isouthrain.github.io/post/mybatis/using-optional-in-mybatis-mapper/","tags":["mybatis"],"title":"åœ¨MyBatisæ¥å£ä¸­ä½¿ç”¨Optionalè¿›è¡Œéç©ºåˆ¤æ–­"},{"categories":["æ•°æ®åº“"],"contents":"åœ¨ç»™MySQLæ•°æ®åº“è¿›è¡Œé…ç½®æ—¶ï¼Œå¯¹äºmysqlæ•°æ®åº“è¡¨ä¸‹çš„userè¡¨é…ç½®é”™è¯¯ï¼Œå¯¼è‡´æ— æ³•é€šè¿‡å‘½ä»¤ç™»å½•è¿›å…¥MySQLæ•°æ®åº“ï¼ŒæŸ¥æ‰¾ç½‘ä¸Šçš„æ–‡æ¡£å‘ç°å¯é€šè¿‡å®‰å…¨æ¨¡å¼è¿›å…¥ï¼Œç®€å•è®°å½•ä¸‹ã€‚\n  å…¬å¸æŸä¸ªé¡¹ç›®é‡‡ç”¨çš„MySQLæ•°æ®åº“ä¸æ”¯æŒè¿œç¨‹è¿æ¥ï¼Œäºæ˜¯ä¸ªäººç™»å½•ååœ¨hostè¡¨è¿›å…¥å¦‚ä¸‹ä¿®æ”¹:\n  ç”±äºå°†hostä¿®æ”¹ä¸ºäº†%dè€Œæ­£å¸¸çš„å†™æ³•æ˜¯%,ä»è€Œå¯¼è‡´åœ¨é‡å¯MySQLåæ— æ³•ç™»å½•\n  ç”±äºuserè¡¨ä¸»è¦ç”¨äºæ§åˆ¶ç”¨æˆ·èƒ½å¦è¿œç¨‹ç™»å½•ä»¥åŠå…¶æƒé™ï¼Œå½“æ­¤è¡¨é…ç½®é”™è¯¯æ—¶ä¼šå‡ºç°æ— æ³•é€šè¿‡å¸¸è§„çš„mysql -uroot -pxxxçš„æ–¹å¼ç™»å½•æ•°æ®åº“ä¿®æ”¹å…¶é…ç½®ï¼Œæ­¤æ—¶åªèƒ½é€šè¿‡å®‰å…¨æ¨¡å¼è¿›è¡Œç™»å½•ã€‚é¦–å…ˆåœ¨ç»ˆç«¯è¾“å…¥service mysql stopå…³é—­MySQLæœåŠ¡ï¼Œæ¥ä¸‹æ¥è¾“å…¥mysqld_safe --skip-grant-tablesä»¥å®‰å…¨æ¨¡å¼å¼€å¯MySQLæœåŠ¡\n  æ¥ä¸‹æ¥åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­è¾“å…¥mysql -uroot -pxxxå³å¯æ­£å¸¸ç™»å½•ï¼Œç™»å½•ä¹‹åé‡æ–°ä¿®æ”¹mysqlæ•°æ®åº“ä¸‹çš„userè¡¨ä¸­çš„ç›¸å…³é…ç½®å¹¶é‡å¯MySQLæœåŠ¡å³å¯ã€‚\n  å‚è€ƒæ–‡æ¡£:\n https://stackoverflow.com/questions/48246503/user-table-not-having-root-user ","permalink":"http://isouthrain.github.io/post/mysql/mysql-can-not-login-due-to-incorrect-host-config/","tags":["mysql"],"title":"MySQLä¸­ç”±äºuserè¡¨ä¸­é”™è¯¯çš„hosté…ç½®å¯¼å…¥æ— æ³•ç™»å½•æ•°æ®åº“"},{"categories":["javaç¼–ç¨‹"],"contents":"åœ¨å„ç§Javaç¼–ç¨‹è§„èŒƒä¸­éƒ½å¼ºè°ƒå°½é‡ä¸ç”¨java.util.Arrays.asList()æ–¹æ³•ä»¥é¿å…è°ƒç”¨æ­¤æ–¹æ³•ç”Ÿæˆçš„Listæ— æ³•è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œä¸ªäººè¿‘æœŸåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°è¯¥æ–¹æ³•çš„å¦å¤–ä¸€ä¸ªå‘ï¼Œç®€å•è®°å½•ä¸‹ã€‚\né—®é¢˜æè¿° åœ¨ç¨‹åºä¸­éœ€è¦æ£€æµ‹æŸä¸ªå…ƒç´ æ˜¯å¦åœ¨æ•°ç»„ä¸­ï¼Œå¤„äºç¼©çŸ­ä»£ç ç¯‡å¹…çš„è€ƒè™‘ï¼Œè‡ªå·±é‡‡ç”¨äº†Arrays.asListæ–¹æ³•å°†å…¶è½¬åŒ–ä¸ºListç„¶åè°ƒç”¨containsæ–¹æ³•æ¥åˆ¤æ–­ï¼š\n1 2 3 4  public static boolean checkContains(int ele) { int[] data = {11, 12, 13, 14}; return Arrays.asList(data).contains(ele); }   ä½†å®é™…æ‰§è¡Œç»“æœå’Œè‡ªå·±é¢„æœŸçš„ä¸ä¸€è‡´ï¼Œç†è®ºä¸Šçš„ç»“æœåº”è¯¥ä¸ºtrueï¼Œè€Œå®é™…è¿”å›çš„ç»“æœä¸ºfalse\né—®é¢˜åˆ†æ åœ¨Debugæ¨¡å¼ä¸‹æŸ¥çœ‹Arrays.asList(data)è¿”å›çš„å€¼ï¼Œå‘ç°å…¶è¿”å›çš„ç»“æœä¸æ˜¯é¢„æœŸä¸­çš„List\u0026lt;Integer\u0026gt;è€Œæ˜¯List\u0026lt;int[]\u0026gt;ï¼Œä»è€Œå¯¼è‡´è°ƒç”¨List.contains()æ–¹æ³•å¤±æ•ˆ!\nåœ¨IDEAä¸­å°†Arrays.asList(data)è¿”å›çš„ç»“æœå•ç‹¬èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œå¯å‘ç°å…¶ç±»å‹ç¡®å®ä¸ºList\u0026lt;int[]\u0026gt;ï¼Œè‹¥å°†ç»“æœç±»å‹ä¿®æ”¹ä¸ºList\u0026lt;Integer\u0026gt;åˆ™ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nåœ¨ä¸Šå›¾å³è¾¹çš„æŠ¥é”™ä¿¡æ¯ä¸­æœ‰å¦‚ä¸‹è¯´æ˜ä¿¡æ¯:\n no instance(s) of type variable(s) exist so that int[] conforms to Integer inference variable T has incompatible bounds: equality constraints: Integer lower bounds: int[]\n ä¸Šè¿°æ–‡å­—çš„æ ¸å¿ƒå†…å®¹ä¸ºArrays.asListéœ€è¦è·å–Objectç±»å‹ï¼Œè€Œintæ˜¯åŸç”Ÿç±»å‹ï¼Œä½†int[]ç¬¦åˆè¦æ±‚ï¼Œå› æ­¤Arrays.asList()æ–¹æ³•ä¼šå°†åŸå§‹çš„intæ•°ç»„è§†ä½œä¸€ä¸ªint[]å¯¹è±¡è¿›è¡Œå¤„ç†ï¼Œä»è€Œå¯¼è‡´æ­¤ç»“æœ1ã€‚\nè§£å†³æ–¹æ¡ˆ æ‰¾åˆ°é—®é¢˜åŸå› åä¿®æ”¹èµ·æ¥ä¹Ÿå¾ˆå®¹æ˜“ï¼ŒæŒ‰ç…§é€šå¸¸çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œåªéœ€è¦æŠŠæ•°ç»„çš„å®šä¹‰ä»intä¿®æ”¹ä¸ºIntegerå³å¯\n1 2 3 4 5  public static boolean checkContains(int ele) { Integer[] data = {11, 12, 13, 14}; List\u0026lt;Integer\u0026gt; dataList = Arrays.asList(data); return dataList.contains(ele); }   æ‰§è¡Œç»“æœç¬¦åˆé¢„æœŸ\n Update:\nåœ¨Stackoverflowä¸Šæ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼é—®é¢˜2ï¼Œåœ¨å…¶å›ç­”ä¸­æä¾›äº†ä¸€äº›å…¶å®ƒå®ç°æ–¹æ¡ˆï¼š\n  JDK8å®ç°\n1 2  int[] ints = new int[] {1,2,3,4,5}; List\u0026lt;Integer\u0026gt; list11 =Arrays.stream(ints).boxed().collect(Collectors.toList());     JDK16å®ç°\n1 2  int[] ints = new int[] {1,2,3,4,5}; Arrays.stream(ints).boxed().toList();     asListä¸å¯å˜åŸå› åˆ†æ æŸ¥çœ‹Arrays.asListè¿”å›ç»“æœä¸­çš„Listï¼Œå‘ç°å…¶è¿”å›çš„æ˜¯å†…éƒ¨è‡ªå·±å®ç°çš„ArrayListï¼Œä½†è¯¥ArrayListæ²¡æœ‰é‡å†™addæ–¹æ³•ã€‚\nä½†AbstractListé»˜è®¤æ²¡æœ‰å®ç°add()æ–¹æ³•è€Œæ˜¯æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œä»è€Œå¯¼è‡´æ— æ³•é€šè¿‡è°ƒç”¨add()æ–¹æ³•æ·»åŠ å…ƒç´ ã€‚\n  https://stackoverflow.com/questions/27522741/incompatible-types-inference-variable-t-has-incompatible-bounds\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n https://stackoverflow.com/questions/2607289/converting-array-to-list-in-java\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/java-core/arrays-as-list-convert-result-in-java/","tags":["java"],"title":"Arrays.asListç±»å‹è½¬æ¢ç»“æœçš„å‘"},{"categories":["æ•°æ®åº“"],"contents":"åœ¨è½¯ä»¶å¼€å‘ä¸­é‡‡ç”¨LIMIT OFFSETå¯¹æ•°æ®åº“è¿›è¡Œåˆ†é¡µæ˜¯å¸¸è§æ“ä½œï¼Œä½†åœ¨æ•°æ®é‡å¾ˆå¤§æ—¶ç›´æ¥ä½¿ç”¨LIMIT OFFSETæŸ¥è¯¢å°¾éƒ¨çš„æ•°æ®ä¼šå¯¼è‡´æ€§èƒ½å¾ˆæ…¢ï¼Œæœ¬æ–‡ç®€è¦ä»‹ç»2ç§æ”¹è¿›æ–¹æ¡ˆã€‚\nä»¥system_userè¡¨ä¸ºä¾‹ï¼ŒåŸºäºMySQLä¸­å¿«é€Ÿåˆ›å»ºå¤§é‡æµ‹è¯•æ•°æ®ä¸€æ–‡ä¸­çš„ä»‹ç»ç»™å…¶æ·»åŠ 1000ä¸‡çš„æµ‹è¯•æ•°æ®\n1 2 3 4 5 6 7  CREATETABLE`system_user`(`id`INTNOTNULLAUTO_INCREMENT,`name`VARCHAR(8)CHARACTERSETutf8COLLATEutf8_general_ciNOTNULL,`age`INTDEFAULTNULL,`tag`VARCHAR(8)CHARACTERSETutf8COLLATEutf8_general_ciDEFAULTNULL,PRIMARYKEY(`id`))ENGINE=INNODBCHARSET=utf8;  åŸºäºæŸ¥è¯¢SQLSELECT * FROM system_user LIMIT 9999990,10;è¿›è¡Œä¼˜åŒ–åˆ†æã€‚\nä¸Šè¿°SQLåœ¨æ•°æ®åº“ä¸­çš„æŸ¥è¯¢è€—æ—¶å¦‚ä¸‹ï¼š\nåˆ©ç”¨explainåˆ†æå…¶æ‰§è¡Œè®¡åˆ’ç»“æœå¦‚ä¸‹ï¼š\nä¸Šå›¾ä¸­çš„rowsè¿™ä¸€ä¾‹çš„æ•°æ®ä¸º9722930ï¼Œç”±äºrowsè¿™ä¸€åˆ—çš„å€¼æ˜¯é¢„ä¼°å€¼ï¼Œå®é™…ä¸ŠMySQLä¼šå°†æ•°æ®offset+countçš„æ•°æ®éƒ½è·å–åˆ°å†…å­˜ä¸­ï¼Œç„¶åå†è¿›è¡Œè¿‡æ»¤ã€‚åœ¨æœ¬ä¾‹ä¸­å³ä¼šå°†10000000æ¡æ•°æ®éƒ½è·å–åˆ°ç„¶åå†è¿›è¡Œè¿‡æ»¤ç­›é€‰ï¼Œè€Œè·å–è¿™ä¹ˆå¤šæ•°æ®æ˜¾ç„¶ä¼šå¯¼è‡´æŸ¥è¯¢é€Ÿåº¦å˜æ…¢ï¼\n é—®é¢˜æ ¹æºä¸ºMySQLåœ¨æ‰§è¡ŒLIMIT OFFSETæ—¶ä¼šå°†æ•°æ®å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­ç„¶åå†è¿›è¡Œè¿‡æ»¤ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯ä¸€ç§å‡åˆ†é¡µï¼\n æ‰¾åˆ°é—®é¢˜çš„æ ¹æºåï¼Œè¦æé«˜æŸ¥è¯¢é€Ÿåº¦åªèƒ½è®©MySQLæŸ¥è¯¢æ—¶è¿”å›çš„æ•°æ®å°½å¯èƒ½å°ï¼Œæ¥ä¸‹æ¥æ ¹æ®ä¸»é”®æ˜¯å¦è¿ç»­è‡ªå¢æ¥åˆ†åˆ«å™è¿°ã€‚\nè‡ªå¢ä¸»é”®è¿‡æ»¤ è‹¥ä¸»é”®è¿ç»­è‡ªå¢ï¼Œåˆ™å¯ä»ä¸šåŠ¡é€»è¾‘çš„è§’åº¦å…ˆå¯¹æ•°æ®ç”¨WHEREè¿‡æ»¤ï¼Œç„¶åç”¨LIMITè¿›è¡Œåˆ†é¡µï¼Œç±»ä¼¼SQLå¦‚ä¸‹ï¼š\n1  SELECT*FROM`system_user`WHEREid\u0026gt;=9999990LIMIT10;  æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºæ—¶é—´æ˜æ˜¾ç¼©çŸ­å¾ˆå¤š\nè¿›ä¸€æ­¥åˆ†æå…¶æ‰§è¡Œè®¡åˆ’ï¼Œå‘ç°rowsè¿™ä¸€åˆ—çš„å€¼ä¸º11ï¼Œåªæ˜¯è·å–äº†æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ï¼Œæ²¡æœ‰è·å–å¤§æ‰¹é‡æ•°æ®ã€‚\né‡‡ç”¨æ­¤ç§æ–¹å¼æ€§èƒ½æå‡çš„åŸå› å¦‚ä¸‹ï¼š\n MySQLä¸­çš„ä¸»é”®é»˜è®¤æœ‰ç´¢å¼•ï¼ŒåŸºäºç´¢å¼•æŸ¥è¯¢é€Ÿåº¦å¾ˆå¿« WHEREä¼˜å…ˆäºLIMITæ‰§è¡Œï¼Œæ•°æ®é‡ç›¸å¯¹ä¹‹å‰ï¼Œå˜å¾—å¾ˆå°  å…¶ä¸­æœ€å…³é”®çš„æ˜¯ç¬¬2ç‚¹ï¼Œåªè¦æŸ¥è¯¢çš„æ•°æ®é‡å˜å°ï¼ŒæŸ¥è¯¢é€Ÿåº¦è‡ªç„¶ä¼šæå‡ã€‚\nè¦†ç›–ç´¢å¼•è¿‡æ»¤ åŸºäºè‡ªå¢ä¸»é”®è¿‡æ»¤è¦æ±‚ä¸»é”®å¿…é¡»ä¸»é”®è¿ç»­è‡ªå¢ï¼Œè‹¥ä¸»é”®ä¸è¿ç»­(å¦‚ä¸»é”®é‡‡ç”¨UUIDç”Ÿæˆ)åˆ™ä¸Šè¿°æ–¹æ¡ˆä¸å¯è¡Œï¼Œæ­¤æ—¶å¯åŸºäºè¦†ç›–ç´¢å¼•æ¥å‡å°‘è·å–å’Œä¼ è¾“çš„æ•°æ®é‡å¤§å°ã€‚\nå°†æŸ¥è¯¢sqlä¿®æ”¹ä¸ºç±»ä¼¼å¦‚ä¸‹\n1 2 3  SELECTu1.*FROM`system_user`u1JOIN(SELECTidFROM`system_user`LIMIT9999990,10)u2ONu1.id=u2.id;  æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºè€—æ—¶åªæ¯”æœ€åˆçš„å°‘1ç§’\næŸ¥çœ‹å…¶æ‰§è¡Œè®¡åˆ’ï¼Œå‘ç°è·å–çš„æ•°æ®é‡ä»ç„¶å¾ˆå¤§\nç”±äºMySQLåœ¨æ•°æ®é‡ä¸ºåƒä¸‡çº§æ—¶æŸ¥è¯¢é€Ÿåº¦ä¼šå˜æ…¢ï¼Œå°†æ•°æ®åº“è¡¨ä¸­çš„æ•°æ®é‡ç¼©å°åˆ°500ä¸‡ï¼Œæ‰§è¡Œå¦‚ä¸‹ï¼š\né—®é¢˜çš„æ ¹æºåœ¨SELECT id FROM system_user LIMIT 9999990,10ï¼Œè™½ç„¶æ­¤æ—¶åªæŸ¥è¯¢idï¼Œä½†æ˜¯idçš„æ•°é‡ä»ç„¶å¾ˆåºå¤§ï¼Œç”±æ­¤é€ æˆæŸ¥è¯¢é€Ÿåº¦å˜æ…¢ã€‚\næ­¤æ—¶å¯é€šè¿‡åœ¨æ•°æ®åº“è¡¨ä¸­æ·»åŠ ä¸€åˆ—numå¹¶å¯¹å…¶åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼Œä¹‹ååŸºäºnumè¿›è¡Œè¿‡æ»¤æŸ¥è¯¢\n1 2 3 4 5 6 7  -- æ·»åŠ ç´¢å¼• ALTERTABLE`system_user`ADDCOLUMN`num`INTNOTNULLDEFAULT1;ALTERTABLE`system_user`ADDUNIQUEINDEX`user_num_index`(`num`);-- é‡æ–°åˆ¶é€ æ•°æ® TRUNCATETABLE`system_user`;CALLadd_user_batch(10000000);  æ”¹è¿›åçš„sqlå¦‚ä¸‹\n1 2 3  SELECTu1.*FROM`system_user`u1JOIN(SELECTnumFROM`system_user`WHEREnum\u0026gt;=9999990LIMIT10)u2ONu1.num=u2.num;  æ‰§è¡Œç»“æœè€—æ—¶å¦‚ä¸‹ï¼š\nå¯ä»¥çœ‹å‡ºå…¶è€—æ—¶å’Œé‡‡ç”¨è‡ªå¢è¿ç»­ä¸»é”®æ—¶ç±»ä¼¼ã€‚å¯¹åº”çš„æ‰§è¡Œè®¡åˆ’å¦‚ä¸‹ï¼Œä»å›¾ä¸­ä¹Ÿèƒ½çœ‹å‡ºè¦è·å–çš„æ•°æ®é‡æ˜æ˜¾å˜å°ã€‚\næ€»ç»“ ä¸Šè¿°ä¸¤ç§æ–¹æ¡ˆå½’æ ¹åˆ°åº•å‡ä¸ºè¦é€šè¿‡WHEREæå‰è¿‡æ»¤ä¸éœ€è¦çš„æ•°æ®ï¼Œå‡å°‘è¿”å›çš„æ•°æ®é‡ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š\n è‹¥ä¸»é”®è¿ç»­ä¸”è‡ªå¢ï¼Œåˆ™é€šè¿‡ä¸»é”®è¿›è¡Œè¿‡æ»¤ è‹¥ä¸»é”®ä¸è¿ç»­è‡ªå¢ï¼Œå¯é¢å¤–åˆ›å»ºä¸€ä¸ªè‡ªå¢åˆ—æˆ–è€…é‡‡ç”¨è¦†ç›–ç´¢å¼•çš„æ–¹å¼æ”¹å†™ ","permalink":"http://isouthrain.github.io/post/mysql/limit-large-size-data-in-mysql/","tags":["mysql"],"title":"åœ¨MySQLä¸­å¯¹å¤§é‡æ•°æ®è¿›è¡Œlimit offsetåˆ†é¡µæŸ¥è¯¢çš„ä¼˜åŒ–"},{"categories":["æ•°æ®åº“"],"contents":"åœ¨å­¦ä¹ MySQLç´¢å¼•å’Œåˆ†åº“åˆ†è¡¨ç­‰çŸ¥è¯†çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šæ¶‰åŠåˆ°åˆ›å»ºå¤§æ‰¹é‡çš„æµ‹è¯•æ•°æ®ï¼Œæœ¬æ–‡ç®€è¦è¯´æ˜è‡ªå·±å¸¸ç”¨çš„å‡ ç§åˆ›å»ºæ–¹å¼ä»¥åŠå„è‡ªçš„ä¼˜åŠ£å¯¹æ¯”ã€‚\nå®ç°æ–¹å¼ ä»¥ä¸‹è¿°çš„system_userè¡¨ä¸ºä¾‹åˆ†åˆ«è¯´æ˜åœ¨ä¸åŒçš„æ–¹å¼ä¸‹å¦‚ä½•å¤§æ‰¹é‡çš„åˆ›å»ºæµ‹è¯•æ•°æ®ã€‚\n1 2 3 4 5 6 7  CREATETABLE`system_user`(`id`INTNOTNULLAUTO_INCREMENT,`name`VARCHAR(8)CHARACTERSETutf8COLLATEutf8_general_ciNOTNULL,`age`INTDEFAULTNULL,`tag`VARCHAR(8)CHARACTERSETutf8COLLATEutf8_general_ciDEFAULTNULL,PRIMARYKEY(`id`))ENGINE=INNODBCHARSET=utf8;  é€šè¿‡ä»£ç ç¨‹åºåˆ›å»º å·¥ä½œä¸­ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¸»è¦æ˜¯Javaï¼Œåœ¨ä¹‹å‰æˆ‘ä¸ç†Ÿæ‚‰MySQLå­˜å‚¨è¿‡ç¨‹ç”¨æ³•çš„æ—¶ï¼Œä¸»è¦é‡‡ç”¨JDBCçš„æ–¹å¼å®ç°æ‰¹é‡åˆ›å»ºæ•°æ®ï¼Œä»£ç ç±»ä¼¼å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47  import lombok.extern.slf4j.Slf4j; import org.apache.commons.lang3.RandomStringUtils; import org.apache.commons.lang3.RandomUtils; import org.junit.jupiter.api.Test; import org.springframework.boot.test.context.SpringBootTest; import javax.annotation.Resource; import javax.sql.DataSource; import java.sql.Connection; import java.sql.PreparedStatement; import java.sql.SQLException; @Slf4j @SpringBootTest public class TestBatchInsertData { @Resource private DataSource dataSource; private int DATA_SIZE = 1000_0000; private int BATCH_SIZE = 100; @Test public void testAddBatchData() { String insertSQL = \u0026#34;insert into system_user(name,age,tag) VALUES(?,?,?)\u0026#34;; try (Connection conn = dataSource.getConnection(); PreparedStatement pstmt = conn.prepareStatement(insertSQL)) { conn.setAutoCommit(false); for (int i = 1; i \u0026lt;= DATA_SIZE; i++) { pstmt.setString(1, RandomStringUtils.randomAlphanumeric(8)); pstmt.setInt(2, RandomUtils.nextInt(18, 80)); pstmt.setString(3, RandomStringUtils.randomAlphabetic(8)); pstmt.addBatch(); if (i % BATCH_SIZE == 0) { pstmt.executeBatch(); conn.commit(); log.info(\u0026#34;æ‰§è¡Œä¸€æ¬¡æ‰¹é‡æäº¤:\\t\u0026#34; + i / BATCH_SIZE); } } pstmt.executeBatch(); conn.commit(); log.info(\u0026#34;å®Œæˆæ•°æ®æ‰¹é‡æ’å…¥\u0026#34;); } catch (SQLException e) { throw new RuntimeException(e); } } }   ä»ä¸Šè¿°ä»£ç å¯çŸ¥ï¼Œæ­¤ç§å®ç°æ–¹å¼è¾ƒä¸ºç®€æ´ï¼Œå®é™…çš„ä¸šåŠ¡ä»£ç åªæœ‰20è¡Œå·¦å³ï¼Œå¯¹äºå…·æœ‰Javaå¼€å‘ç»éªŒçš„äººæ¥è¯´ä¸Šæ‰‹å¾ˆå¿«ï¼Œä¸è¶³ä¹‹å¤„æ˜¯éœ€è¦é¢å¤–å‡†å¤‡ç›¸åº”çš„æ‰§è¡Œç¯å¢ƒã€‚\né€šè¿‡å­˜å‚¨è¿‡ç¨‹åˆ›å»º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68  DELIMITER$$USE`test`$$DROPPROCEDUREIFEXISTS`add_user_batch`$$CREATEDEFINER=`root`@`%`PROCEDURE`add_user_batch`(INCOUNTINT)BEGINDECLAREiINT;DECLAREt_nameVARCHAR(8);DECLAREt_tagVARCHAR(20);DECLAREt_ageINT(2);DECLAREt_sql_templateVARCHAR(100);DECLAREt_sqlTEXT;DECLAREt_tag_mod_valINTDEFAULT(25);DECLAREt_commit_mod_valINTDEFAULT(100);DECLAREt_start_timeDATETIME;DECLAREt_end_timeDATETIME;TRUNCATETABLE`system_user`;SETt_start_time=NOW();SETt_sql_template=\u0026#34;INSERT INTO `system_user`(NAME, age, tag) VALUES\u0026#34;;SETt_sql=t_sql_template;SETi=1;WHILEi\u0026lt;=COUNTDOSETt_age=FLOOR(1+RAND()*60);SETt_name=LEFT(UUID(),8);-- ç»™tagéšæœºåˆ¶é€ ç©ºå€¼ IFMOD(i,t_tag_mod_val)=0THENSETt_tag=\u0026#34;NULL\u0026#34;;ELSESETt_tag=CONCAT(\u0026#34;\u0026#39;\u0026#34;,LEFT(UUID(),8),\u0026#34;\u0026#39;\u0026#34;);ENDIF;SETt_sql=CONCAT(t_sql,\u0026#34;(\u0026#39;\u0026#34;,t_name,\u0026#34;\u0026#39;,\u0026#34;,t_age,\u0026#34;,\u0026#34;,t_tag,\u0026#34;)\u0026#34;);IFMOD(i,t_commit_mod_val)!=0THENSETt_sql=CONCAT(t_sql,\u0026#34;,\u0026#34;);ELSESETt_sql=CONCAT(t_sql,\u0026#34;;\u0026#34;);-- åªè¦è¾¾åˆ°t_commit_mod_valè¦æ±‚çš„æ¬¡æ•°ï¼Œå°±æ‰§è¡Œå¹¶æäº¤ SET@insert_sql=t_sql;PREPAREstmtFROM@insert_sql;EXECUTEstmt;DEALLOCATEPREPAREstmt;COMMIT;SETt_sql=t_sql_template;ENDIF;SETi=i+1;ENDWHILE;-- ä¸èƒ½è¢«t_commit_mod_valæ•´é™¤æ—¶ï¼Œä½™ä¸‹çš„æ•°æ®å¤„ç† IFLENGTH(t_sql)\u0026gt;LENGTH(t_sql_template)THENSETt_sql=CONCAT(SUBSTRING(t_sql,1,LENGTH(t_sql)-1),\u0026#39;;\u0026#39;);SET@insert_sql=t_sql;PREPAREstmtFROM@insert_sql;EXECUTEstmt;DEALLOCATEPREPAREstmt;COMMIT;ENDIF;SETt_end_time=NOW();SELECTCONCAT(\u0026#39;insert data success,time cost \u0026#39;,TIMEDIFF(t_end_time,t_start_time))ASfinishedTag;END$$DELIMITER;  è°ƒç”¨è¿‡ç¨‹ç±»ä¼¼å¦‚ä¸‹:\n1 2 3 4 5 6 7 8  -- æ¸…ç©ºåŸæœ‰è®°å½• TRUNCATETABLE`system_user`;-- è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ CALLadd_user_batch(1000);-- éªŒè¯æŸ¥è¯¢ç»“æœ SELECTCOUNT(*)FROM`system_user`;  å¯ä»¥çœ‹å‡ºè™½ç„¶ç”¨å­˜å‚¨è¿‡ç¨‹ä¹Ÿèƒ½å®ç°æ‰¹é‡æäº¤ï¼Œä½†ç›¸å¯¹äºJavaå®ç°è€Œè¨€ï¼Œå…¶ä»£ç é‡æ›´å¤§æ›´ä¸ºå¤æ‚ï¼Œä¸Šæ‰‹é—¨æ§›ç•¥é«˜ã€‚ä¸è¿‡å…¶å¥½å¤„ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œåªè¦æœ‰æ•°æ®åº“ç¯å¢ƒå°±èƒ½æ‰§è¡Œ1ã€‚\né€šè¿‡SQLè¯­å¥åˆ›å»º æ­¤ç§æ–¹å¼éœ€è¦é€šè¿‡SELECT INSERT INTOæ¥å®ç°ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š\n  é€šè¿‡å¦‚ä¸‹çš„SQLåˆå§‹åŒ–è¡¨ä¸­çš„æ•°æ®ï¼š\n1 2  INSERTINTO`system_user`(NAME,age,tag)VALUES(LEFT(UUID(),8),FLOOR(1+RAND()*60),LEFT(UUID(),8));    æ ¹æ®å®é™…éœ€è¦å¤šæ¬¡æ‰§è¡Œä¸‹è¿°SQLï¼š\n1 2  INSERTINTO`system_user`(NAME,age,tag)SELECTLEFT(UUID(),8),FLOOR(1+RAND()*60),LEFT(UUID(),8)FROM`system_user`;    è¿™ç§æ–¹å¼ä¸»è¦æ˜¯åˆ©ç”¨äº†SELECTæ¯æ¬¡æŸ¥è¯¢ä¹‹å‰è¡¨ä¸­çš„å…¨éƒ¨æ•°æ®ï¼Œç„¶åé‡æ–°æ’å…¥ï¼Œæ¯æ¬¡SELECTæ—¶éƒ½ä¼šå°†è¡¨ä¸­å·²æœ‰çš„æ•°æ®å…¨éƒ¨æŸ¥è¯¢å‡ºæ¥ï¼Œè·å–å‡ºæ€»çš„è®°å½•æ•°ï¼Œç„¶åæ ¹æ®SELECTåé¢çš„æ¡ä»¶é‡æ–°å¯¹æ¯ä¸€æ¡æ’å…¥çš„è®°å½•é‡æ–°èµ‹å€¼æ’å…¥ï¼Œå®é™…ä¸Šç›¸å½“äºç¿»å€æ’å…¥ã€‚\nç”±äºæ¯æ¬¡æ‰§è¡ŒSELECT INTOæ—¶éƒ½æ˜¯å°†ä¹‹å‰çš„æ•°æ®é‡æ‰©å¤§1å€ï¼Œæ•…å¾€æ•°æ®åº“ä¸­æ’å…¥çš„æ€»æ•°countä¸æ‰§è¡Œæ¬¡æ•°nçš„å…³ç³»å¦‚ä¸‹:\n count = $2^n$\n æ›´å…·ä½“çš„ä¿¡æ¯å¦‚ä¸‹ï¼š\n   é˜¶æ®µ æ’å…¥æ€»æ•°     ç¬¬1æ¬¡æ‰§è¡Œ 2   ç¬¬2æ¬¡æ‰§è¡Œ 4   ç¬¬3æ¬¡æ‰§è¡Œ 8   \u0026hellip;    ç¬¬10æ¬¡æ‰§è¡Œ 1024   \u0026hellip;    ç¬¬20æ¬¡æ‰§è¡Œ 1048576   ç¬¬21æ¬¡æ‰§è¡Œ 2097152   ç¬¬22æ¬¡æ‰§è¡Œ 4194304   ç¬¬23æ¬¡æ‰§è¡Œ 8388608    åœ¨MySQLä¸­tmp_table_sizeä¸º16Mï¼Œinnodb_buffer_pool_sizeçš„é»˜è®¤å€¼æ˜¯128Mï¼Œå½“æ‰§è¡Œåˆ°ä¸€å®šæ¬¡æ•°åï¼Œä¼šå‡ºç°ç±»ä¼¼The total number of locks exceeds the lock table sizeçš„é”™è¯¯ï¼Œæ­¤æ—¶éœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´è¿™ä¸¤ä¸ªå‚æ•°ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š\n1 2  SETGLOBALtmp_table_size=512*1024*1024;-- 512M SETglobalinnodb_buffer_pool_size=2*1024*1024*1024;-- 2G   æ­¤ç§æ–¹å¼è™½ç„¶éœ€è¦å¤šæ¬¡æ‰§è¡ŒSQLè¯­å¥ï¼Œä½†å…¶ä¼˜ç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œåªéœ€è¦å°†SQLè¯­å¥ç¨ä½œä¿®æ”¹ï¼Œå°±èƒ½é€‚ç”¨äºä¸åŒçš„æ•°æ®åº“è¡¨ã€‚\nå¯¹æ¯”\u0026amp;æ€»ç»“ å„ç§æ–¹å¼çš„å¯¹æ¯”å¦‚ä¸‹ï¼š\n    ä¼˜ç‚¹ ç¼ºç‚¹ é€‚ç”¨åœºæ™¯     ä»£ç ç¨‹åºåˆ›å»º 1.å®ç°æ–¹ä¾¿ï¼Œæœ‰ç¼–ç¨‹çŸ¥è¯†å³å¯\n2.æ€§èƒ½ä¸å—æ•°æ®é‡å¤§å°çš„å½±å“ 1.éœ€è¦å…·å¤‡ç›¸å…³çš„ç¼–ç¨‹çŸ¥è¯†\n2.éœ€è¦æœ‰ä¸“é—¨çš„è½¯ä»¶è¿è¡Œç¯å¢ƒï¼Œç§»æ¤æ€§ä¸å¥½\n3.ä¸å…·å¤‡é€šç”¨æ€§ éœ€è¦åå¤çš„åˆ›å»ºå¤§æ‰¹é‡æ•°æ®   å­˜å‚¨è¿‡ç¨‹åˆ›å»º 1.ç”±äºç›´æ¥æ“ä½œæ•°æ®åº“ï¼Œé€Ÿåº¦æœ€å¿«\n2.ç¼–å†™å®Œæˆåå¯é‡å¤ä½¿ç”¨\n3.æ€§èƒ½ä¸å—æ•°æ®é‡å¤§å°çš„å½±å“ 1.å­˜å‚¨è¿‡ç¨‹çš„ç¼–å†™è€—æ—¶ï¼Œè°ƒè¯•ä¸å¤ªæ–¹ä¾¿\n2.ä¸å…·å¤‡é€šç”¨æ€§ 1.éœ€è¦åå¤çš„åˆ›å»ºå¤§æ‰¹é‡æ•°æ®\n2.æ— æ³•é€šè¿‡ç¨‹åºä»£ç åˆ›å»º   SQLè¯­å¥åˆ›å»º 1.ä½¿ç”¨æœ€æ–¹ä¾¿ï¼Œåªè¦æœ‰mysqlç¯å¢ƒå°±èƒ½ä¸Šæ‰‹\n2.å…·å¤‡é€šç”¨æ€§ï¼Œé€‚åˆå„ç§æ•°æ®åº“è¡¨ 1.éœ€è¦å¤šæ¬¡æ‰§è¡ŒSQLè¯­å¥\n2.è¶Šåˆ°åé¢å•æ¬¡æ•°æ®é‡è¶Šå¤§ï¼Œå½±å“æ€§èƒ½ åˆ›å»ºå¤§æ‰¹é‡æµ‹è¯•æ•°æ®çš„æ¬¡æ•°è¾ƒå°‘,é€šå¸¸1åˆ°2æ¬¡    å„è‡ªæ‰§è¡Œ1000ä¸‡æ¡æ•°æ®çš„ç²—ç•¥è€—æ—¶å¯¹æ¯”å¦‚ä¸‹ï¼š2\n ä»£ç ç¨‹åºåˆ›å»ºï¼Œ6å°æ—¶ å­˜å‚¨è¿‡ç¨‹åˆ›å»ºï¼Œ11åˆ†é’Ÿ SQLè¯­å¥åˆ›å»ºï¼Œ5åˆ†é’Ÿ  ä»ä¸Šè¿°ç»“æœå¯ä»¥çœ‹å‡ºé€šè¿‡SQLè¯­å¥åˆ›å»ºè€—æ—¶ç›¸å¯¹è¾ƒå°‘3ï¼Œè‹¥åªæ˜¯å•çº¯çš„æ’å…¥æ•°æ®ï¼Œå»ºè®®ä¼˜å…ˆé€‰æ‹©æ­¤ç§æ–¹å¼ã€‚\nè¯´æ˜\nç”±äºä»£ç ç¨‹åºåˆ›å»ºå’Œå­˜å‚¨è¿‡ç¨‹åˆ›å»ºè¿™2ç§æ–¹å¼ä¸ç‰¹å®šçš„æ•°æ®è¡¨å¼ºç›¸å…³ï¼Œæ¢åšå…¶å®ƒè¡¨åéœ€è¦é‡æ–°ä¿®æ”¹ï¼Œæ•…åœ¨æ²¡æœ‰ç‰¹æ®Šè¦æ±‚çš„æƒ…å†µä¸‹å»ºè®®é‡‡ç”¨SQLè¯­å¥åˆ›å»ºã€‚\n\rç–‘é—®\næŒ‰å­˜å‚¨è¿‡ç¨‹åˆ›å»ºä»ç†è®ºä¸Šæ¥è¯´é€Ÿåº¦è¦æ¯”SQLè¯­å¥åˆ›å»ºå¿«å¾ˆå¤š(å­˜å‚¨è¿‡ç¨‹å¯ä»¥æ§åˆ¶æ¯æ¬¡æäº¤çš„æ•°æ®é‡å¤§å°)ï¼Œä½†å¤šæ¬¡æµ‹è¯•å‘ç°å‰è€…çš„è€—æ—¶çº¦ä¸ºåè€…çš„1å€ï¼ŒåŸå› å¾…ç»§ç»­åˆ†æã€‚\n\r  å‰ææ˜¯æœ‰åˆ›å»ºå­˜å‚¨è¿‡ç¨‹çš„æƒé™\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n åŸºäºç›¸åŒçš„æäº¤æ¬¡æ•°è¿›è¡Œæ¯”è¾ƒï¼Œä¸”æ˜¯åœ¨ä¸ªäººç”µè„‘ç¯å¢ƒï¼Œåªåšæ¨ªå‘å¯¹æ¯”ï¼Œä¸å…·æœ‰å¾ˆå¼ºçš„å‚è€ƒä»·å€¼\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n ä»£ç ç¨‹åºåˆ›å»ºå’Œå­˜å‚¨è¿‡ç¨‹åˆ›å»ºä¸­æ¶‰åŠåˆ°ä¸€äº›æ§åˆ¶é€»è¾‘å’Œéšæœºæ•°çš„ç”Ÿæˆï¼Œè¿™äº›æ˜¯é€ æˆå…¶è€—è´¹æ—¶é—´è¾ƒé•¿çš„å› ç´ ä¹‹ä¸€\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/mysql/mysql-create-massive-test-data-quickly/","tags":["mysql"],"title":"MySQLä¸­å¿«é€Ÿåˆ›å»ºå¤§é‡æµ‹è¯•æ•°æ®"},{"categories":["æ•°æ®åº“"],"contents":"åœ¨æ•°æ®åº“ä¸­ä½¿ç”¨COUNTå‡½æ•°ç»Ÿè®¡æ€»æ•°æ˜¯å¸¸ç”¨æ“ä½œï¼Œæœ¬æ–‡å‚è€ƒç½‘ä¸Šèµ„æ–™ä»¥åŠä¸ªäººå®é™…æ“ä½œè®°å½•ä¸‹MySQLä¸­é€šè¿‡COUNT(åˆ—å)ã€COUNT(å¸¸é‡)ä»¥åŠCOUNT(*)åœ¨ç›¸åŒæŸ¥è¯¢æ¡ä»¶ä¸‹1 çš„åŒºåˆ«ä»¥åŠä½¿ç”¨åœºæ™¯ã€‚\næœ¬æ–‡åŸºäºInnoDBå’ŒMyISAMè¿™ä¸¤ç§å¸¸è§çš„MySQLå¼•æ“ï¼Œåˆ©ç”¨åä¸ºadd_user_batchçš„å­˜å‚¨è¿‡ç¨‹å‘system_userè¡¨ä¸­æ’å…¥1000ä¸‡æ•°æ®ï¼Œå¯¹æ¯”æµ‹è¯•å®ƒä»¬çš„æŸ¥è¯¢ç»“æœå’Œå“åº”æ€§èƒ½ã€‚\n1 2 3 4 5 6 7  CREATETABLE`system_user`(`id`INTNOTNULLAUTO_INCREMENT,`name`VARCHAR(8)CHARACTERSETutf8COLLATEutf8_general_ciNOTNULL,`age`INTDEFAULTNULL,`tag`VARCHAR(8)CHARACTERSETutf8COLLATEutf8_general_ciDEFAULTNULL,PRIMARYKEY(`id`))ENGINE=INNODBCHARSET=utf8;  åœ¨add_user_batchä¸­ï¼Œé‡‡ç”¨å¾ªç¯çš„æ–¹å¼åŠ¨æ€ç”Ÿæˆæ•°æ®ï¼Œæ¯å¾ªç¯100æ¬¡ä¼šå°†insertæ‰¹é‡æ‰§è¡Œè¯­å¥æ’å…¥æ•°æ®åº“ä¸­å¹¶æäº¤ï¼Œæ¯å¾ªç¯25æ¬¡å…¶ä¸­çš„tagå°±ä¼šè¢«ç½®ä¸ºç©ºï¼Œæ•…tagå€¼ä¸ºç©ºçš„è®°å½•æ€»å…±æœ‰400000ä¸ªã€‚\nç»“æœå¯¹æ¯” åœ¨MySQLçš„å®˜ç½‘ä¸­å¯¹äºCOUNT()å‡½æ•°æœ‰å¦‚ä¸‹è¯´æ˜ï¼š\n Returns a count of the number of non-NULL values of expr in the rows retrieved by a SELECT statement. The result is a BIGINT value.\nIf there are no matching rows,COUNT() returns 0. COUNT(NULL) returns 0.\n\rCOUNT(*)is somewhat different in that it returns a count of the number of rows retrieved, whether or not they contain NULL values.\n ä»ä¸­å¯ä»¥å¾—å‡ºå¦‚ä¸‹ç»“è®º:\n COUNT(expr)è®¡ç®—çš„æ˜¯SELECTæ“ä½œè·å–çš„æ•°æ®è¡Œä¸­exprä¸ä¸ºç©ºçš„æ€»æ•° COUNT(*)è®¡ç®—çš„æ˜¯SELECTæ“ä½œè·å–çš„æ‰€æœ‰è¡Œæ•°ï¼Œä¸è®ºå…¶ä¸­æ˜¯å¦æœ‰åˆ—ä¸ºç©º  ç”±äºCOUNT()ä¸»è¦æ˜¯è·å–ä¸ä¸ºç©ºçš„å€¼ï¼Œè€Œåœ¨ä½¿ç”¨COUNT(å¸¸é‡)æ—¶å…¶å€¼æ’ä¸ºçœŸï¼Œæ•…å…¶ç»“æœä¸COUNT(*)ç›¸åŒï¼ŒåŒæ—¶ç”±äºä¸»é”®ä¸èƒ½ä¸ºç©ºï¼Œæ•…COUNT(ä¸»é”®)çš„ç»“æœä¹Ÿä¸å®ƒä»¬ç›¸åŒã€‚åŸºäºä¸Šè¿°ç†è®ºåˆ†æå¯è·çŸ¥\n COUNT(*)=COUNT(å¸¸é‡)=COUNT(ä¸»é”®)\u0026gt;=2COUNT(éä¸»é”®åˆ—)\n é‡‡ç”¨å‰é¢å­˜å‚¨è¿‡ç¨‹ç”Ÿæˆçš„æ•°æ®åˆ†åˆ«ç”¨ä¸Šè¿°4ç§æ–¹å¼å»æŸ¥è¯¢çš„ç»“æœå¦‚ä¸‹ï¼Œç”±äºtagå€¼ä¸ºç©ºçš„è®°å½•æ•°ä¸º400000ä¸ªï¼Œæ•…COUNT(tag)è¿”å›çš„è®°å½•æ•°ä¸º9600000ï¼Œå®é™…æŸ¥è¯¢ç»“æœå‡ç¬¦åˆç†è®ºé¢„æœŸã€‚\nä¸åŒäº‹åŠ¡ä¸­çš„ç»“æœ ç”±äºInnoDBå¼•æ“æ”¯æŒäº‹åŠ¡ï¼Œè€Œåœ¨ä¸åŒäº‹åŠ¡å¯èƒ½ä¼šå¯¼è‡´æ•°æ®åº“è®°å½•ä¸ä¸€è‡´ï¼Œæ•…åœ¨MySQLå®˜ç½‘ä¸­å¯¹äºInnoDBæœ‰å¦‚ä¸‹æ–‡å­—è¯´æ˜ï¼Œå…¶ä¸»è¦è¯´æ˜çš„æ˜¯COUNT()è¿”å›çš„æ˜¯å½“å‰äº‹åŠ¡ä¸­å¯è§çš„å¯¹åº”è¡Œæ•° ï¼Œå³åŒæ ·çš„æŸ¥è¯¢SQLåœ¨ä¸åŒçš„äº‹åŠ¡ä¸­å…¶ç»“æœå¯èƒ½ä¸ç›¸åŒ3\n InnoDB does not keep an internal count of rows in a table because concurrent transactions might â€œseeâ€ different numbers of rows at the same time. Consequently, SELECT COUNT(*) statements only count rows visible to the current transaction.\n æ€§èƒ½å¯¹æ¯” è¯´æ˜\nç”±äºæµ‹è¯•ç¯å¢ƒä»¥åŠMySQLæŸ¥è¯¢ç¼“å­˜çš„åŸå› ï¼Œå³ä½¿æ˜¯åŒä¸€æ¡SQLæŸ¥è¯¢å¤šæ¬¡æŸ¥è¯¢çš„æ—¶é—´æ¶ˆè€—ä¹Ÿä¸å®Œå…¨ç›¸åŒï¼Œæ•…åœ¨æ€§èƒ½å¯¹æ¯”è¿™å—åªåšå¤§è‡´æ—¶é—´çš„å¯¹æ¯”ï¼Œä¸ä¼šç²¾ç¡®åˆ°æ¯«ç§’çº§ã€‚\n\rç»§ç»­ä»MySQLå®˜æ–¹ä¸­å¯»æ‰¾ç›¸å…³è¯´æ˜:\n InnoDB handles SELECT COUNT(*) and SELECT COUNT(1) operations in the same way. There is no performance difference.\nFor MyISAM tables, COUNT(*) is optimized to return very quickly if the SELECT retrieves from one table, no other columns are retrieved, and there is no WHERE clause.\nThis optimization only applies to MyISAM tables, because an exact row count is stored for this storage engine and can be accessed very quickly. COUNT(1) is only subject to the same optimization if the first column is defined as NOT NULL\n ä¸Šè¿°æ–‡å­—çš„è¦ç‚¹å¦‚ä¸‹ï¼š\n InnoDBå¯¹äºCOUNT(*)å’ŒCOUNT(1)ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç†ï¼Œå®ƒä»¬æ²¡æœ‰æ€§èƒ½ä¸Šçš„åŒºåˆ« MyISAMå¯¹äºCOUNT(*)åœ¨ æ²¡æœ‰WHEREæ¡ä»¶ä¸”åªæŸ¥è¯¢ä¸€å¼ è¡¨ çš„æƒ…å†µä¸‹ä¼šè¿›è¡Œä¼˜åŒ–ï¼Œè€ŒCOUNT(1)åªæœ‰åœ¨ æ²¡æœ‰WHEREæ¡ä»¶ä¸”ç¬¬1åˆ—ä¸ä¸ºç©º çš„æƒ…å†µä¸‹æ‰ä¼šè¿›è¡Œä¼˜åŒ–  å¯¹äºç¬¬1ç‚¹å¯ä»å‰é¢ç»“æœå¯¹æ¯”æŸ¥è¯¢å›¾ä¸­å¾—åˆ°éªŒè¯ï¼Œå…¶æŸ¥è¯¢æ—¶é—´éƒ½è¿‘ä¼¼ä¸º0.01sã€‚\nä¸‹é¢åˆ†åˆ«å±•ç¤ºMyISAMåœ¨æœ‰å’Œæ²¡æœ‰WHEREè¿‡æ»¤æ¡ä»¶æ—¶COUNT()å‡½æ•°çš„æŸ¥è¯¢è€—æ—¶ï¼š\n  æ²¡æœ‰WHEREæ¡ä»¶æ‰§è¡Œå¦‚ä¸‹ï¼Œä»ä¸­å¯ä»¥çœ‹å‡ºåªæœ‰å¯¹äºå¯èƒ½å­˜åœ¨ç©ºå€¼çš„tagåˆ—ï¼Œå…¶æŸ¥è¯¢è€—æ—¶ä¸º2.26sï¼Œå…¶ä½™çš„è€—æ—¶å‡ä¸º0.01sï¼Œè¿™å…¶ä¸­çš„ç‰¹ä¾‹æ˜¯nameåˆ—ï¼Œè™½ç„¶ä¸æ˜¯ä¸»é”®ï¼Œä½†æ˜¯ç”±äºåœ¨å»ºè¡¨æ—¶é™åˆ¶å…¶éç©ºï¼Œæ•…InnoDBå¼•æ“ä¼šå¯¹å…¶è¿›è¡Œä¼˜åŒ–å¤„ç†ã€‚\n  æœ‰WHEREæ¡ä»¶æ‰§è¡Œå¦‚ä¸‹ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶ç”±äºInnoDBå¼•æ“ä¼˜åŒ–ä¸ç”Ÿæ•ˆï¼Œæ•…å®ƒä»¬çš„æŸ¥è¯¢æ—¶é—´éƒ½åœ¨ç§’çº§èŒƒå›´ã€‚\n  ç»™system_userè¡¨æ·»åŠ åä¸ºtypeçš„åˆ—å¹¶æ”¾åœ¨ç¬¬1åˆ—ï¼Œç„¶ååˆ†åˆ«æ‰§è¡ŒCOUNT(1)ä¸COUNT(*)å‘ç°è€—æ—¶è¿‘ä¼¼ç›¸ï¼Œå®˜æ–¹æ–‡æ¡£ä¸Šè¯´çš„åªæœ‰åœ¨ç¬¬1åˆ—ä¸ä¸ºç©ºçš„é™åˆ¶æ¡ä»¶åœ¨æ­¤å¤„å¹¶ä¸ç”Ÿæ•ˆï¼ŒåŸå› å¾…è¿›ä¸€æ­¥åˆ†æã€‚\n  æ€»ç»“\u0026amp;å»ºè®®  æ€»ç»“:  SELECT COUNT(*)ï¼ŒæŸ¥è¯¢ç‰¹å®šè¡¨æ€»è¡Œæ•°æ—¶ SELECT COUNT(1)ï¼ŒæŸ¥è¯¢ç‰¹å®šè¡¨æ€»è¡Œæ•°ï¼Œå…¶ç»“æœåŒSELECT COUNT(*) SELECT COUNT(åˆ—å),æŸ¥è¯¢æŒ‡å®šåˆ—ä¸­ç¬¦åˆæ¡ä»¶å¾—æ‰€æœ‰éç©ºå€¼   ä½¿ç”¨å»ºè®®:  SELECT COUNT(*)ï¼ŒæŸ¥è¯¢æ€»è¡Œæ•°æ—¶ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯MyISAMå¼•æ“ä¼šåœ¨ç‰¹å®šåœºæ™¯ä¸‹è¿›è¡Œä¼˜åŒ– SELECT COUNT(1)ï¼Œç”±äºåœ¨MyISAMä¸­åªæœ‰åœ¨ç‰¹å®šåœºæ™¯ä¸‹ä¼˜åŒ–æ‰ä¼šç”Ÿæ•ˆï¼Œæ­¤ç§ç”¨æ³•è¾ƒä¸ºååƒ»ä¸ç¬¦åˆSQLè§„èŒƒï¼Œä¸å»ºè®®ä½¿ç”¨ SELECT COUNT(åˆ—å)ï¼ŒæŸ¥è¯¢å¯¹åº”åˆ—çš„éç©ºæ€»è¡Œæ•°    å‚è€ƒæ–‡æ¡£:\n https://segmentfault.com/a/1190000040733649 https://stackoverflow.com/questions/2710621/count-vs-count1-vs-countpk-which-is-better https://github.com/lucumt/myrepository/blob/master/mysql/add_user_batch.sql    å³WHEREåé¢çš„è¿‡æ»¤æ¡ä»¶ç›¸åŒ\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n ç›¸ç­‰çš„åœºæ™¯ä¸ºSELECTè¿”å›çš„è¡Œä¸­è¯¥åˆ—æ•°æ®å…¨éƒ¨ä¸ä¸ºç©º\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n ä¾èµ–äºå…·ä½“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/mysql/difference-and-usage-for-various-select-count/","tags":["mysql"],"title":"MySQLä¸­ä¸åŒSELECT COUNTç»Ÿè®¡æ€»æ•°æ—¶çš„åŒºåˆ«"},{"categories":["Javaç¼–ç¨‹"],"contents":"ClassNotFoundExceptionä¸NoClassDefFoundErroræ˜¯Javaå¼€å‘ä¸­ç»å¸¸ä¼šé‡åˆ°çš„å¼‚å¸¸ä¸é”™è¯¯ï¼Œæœ¬æ–‡åŸºäºä¸ªäººå·¥ä½œä¸­é‡åˆ°çš„åœºæ™¯ä»¥åŠç½‘ä¸Šçš„èµ„æ–™ï¼Œç®€è¦æ€»ç»“å®ƒä»¬çš„å·®å¼‚ã€å‡ºç°åœºæ™¯ä»¥åŠè§„é¿æ–¹æ¡ˆã€‚\nClassNotFoundException åˆ†æ ä¸Šå›¾ä¸ºClassNotFoundExceptionçš„ç±»ç»§æ‰¿ç»“æ„ï¼Œä»å›¾ä¸­å¯çœ‹å‡ºå®ƒç»§æ‰¿è‡ªExceptionä¸”æ²¡æœ‰ç»§æ‰¿è‡ªRuntimeException,åŸºäºJavaè¯­è¨€è§„èŒƒå®ƒå±äºChecked Exception1ï¼Œå®é™…ç¼–ç¨‹æ—¶å¿…é¡»åœ¨ä»£ç ä¸­åˆ©ç”¨try-catchæ˜¾ç¤ºçš„æ•è·å¤„ç†æˆ–è€…åˆ©ç”¨throwså°†å…¶æŠ›å‡ºåˆ°ä¸Šä¸€å±‚è°ƒç”¨è€…å¤„ç†ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç¼–è¯‘å™¨æŠ¥é”™ã€‚\näº§ç”ŸåŸå›  åœ¨ClassNotFoundExceptionçš„å®˜æ–¹APIä¸­å¯¹äºå…¶äº§ç”Ÿçš„åŸå› æœ‰å¦‚ä¸‹æè¿°:\n Thrown when an application tries to load in a class through its string name using:\n The forName method in class Class. The findSystemClass method in class ClassLoader . The loadClass method in class ClassLoader.  but no definition for the class with the specified name could be found.\n åŸºäºä¸Šè¿°æè¿°å¯çŸ¥ClassNotFoundExceptionäº§ç”Ÿçš„æ ¹æœ¬åŸå› å¦‚ä¸‹ï¼š\n åœ¨åº”ç”¨ç¨‹åºç±»ä¸­é€šè¿‡å¯¹åº”ç±»çš„å­—ç¬¦ä¸²åç§°å»åŠ è½½è¯¥ç±»æ—¶æ‰¾ä¸åˆ°ç±»çš„å®šä¹‰æ–‡ä»¶ï¼Œå³ä¼šæŠ›å‡ºæ­¤å¼‚å¸¸\n ä¸Šè¿°æè¿°å®é™…ä¸Šå¯åˆ†ä¸º2ç±»:\n åœ¨Classç±»ä¸­é€šè¿‡forNameæ–¹æ³•å»åŠ è½½ç±»æ—¶æ‰¾ä¸åˆ°ç±»å®šä¹‰æ–‡ä»¶ï¼Œç”±äºè¯¥æ–¹å¼å¯åœ¨æ™®é€šçš„Javaç±»ä¸­ä½¿ç”¨æ•…è¾ƒä¸ºå¸¸è§(å¦‚åŠ è½½æ•°æ®åº“é©±åŠ¨) åœ¨ClassLoaderç±»ä¸­é€šè¿‡findSystemClassæˆ–loadClasså»åŠ è½½ç±»æ—¶æ‰¾ä¸åˆ°ç±»å®šä¹‰æ–‡ä»¶ï¼Œç”±äºæ˜¯åœ¨ç±»åŠ è½½å™¨ä¸­ä½¿ç”¨ï¼Œä¸€èˆ¬çš„ä¸šåŠ¡æ¶‰åŠè¾ƒå°‘æ•…ä¸å¸¸è§  é—®é¢˜å¤ç°   åŸºäºClassç±»çš„forNameæ¨¡æ‹Ÿå¤ç°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  public class TestClassForName { public static void main(String[] args) { testForName(); } private static void testForName() { try { Class.forName(\u0026#34;com.jdbc.mysql.Driver\u0026#34;); System.out.println(\u0026#34;output info after Class.forName invoke inside try-catch\u0026#34;); } catch (ClassNotFoundException e) { e.printStackTrace(); } System.out.println(\u0026#34;output info after Class.forName invoke outside try-catch\u0026#34;); } }   è¾“å‡ºç»“æœå¦‚ä¸‹ï¼Œå¯è§try-catchä¹‹åçš„ä»£ç å—è¿˜èƒ½æ­£å¸¸æ‰§è¡Œ\n  åŸºäºClassLoaderä¸­çš„loadClasså¤ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  public class TestClassLoader { public static void main(String[] args) { testLoadClass(); } private static void testLoadClass() { try { ClassLoader.getSystemClassLoader().loadClass(\u0026#34;com.jdbc.mysql.Driver\u0026#34;); System.out.println(\u0026#34;output info after ClassLoader.loadClass invoke inside try-catch\u0026#34;); } catch (ClassNotFoundException e) { e.printStackTrace(); } System.out.println(\u0026#34;output info after ClassLoader.loadClass invoke outside try-catch\u0026#34;); } }   è¾“å‡ºç»“æœå¦‚ä¸‹\n  ä»ä¸Šè¿°ç»“æœå¯ä»¥çœ‹å‡ºClassNotFoundExceptionè™½ç„¶ä¼šå¯¼è‡´try-catchä»£ç å—é‡Œé¢ä½äºå¼‚å¸¸å‘ç”Ÿç‚¹ä¹‹åçš„ä»£ç æ— æ³•æ‰§è¡Œï¼Œä½†æ˜¯ä½äºtry-catchä»£ç å—å¤–é¢çš„ä»£ç ç¨‹åºæ‰§è¡Œä¸å—å½±å“(è¿™å…¶å®æ˜¯Checked Exceptionè‡ªèº«çš„ç‰¹æ€§å†³å®šçš„)ã€‚\nNoClassDefFoundError åˆ†æ ä¸Šå›¾ä¸ºNoClassDefFoundErrorçš„ç±»ç»§æ‰¿ç»“æ„ï¼Œä»å›¾ä¸­å¯çœ‹å‡ºå®ƒç»§æ‰¿è‡ªError,ï¼Œåœ¨Javaè¯­è¨€å…³äºExceptionçš„å®˜æ–¹APIä¸­æœ‰å¦‚ä¸‹æè¿°ï¼š\n The unchecked exception classes are the run-time exception classes and the error classes.\n æ•…NoClassDefFoundErrorå±äºUnchecked Exceptionï¼Œè€Œå¯¹äºè¿™ç±»å¼‚å¸¸ä¸éœ€è¦åœ¨ç¨‹åºä¸­æ˜¾ç¤ºçš„é€šè¿‡try-catchæ•è·ï¼Œéœ€è¦ä»ä»£ç å’Œå·¥ç¨‹å±‚é¢è¿›è¡Œå¤„ç†ã€‚\näº§ç”ŸåŸå›  åœ¨NoClassDefFoundErrorçš„å®˜æ–¹APIä¸­æœ‰å¦‚ä¸‹æè¿°ï¼š\n Thrown if the Java Virtual Machine or a ClassLoader instance tries to load in the definition of a class (as part of a normal method call or as part of creating a new instance using the new expression) and no definition of the class could be found.\nThe searched-for class definition existed when the currently executing class was compiled, but the definition can no longer be found.\n åŸºäºä¸Šè¿°æè¿°å¯çŸ¥NoClassDefFoundErroräº§ç”Ÿçš„æ ¹æœ¬åŸå› å¦‚ä¸‹ï¼š\n ç¨‹åºåœ¨ç¼–è¯‘æ—¶è¯¥ç±»å­˜åœ¨ï¼Œåœ¨è°ƒç”¨è¿‡ç¨‹ä¸­JVMè™šæ‹ŸæœºåŠ è½½è¯¥ç±»æ—¶æ‰¾ä¸åˆ°è¯¥ç±»çš„Classæ–‡ä»¶\n ç”±äºJavaç±»åŠ è½½è¿‡ç¨‹æœ‰å¦‚ä¸‹å›¾æ‰€ç¤ºçš„5ä¸ªé˜¶æ®µï¼Œåœ¨å…¶ä¸­æ¯ä¸ªé˜¶æ®µéƒ½å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œç»“åˆå®é™…å¼€å‘åœºæ™¯ï¼Œæœ€å…¸å‹çš„ä¸¤ç±»åœºæ™¯å¦‚ä¸‹ï¼š\n ç±»åŠ è½½é˜¶æ®µå‡ºé”™ã€‚å¦‚åœ¨ç¼–è¯‘æ—¶ç±»å­˜åœ¨ï¼Œä½†æ‰§è¡Œæ—¶ä¸å­˜åœ¨ï¼Œä¸€ä¸ªå…¸å‹çš„åœºæ™¯æ˜¯ jaråŒ…ç‰ˆæœ¬ä¸åŒ¹é…ï¼ è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­æœ€å®¹æ˜“é‡åˆ°çš„åœºæ™¯ ç±»åˆå§‹åŒ–é˜¶æ®µå‡ºé”™ã€‚æ­¤ç§åœºæ™¯ä¸‹ç¼–è¯‘ä¹Ÿèƒ½é€šè¿‡ï¼Œä½†ç”±äºæŸç§åŸå› å¯¼è‡´åˆå§‹åŒ–å¤±è´¥ï¼Œç¨‹åºä»ç„¶æ— æ³•è°ƒç”¨ç±»ã€‚  ä¸ä¹‹ç›¸ä¼¼çš„é”™è¯¯ä¸ºNoSuchMethodErrorï¼Œå…¶äº§ç”ŸåŸå› ä¸ºç¨‹åºæ‰§è¡Œæ—¶ç±»å­˜åœ¨ï¼Œä½†æ˜¯å½“å‰ç¨‹åºè°ƒç”¨çš„æ–¹æ³•ä¸å­˜åœ¨ã€‚\né—®é¢˜å¤ç°   ç±»åŠ è½½é˜¶æ®µå‡ºé”™ï¼Œåœ¨ç¼–è¯‘åjaræ–‡ä»¶ä¸­åˆ é™¤è¦è°ƒç”¨çš„classç±»å³å¯å®ç°ï¼š\nè¦ç¼–è¯‘ä¸ºjaræ–‡ä»¶çš„ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  /* ç±»ç»“æ„ +---src | +---main | | \\---java | | \\---com | | \\---lucumt | | \\---api | | InnerApi.java | | OuterApi.java */ public class OuterApi { public static void invoke() { InnerApi.hello(); } } public class InnerApi { public static void hello() { System.out.println(\u0026#34;hello\u0026#34;); } }   ä¸»æ‰§è¡Œç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13  import com.lucumt.api.OuterApi; public class TestNoClassDefFoundError1 { public static void main(String[] args) { try { OuterApi.invoke(); } catch (NoClassDefFoundError e) { e.printStackTrace(); } System.out.println(\u0026#34;OutApi invoke\u0026#34;); } }   å°†ä¸Šè¿°å·¥ç¨‹ç¼–è¯‘æ‰“åŒ…ä¸ºjaræ–‡ä»¶ï¼Œç„¶ååœ¨jaræ–‡ä»¶ä¸­å»æ‰InnerApiï¼Œå°†å…¶å¼•å…¥åŒ…å«æ‰§è¡Œç±»çš„æµ‹è¯•å·¥ç¨‹ï¼Œæ­¤æ—¶å…¶ç»“æ„å¦‚ä¸‹ï¼š\nè¾“å‡ºç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºè™½ç„¶æŠ›å‡ºäº†å¼‚å¸¸ï¼Œä½†åœ¨try-catchä»£ç å—ä¹‹åçš„ä»£ç è¿˜æ˜¯èƒ½å¤Ÿæ‰§è¡Œ\n  ç±»åˆå§‹åŒ–é˜¶æ®µå‡ºé”™ï¼Œé€šè¿‡æŸç§æ–¹å¼å¼ºåˆ¶åˆå§‹åŒ–å‡ºé”™ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  public class TestNoClassDefFoundError2 { public static void main(String[] args) { try { Demo.hello(); }catch(NoClassDefFoundError e){ e.printStackTrace(); } System.out.println(\u0026#34;invoke Demo.hello()\u0026#34;); } } class Demo { private static int val = 1 / 0; public static void hello() { System.out.println(\u0026#34;hello\u0026#34;); } }   è¾“å‡ºç»“æœå¦‚ä¸‹ï¼Œä¸åŒäºå‰ä¸€ä¸ªæµ‹è¯•ï¼Œæ­¤å¤„çš„try-catchä¹‹åçš„ä»£ç æ²¡æœ‰æœºä¼šæ‰§è¡Œ\n  ä»ä¸Šé¢2ä¸ªå®éªŒä¸­å¯å‘ç°è™½ç„¶éƒ½å¯¹NoClassDefFoundErrorè¿›è¡Œäº†try-catchæ•è·ï¼Œä½†ç¬¬ä¸€ä¸ªèƒ½ç»§ç»­æ‰§è¡Œï¼Œè€Œç¬¬äºŒä¸ªå´ç›´æ¥ç»ˆæ­¢ã€‚é€ æˆè¿™ç§å·®å¼‚çš„ä¸»è¦åŸå› æ˜¯ç¬¬ä¸€ä¸ªæµ‹è¯•ä¸­çš„Demoæ²¡èƒ½å®Œæˆåˆå§‹åŒ–ï¼Œå¯¼è‡´æ•´ä¸ªç¨‹åºåŠ è½½å¤±è´¥(å®é™…ä¸Šç¨‹åºæç¤ºçš„é”™è¯¯ä¸º ExceptionInInitializerError)ï¼Œè€Œç¬¬äºŒä¸ªç¨‹åºæ˜¯åœ¨æ‰§è¡Œä¸­æ‰é‡åˆ°ç±»ç¼ºå¤±2ã€‚\nåŸºäºUnchecked Exceptionæˆ‘ä»¬é€šå¸¸ä¸éœ€è¦åœ¨ä»£ç ä¸­æ˜¾ç¤ºçš„åˆ©ç”¨try-catchæ•è·ï¼Œæ›´å¤šçš„æ˜¯ä¿®æ”¹ä»£ç æœ¬èº«å’Œè°ƒæ•´jaræ–‡ä»¶ç‰ˆæœ¬ã€‚\næ€»ç»“     ClassNotFoundException NoClassDefFoundError     ç»§æ‰¿å…³ç³» java.lang.Exception java.lang.Error   ç±»å‹ å¼‚å¸¸ é”™è¯¯   ç¨‹åºå—å½±å“ç¨‹åº¦ æ·»åŠ try-catchåå¯ç»§ç»­æ‰§è¡Œ åŸºäºäº§ç”Ÿäºç±»åŠ è½½çš„ä¸åŒé˜¶æ®µï¼Œå¯èƒ½ç›´æ¥ç§æ¤ï¼Œä¹Ÿå¯èƒ½åœ¨try-catchä¹‹åç»§ç»­æ‰§è¡Œ   å¯èƒ½çš„åœºæ™¯ 1.è¦åŠ è½½çš„ç±»ä¸å­˜åœ¨\n2.ç±»åç¼–å†™é”™è¯¯ 1.jaråŒ…ç¼ºå¤±æˆ–jaråŒ…ç‰ˆæœ¬ä¸åŒ¹é…\n2.ç±»åˆå§‹åŒ–å¤±è´¥   å¤„ç†æ–¹æ³• 1. ä¿®æ”¹ä»£ç ï¼Œæ·»åŠ ç¼ºå¤±çš„jaræ–‡ä»¶\n2. ä»£ç ä¸­æ·»åŠ try-catchæ•è·å¼‚å¸¸ ä¿®æ”¹ä»£ç ä¸šåŠ¡é€»è¾‘    å‚è€ƒ:\n  https://segmentfault.com/a/1190000021292121\n  https://stackoverflow.com/questions/28322833/classnotfoundexception-vs-noclassdeffounderror\n    https://docs.oracle.com/javase/specs/jls/se7/html/jls-11.html\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n å®é™…ä¸Šåº”è¯¥æœ‰æ›´ç§‘å­¦æ›´ç†è®ºçš„è§£é‡Šï¼Œåªä¸è¿‡è‡ªå·±ç›®å‰æ‰¾ä¸åˆ°ç›¸å…³èµ„æ–™ï¼Œæš‚æ—¶è¿™ä¹ˆè§£é‡Š\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/java-core/difference-between-class-not-found-exception-and-no-class-def-found-error/","tags":["Java"],"title":"ClassNotFoundExceptionä¸NoClassDefFoundErrorå¯¹æ¯”"},{"categories":["Javaç¼–ç¨‹","Javaå¤šçº¿ç¨‹","ç¿»è¯‘"],"contents":"æœ¬æ–‡ç¿»è¯‘è‡ª Dealing with InterruptedException\nè¿™ä¸ªæ•…äº‹å¯èƒ½å¾ˆç†Ÿæ‚‰: ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åºï¼Œéœ€è¦å°†ç¨‹åºæš‚åœä¸€æ®µæ—¶é—´,äºæ˜¯ä½ è°ƒç”¨äº†Thread.sleep()æ¥å®ç°ã€‚ ä½†æ­¤æ—¶ç¼–è¯‘å™¨æˆ–IDEä¼šç«‹å³æç¤ºä½ æ²¡æœ‰å¤„ç†éè¿è¡Œæ—¶å¼‚å¸¸ InterruptedExceptionã€‚é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯InterruptedException,ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å¿…é¡»å¤„ç†å®ƒå‘¢ï¼Ÿ\næœ€å¸¸è§çš„å¤„ç†æ–¹å¼æ˜¯å°†è¯¥å¼‚å¸¸åæ²¡æ‰: é€šè¿‡try-catchæ•è·è¯¥å¼‚å¸¸ç„¶åä¸è¿›è¡Œä»»ä½•å¤„ç†(æˆ–è®¸ä¼šç”¨æ—¥å¿—æ¥è®°å½•å¼‚å¸¸ï¼Œä½†å¹¶æ²¡æœ‰æ”¹è¿›å¤šå°‘)ï¼Œ æˆ‘ä»¬å°†åœ¨ä»£ç æ¸…å•4ä¸­çœ‹è§æ­¤æ–¹å¼çš„ä½¿ç”¨ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§æ–¹å¼ä¸¢å¼ƒäº†æœ‰å…³ä¸­æ–­äº§ç”Ÿçš„é‡è¦ä¿¡æ¯ï¼Œè€Œè¿™å¯èƒ½ä¼šå½±å“åº”ç”¨ç¨‹åºåŠæ—¶å–æ¶ˆæ‰§è¡Œæˆ–å…³é—­çš„èƒ½åŠ›ã€‚\né˜»å¡æ–¹æ³• å½“ä¸€ä¸ªæ–¹æ³•æŠ›å‡ºInterruptedExceptionå¼‚å¸¸æ—¶ï¼Œé™¤äº†è¯¥å¼‚å¸¸ä¹‹å¤–å®ƒè¿˜ä¼šå‘Šè¯‰ä½ é¢å¤–çš„ä¸€äº›ä¿¡æ¯ã€‚å¦‚æœä½ é—®çš„å¥½ï¼Œå®ƒä¼šå‘Šè¯‰ä½ è¿™æ˜¯ä¸€ä¸ªé˜»å¡æ–¹æ³•ï¼Œ å®ƒä¼šå°è¯•è§£é™¤é˜»å¡å¹¶ä¸”æå‰è¿”å›ã€‚\né˜»å¡æ–¹æ³•ä¸åŒäºä¸€ä¸ªéœ€è¦é•¿æ—¶é—´è¿”å›çš„æ™®é€šæ–¹æ³•ï¼Œæ™®é€šæ–¹æ³•çš„å®Œæˆä»…å–å†³äºä½ è¦æ±‚å®ƒåšå¤šå°‘å·¥ä½œä»¥åŠæ˜¯å¦æœ‰è¶³å¤Ÿçš„è®¡ç®—èµ„æº(CPUå¾ªç¯å’Œå†…å­˜)ï¼Œå¦ä¸€æ–¹é¢ï¼Œé˜»å¡æ–¹æ³•çš„å®Œæˆåº¦è¿˜å–å†³äºæŸäº›å¤–éƒ¨äº‹ä»¶ï¼Œä¾‹å¦‚è®¡æ—¶å™¨åˆ°æœŸã€I/Oæ“ä½œå®Œæˆæˆ–å¦ä¸€ä¸ªçº¿ç¨‹çš„æ“ä½œ(é‡Šæ”¾é”ã€è®¾ç½®æ ‡å¿—ä½æˆ–å°†ä»»åŠ¡æ”¾åˆ°ä¸€ä¸ªå·¥ä½œé˜Ÿåˆ—ä¸­ç­‰)ã€‚æ™®é€šçš„æ–¹æ³•åªè¦å…¶å·¥ä½œä»»åŠ¡å®Œæˆäº†è¯¥æ–¹æ³•å°±å®Œæˆï¼Œè€Œé˜»å¡æ–¹æ³•ç”±äºå®ƒä»¬ä¾èµ–äºå¤–éƒ¨äº‹ä»¶è€Œä¸å¤ªå¯é¢„æµ‹ã€‚ç”±äºå¾ˆéš¾é¢„æµ‹ä½•æ—¶å®Œæˆï¼Œé˜»å¡æ–¹æ³•ä¼šå½±å“å“åº”èƒ½åŠ›ã€‚\nç”±äºé˜»å¡æ–¹æ³•å¯èƒ½ç”±äºç­‰å¾…çš„äº‹ä»¶æ°¸è¿œä¸å‘ç”Ÿè€Œä¸€ç›´é˜»å¡ï¼Œæ‰€ä»¥é€šå¸¸èƒ½å–æ¶ˆè¯¥æ–¹æ³•å¯¹é˜»å¡æ–¹æ³•å¾ˆæœ‰ç”¨(å¯¹äºé•¿æ—¶é—´è¿è¡Œçš„éé˜»å¡æ–¹æ³•ï¼Œé€šå¸¸ä¹Ÿæ˜¯æœ‰ç”¨çš„)ã€‚å¯å–æ¶ˆçš„æ“ä½œæ˜¯æŒ‡èƒ½ä»å¤–éƒ¨æå‰ç»“æŸä¸€ä¸ªéœ€è¦å®ƒè‡ªå·±å®Œæˆçš„ä»»åŠ¡ã€‚Object.wait()å’ŒThreadæä¾›çš„Thread.sleep()å³æ˜¯ä¸€ç§å–æ¶ˆæœºåˆ¶ï¼Œå®ƒå…è®¸ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚å¦å¤–ä¸€ä¸ªçº¿ç¨‹æå‰åœæ­¢å®ƒæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚å½“ä¸€ä¸ªæ–¹æ³•æŠ›å‡ºInterruptedExceptionå¼‚å¸¸æ—¶ï¼Œæ„å‘³ç€å¦‚æœæ‰§è¡Œè¯¥æ–¹æ³•çš„çº¿ç¨‹è¢«ä¸­æ–­ï¼Œå®ƒå°†é€šè¿‡æŠ›å‡ºInterruptedExceptionå¼‚å¸¸æ¥å°è¯•åœæ­¢å½“å‰ä»»åŠ¡å¹¶ä¸”æå‰è¿”å›ã€‚ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„é˜»å¡åº“æ–¹æ³•åº”è¯¥åŠæ—¶å“åº”ä¸­æ–­å¹¶æŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼Œå› è€Œå¯ä»¥åœ¨å¯å–æ¶ˆçš„ä»»åŠ¡ä¸­ä½¿ç”¨è€Œä¸å½±å“å“åº”èƒ½åŠ›ã€‚\nçº¿ç¨‹ä¸­æ–­ æ¯ä¸ªçº¿ç¨‹éƒ½ä¸€ä¸ªä¸ä¹‹å…³è”çš„å¸ƒå°”å±æ€§æ¥è¡¨ç¤ºå…¶ä¸­æ–­çŠ¶æ€ã€‚ä¸­æ–­çŠ¶æ€çš„åˆå§‹å€¼ä¸ºfalseï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¢«å…¶å®ƒçº¿ç¨‹è°ƒç”¨Thread.interrupt()æ–¹æ³•ä¸­æ–­æ—¶ï¼Œä¼šæ ¹æ®å®é™…æƒ…å†µåšå‡ºå“åº”: å¦‚æœè¯¥çº¿ç¨‹æ­£åœ¨æ‰§è¡Œä½çº§åˆ«çš„å¯ä¸­æ–­æ–¹æ³•(å¦‚Thread.sleep()ã€Thread.join()æˆ–Object.wait())ï¼Œåˆ™ä¼šè§£é™¤é˜»å¡å¹¶æŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼Œå¦åˆ™Thread.interrupt()ä»…è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œåœ¨è¯¥è¢«ä¸­æ–­çš„çº¿ç¨‹ä¸­ç¨åå¯é€šè¿‡è½®è¯¢ä¸­æ–­çŠ¶æ€æ¥å†³å®šæ˜¯å¦è¦åœæ­¢å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚ä¸­æ–­çŠ¶æ€å¯é€šè¿‡Thread.isInterrupted()æ¥è¯»å–ï¼Œä¹Ÿå¯é€šè¿‡ä¸è§„èŒƒå‘½åçš„Thread.interrupted()åœ¨å•ä¸ªæ“ä½œä¸­è¯»å–å’Œæ¸…é™¤ä¸­æ–­çŠ¶æ€ã€‚\nä¸­æ–­æ˜¯ä¸€ç§åä½œæœºåˆ¶ã€‚å½“ä¸€ä¸ªçº¿ç¨‹ä¸­æ–­äº†å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œè¢«ä¸­æ–­çš„çº¿ç¨‹æ²¡å¿…è¦åœæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œç›¸åï¼Œä¸­æ–­åªæ˜¯ç¤¼è²Œçš„è¦æ±‚è¢«ä¸­æ–­çš„çº¿ç¨‹åœ¨å®ƒæ–¹ä¾¿çš„æ—¶å€™åœæ­¢å®ƒå½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚æœ‰äº›æ–¹æ³•å¦‚Thread.sleep()ä¼šè®¤çœŸå¯¹å¾…è¿™ä¸ªè¦æ±‚ï¼Œè€Œå…¶å®ƒä¸€äº›æ–¹æ³•åˆ™ä¸éœ€è¦æ³¨æ„ä¸­æ–­ã€‚ä¸é˜»å¡ä½†éœ€è¦é•¿æ—¶é—´æ‰§è¡Œçš„æ–¹æ³•ä¹Ÿå¯é€šè¿‡è½®è¯¢ä¸­æ–­çŠ¶æ€æ¥æå‰è¿”å›ï¼Œä½ ä¹Ÿå¯ä»¥å¿½ç•¥ä¸­æ–­æ±‚ï¼Œä½†è¿™æ ·åšå¯èƒ½ä¼šå½±å“å“åº”æ€§ã€‚\nä¸­æ–­çš„åä½œç‰¹æ€§çš„ä¸€ä¸ªå¥½å¤„æ˜¯å®ƒä¸ºå®‰å…¨çš„æ„å»ºå¯å–æ¶ˆçš„ä»»åŠ¡æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚å®é™…ä¸Šæˆ‘ä»¬å¾ˆå°‘æƒ³è¦ç«‹å³ç»ˆæ­¢ä¸€ä¸ªä»»åŠ¡ï¼Œå¦‚æœä»»åŠ¡åœ¨æ›´æ–°æœŸé—´è¢«å–æ¶ˆï¼Œç¨‹åºæ•°æ®ç»“æ„å¯èƒ½ä¼šå¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚è€Œä¸­æ–­æ“ä½œå…è®¸æˆ‘ä»¬åœ¨ä»»åŠ¡ç»ˆæ­¢ä¹‹å‰åšå…¶å®ƒçš„ä¸€äº›æ“ä½œï¼Œå¦‚æ¸…ç†ä»»ä½•æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ã€æ¢å¤ä¸å˜é‡ã€å°†ç»ˆç«¯è¯·æ±‚é€šçŸ¥ç»™å…¶å®ƒä»»åŠ¡ç­‰ã€‚\nå¤„ç†InterruptedException å¦‚æœæŠ›å‡ºInterruptedExceptionå¼‚å¸¸æ„å‘³ç€è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªé˜»å¡æ–¹æ³•ï¼Œé‚£ä¹ˆè°ƒç”¨ä¸€ä¸ªé˜»å¡æ–¹æ³•æ„å‘³ç€è°ƒç”¨æ–¹æ³•ä¹Ÿæ˜¯é˜»å¡æ–¹æ³•ï¼Œæˆ‘ä»¬åº”è¯¥æœ‰ä¸€ä¸ªå¤„ç†InterruptedExceptionå¼‚å¸¸çš„ç­–ç•¥ã€‚é€šè¿‡æœ€ç®€å•çš„ç­–ç•¥æ˜¯ç›´æ¥æŠ›å‡ºInterruptedExceptionï¼Œå¦‚ä»£ç æ¸…å•1ä¸­puskTask()å’ŒgetTask()æ–¹æ³•æ‰€ç¤º,è¿™æ ·åšå³å¯ä½¿æ–¹æ³•å“åº”ä¸­æ–­ï¼Œå¹¶ä¸”é€šå¸¸åªéœ€è¦åœ¨throwså­—å¥ä¸­æ·»åŠ InterruptedExceptionã€‚\nä»£ç æ¸…å•1ï¼š é€šè¿‡å‘è°ƒç”¨è€…ä¼ é€’InterruptedExceptionæ¥é¿å…æ•è·\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  public class TaskQueue { private static final int MAX_TASKS = 1000; private BlockingQueue\u0026lt;Task\u0026gt; queue = new LinkedBlockingQueue\u0026lt;Task\u0026gt;(MAX_TASKS); public void putTask(Task r) throws InterruptedException { queue.put(r); } public Task getTask() throws InterruptedException { return queue.take(); } }   æœ‰æ—¶åœ¨ä¼ æ’­å¼‚å¸¸ä¹‹å‰éœ€è¦è¿›è¡Œä¸€äº›æ¸…ç†ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥æ•è·InterruptedExceptionï¼Œæ‰§è¡Œæ¸…ç†ç„¶åé‡æ–°æŠ›å‡ºå¼‚å¸¸ã€‚ä»£ç æ¸…å•2ï¼Œä¸€ç§ç”¨äºåŒ¹é…åœ¨çº¿æ¸¸æˆæœåŠ¡ä¸­ç©å®¶çš„æœºåˆ¶å±•ç¤ºäº†è¿™ç§æŠ€æœ¯ã€‚matchPlayers()æ–¹æ³•ç­‰å¾…ä¸¤ä¸ªç©å®¶åˆ°è¾¾åå°±å¼€å§‹ä¸€ä¸ªæ–°çš„æ¸¸æˆï¼Œå¦‚æœåœ¨ä¸€ä¸ªç©å®¶åˆ°è¾¾åä½†åœ¨ç¬¬äºŒä¸ªç©å®¶åˆ°è¾¾ä¹‹å‰è¢«ä¸­æ–­ï¼Œå®ƒä¼šåœ¨é‡æ–°æŠ›å‡ºInterruptedExceptionå¼‚å¸¸ä¹‹å‰å°†è¯¥ç©å®¶æ”¾å›é˜Ÿåˆ—ï¼Œè¿™æ ·ç©å®¶çš„è¯·æ±‚å°±ä¸ä¼šä¸¢å¤±ã€‚\nä»£ç æ¸…å•2: åœ¨é‡æ–°æŠ›å‡ºInterruptedExceptionä¹‹å‰åŸºäºä»»åŠ¡è¿›è¡Œç‰¹å®šæ¸…ç†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  public class PlayerMatcher { private PlayerSource players; public PlayerMatcher(PlayerSource players) { this.players = players; } public void matchPlayers() throws InterruptedException { Player playerOne, playerTwo; try { while (true) { playerOne = playerTwo = null; // ç­‰ä¸¤ä¸ªç©å®¶åˆ°è¾¾åå¼€å§‹ä¸€ä¸ªæ–°çš„æ¸¸æˆ  playerOne = players.waitForPlayer(); // å¯èƒ½æŠ›å‡ºInterruptedException  playerTwo = players.waitForPlayer(); // å¯èƒ½æŠ›å‡ºInterruptedException  startNewGame(playerOne, playerTwo); } } catch (InterruptedException e) { //å¦‚æœä¸€ä¸ªç©å®¶è¾¾åˆ°åçº¿ç¨‹è¢«ä¸­æ–­ï¼Œå°†è¿™ä¸ªç©å®¶æ”¾å›é˜Ÿåˆ—  if (playerOne != null) players.addFirst(playerOne); //é‡æ–°æŠ›å‡ºå¼‚å¸¸  throw e; } } }   ä¸è¦åæ²¡ä¸­æ–­ æœ‰äº›æ—¶å€™æŠ›å‡ºInterruptedExceptionå¼‚å¸¸å¹¶ä¸åˆé€‚ï¼Œä¾‹å¦‚åœ¨ç”±Runnableå®šä¹‰çš„ä»»åŠ¡ä¸­è°ƒç”¨ä¸€ä¸ªå¯ä¸­æ–­æ–¹æ³•ï¼Œåœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œä½ ä¸èƒ½æŠ›å‡ºInterruptedExceptionï¼Œä½†ä½ ä¹Ÿä¸æƒ³åšå…¶å®ƒä»»ä½•äº‹æƒ…ã€‚å½“é˜»å¡æ–¹æ³•æ£€æµ‹åˆ°ä¸­æ–­å¹¶æŠ›å‡ºInterruptedExceptionæ—¶ï¼Œå®ƒä¼šæ¸…é™¤ä¸­æ–­çŠ¶æ€ã€‚å¦‚æœæ•è·InterruptedExceptionå¼‚å¸¸ä½†æ— æ³•é‡æ–°æŠ›å‡ºå®ƒï¼Œåˆ™åº”ä¿ç•™ä¸­æ–­å‘ç”Ÿæ—¶çš„è¯æ®ï¼Œä»¥ä¾¿è°ƒç”¨å †æ ˆä¸Šçš„ä»£ç å¯ä»¥äº†è§£ä¸­æ–­å¹¶åœ¨å¿…è¦æ—¶å¯¹å…¶è¿›è¡Œå“åº”ã€‚å¦‚ä»£ç æ¸…å•3æ‰€ç¤ºï¼Œè¿™ä¸ªä»»åŠ¡æ˜¯é€šè¿‡è°ƒç”¨interrupt()æ¥ é‡æ–°ä¸­æ–­(reinterrupt) å½“å‰çº¿ç¨‹å®Œæˆçš„ã€‚æ¯å½“ä½ æ•è·InterruptedExceptionå¹¶ä¸”ä¸é‡æ–°æŠ›å‡ºå®ƒæ—¶ï¼Œè¦åœ¨è¿”å›ä¹‹å‰é‡æ–°ä¸­æ–­å½“å‰çº¿ç¨‹(å³æ¸…é™¤ä¸­æ–­çŠ¶æ€)ã€‚\nä»£ç æ¸…å•3: æ•è·InterruptedExceptionåæ¢å¤ä¸­æ–­çŠ¶æ€\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  public class TaskRunner implements Runnable { private BlockingQueue\u0026lt;Task\u0026gt; queue; public TaskRunner(BlockingQueue\u0026lt;Task\u0026gt; queue) { this.queue = queue; } public void run() { try { while (true) { Task task = queue.take(10, TimeUnit.SECONDS); task.execute(); } } catch (InterruptedException e) { //é‡æ–°è®¾ç½®å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ Thread.currentThread().interrupt(); } } }   å¯¹äºInterruptedExceptionæœ€ç³Ÿç³•çš„å¤„ç†æ˜¯åæ²¡å®ƒï¼Œåœ¨æ•è·å®ƒä¹‹åæ—¢ä¸é‡æ–°æŠ›å‡ºå®ƒä¹Ÿä¸é‡æ–°è®¾ç½®å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ã€‚\nä»£ç æ¸…å•4: åä¸‹ä¸­æ–­\u0026ndash;ä¸è¦è¿™æ ·åš\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  // ä¸è¦è¿™ä¹ˆåš public class TaskRunner implements Runnable { private BlockingQueue\u0026lt;Task\u0026gt; queue; public TaskRunner(BlockingQueue\u0026lt;Task\u0026gt; queue) { this.queue = queue; } public void run() { try { while (true) { Task task = queue.take(10, TimeUnit.SECONDS); task.execute(); } } catch (InterruptedException swallowed) { /* ä¸è¦è¿™ä¹ˆåš - ç›¸åè¦æ¢å¤çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ */ } } }   å¦‚æœä½ æ— æ³•é‡æ–°æŠ›å‡ºInterruptedExceptionï¼Œä¸è®ºä½ æ˜¯å¦è®¡åˆ’å¯¹ä¸­æ–­è¯·æ±‚è¿›è¡Œå“åº”ï¼Œä½ ä»ç„¶åº”è¯¥é‡æ–°è®¾ç½®å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œå› ä¸ºå•ä¸ªä¸­æ–­è¯·æ±‚å¯èƒ½æœ‰å¤šä¸ªæ¥æ”¶äººã€‚æ ‡å‡†çº¿ç¨‹æ± (ThreadPoolExecutor)ä¸­çš„å·¥ä½œçº¿ç¨‹å®ç°äº†å“åº”ä¸­æ–­ï¼Œå› æ­¤ä¸­æ–­çº¿ç¨‹æ± ä¸­è¿è¡Œçš„ä»»åŠ¡å¯èƒ½ä¼šåŒæ—¶å½±å“åˆ°å–æ¶ˆä»»åŠ¡å’Œé€šçŸ¥æ‰§è¡Œçº¿ç¨‹å½“å‰çº¿ç¨‹æ± æ­£åœ¨å…³é—­ã€‚å¦‚æœè¯¥ä»»åŠ¡åä¸‹ä¸­æ–­è¯·æ±‚ï¼Œåˆ™å·¥ä½œçº¿ç¨‹å¯èƒ½ä¸ä¼šçŸ¥é“è¯¥ä¸­æ–­è¢«è¯·æ±‚è¿‡ï¼Œè¿™å¯èƒ½ä¼šå»¶è¿Ÿåº”ç”¨ç¨‹åºæˆ–å…³é—­æœåŠ¡ã€‚\nå®ç°å¯å–æ¶ˆçš„ä»»åŠ¡ åœ¨Javaè¯­è¨€è§„èŒƒä¸­æ²¡æœ‰ä»»ä½•å†…å®¹å¯ä»¥ä¸­æ–­ä»»ä½•ç‰¹å®šè¯­ä¹‰ï¼Œä½†åœ¨è¾ƒå¤§ç¨‹åºä¸­ï¼Œå¾ˆéš¾ä¿æŒé™¤äº†å–æ¶ˆæ“ä½œä¹‹å¤–çš„ä»»ä½•ä¸­æ–­è¯­ä¹‰ã€‚ä¾èµ–äºå…·ä½“çš„ä¸šåŠ¡æ´»åŠ¨ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡GUIæˆ–JMSã€WebServiceæœåŠ¡ç­‰æ¥è¯·æ±‚å–æ¶ˆæ“ä½œã€‚ä¹Ÿå¯ä»¥ç”±ç¨‹åºé€»è¾‘è¯·æ±‚å®ç°ï¼Œä¾‹å¦‚ï¼Œç½‘ç»œçˆ¬è™«åœ¨æ£€æµ‹åˆ°ç£ç›˜ç©ºé—´å·²æ»¡æ—¶è‡ªåŠ¨å…³é—­ï¼Œæˆ–è€…å¹¶è¡Œç®—æ³•å¯èƒ½ä¼šå¯åŠ¨å¤šä¸ªçº¿ç¨‹æ¥æœç´¢è§£å†³æ–¹æ¡ˆçš„ä¸åŒåŒºåŸŸå¹¶åœ¨å…¶ä¸­ä¸€ä¸ªæ‰¾åˆ°è§£å†³æ–¹æ¡ˆåå–æ¶ˆå…¶ä½™çš„ã€‚\nä¸€ä¸ªä»»åŠ¡ä¸èƒ½ä»…ä»…å› ä¸ºå®ƒå¯ä»¥å–æ¶ˆè€Œæ„å‘³ç€å®ƒéœ€è¦ç«‹å³å“åº”ä¸­æ–­è¯·æ±‚ã€‚å¯¹äºé€šè¿‡ä»£ç å¾ªç¯æ‰§è¡Œçš„ä»»åŠ¡ï¼Œé€šå¸¸æ˜¯åœ¨æ¯ä¸ªå¾ªç¯ä¸­æ£€æŸ¥ä¸­æ–­çŠ¶æ€ã€‚æ ¹æ®å¾ªç¯æ‰§è¡Œçš„æ—¶é—´é•¿çŸ­ï¼Œåœ¨ä»»åŠ¡ä»£ç é€šçŸ¥çº¿ç¨‹ä¸­æ–­ä¹‹å‰å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´(é€šè¿‡è°ƒç”¨Thread.isInterrupted()è½®è¯¢ä¸­æ–­ä¸­æ–­æˆ–è°ƒç”¨ä¸€ä¸ªé˜»å¡æ–¹æ³•)ã€‚å¦‚æœä»»åŠ¡éœ€è¦æ›´å…·å“åº”æ€§ï¼Œåˆ™å¯ä»¥æ›´é¢‘ç¹çš„è½®è¯¢ä¸­æ–­çŠ¶æ€ã€‚é˜»å¡æ–¹æ³•é€šå¸¸åœ¨è¿›å…¥è¯¥æ–¹æ³•æ—¶ç«‹å³è½®è¯¢ä¸­æ–­çŠ¶æ€ï¼Œå¦‚æœè¦æé«˜å“åº”æ€§ï¼Œå¯ä»¥ç›´æ¥æŠ›å‡ºInterruptedExceptionå¼‚å¸¸ã€‚\nå½“ä½ çŸ¥é“ä¸€ä¸ªçº¿ç¨‹å³å°†ç»“æŸæ‰§è¡Œæ—¶ï¼Œåä¸‹ä¸€ä¸ªä¸­æ–­æ˜¯å¯æ¥å—çš„ã€‚åªæœ‰å½“è°ƒç”¨å¯ä¸­æ–­æ–¹æ³•çš„ç±»æ˜¯Threadçš„ä¸€éƒ¨åˆ†è€Œä¸æ˜¯Runnableæˆ–é€šç”¨åº“ä»£ç æ—¶æ‰ä¼šå‡ºç°æ­¤ç§æƒ…å½¢ï¼Œå¦‚ä»£ç æ¸…å•5æ‰€ç¤ºã€‚å®ƒåˆ›å»ºäº†ä¸€ä¸ªæšä¸¾è´¨æ•°çš„çº¿ç¨‹ï¼Œå¹¶ä¸”å…è®¸çº¿ç¨‹åœ¨ä¸­æ–­æ—¶é€€å‡ºã€‚è¿™ä¸ªå¯»æ‰¾è´¨æ•°çš„å¾ªç¯åœ¨ä¸¤ä¸ªåœ°æ–¹æ£€æŸ¥ä¸­æ–­ï¼šä¸€ä¸ªé€šè¿‡è½®è¿…whileå¾ªç¯åˆ¤æ–­æ¡ä»¶ä¸­çš„isInterrupted()æ–¹æ³•ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯é€šè¿‡è°ƒç”¨é˜»å¡çš„BlockingQueue.put()æ–¹æ³•ã€‚\nä»£ç æ¸…å•5: åœ¨çŸ¥é“çº¿ç¨‹å°†ç»“æŸæ—¶å¯ä»¥åä¸‹ä¸­æ–­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  public class PrimeProducer extends Thread { private final BlockingQueue\u0026lt;BigInteger\u0026gt; queue; PrimeProducer(BlockingQueue\u0026lt;BigInteger\u0026gt; queue) { this.queue = queue; } public void run() { try { BigInteger p = BigInteger.ONE; while (!Thread.currentThread().isInterrupted()) queue.put(p = p.nextProbablePrime()); } catch (InterruptedException consumed) { /* å…è®¸çº¿ç¨‹é€€å‡º */ } } public void cancel() { interrupt(); } }   éä¸­æ–­é˜»å¡ å¹¶éæ‰€æœ‰çš„é˜»å¡æ–¹æ³•éƒ½ä¼šæŠ›å‡ºInterruptedExceptionã€‚è¾“å…¥æµå’Œè¾“å‡ºæµç”±äºç­‰å¾…I/Oæ“ä½œå®Œæˆè€Œé˜»å¡ï¼Œä½†å®ƒä»¬ä¸ä¼šæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼Œå¹¶ä¸”å¦‚æœå®ƒä»¬è¢«ä¸­æ–­ï¼Œä¹Ÿä¸ä¼šæå‰è¿”å›ã€‚ä½†åœ¨å¥—æ¥å­—I/Oçš„æƒ…å½¢ä¸‹ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹å…³é—­å¥—æ¥å­—ï¼Œåœ¨å…¶å®ƒçº¿ç¨‹ä¸­çš„é˜»å¡I/Oæ“ä½œå°†ä¼šé€šè¿‡SocketExceptionææ—©ç»“æŸã€‚java.nioåŒ…ä¸­çš„éé˜»å¡I/Oæ“ä½œä¹Ÿä¸æ”¯æŒå¯ä¸­æ–­çš„I/Oæ“ä½œï¼Œä½†å¯ä»¥é€šè¿‡å…³é—­é€šé“æˆ–è¯·æ±‚å”¤é†’Selectoræ¥å®ç°ç±»ä¼¼çš„é˜»å¡æ“ä½œã€‚ç±»ä¼¼çš„ï¼Œå°è¯•è·å–å†…éƒ¨é”(è¿›å…¥ä¸€ä¸ªåŒæ­¥å—)ä¸èƒ½è¢«ä¸­æ–­ï¼Œä½†ä½¿ç”¨ReentrantLockèƒ½å®ç°å¯ä¸­æ–­çš„è·å–é”ã€‚\néå–æ¶ˆä»»åŠ¡ æœ‰äº›ä»»åŠ¡åªæ˜¯ç®€å•çš„æ‹’ç»è¢«ä¸­æ–­ä»è€Œå¯¼è‡´å®ƒä»¬æ— æ³•å–æ¶ˆã€‚ä½†å³ä½¿æ˜¯ä¸å¯å–æ¶ˆçš„ä»»åŠ¡ä¹Ÿåº”è¯¥ä¿ç•™ä¸­æ–­çŠ¶æ€ï¼Œä»¥é˜²åœ¨è°ƒç”¨å †æ ˆä¸Šçš„ä»£ç æƒ³è¦åœ¨ä¸å¯å–æ¶ˆçš„ä»»åŠ¡å®Œæˆåå“åº”ä¸­æ–­ã€‚ä»£ç æ¸…å•6æ˜¾ç¤ºäº†ä¸€ä¸ªæ–¹æ³•ç­‰å¾…é˜»å¡é˜Ÿåˆ—ç›´åˆ°å…¶ä¸­æŸä¸ªå…ƒç´ å¯ç”¨ï¼Œæ— è®ºå®ƒæ˜¯å¦è¢«ä¸­æ–­ã€‚ä¸ºäº†å®‰åˆ†å®ˆå·±ï¼Œè¯¥æ–¹æ³•åœ¨å®Œæˆåä¼šæ¸…é™¤æœ€ç»ˆä»£ç å—ä¸­çš„ä¸­æ–­çŠ¶æ€ï¼Œä»¥é¿å…å‰¥å¤ºè°ƒç”¨è€…å‘å‡ºçš„ä¸­æ–­è¯·æ±‚ã€‚ç”±äºä¼šå¯¼è‡´æ— é™å¾ªç¯è€Œä¸èƒ½åœ¨è¯¥æ–¹æ³•ä¸­æ¢å¤ä¸­æ–­çŠ¶æ€ã€‚(BlockingQueue.take()å¯ä»¥åœ¨è°ƒç”¨æ—¶ç«‹å³è½®è¯¢ä¸­æ–­çŠ¶æ€ï¼Œå¦‚æœå‘ç°æœ‰ä¸­æ–­çŠ¶æ€é›†åˆ™ç«‹å³æŠ›å‡ºInterruptedExceptionå¼‚å¸¸ã€‚)\nä»£ç æ¸…å•6: éå–æ¶ˆçš„ä»»åŠ¡åœ¨è¿”å›ä¹‹å‰æ¢å¤ä¸­æ–­çŠ¶æ€\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  public Task getNextTask(BlockingQueue\u0026lt;Task\u0026gt; queue) { boolean interrupted = false; try { while (true) { try { return queue.take(); } catch (InterruptedException e) { interrupted = true; // è™½ç„¶å‘ç”Ÿä¸­æ–­ï¼Œä½†æ˜¯ç»§ç»­å°è¯•  } } } finally { if (interrupted) Thread.currentThread().interrupt(); } }   æ€»ç»“ ä½ å¯ä»¥ä½¿ç”¨Javaå¹³å°æä¾›çš„åä½œä¸­æ–­æœºåˆ¶æ¥æ„å»ºçµæ´»çš„å–æ¶ˆç­–ç•¥ã€‚çº¿ç¨‹æ´»åŠ¨å¯ä»¥å†³å®šå®ƒä»¬æ˜¯å¦å¯ä»¥å–æ¶ˆã€å¦‚ä½•å“åº”ä¸­æ–­ï¼Œå¦‚æœç«‹å³è¿”å›ä¼šå½±å“åº”ç”¨ç¨‹åºçš„å®Œæ•´æ€§æ—¶ï¼Œå®ƒä»¬å¯ä»¥æ¨è¿Ÿä¸­æ–­ä»¥æ‰§è¡Œç‰¹å®šäºä»»åŠ¡çš„æ¸…ç†æ´»åŠ¨ã€‚å³æ˜¯æƒ³å®Œå…¨å¿½ç•¥ä»£ç ä¸­çš„ä¸­æ–­ï¼Œä¹Ÿè¦ç¡®ä¿åœ¨æ•è·InterruptedExceptionæ—¶æ¢å¤ä¸­æ–­çŠ¶æ€ï¼Œå¹¶ä¸”ä¸è¦é‡æ–°æŠ›å‡ºå®ƒä»¥ä¾¿è°ƒç”¨å®ƒçš„ä»£ç ä¸ä¼šè¢«å‰¥å¤ºå¯¹äºä¸­æ–­å‘ç”Ÿçš„æ„ŸçŸ¥ã€‚\n\u0026lt;â€“ç¿»è¯‘ç»“æŸ!â€“\u0026gt;\n","permalink":"http://isouthrain.github.io/post/translate/java-concurrency/dealing-with-interrupted-exception/","tags":["Java"],"title":"[è¯‘]å¦‚ä½•å¤„ç†InterruptedException"},{"categories":["Javaç¼–ç¨‹","Javaå¤šçº¿ç¨‹"],"contents":"volatileå…³é”®å­—åœ¨Javaå¤šçº¿ç¨‹ç¼–ç¨‹ä¸­å¾ˆå¸¸è§ï¼Œç”±äºè‡ªå·±ä¹‹å‰å­¦ä¹ å¤šçº¿ç¨‹æ—¶ä¸€åº¦ä»¥ä¸ºåªè¦éœ€ç¡®ä¿çº¿ç¨‹å¯è§æ€§çš„ä»£ç éƒ½éœ€è¦ä½¿ç”¨volatileå…³é”®å­—ï¼Œåæ¥å‘ç°å¹¶ä¸æ˜¯è¿™æ ·çš„ï¼Œæ•…ç®€å•è®°å½•ä¸‹ã€‚\nå…¸å‹ä½¿ç”¨åœºæ™¯ ä¸‹é¢è¿™æ®µä»£ç åˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹threadAå’ŒthreadBï¼ŒthreadAä¸­è¿è¡Œdisplay()æ–¹æ³•ï¼ŒthreadBä¸­è¿è¡Œstop()æ–¹æ³•ï¼Œåœ¨threadAå¯åŠ¨1ç§’åå¯åŠ¨threadBã€‚\nåœ¨stopå¸ƒå°”å˜é‡ä¸Šåˆ†åˆ«æ³¨é‡Šå’Œä¸æ³¨é‡Švolatileçš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š\n æ³¨é‡Švolatileå…³é”®å­—æ—¶ï¼Œdisplay()æ–¹æ³•ä¸€ç›´è¿è¡Œï¼Œç¨‹åºä¸èƒ½ç»ˆæ­¢ï¼› ä¸æ³¨é‡Švolatileå…³é”®å­—æ—¶ï¼Œdisplay()æ–¹æ³•ä¼šåœ¨è°ƒç”¨stop()æ–¹æ³•åç«‹å³åœæ­¢è¿è¡Œï¼Œç¨‹åºç»ˆæ­¢ï¼›  æ³¨: æ ¹æ®å®é™…è¿è¡Œç”µè„‘çš„é…ç½®ï¼Œæœ‰å¯èƒ½ä¸æ³¨é‡Švolatileå…³é”®å­—æ—¶è°ƒç”¨stop()æ–¹æ³•ä¹Ÿèƒ½è®©display()æ–¹æ³•ç«‹å³åœæ­¢è¿è¡Œã€‚\nä»£ç æ¸…å•1: volatileå…³é”®å­—çš„ä½¿ç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37  public class VolatileTest { //æ³¨é‡Šæ‰volatileå…³é”®å­—æ—¶display()æ–¹æ³•ä¼šä¸€ç›´è¿è¡Œä¸‹å» \tprivate /*volatile*/ boolean stop = false; private void stop() { stop = true; } private void display() { while(!stop) { } System.out.println(LocalDateTime.now()); } public void test() { Thread threadA = new Thread(()-\u0026gt;{ this.display(); }); Thread threadB = new Thread(()-\u0026gt;{ this.stop(); }); threadA.start(); try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { e.printStackTrace(); } threadB.start(); } public static void main(String[] args) { VolatileTest vt = new VolatileTest(); vt.test(); } }   ä¸Šè¿°ä»£ç å±•ç¤ºäº†volatileçš„å…¸å‹ä½¿ç”¨åœºæ™¯:\n å½“æœ‰ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„çº¿ç¨‹åŒæ—¶è¯»å–ä¸€ä¸ªå…±äº«çš„å¯å˜å˜é‡æ—¶ï¼Œä¸ºäº†ç¡®ä¿æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½è·å–åˆ°æœ€æ–°çš„å€¼ï¼Œåº”è¯¥ä½¿ç”¨volatileå…³é”®å­—å¯¹è¯¥å˜é‡è¿›è¡Œä¿®é¥°ï¼Œç¡®ä¿è¯¥å˜é‡çš„å¯è§æ€§ã€‚\n å…³äºvolatileå¦‚ä½•å®ç°ç¡®ä¿å˜é‡å¯è§æ€§ï¼Œç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šèµ„æ–™ï¼Œè¯·è‡ªè¡ŒæŸ¥é˜…ï¼Œå¦‚volatileå’ŒlockåŸç†åˆ†æã€‚\næœ‰ç‹¬å é”æ—¶ä¸éœ€è¦ä½¿ç”¨volatile æ—¢ç„¶volatileå˜é‡ç¡®ä¿çš„æ˜¯åœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–ä¸€ä¸ªå˜é‡æ—¶ç¡®ä¿å†…å­˜å¯è§æ€§ï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œè¯»å†™æ—¶ï¼Œç”±äºæ’å®ƒé”(exclusive lock) çš„å­˜åœ¨å¯¼è‡´ä»»ä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œè¯»å†™æ“ä½œï¼Œæ­¤æ—¶æ˜¯å¦è¿˜éœ€è¦æ·»åŠ volatileå…³é”®å­—å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œä»å­—é¢æ„æ€å¯ä»¥çœ‹å‡ºï¼Œç”±äºåŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®å˜é‡ï¼Œæ‰€ä»¥å˜é‡å¯è§æ€§çš„é—®é¢˜ä¸ä¼šå­˜åœ¨ï¼Œæ•…æ²¡å¿…è¦æ·»åŠ volatileå…³é”®å­—ã€‚\nä»¥Java8ä¸ºä¾‹ï¼Œåœ¨Javaè¯­è¨€è§„èŒƒä¸­æœ‰å…³äºvolatileçš„è¯´æ˜volatile Fieldsä¸­æœ‰å¦‚ä¸‹ç‰‡æ®µ:\n The Java programming language allows threads to access shared variables (Â§17.1). As a rule, to ensure that shared variables are consistently and reliably updated, a thread should ensure that it has exclusive use of such variables by obtaining a lock that, conventionally, enforces mutual exclusion for those shared variables.\n The Java programming language provides a second mechanism, volatile fields, that is more convenient than locking for some purposes.\n A field may be declared volatile, in which case the Java Memory Model ensures that all threads see a consistent value for the variable (Â§17.4).\n ä»è¿™æ®µæ–‡å­—å¯ä»¥çœ‹å‡ºvolatileç›¸å¯¹äºç‹¬å é”æä¾›äº†æ›´åŠ ç®€ä¾¿çš„æ–¹å¼è®©å˜é‡ä¸€è‡´ä¸”å¯é çš„æ›´æ–°ï¼Œvolatileåªç¡®ä¿è¯»å–çš„å€¼æ­£ç¡®ï¼Œå¯¹å†™å…¥å½±å“ä¸å¤§ï¼Œè€Œç‹¬å é”åˆ™é™åˆ¶äº†åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªè¯»æˆ–å†™ï¼Œå¯¼è‡´å‡ºç°æ€§èƒ½é—®é¢˜ä»¥åŠåœ¨ç‰¹å®šçš„åœºæ™¯ä¸‹æ— æ³•ä½¿ç”¨çš„é—®é¢˜(å¦‚ä»£ç æ¸…å•1æ‰€ç¤ºï¼Œè‹¥é‡‡ç”¨ç‹¬å é”åˆ™åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿è¡Œï¼Œè¿èƒŒäº†è®¾è®¡åˆè¡·)ã€‚\nä¸‹è¿°ä»£ç å±•ç¤ºäº†ä¸€ä¸ªå…¸å‹çš„ç”Ÿäº§è€…/æ¶ˆè´¹è€…æ¨¡å¼ï¼Œç”±äºç‹¬å é”çš„å­˜åœ¨ï¼Œå³ä½¿æ²¡æœ‰ä½¿ç”¨volatileå…³é”®å­—ï¼Œç¨‹åºä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚\nä»£ç æ¸…å•2: ç”Ÿäº§è€…/æ¶ˆè´¹è€…æ¨¡å¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66  public class ProducerConsumerTest { private static final int MAX_SIZE = 10; //è¿™ä¸¤ä¸ªå˜é‡æ²¡å¿…è¦ä½¿ç”¨volatileå…³é”®å­—ä¿®é¥° \tprivate LinkedList\u0026lt;String\u0026gt; items = new LinkedList\u0026lt;\u0026gt;(); private int count; private Object lock = new Object(); private void produce(String ele) { synchronized (lock) { try { while (count \u0026gt;= MAX_SIZE) { lock.wait(); } } catch (InterruptedException e) { e.printStackTrace(); } items.add(ele); count++; System.out.println(Thread.currentThread().getName() + \u0026#34; æ·»åŠ äº†å…ƒç´  \u0026#34; + ele + \u0026#34; å½“å‰å…ƒç´ æ€»æ•°ä¸º \u0026#34; + count); lock.notifyAll(); } } private String consume() { String result = null; synchronized (lock) { try { while (count == 0) { lock.wait(); } } catch (InterruptedException e) { e.printStackTrace(); } result = items.pollLast(); count--; System.out.println(Thread.currentThread().getName() + \u0026#34; è·å–äº†å…ƒç´  \u0026#34; + result + \u0026#34; å½“å‰å…ƒç´ æ€»æ•°ä¸º \u0026#34; + count); lock.notifyAll(); } return result; } public void test() { for(int i=0;i\u0026lt;10;i++) { new Thread(() -\u0026gt; { for(int j=0;j\u0026lt;5;j++) { String ele = UUID.randomUUID().toString().replace(\u0026#34;-\u0026#34;, \u0026#34;\u0026#34;); this.produce(ele); } },\u0026#34;Producer_\u0026#34; + i).start(); } for(int i=0;i\u0026lt;5;i++) { new Thread(() -\u0026gt; { for(int j=0;j\u0026lt;10;j++) { this.consume(); } },\u0026#34;Consumer_\u0026#34; + i).start(); } } public static void main(String[] args) { new ProducerConsumerTest().test(); } }   åˆ©ç”¨volatileåœ¨å•ä¾‹æ¨¡å¼ä¸­å®ç°åŒé‡æ£€æŸ¥ volatileå…³é”®å­—ä¸ä»…å¯ä»¥ç¡®ä¿çº¿ç¨‹å¯è§æ€§ï¼Œè¿˜èƒ½ç¦æ­¢é‡æ’åºï¼Œå®ƒçš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯åˆ©ç”¨åŒé‡æ£€æŸ¥å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œå¦‚ä»£ç æ¸…å•3æ‰€ç¤ºã€‚åœ¨è¯¥ç¨‹åºä¸­ä¸»è¦åˆ©ç”¨äº†volatileç¦æ­¢é‡æ’åºçš„åŠŸèƒ½ï¼Œè¯¦ç»†è¯´æ˜è¯·å‚è§Javaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯P67ä¸­çš„ åŒé‡æ£€æŸ¥é”å®šä¸å»¶è¿Ÿåˆå§‹åŒ– ã€‚\nä»£ç æ¸…å•3: åˆ©ç”¨åŒé‡æ£€æŸ¥å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  public class Singleton { private static volatile Singleton instance = null; private Singleton() { } public static Singleton getInstance() { if(instance == null) { synchronized(Singleton.class) { if(instance == null) { instance = new Singleton(); } } } return instance; } }   å‚è€ƒæ–‡ç« :\n Javaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ volatileå’ŒlockåŸç†åˆ†æ Simplest and understandable example of volatile keyword in java Difference between volatile and synchronized in Java ","permalink":"http://isouthrain.github.io/post/java-concurrency/how-to-use-volatile-in-java/","tags":["Java","Java Concurrency"],"title":"volatileå…³é”®å­—åœ¨Javaç¨‹åºä¸­çš„ä½¿ç”¨"},{"categories":["Javaç¼–ç¨‹"],"contents":"Javaä¸­å­—ç¬¦ä¸²çš„æ¯”è¾ƒåœ¨é¢è¯•ä¸­å¾ˆå¸¸è§ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“æ¯”è¾ƒå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰è¦ä½¿ç”¨equals()è€Œä¸æ˜¯==ã€‚æœ¬æ–‡é¦–å…ˆåˆ©ç”¨javapå‘½ä»¤ä»classæ–‡ä»¶çš„è§’åº¦æ¥åˆ†æä¸åŒå­—ç¬¦ä¸²æ¯”è¾ƒçš„ç»“æœï¼Œç„¶ååˆ†æä¸‹Tomcatä¸­å¦‚ä½•è·å–å‰ç«¯è¾“å…¥çš„å­—ç¬¦ä¸²å‚æ•°,å¹¶ä»¥æ­¤è¯´æ˜Java Webå¼€å‘ä¸­è¯¥å¦‚ä½•æ­£ç¡®çš„è¿›è¡Œå­—ç¬¦ä¸²çš„æ¯”è¾ƒã€‚\nç®€å•å­—ç¬¦ä¸²æ¯”è¾ƒ æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  public class StringTest { public static void main(String[] args) { String s1 = \u0026#34;Hello World\u0026#34;; String s2 = \u0026#34;Hello World\u0026#34;; String s3 = new String(\u0026#34;Hello World\u0026#34;); String s4 = new String(\u0026#34;Hello World\u0026#34;); System.out.println(\u0026#34;åˆ©ç”¨==æ¯”è¾ƒ\u0026#34;); System.out.println(s1 == s2); System.out.println(s1 == s4); System.out.println(s3 == s4); System.out.println(s1 == s4.intern()); System.out.println(s3.intern() == s4.intern()); System.out.println(\u0026#34;\\nåˆ©ç”¨equals()æ¯”è¾ƒ\u0026#34;); System.out.println(s1.equals(s2)); System.out.println(s1.equals(s4)); System.out.println(s3.equals(s4)); } }   ç¨‹åºè¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š\nä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡º: åˆ©ç”¨equals()æ¯”è¾ƒæ—¶è¿”å›çš„ç»“æœå…¨ä¸ºtrue,è€Œåˆ©ç”¨==æ¯”è¾ƒçš„ç»“æœåªæœ‰éƒ¨åˆ†ä¸ºtrueã€‚åˆ©ç”¨javapå‘½ä»¤è¾“å‡ºclassæ–‡ä»¶å†…å®¹å¦‚ä¸‹(çœç•¥æ‰äº†System.out.println()ç›¸å…³çš„)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  Compiled from \u0026#34;StringTest.java\u0026#34; public class StringTest { public StringTest(); Code: 0: aload_0 1: invokespecial #8 // Method java/lang/Object.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:()V  4: return public static void main(java.lang.String[]); Code: 0: ldc #16 // String Hello World  2: astore_1 3: ldc #16 // String Hello World  5: astore_2 6: new #18 // class java/lang/String  9: dup 10: ldc #16 // String Hello World  12: invokespecial #20 // Method java/lang/String.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  15: astore_3 16: new #18 // class java/lang/String  19: dup 20: ldc #16 // String Hello World  22: invokespecial #20 // Method java/lang/String.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  25: astore 4 27: new #18 // class java/lang/String  30: dup 31: ldc #16 // String Hello World  33: invokespecial #20 // Method java/lang/String.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  36: invokevirtual #23 // Method java/lang/String.intern:()Ljava/lang/String;  39: astore 5 //......  214: return }   ä¸ºäº†èƒ½è¯»æ‡‚å…¶å†…å®¹ï¼Œå¯å…ˆä»The JavaÂ® Virtual Machine Specificationä¸­äº†è§£ç›¸å…³çš„æŒ‡ä»¤ï¼Œæœ¬æ–‡å°†æ¶‰åŠåˆ°çš„æŒ‡ä»¤åˆ—ä¸¾å¦‚ä¸‹\n ldcï¼Œå°†å­—ç¬¦ä¸²ä»è¿è¡Œæ—¶å¸¸é‡æ± å‹å…¥æ“ä½œæ ˆä¸­ astoreï¼Œå°†ä¸€ä¸ªæ•°å€¼ä»æ“ä½œæ ˆå­˜å…¥å±€éƒ¨å˜é‡è¡¨ dupï¼Œå¤åˆ¶æ ˆé¡¶çš„æ•°å€¼å¹¶å°†å¤åˆ¶çš„æ•°å€¼é‡æ–°å‹å…¥æ ˆä¸­ invokespecialï¼Œè°ƒç”¨å®ä¾‹æ„é€ å™¨æ–¹æ³•ã€ç§æœ‰æ–¹æ³•å’Œçˆ¶ç±»æ–¹æ³• invokevirtualï¼Œè°ƒç”¨å®ä¾‹æ–¹æ³•ï¼ŒåŸºäºç±»è¿›è¡Œåˆ†å‘  åŸºäºä¸Šè¿°å‘½ä»¤æˆ‘ä»¬å¯ä»¥å‘ç°å­—ç¬¦ä¸²s1ã€s2ã€s5éƒ½æ˜¯ä»å¸¸é‡æ± ä¸­çš„è·å–çš„ï¼Œè€Œs3ã€s4åˆ™æ˜¯åˆ†åˆ«åˆ›å»ºäº†ä¸¤ä¸ªStringå¯¹è±¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\nåœ¨Javaä¸­==æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€æ˜¯å¦ç›¸åŒï¼Œè€Œequals()æ¯”è¾ƒçš„æ˜¯å…¶æ–‡æœ¬å€¼æ˜¯å¦ç›¸åŒï¼Œè€Œä»å¸¸é‡æ± ä¸­å¤šæ¬¡è·å–åŒä¸€ä¸ªå¸¸é‡å…¶åœ°å€æ˜¯ç›¸åŒçš„ï¼Œæ–°å»ºçš„Stringå¯¹è±¡JVMä¼šä¸ºå…¶é‡æ–°åˆ†é…å†…å­˜åœ°å€ã€‚æ•…åœ¨åˆ©ç”¨==è¿›è¡Œæ¯”è¾ƒæ—¶,1ã€2ã€5è¿™ä¸‰ä¸ªéƒ½æ˜¯åŸºäºå¸¸é‡æ± çš„æ¯”è¾ƒï¼Œå®ƒä»¬çš„ç»“æœéƒ½ä¸ºtrueï¼Œè€Œ3ã€4ç§éƒ½åŒ…å«æœ‰Stringå¯¹è±¡ï¼Œæ•…å…¶ç»“æœå‡ä¸ºfalseã€‚\nå­—ç¬¦ä¸²ç›¸åŠ åæ¯”è¾ƒ å°†ä¸Šè¿°ä»£ç ä¿®æ”¹ä¸ºå¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  public class StringTest { public static void main(String[] args) { String s1 = \u0026#34;Hello World\u0026#34;; String s2 = \u0026#34;Hello \u0026#34;; String s3 = s2 + \u0026#34;World\u0026#34;; String s4 = \u0026#34;Hello \u0026#34; + \u0026#34;World\u0026#34;; String s5 = \u0026#34;Hello \u0026#34; + new String(\u0026#34;World\u0026#34;); String s6 = \u0026#34;Hello \u0026#34; + new String(\u0026#34;World\u0026#34;).intern(); System.out.println(\u0026#34;åˆ©ç”¨==æ¯”è¾ƒ:\u0026#34;); System.out.println(s1 == s3); System.out.println(s1 == s4); System.out.println(s1 == s5); System.out.println(s1 == s6); System.out.println(\u0026#34;\\nåˆ©ç”¨equals()æ¯”è¾ƒ:\u0026#34;); System.out.println(s1.equals(s3)); System.out.println(s1.equals(s4)); System.out.println(s1.equals(s5)); System.out.println(s1.equals(s6)); } }   ç¨‹åºè¿è¡Œçš„ç»“æœå¦‚ä¸‹:\næ­¤æ—¶åˆ©ç”¨==æ¯”è¾ƒçš„ç»“æœåªæœ‰1ä¸ªä¸ºtrueï¼Œä¸ºäº†æ¢ç©¶åŸå› éœ€è¦ç»§ç»­åˆ†æclassæ–‡ä»¶å†…å®¹ï¼Œç”¨javapå‘½ä»¤è¾“å‡ºçš„classæ–‡ä»¶å†…å®¹å¦‚ä¸‹(çœç•¥æ‰äº†System.out.println()ç›¸å…³çš„)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51  Compiled from \u0026#34;StringTest.java\u0026#34; public class StringTest { public StringTest(); Code: 0: aload_0 1: invokespecial #8 // Method java/lang/Object.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:()V  4: return public static void main(java.lang.String[]); Code: 0: ldc #16 // String Hello World  2: astore_1 3: ldc #18 // String Hello  5: astore_2 6: new #20 // class java/lang/StringBuilder  9: dup 10: aload_2 11: invokestatic #22 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;  14: invokespecial #28 // Method java/lang/StringBuilder.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  17: ldc #31 // String World  19: invokevirtual #33 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;  22: invokevirtual #37 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;  25: astore_3 26: ldc #16 // String Hello World  28: astore 4 30: new #20 // class java/lang/StringBuilder  33: dup 34: ldc #18 // String Hello  36: invokespecial #28 // Method java/lang/StringBuilder.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  39: new #23 // class java/lang/String  42: dup 43: ldc #31 // String World  45: invokespecial #41 // Method java/lang/String.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  48: invokevirtual #33 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;  51: invokevirtual #37 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;  54: astore 5 56: new #20 // class java/lang/StringBuilder  59: dup 60: ldc #18 // String Hello  62: invokespecial #28 // Method java/lang/StringBuilder.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  65: new #23 // class java/lang/String  68: dup 69: ldc #31 // String World  71: invokespecial #41 // Method java/lang/String.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  74: invokevirtual #42 // Method java/lang/String.intern:()Ljava/lang/String;  77: invokevirtual #33 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;  80: invokevirtual #37 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;  83: astore 6 //....  215: return }   åŸºäºclassæ–‡ä»¶çš„å†…å®¹å¯¹s3ã€s4ã€s5ã€s6è¿™4ä¸ªå­—ç¬¦ä¸²è¿›è¡Œåˆ†æï¼Œå¯å‘ç°s4æ˜¯ç¼–è¯‘å™¨è‡ªåŠ¨ä¼˜åŒ–åä»å­—ç¬¦å¸¸é‡æ± ä¸­è·å–çš„ä¹‹å¤–ï¼Œå…¶ä½™çš„3ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯åˆ©ç”¨StringBuilderä¸­çš„toString()æ–¹æ³•ç”Ÿæˆçš„ï¼ŒtoString()çš„æºç å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºè¿”å›çš„æ˜¯ä¸€ä¸ªStringå¯¹è±¡ã€‚è¿™æ­£å¥½è§£é‡Šäº†é™¤äº†s1==s4è¾“å‡ºå€¼ä¸ºtrueä¹‹å¤–å…¶ä½™çš„è¾“å‡ºå€¼éƒ½ä¸ºfalseçš„åŸå› ã€‚\n1 2 3 4  @Override public String toString() { return new String(value, 0, count); }   Stringæ˜¯ä¸å¯å˜çš„åŸå› åˆ†æ åœ¨å­¦ä¹ Javaæ—¶æˆ‘ä»¬ä¸€ç›´è¢«å¼ºè°ƒStringæ˜¯ä¸å¯å˜çš„ï¼Œè€Œå®é™…ä½¿ç”¨ä¸­æˆ‘ä»¬åˆå¯ä»¥åˆ©ç”¨ç±»ä¼¼å¦‚ä¸‹çš„ä»£ç å¯¹Stringè¿›è¡Œæ‹¼æ¥æ“ä½œï¼Œçœ‹èµ·æ¥å¾ˆçŸ›ç›¾ã€‚\n1 2 3 4 5 6 7 8  public class StringTest { public static void main(String[] args) { String s1 = \u0026#34;Hello\u0026#34;; s1 +=\u0026#34; Java\u0026#34;; s1 +=\u0026#34; Golang\u0026#34;; } }   åŒæ ·å¯ä»¥é€šè¿‡é˜…è¯»classæ–‡ä»¶æ¥åˆ†æè¯¥é—®é¢˜ï¼Œå¯¹åº”çš„classæ–‡ä»¶å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  Compiled from \u0026#34;StringTest.java\u0026#34; public class StringTest { public StringTest(); Code: 0: aload_0 1: invokespecial #8 // Method java/lang/Object.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:()V  4: return public static void main(java.lang.String[]); Code: 0: ldc #16 // String Hello  2: astore_1 3: new #18 // class java/lang/StringBuilder  6: dup 7: aload_1 8: invokestatic #20 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;  11: invokespecial #26 // Method java/lang/StringBuilder.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  14: ldc #29 // String Java  16: invokevirtual #31 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;  19: invokevirtual #35 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;  22: astore_1 23: new #18 // class java/lang/StringBuilder  26: dup 27: aload_1 28: invokestatic #20 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;  31: invokespecial #26 // Method java/lang/StringBuilder.\u0026#34;\u0026lt;init\u0026gt;\u0026#34;:(Ljava/lang/String;)V  34: ldc #39 // String Golang  36: invokevirtual #31 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;  39: invokevirtual #35 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;  42: astore_1 43: return }   åˆ†æclassæ–‡ä»¶å¯å‘ç°åˆ©ç”¨+=æ“ä½œå®è´¨ä¸Šæ˜¯é€šè¿‡StringBuilderæ¥æ‹¼æ¥å¹¶é‡æ–°æ„å»ºå­—ç¬¦ä¸²ï¼Œæ¯æ¬¡+=æ“ä½œéƒ½ä¼šç”Ÿæˆæ–°çš„å­—ç¬¦ä¸²ï¼ŒåŸå§‹å­—ç¬¦ä¸²çš„æŒ‡å‘åœ°å€è¢«ä¸¢å¤±ï¼ŒStringæ˜¯ä¸å¯å˜å®é™…ä¸ŠæŒ‡çš„æ˜¯åŸæœ‰çš„å­—ç¬¦ä¸²æ— æ³•æ”¹å˜ï¼Œå‰è¿°çš„é—®é¢˜å¾—ä»¥è§£å†³ã€‚\nåŒæ—¶é€šè¿‡åˆ†æä¸Šè¿°classæ–‡ä»¶è¿˜èƒ½å¾—å‡ºä»¥ä¸‹ç»“è®º:\n å¯¹äºç±»ä¼¼String str=\u0026quot;Hello\u0026quot; + \u0026quot;World\u0026quot;çš„èµ‹å€¼ï¼ŒJVMä¼šå°†å…¶è‡ªåŠ¨ä¼˜åŒ–ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼Œé™¤æ­¤ä¹‹å¤–çš„å…¶å®ƒåŸºäºStringçš„æ‹¼æ¥éƒ½ä¼šç”Ÿæˆæ–°çš„Stringå¯¹è±¡ï¼› åœ¨å­—ç¬¦ä¸²æ‹¼æ¥æ—¶ï¼Œè‹¥é‡‡ç”¨åŸºäºStringçš„æ‹¼æ¥æ“ä½œï¼Œä¼šé¢‘ç¹çš„åˆ›å»ºStringBuilderå¯¹è±¡ï¼Œå½±å“ç¨‹åºæ€§èƒ½ï¼Œåº”è¯¥é‡‡ç”¨StringBuilderæ›¿ä»£ä»¥å‡å°‘StringBuilderåˆ›å»ºçš„æ¬¡æ•°; éœ€è¦ç¡®ä¿çº¿ç¨‹å®‰å…¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨StringBufferæ›¿ä»£StringBuilder  Java Webç¨‹åºä¸­çš„å­—ç¬¦ä¸²èµ‹å€¼ åˆ©ç”¨ä¸‹è¿°ä»£ç åœ¨Webé¡µé¢è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶ååˆ©ç”¨==åœ¨Servletä»£ç ä¸­å’Œç‰¹å®šçš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta http-equiv=\u0026#34;Content-Type\u0026#34; content=\u0026#34;text/html; charset=UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;æµ‹è¯•æ•°æ®ä¼ é€’\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div\u0026gt; \u0026lt;form action=\u0026#34;addUser\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;table\u0026gt; \u0026lt;tbody\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;ç”¨æˆ·å:\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34;/\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;å¯†ç :\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;\u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34;/\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;td\u0026gt;\u0026amp;nbsp;\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt;\u0026lt;button type=\u0026#34;submit\u0026#34;\u0026gt;æäº¤\u0026lt;/button\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/tbody\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  TestServlet.java public class TestServlet extends HttpServlet { private static final long serialVersionUID = 6174437812832777462L; @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { doPost(request, response); } @Override protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String username = request.getParameter(\u0026#34;username\u0026#34;); System.out.println(username == \u0026#34;Rosen\u0026#34;); System.out.println(\u0026#34;Rosen\u0026#34;.equals(username)); request.getRequestDispatcher(\u0026#34;index.html\u0026#34;).forward(request, response); } }   åœ¨Tomcat7ä¸­çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºå…¶è¿è¡Œç»“æœç¬¦åˆå‰é¢åŸºäºclassæ–‡ä»¶çš„ç†è®ºåˆ†æã€‚ é€šè¿‡å‰é¢çš„åˆ†æå¯çŸ¥é€šè¿‡WebæœåŠ¡å™¨ä¼ é€’ç»™Servletçš„å­—ç¬¦ä¸²å‚æ•°è‚¯å®šæ˜¯ä¸€ä¸ªStringå¯¹è±¡è€Œéä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ã€‚æ¥ä¸‹æ¥é€šè¿‡åœ¨GitHubä¸­åˆ†æTomcatæºç æ¥äº†è§£å…¶å¦‚ä½•èµ‹å€¼ã€‚\n åœ¨Tomcatä¸­ï¼Œç”Ÿæˆå‚æ•°çš„ç›¸å…³ä»£ç ä½äºParameters.javaç±»ä¸­private void processParameters(byte bytes[], int start, int len, Charset charset)æ–¹æ³•ä¸­ï¼Œè¯¥æ–¹æ³•ç»™å‚æ•°èµ‹å€¼çš„æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š  1 2 3 4 5 6 7 8 9  if (valueStart \u0026gt;= 0) { if (decodeValue) { urlDecode(tmpValue); } tmpValue.setCharset(charset); value = tmpValue.toString(); } else { value = \u0026#34;\u0026#34;; }   ç»§ç»­æŸ¥çœ‹å¯çŸ¥tmpValueçš„ç±»å‹ä¸ºByteChunk,å…¶toString()æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š  1 2 3 4 5 6 7 8  public String toString() { if (isNull()) { return null; } else if (end - start == 0) { return \u0026#34;\u0026#34;; } return StringCache.toString(this); }   ç»§ç»­æŸ¥çœ‹StringCacheçš„toString()æ–¹æ³•å¦‚ä¸‹  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114  public static String toString(ByteChunk bc) { // If the cache is null, then either caching is disabled, or we\u0026#39;re  // still training  if (bcCache == null) { String value = bc.toStringInternal(); if (byteEnabled \u0026amp;\u0026amp; (value.length() \u0026lt; maxStringSize)) { // If training, everything is synced  synchronized (bcStats) { // If the cache has been generated on a previous invocation  // while waiting for the lock, just return the toString  // value we just calculated  if (bcCache != null) { return value; } // Two cases: either we just exceeded the train count, in  // which case the cache must be created, or we just update  // the count for the string  if (bcCount \u0026gt; trainThreshold) { long t1 = System.currentTimeMillis(); // Sort the entries according to occurrence  TreeMap\u0026lt;Integer,ArrayList\u0026lt;ByteEntry\u0026gt;\u0026gt; tempMap = new TreeMap\u0026lt;\u0026gt;(); for (Entry\u0026lt;ByteEntry,int[]\u0026gt; item : bcStats.entrySet()) { ByteEntry entry = item.getKey(); int[] countA = item.getValue(); Integer count = Integer.valueOf(countA[0]); // Add to the list for that count  ArrayList\u0026lt;ByteEntry\u0026gt; list = tempMap.get(count); if (list == null) { // Create list  list = new ArrayList\u0026lt;\u0026gt;(); tempMap.put(count, list); } list.add(entry); } // Allocate array of the right size  int size = bcStats.size(); if (size \u0026gt; cacheSize) { size = cacheSize; } ByteEntry[] tempbcCache = new ByteEntry[size]; // Fill it up using an alphabetical order  // and a dumb insert sort  ByteChunk tempChunk = new ByteChunk(); int n = 0; while (n \u0026lt; size) { Object key = tempMap.lastKey(); ArrayList\u0026lt;ByteEntry\u0026gt; list = tempMap.get(key); for (int i = 0; i \u0026lt; list.size() \u0026amp;\u0026amp; n \u0026lt; size; i++) { ByteEntry entry = list.get(i); tempChunk.setBytes(entry.name, 0, entry.name.length); int insertPos = findClosest(tempChunk, tempbcCache, n); if (insertPos == n) { tempbcCache[n + 1] = entry; } else { System.arraycopy(tempbcCache, insertPos + 1, tempbcCache, insertPos + 2, n - insertPos - 1); tempbcCache[insertPos + 1] = entry; } n++; } tempMap.remove(key); } bcCount = 0; bcStats.clear(); bcCache = tempbcCache; if (log.isDebugEnabled()) { long t2 = System.currentTimeMillis(); log.debug(\u0026#34;ByteCache generation time: \u0026#34; + (t2 - t1) + \u0026#34;ms\u0026#34;); } } else { bcCount++; // Allocate new ByteEntry for the lookup  ByteEntry entry = new ByteEntry(); entry.value = value; int[] count = bcStats.get(entry); if (count == null) { int end = bc.getEnd(); int start = bc.getStart(); // Create byte array and copy bytes  entry.name = new byte[bc.getLength()]; System.arraycopy(bc.getBuffer(), start, entry.name, 0, end - start); // Set encoding  entry.charset = bc.getCharset(); // Initialize occurrence count to one  count = new int[1]; count[0] = 1; // Set in the stats hash map  bcStats.put(entry, count); } else { count[0] = count[0] + 1; } } } } return value; } else { accessCount++; // Find the corresponding String  String result = find(bc); if (result == null) { return bc.toStringInternal(); } // Note: We don\u0026#39;t care about safety for the stats  hitCount++; return result; } }   è¯¥æ–¹æ³•ç¯‡å¹…å¾ˆé•¿ï¼Œä½†æ ¸å¿ƒä»£ç åªæœ‰ä¸€è¡ŒString value = bc.toStringInternal();è€Œbcçš„ç±»å‹ä¸ºByteChunkã€‚\nç»§ç»­åœ¨ByteChunkæœç´¢toStringInternal()æ–¹æ³•ï¼Œå…¶ä»£ç å¦‚ä¸‹  1 2 3 4 5 6 7 8 9 10  public String toStringInternal() { if (charset == null) { charset = DEFAULT_CHARSET; } // new String(byte[], int, int, Charset) takes a defensive copy of the  // entire byte array. This is expensive if only a small subset of the  // bytes will be used. The code below is from Apache Harmony.  CharBuffer cb = charset.decode(ByteBuffer.wrap(buff, start, end - start)); return new String(cb.array(), cb.arrayOffset(), cb.length()); }   æŸ¥çœ‹è¯¥æ–¹æ³•å¯çŸ¥å…¶ä½¿ç”¨new String(cb.array(), cb.arrayOffset(), cb.length())çš„æ–¹å¼æ¥æ„é€ Stringå¯¹è±¡ï¼Œæ•…åˆ©ç”¨==æ¯”è¾ƒå­—ç¬¦ä¸²æ—¶å…¶è¿”å›å€¼ä¸ºfalseã€‚\nåˆ†æäº†æœ€åŸºæœ¬çš„Serveltåï¼Œç”±äºSpringMVCæ˜¯åŸºäºServletå®ç°çš„ï¼Œæ•…ä½¿ç”¨å¦‚ä¸‹ä»£ç è¿›è¡Œå‚æ•°æ¯”è¾ƒå…¶å€¼ä¹Ÿä¸ºfalseã€‚\n1 2 3 4 5  @RequestMapping(\u0026#34;addUser\u0026#34;) public String addUser(UserModel user) { System.out.println(user.getUsername() == \u0026#34;Rosen\u0026#34;); return StringConstant.SUCCESS; }   å‚è€ƒæ–‡ç« :\n è½»æ¾çœ‹æ‡‚Javaå­—èŠ‚ç  The JavaÂ® Virtual Machine Specification ","permalink":"http://isouthrain.github.io/post/java-core/java-string-equal-compare/","tags":["Java"],"title":"Javaä¸­åˆ©ç”¨==å’Œequals()è¿›è¡Œå­—ç¬¦ä¸²æ¯”è¾ƒçš„è¯´æ˜"},{"categories":["Javaç¼–ç¨‹","Javaå¤šçº¿ç¨‹"],"contents":"æœ€è¿‘å¤ä¹ Javaå¤šçº¿ç¨‹ç›¸å…³çŸ¥è¯†æ—¶ï¼Œå‘ç°çº¿ç¨‹ä¸­æ–­çš„interrupt()ã€interrupted()ã€isInterrupted()è¿™3ä¸ªæ–¹æ³•å®¹æ˜“è®©äººäº§ç”Ÿæ··æ·†ï¼Œç»“åˆå®˜ç½‘çš„APIä»¥åŠå®é™…ä»£ç éªŒè¯ï¼Œå…ˆç®€å•è®°å½•ä¸‹ã€‚\nç›¸å…³ä½¿ç”¨è¯´æ˜ ä¸‹è¡¨æ˜¯æ ¹æ®JDKå®˜ç½‘çš„APIæ€»ç»“å‡ºçš„è¿™3ä¸ªæ–¹æ³•çš„ä½¿ç”¨è¯´æ˜,ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºä¸­æ–­çº¿ç¨‹å®é™…ä½¿ç”¨çš„æ˜¯interrupt()ï¼Œè€Œinterrupted()å’ŒisInterrupted()åˆ™ç”¨æ¥æ£€æµ‹çº¿ç¨‹æ˜¯å¦ä¸­æ–­ï¼ŒåŒºåˆ«ä¸ºå‰è€…ä¼šæ¸…é™¤ä¸­æ–­çŠ¶æ€æ ‡è®°ã€‚\n   Â æ–¹æ³•Â  æ˜¯å¦é™æ€ è¿”å›å€¼ ä½œç”¨     interrupt() å¦ æ—  ä¸­æ–­è°ƒç”¨è¯¥æ–¹æ³•çš„å½“å‰çº¿ç¨‹   interrupted() æ˜¯ æœ‰ æ£€æµ‹å½“å‰çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œå¦‚å·²è¢«ä¸­æ–­è¿‡åˆ™æ¸…é™¤ä¸­æ–­çŠ¶æ€   isInterrupted() å¦ æœ‰ æ£€æµ‹è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¸æ¸…é™¤ä¸­æ–­æ ‡è®°    ä¸‹é¢è¿™ä¸ªç¨‹åºå±•ç¤ºé€šè¿‡2ä¸ªçº¿ç¨‹å±•ç¤ºäº†è¿™3ä¸ªæ–¹æ³•çš„ç”¨æ³•ï¼Œé¦–å…ˆå¯åŠ¨threadAï¼Œé—´éš”30æ¯«ç§’åå¯åŠ¨threadBå¹¶åœ¨threadBä¸­è°ƒç”¨interrupt()ä¸­æ–­threadA,ç„¶åè§‚å¯ŸthreadAçš„ä¸­æ–­çŠ¶æ€ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  public class InterruptedTest { @Test public void testThread() { Thread threadA = new Thread(() -\u0026gt; { while (!Thread.currentThread().isInterrupted()) { System.out.println(Thread.currentThread().getName() + \u0026#34;\\t\u0026#34; + LocalTime.now()); } System.out.println(Thread.currentThread().isInterrupted()); System.out.println(Thread.interrupted()); System.out.println(Thread.currentThread().isInterrupted()); }, \u0026#34;Thread_A\u0026#34;); Thread threadB = new Thread(() -\u0026gt; { System.out.println(Thread.currentThread().getName() + \u0026#34; interrupt ThreadA\u0026#34;); threadA.interrupt(); }, \u0026#34;Thread_B\u0026#34;); threadA.start(); try { Thread.sleep(30); } catch (InterruptedException e) { e.printStackTrace(); } threadB.start(); } }   æ ¹æ®å‰è¿°çš„æ–¹æ³•è¯´æ˜ï¼Œç¨‹åºçš„è¾“å‡ºç»“æœåº”æ”¹ä¸ºtrueã€trueã€falseï¼Œå®é™…è¿è¡Œç»“æœç±»ä¼¼å¦‚ä¸‹,ä»å›¾ä¸­å¯çŸ¥å…¶è¾“å‡ºç»“æœä¸ç†è®ºåˆ†æç›¸ç¬¦ã€‚\nå°†ä¸Šè¿°ä»£ç ä¿®æ”¹å¦‚ä¸‹,é¦–å…ˆç»™threadAåŠ ä¸ŠåŒæ­¥é”å¹¶è°ƒç”¨wait()æˆ–sleep()æ–¹æ³•ï¼Œç„¶åæ£€æµ‹å…¶ä¸­æ–­çŠ¶æ€ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  public class InterruptedTest { @Test public void testThread() { Object lock = new Object(); Thread threadA = new Thread(() -\u0026gt; { synchronized(lock) { try { Thread.sleep(1000); //lock.wait(); \t} catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().isInterrupted()); System.out.println(Thread.interrupted()); System.out.println(Thread.currentThread().isInterrupted()); } }, \u0026#34;Thread_A\u0026#34;); Thread threadB = new Thread(() -\u0026gt; { System.out.println(Thread.currentThread().getName() + \u0026#34; will interrupt ThreadA\u0026#34;); threadA.interrupt(); }, \u0026#34;Thread_B\u0026#34;); threadA.start(); try { Thread.sleep(30); } catch (InterruptedException e) { e.printStackTrace(); } threadB.start(); } }   åˆ†åˆ«è°ƒç”¨sleep()å’Œwait()æ—¶çš„è¿è¡Œç»“æœå¦‚ä¸‹\nåˆ†æè¿è¡Œç»“æœå¯çŸ¥ï¼šæ— è®ºè°ƒç”¨å“ªç§æ–¹æ³•ï¼Œåœ¨ä¸­æ–­çº¿ç¨‹æ—¶éƒ½ä¼šæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼Œå…¶è¿è¡Œç»“æœéƒ½ä¸ºfalseåˆ™æ„å‘³ç€ä¸­æ–­çŠ¶æ€ä¹Ÿä¸ä¼šè®¾ç½®ã€‚\nä»¥JDK1.8ä¸ºä¾‹ï¼Œå…³äºè°ƒç”¨interrupt()æ–¹æ³•æ—¶ä¸­æ–­çŠ¶æ€çš„è®¾ç½®ï¼Œå¯ä»¥ä»å®˜ç½‘ä¸Šçœ‹åˆ°å¦‚ä¸‹æè¿°ï¼š\n If this thread is blocked in an invocation of the wait(), wait(long), or wait(long, int) methods of the Object class, or of the join(), join(long), join(long, int), sleep(long), or sleep(long, int), methods of this class, then its interrupt status will be cleared and it will receive an InterruptedException.  If this thread is blocked in an I/O operation upon an InterruptibleChannel then the channel will be closed, the thread\u0026rsquo;s interrupt status will be set, and the thread will receive a ClosedByInterruptException.\n If this thread is blocked in a Selector then the thread\u0026rsquo;s interrupt status will be set and it will return immediately from the selection operation, possibly with a non-zero value, just as if the selector\u0026rsquo;s wakeup method were invoked.\n If none of the previous conditions hold then this thread\u0026rsquo;s interrupt status will be set.\n ç»¼ä¸Šï¼Œinterrupt()ã€intterupted()ã€isInterrupted()è¿™3ä¸ªæ–¹æ³•çš„åŒºåˆ«ä¸ä½œç”¨æ€»ç»“å¦‚ä¸‹ï¼š\n interrupt(),ä¸­æ–­è°ƒç”¨è¯¥æ–¹æ³•çš„å½“å‰çº¿ç¨‹ï¼Œå¹¶è®¾ç½®å…¶ä¸­æ–­æ ‡è®°ï¼Œå…·ä½“è€Œè¨€åˆ†ä¸‹è¿°4ç§æƒ…å†µ  è‹¥å½“å‰çº¿ç¨‹è¢«wait()ã€join()ã€sleep()è¿™äº›æ–¹æ³•(å«è¶…æ—¶)é˜»å¡æ—¶ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ä¸­æ–­çº¿ç¨‹æ—¶ä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ï¼ŒåŒæ—¶æŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼› è‹¥å½“å‰çº¿ç¨‹è¢«ä¸€ä¸ªå¯ä¸­æ–­çš„I/Oæ“ä½œé˜»å¡ï¼Œåˆ™ä¼šè®¾ç½®ä¸­æ–­çŠ¶æ€ï¼ŒåŒæ—¶å…³é—­I/Oé€šé“å¹¶æŠ›å‡ºClosedByInterruptExceptionå¼‚å¸¸ï¼› è‹¥å½“å‰çº¿ç¨‹è¢«ä¸€ä¸ªå¼‚æ­¥I/Oæ“ä½œ(Selector)é˜»å¡ï¼Œåˆ™ä¼šè®¾ç½®ä¸­æ–­çŠ¶æ€å¹¶ç«‹å³è¿”å›ï¼Œçœ‹èµ·æ¥å¼‚æ­¥I/Oæ“ä½œçš„å”¤é†’æ–¹æ³•è¢«è°ƒç”¨ï¼› é™¤ä»¥ä¸Š3ç§æƒ…å†µå¤–ï¼Œå…¶ä½™æƒ…å½¢ä¸‹ä¸­æ–­çŠ¶æ€ä¼šè¢«æ­£å¸¸è®¾ç½®ï¼›   interrupted(),æ£€æµ‹å½“å‰çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œå¦‚å·²è¢«ä¸­æ–­è¿‡åˆ™æ¸…é™¤ä¸­æ–­çŠ¶æ€ isInterrupted(),æ£€æµ‹è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¸æ¸…é™¤ä¸­æ–­æ ‡è®°  çº¿ç¨‹ä¸­æ–­çš„ä½¿ç”¨ åœ¨Oracleå®˜ç½‘æœ‰å…³äºinterruptçš„å¦‚ä¸‹å¦‚è¯´æ˜\n An interrupt is an indication to a thread that it should stop what it is doing and do something else. It\u0026rsquo;s up to the programmer to decide exactly how a thread responds to an interrupt, but it is very common for the thread to terminate.\n ä»ä¸Šå¯çŸ¥ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¢«ä¸­æ–­æ—¶ï¼ŒJVMæ²¡æœ‰å¼ºåˆ¶è®©å½“å‰çº¿ç¨‹ç«‹å³ä¸­æ–­,JVMåªæ˜¯è¦æ±‚æˆ‘ä»¬åœ¨å‘ç”Ÿçº¿ç¨‹ä¸­æ–­æ—¶åº”è¯¥åœæ­¢å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡è½¬è€Œå»æ‰§è¡Œå…¶å®ƒä»»åŠ¡ã€‚ä¸€ä¸ªå¸¸ç”¨çš„åœºæ™¯æ˜¯åœ¨å¾ªç¯ä½“ä¸­åˆ©ç”¨isInterrupt()è¿›è¡Œåˆ¤æ–­æ˜¯å¦è¢«ä¸­æ–­ï¼Œåœ¨æ²¡æœ‰è¢«ä¸­æ–­æ—¶åœ¨å¾ªç¯ä½“ä¸­æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œå½“è¢«ä¸­æ–­æ—¶åˆ™è·³å‡ºå¾ªç¯ä½“ç„¶åæ‰§è¡Œå…¶å®ƒä¸šåŠ¡é€»è¾‘ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4  while (!Thread.currentThread().isInterrupted()) { //do something when not been interrupted } //do other things when been interrupted   ä¸LockSupportçš„æ¯”è¾ƒ åˆ©ç”¨LockSupportæ–¹æ³•é‡æ–°ä¿®æ”¹ä¸Šè¿°ä»£ç ï¼Œä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  public void testThread() { Thread threadA = new Thread(() -\u0026gt; { LockSupport.park(); System.out.println(Thread.currentThread().isInterrupted()); System.out.println(Thread.interrupted()); System.out.println(Thread.currentThread().isInterrupted()); }, \u0026#34;Thread_A\u0026#34;); Thread threadB = new Thread(() -\u0026gt; { System.out.println(Thread.currentThread().getName() + \u0026#34; will unpark ThreadA\u0026#34;); LockSupport.unpark(threadA); }, \u0026#34;Thread_B\u0026#34;); threadA.start(); try { Thread.sleep(30); } catch (InterruptedException e) { e.printStackTrace(); } threadB.start(); }   ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼š\nä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºLockSupportä¸­çš„æ–¹æ³•æ¥é˜»å¡å’Œå”¤é†’çº¿ç¨‹æ—¶(æ›´å‡†ç¡®çš„è¯´æ³•æ˜¯é€šè¿‡è®¸å¯æ¥è§‰å¾—çº¿ç¨‹æ˜¯å¦å¯è¿è¡Œ)ï¼Œæ—¢ä¸ä¿®æ”¹çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ä¹Ÿä¸æŠ›å‡ºInterruptedExceptionå¼‚å¸¸ã€‚\nå‚è€ƒæ–‡ç« ï¼š\n https://stackoverflow.com/questions/3590000/what-does-java-lang-thread-interrupt-do https://docs.oracle.com/javase/tutorial/essential/concurrency/interrupt.html https://www.ibm.com/developerworks/library/j-jtp05236/  å…³äºå¦‚ä½•å¤„ç†InterruptedExceptionå¼‚å¸¸ï¼Œè¯·å‚è§æœ¬äººç¿»è¯‘ä¸€ç¯‡æ–‡ç«  [è¯‘]å¦‚ä½•å¤„ç†InterruptedException\n","permalink":"http://isouthrain.github.io/post/java-concurrency/difference-between-interrupt-interrupted-isinterrupted/","tags":["Java","Java Concurrency"],"title":"Javaä¸­interrupt()ã€interrupted()ã€isInterrupted()çš„åŒºåˆ«"},{"categories":["Javaç¼–ç¨‹"],"contents":"ç”±äºå·¥ä½œåŸå› éœ€è¦åœ¨é˜¿é‡Œäº‘ä¸­éƒ¨ç½²ä¸€ä¸ªWebç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿä¼šè°ƒç”¨é‚®ç®±æœåŠ¡å™¨å®šæ—¶ç»™ç›¸å…³äººå‘˜å‘é€é€šçŸ¥é‚®ä»¶,åœ¨æµ‹è¯•é‚®ç®±é…ç½®æ—¶ï¼Œå‘ç°å§‹ç»ˆæ— æ³•æ­£ç¡®å‘é€é‚®ä»¶ï¼Œè€Œä¹‹å‰åœ¨ç ”å‘ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒéƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚ç½‘ä¸ŠæŸ¥æ‰¾ä¹‹åï¼Œå‘ç°æ˜¯é˜¿é‡Œäº‘å‡ºäºå®‰å…¨åŸå› é»˜è®¤ç¦æ­¢äº†25ç«¯å£çš„å‡ºæ–¹å‘è®¿é—®ï¼Œéœ€è¦è¿›è¡Œ25ç«¯å£è§£å°ç”³è¯·ï¼ŒæŒ‰ç…§è¯´æ˜æäº¤ç›¸åº”çš„ç”³è¯·åæ²¡æƒ³åˆ°ä¸åˆ°ä¸€ä¸ªå°æ—¶å°±æé†’ç”³è¯·æœªé€šè¿‡ï¼ŒåŒæ—¶æç¤ºä½¿ç”¨465ç«¯å£æ¥å‘é€åŠ å¯†é‚®ä»¶ã€‚åŸºäºæ­¤ï¼Œæœ¬æ–‡ç®€è¦è¯´æ˜å¦‚ä½•ä½¿ç”¨126é‚®ç®±é€šè¿‡465ç«¯å£åœ¨é˜¿é‡Œäº‘ä¸­å‘é€é‚®ä»¶ã€‚\né‚®ç®±é…ç½® é¦–å…ˆæ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„126é‚®ç®±ï¼Œè¿›å…¥é‚®ç®±è®¾ç½®é€‰é¡¹ï¼Œå¼€å¯SMTPæœåŠ¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\nå¯¹äºæŸäº›ç±»å‹çš„é‚®ç®±å®Œæˆä¸Šä¸€æ­¥çš„æ“ä½œåå³å¯é€šè¿‡é‚®ç®±å’Œå¯†ç å‘é€é‚®ä»¶ï¼Œä½†å¯¹äº126é‚®ç®±è¿˜éœ€è¦åœ¨â€œå®¢æˆ·ç«¯æˆæƒå¯†ç â€ä¸­è®¾ç½®ç›¸åº”çš„æˆæƒç ã€‚æˆæƒç çš„ä½œç”¨å’Œé‚®ç®±å¯†ç ç±»ä¼¼ï¼Œä½†æˆæƒç ä¸»è¦æ˜¯ä¾›ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯è°ƒç”¨æ—¶ä½¿ç”¨ï¼Œè¿™æ ·å¯è¾¾åˆ°å³å¯è®©ç¬¬ä¸‰æ–¹è½¯ä»¶è°ƒç”¨ï¼Œä¹Ÿä¸æ³„éœ²è‡ªå·±é‚®ç®±å¯†ç çš„ç›®çš„ã€‚\nä»£ç ç¼–å†™ ä¸‹è¿°ä»£ç ä¸ºä½¿ç”¨25ç«¯å£å‘é€é‚®ä»¶çš„Javaä»£ç ï¼Œå…¶å®ç°åŸºäºJava Mail 1.4.1ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  public void testSendMail() { final String sendUserName = \u0026#34;***@126.com\u0026#34;; final String sendUserPassword = \u0026#34;***\u0026#34;; // æ”¶ä»¶ç®± \tString receiveUser = \u0026#34;recevie@mail.com\u0026#34;; Properties props = new Properties(); props.put(\u0026#34;mail.smtp.auth\u0026#34;, \u0026#34;true\u0026#34;); props.put(\u0026#34;mail.smtp.host\u0026#34;, \u0026#34;smtp.126.com\u0026#34;); props.put(\u0026#34;mail.smtp.port\u0026#34;, \u0026#34;25\u0026#34;); Session session = Session.getDefaultInstance(props,new Authenticator() { @Override protected PasswordAuthentication getPasswordAuthentication() { return new PasswordAuthentication(sendUserName, sendUserPassword); } }); try { Message message = new MimeMessage(session); message.setFrom(new InternetAddress(sendUserName)); message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(receiveUser)); message.setSubject(\u0026#34;Test Mail Send\u0026#34;); message.setText(\u0026#34;Hello World!\u0026#34;); Transport.send(message); System.out.println(\u0026#34;Send mail success\u0026#34;); } catch (MessagingException e) { e.printStackTrace(); } }   ä¸ºäº†ä½¿ç”¨465ç«¯å£å‘é€é‚®ä»¶ï¼Œé™¤äº†åœ¨ä»£ç ä¸­ä¿®æ”¹ç«¯å£ä¹‹å¤–ï¼Œè¿˜éœ€è¦å°†Mail SocketæŒ‡å®šä¸ºSSLå®ç°ï¼Œå®é™…ä½¿ç”¨ä¸­æˆ‘å‘ç°é€šè¿‡props.put(\u0026quot;mail.smtp.socketFactory.class\u0026quot;, \u0026quot;javax.net.ssl.SSLSocketFactory\u0026quot;);å³å¯å®ç°ï¼Œå®Œæ•´çš„ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  public void testSendMail() { final String sendUserName = \u0026#34;***@126.com\u0026#34;; final String sendUserPassword = \u0026#34;***\u0026#34;; // æ”¶ä»¶ç®± \tString receiveUser = \u0026#34;recevie@mail.com\u0026#34;; Properties props = new Properties(); props.put(\u0026#34;mail.smtp.auth\u0026#34;, \u0026#34;true\u0026#34;); props.put(\u0026#34;mail.smtp.host\u0026#34;, \u0026#34;smtp.126.com\u0026#34;); props.put(\u0026#34;mail.smtp.port\u0026#34;, \u0026#34;465\u0026#34;); //æŒ‡å®šä½¿ç”¨åŸºäºSSLçš„å¥—æ¥å­— \tprops.put(\u0026#34;mail.smtp.socketFactory.class\u0026#34;, \u0026#34;javax.net.ssl.SSLSocketFactory\u0026#34;); Session session = Session.getDefaultInstance(props,new Authenticator() { @Override protected PasswordAuthentication getPasswordAuthentication() { return new PasswordAuthentication(sendUserName, sendUserPassword); } }); try { Message message = new MimeMessage(session); message.setFrom(new InternetAddress(sendUserName)); message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(receiveUser)); message.setSubject(\u0026#34;Test Mail Send\u0026#34;); message.setText(\u0026#34;Hello World!\u0026#34;); Transport.send(message); System.out.println(\u0026#34;Send mail success\u0026#34;); } catch (MessagingException e) { e.printStackTrace(); } }   å…¶ä»–è¯´æ˜ Java Mailä¸­å…³äºé‚®ä»¶è®¾ç½®çš„é€‰é¡¹è¯·å‚è§com.sun.mail.smtp,å®é™…ä½¿ç”¨æ—¶æˆ‘å‘ç°åªéœ€è¦æ·»åŠ props.put(\u0026quot;mail.smtp.socketFactory.class\u0026quot;, \u0026quot;javax.net.ssl.SSLSocketFactory\u0026quot;);å³å¯ï¼Œé¢å¤–çš„æ·»åŠ å…¶å®ƒä¸€äº›é…ç½®åè€Œå¯èƒ½ä¼šå¯¼è‡´ä¸èƒ½æ­£å¸¸ä½¿ç”¨ã€‚\nå¦‚å½“å‚ç…§Stackoverflowä¸­çš„Using JavaMail with TLSè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆåŠ ä¸Šå¦‚ä¸‹ä»£ç ï¼š\n1 2 3  props.put(\u0026#34;mail.smtp.starttls.enable\u0026#34;,\u0026#34;true\u0026#34;); props.put(\u0026#34;mail.smtp.auth\u0026#34;, \u0026#34;true\u0026#34;); props.put(\u0026#34;mail.smtp.socketFactory.fallback\u0026#34;, \u0026#34;false\u0026#34;);   ç¨‹åºè¿è¡Œçš„ç»“æœå¦‚ä¸‹ æ­¤æ—¶åªéœ€å°†props.put(\u0026quot;mail.smtp.starttls.enable\u0026quot;,\u0026quot;true\u0026quot;);è¿™è¡Œä»£ç å»æ‰æˆ–å°†å…¶å€¼è®¾ç½®ä¸ºfalseå³å¯æ­£å¸¸å‘é€é‚®ä»¶ã€‚\nå‚è€ƒè¯´æ˜:\n JavaMail ä½¿ç”¨ 163 å‘é€é‚®ä»¶ Using JavaMail with TLS ","permalink":"http://isouthrain.github.io/post/java-core/send-ssl-mail-with-126-in-aliyun/","tags":["Java"],"title":"åˆ©ç”¨126é‚®ç®±åœ¨é˜¿é‡Œäº‘ä¸­å‘é€SSL/TSLåŠ å¯†é‚®ä»¶"},{"categories":["Webç¼–ç¨‹","Javaç¼–ç¨‹"],"contents":"Quartzæ˜¯è½¯ä»¶å¼€å‘ä¸­å¸¸ç”¨çš„ä»»åŠ¡è°ƒåº¦æ¡†æ¶ï¼Œå®é™…ä¸­é€šå¸¸ç»“åˆ Spring ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶åœ¨Springçš„é…ç½®æ–‡ä»¶ä¸­åˆ©ç”¨0 0 12 ? \\* WEDè¿™ç§æ–¹å¼ä»¥ç¡¬ç¼–ç çš„æ–¹å¼é…ç½®å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ã€‚æœ‰æ—¶å€™éœ€è¦åŠ¨æ€çš„è®¾ç½®å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ï¼Œå¦‚è®©ç”¨æˆ·è‡ªå·±é€‰æ‹©ä½•æ—¶å¤‡ä»½æ•°æ®ï¼Œæ­¤æ—¶å°±éœ€è¦é‡‡ç”¨åŠ¨æ€è®¾ç½®å…¶æ‰§è¡Œæ—¶é—´ã€‚\nä¸ºå®ç°åŠ¨æ€è®¾ç½®å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶é—´çš„åŠŸèƒ½ï¼Œé¦–å…ˆéœ€è¦å®ç°ä»¥ç¡¬ç¼–ç çš„æ–¹å¼è®¾ç½®å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶é—´ï¼Œç„¶ååœ¨å…¶åŸºç¡€ä¸Šä¿®æ”¹ä¸ºå¯åŠ¨æ€è®¾ç½®ï¼Œæœ¬æ–‡åŸºäºè¿™ä¸¤åˆ†éƒ¨åˆ†é€æ­¥ä»‹ç»å¦‚ä½•å®ç°ã€‚\nç¡¬ç¼–ç è®¾ç½®å®šæ—¶æ—¶é—´ æœ¬æ–‡é‡‡ç”¨ Quartz + SpringMVC çš„å®ç°æ¡†æ¶ï¼ŒåŒæ—¶åŸºäº Mavenè¿è¡Œï¼Œç›¸å…³é…ç½®è¿‡ç¨‹å¦‚ä¸‹ï¼š\n1.é¦–å…ˆåœ¨pom.xmlæ–‡ä»¶ä¸­å¼•å…¥ç›¸åº”çš„ä¾èµ–JARåŒ…ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.quartz-scheduler\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;quartz\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.3.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.slf4j\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;slf4j-api\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.7.25\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-context\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.13.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-context-support\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.13.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-web\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.13.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-webmvc\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.13.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-tx\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.13.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;junit\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;junit\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.9\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;javaee\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;javaee-api\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;provided\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt;   2.åˆ›å»ºä¸€ä¸ªå®šæ—¶ä»»åŠ¡æµ‹è¯•ç±»TestJob\n1 2 3 4 5 6 7 8  public class TestJob { private DateFormat df = new SimpleDateFormat(\u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;); public void schedulerJob(){ System.out.println(\u0026#34;=========å®šæ—¶è¾“å‡º:\\t\u0026#34;+df.format(new Date())); } }   3.ç»“åˆSpringè¿›è¡Œå®šæ—¶ä»»åŠ¡çš„é…ç½®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  \u0026lt;beans xmlns=\u0026#34;http://www.springframework.org/schema/beans\u0026#34; xsi:schemaLocation=\u0026#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd \u0026#34;\u0026gt; \u0026lt;bean id=\u0026#34;testJob\u0026#34; class=\u0026#34;com.lucumt.quartz.TestJob\u0026#34;\u0026gt;\u0026lt;/bean\u0026gt; \u0026lt;bean id=\u0026#34;testJobDetail\u0026#34; class=\u0026#34;org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean\u0026#34;\u0026gt; \u0026lt;!-- æŒ‡å®šä»»åŠ¡ç±» --\u0026gt; \u0026lt;property name=\u0026#34;targetObject\u0026#34; ref=\u0026#34;testJob\u0026#34; /\u0026gt; \u0026lt;!-- æŒ‡å®šä»»åŠ¡æ‰§è¡Œçš„æ–¹æ³• --\u0026gt; \u0026lt;property name=\u0026#34;targetMethod\u0026#34; value=\u0026#34;schedulerJob\u0026#34; /\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;bean id=\u0026#34;testJobTrigger\u0026#34; class=\u0026#34;org.springframework.scheduling.quartz.CronTriggerFactoryBean\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;jobDetail\u0026#34; ref=\u0026#34;testJobDetail\u0026#34; /\u0026gt; \u0026lt;!-- æ¯10ç§’è¿è¡Œä¸€æ¬¡ --\u0026gt; \u0026lt;property name=\u0026#34;cronExpression\u0026#34; value=\u0026#34;0/10 * * * * ?\u0026#34; /\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;bean class=\u0026#34;org.springframework.scheduling.quartz.SchedulerFactoryBean\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;triggers\u0026#34;\u0026gt; \u0026lt;list\u0026gt; \u0026lt;ref bean=\u0026#34;testJobTrigger\u0026#34; /\u0026gt; \u0026lt;/list\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;/beans\u0026gt;   4.web.xmlä¸­é…ç½®å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  \u0026lt;web-app version=\u0026#34;2.5\u0026#34; xmlns=\u0026#34;http://java.sun.com/xml/ns/javaee\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xsi:schemaLocation=\u0026#34;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\u0026#34;\u0026gt; \u0026lt;display-name\u0026gt;Dynamic Quartz Scheduler\u0026lt;/display-name\u0026gt; \u0026lt;listener\u0026gt; \u0026lt;listener-class\u0026gt;org.springframework.web.context.ContextLoaderListener\u0026lt;/listener-class\u0026gt; \u0026lt;/listener\u0026gt; \u0026lt;context-param\u0026gt; \u0026lt;param-name\u0026gt;contextConfigLocation\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;classpath*:spring-context-*.xml\u0026lt;/param-value\u0026gt; \u0026lt;/context-param\u0026gt; \u0026lt;/web-app\u0026gt;   é…ç½®å®Œæˆåï¼Œåœ¨eclipseä¸­è¿è¡Œtomcat7:runè¿è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºå®šæ—¶ä»»åŠ¡æ¯éš”10ç§’æ‰§è¡Œä¸€æ¬¡ã€‚\nä¸Šè¿°çš„ç¡¬ç¼–ç è®¾ç½®å°† Quartz çš„æ‰§è¡Œæ—¶é—´é€šè¿‡ç¡¬ç¼–ç æ–¹å¼å†™å…¥XMLé…ç½®æ–‡ä»¶ä¸­ï¼Œè¿™æ˜¯æœ€å¸¸è§çš„ç”¨æ³•ï¼Œä½†é€šè¿‡XMLé…ç½®æ–‡ä»¶å†™å…¥å®šæ—¶æ—¶é—´æ—¶æ— æ³•åŠ¨æ€çš„æ›´æ”¹å…¶æ‰§è¡Œæ—¶é—´ã€‚\nåŠ¨æ€è®¾ç½®å®šæ—¶æ—¶é—´ ä¸ºäº†ä¾¿äºæ¼”ç¤ºï¼Œæœ¬æ–‡é‡‡ç”¨Webç¨‹åºçš„æ–¹å¼å±•ç¤ºç›¸å…³æ“ä½œè¿‡ç¨‹ã€‚\n1.å¢åŠ ä¸€ä¸ªtestScheduler.jspå±•ç¤ºæ“ä½œç•Œé¢:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65  \u0026lt;%@ page language=\u0026#34;java\u0026#34; import=\u0026#34;java.util.*\u0026#34; pageEncoding=\u0026#34;UTF-8\u0026#34;%\u0026gt; \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta http-equiv=\u0026#34;content-type\u0026#34; content=\u0026#34;text/html; charset=UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;åŠ¨æ€è®¾ç½®quartz\u0026lt;/title\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;js/jquery-2.1.1.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; type=\u0026#34;text/css\u0026#34; href=\u0026#34;js/bootstrap/css/bootstrap.min.css\u0026#34;/\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; src=\u0026#34;js/bootstrap/js/bootstrap.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;style type=\u0026#34;text/css\u0026#34;\u0026gt; .container{ margin-top: 30px; margin-left: auto; margin-right: auto; padding: 10px; background-color: #d0d0d0; border-radius: 5px; min-height:400px; } .hidden{ display: none; } \u0026lt;/style\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; function changeScheduler(){ var hiddenId = $(\u0026#34;.hidden\u0026#34;).attr(\u0026#34;id\u0026#34;); var expression = null; if(hiddenId==\u0026#34;scheduler_one\u0026#34;){ $(\u0026#34;#scheduler_one\u0026#34;).removeClass(\u0026#34;hidden\u0026#34;); $(\u0026#34;#scheduler_two\u0026#34;).addClass(\u0026#34;hidden\u0026#34;); expression=\u0026#34;0/10 * * * * ?\u0026#34;; }else{ $(\u0026#34;#scheduler_one\u0026#34;).addClass(\u0026#34;hidden\u0026#34;); $(\u0026#34;#scheduler_two\u0026#34;).removeClass(\u0026#34;hidden\u0026#34;); expression=\u0026#34;0/30 * * * * ?\u0026#34;; } sendChangeRequest(expression); } function sendChangeRequest(expression){ $.ajax({ url:\u0026#34;changeScheduler\u0026#34;, type:\u0026#34;post\u0026#34;, data:{ expression:expression }, success:function(){ } }); } \u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container-fluid container\u0026#34;\u0026gt; \u0026lt;div id=\u0026#34;scheduler_one\u0026#34;\u0026gt; å½“å‰å®šæ—¶ä»»åŠ¡çš„è¡¨è¾¾å¼ä¸º\u0026lt;b\u0026gt;0/10 * * * * ?\u0026lt;/b\u0026gt;,æ¯éš”10ç§’è¾“å‡ºä¸€æ¬¡ \u0026lt;/div\u0026gt; \u0026lt;div id=\u0026#34;scheduler_two\u0026#34; class=\u0026#34;hidden\u0026#34;\u0026gt; å½“å‰å®šæ—¶ä»»åŠ¡çš„è¡¨è¾¾å¼ä¸º\u0026lt;b\u0026gt;0/30 * * * * ?\u0026lt;/b\u0026gt;,æ¯éš”30ç§’è¾“å‡ºä¸€æ¬¡ \u0026lt;/div\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; class=\u0026#34;btn btn-primary btn-sm\u0026#34; onclick=\u0026#34;changeScheduler()\u0026#34;\u0026gt;åˆ‡æ¢å®šæ—¶æ—¶é—´\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt;   2.å¢åŠ ä¸€ä¸ªControllerç±»QuartzControllerç”¨äºå“åº”å‰ç«¯é‡æ–°è®¾ç½®å®šæ—¶ä»»åŠ¡æ—¶é—´çš„è¯·æ±‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  @Controller(\u0026#34;/\u0026#34;) public class QuartzController { @Autowired private JobScheduler jobScheduler; @RequestMapping(\u0026#34;testScheduler\u0026#34;) public String testScheduler(){ return \u0026#34;testScheduler\u0026#34;; } @RequestMapping(\u0026#34;changeScheduler\u0026#34;) @ResponseBody public String changeScheduler(String expression){ System.out.println(\u0026#34;æ‰§è¡Œæ—¶é—´è¢«ä¿®æ”¹ä¸º:\\t\u0026#34;+expression); jobScheduler.resetJob(expression); return \u0026#34;SUCCESS\u0026#34;; } }   3.åœ¨æ—¶ä»»åŠ¡æµ‹è¯•ç±»TestJobä¸­æ·»åŠ ä¸€ä¸ªresetJobæ–¹æ³•ï¼Œç”¨äºé‡æ–°è®¾ç½®å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶é—´\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  public class JobScheduler implements ServletContextAware { private DateFormat df = new SimpleDateFormat(\u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;); private ServletContext context; @Override public void setServletContext(ServletContext context) { this.context=context;\t} public void schedulerJob() { System.out.println(\u0026#34;=========å®šæ—¶è¾“å‡º:\\t\u0026#34; + df.format(new Date())); } //é€šè¿‡æ­¤æ–¹æ³•é‡æ–°è®¾ç½®å®šæ—¶ä»»åŠ¡è°ƒåº¦æ—¶é—´ \tpublic void resetJob(String expression){ ApplicationContext applicationContext = WebApplicationContextUtils.getRequiredWebApplicationContext(context); Scheduler scheduler = (Scheduler) applicationContext.getBean(\u0026#34;testScheduler\u0026#34;); CronTriggerImpl trigger = null; try { TriggerKey triggerKeys = TriggerKey.triggerKey(\u0026#34;testJobTrigger\u0026#34;,Scheduler.DEFAULT_GROUP); trigger = new CronTriggerImpl(); trigger.setCronExpression(expression); trigger.setKey(triggerKeys);//è¦ç¡®ä¿keyç›¸åŒ \tscheduler.rescheduleJob(triggerKeys,trigger); } catch (ParseException | SchedulerException e) { e.printStackTrace(); } } }   4.å…¶ä»–é…ç½®æ–‡ä»¶ä¿æŒä¸å˜ï¼Œä¿®æ”¹åçš„è¿è¡Œç•Œé¢å¦‚ä¸‹\n5.å¤šæ¬¡ç‚¹å‡»è¯¥æŒ‰é’®ï¼Œæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºå®ç°äº†åŠ¨æ€è®¾ç½®å®šæ—¶ä»»åŠ¡çš„åŠŸèƒ½\nä¸Šè¿°ä»£ç æ˜¯åŸºäºQuartz2.3.0æ¥å®ç°çš„ï¼Œç›¸å…³æºä»£ç è¯·å‚è§ quartz_demo ï¼Œå…¶æ ¸å¿ƒåœ¨äº resetJob æ–¹æ³•é€šè¿‡è°ƒç”¨ CronTriggerImpl æ¥é‡æ–°è®¾ç½®å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶é—´ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¦ç¡®ä¿å®šæ—¶ä»»åŠ¡ä¿®æ”¹å‰åçš„triggerKeyä¸€è‡´ï¼Œè¿™æ ·æ‰èƒ½ä¿®æ”¹ç”Ÿæ•ˆï¼Œå¦åˆ™åº”ç”¨ç¨‹åºä¼šåœ¨æ‰§è¡ŒåŸæœ‰çš„å®šæ—¶ä»»åŠ¡æ—¶åŒæ—¶ä»¥æ–°çš„æ—¶é—´æ¥æ‰§è¡Œæ–°çš„å®šæ—¶ä»»åŠ¡ï¼Œå³åŒæ—¶æ‰§è¡Œä¸¤ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œè¾¾ä¸åˆ°é¢„æœŸæ•ˆæœã€‚\nQuartz1.7.2ä¸­çš„å®šæ—¶ä»»åŠ¡è®¾ç½® åœ¨æ—§ç‰ˆçš„Quartz(1.7.2)ä¸­rescheduleJobçš„æ–¹æ³•å‚æ•°å‘ç”Ÿäº†å˜åŒ–ï¼Œç›¸åº”çš„Springç‰ˆæœ¬ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œéœ€è¦ç”¨ CronTriggerBeanæ›¿æ¢ CronTriggerImplï¼Œå¯¹åº”çš„å®ç°ä»£ç å¯ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  public void resetJob(String expression){ ApplicationContext applicationContext = WebApplicationContextUtils.getRequiredWebApplicationContext(context); Scheduler scheduler = (Scheduler) applicationContext.getBean(\u0026#34;testScheduler\u0026#34;); try { CronTriggerBean trigger = new CronTriggerBean(); trigger.setCronExpression(expression); trigger.setName(\u0026#34;testJobTrigger\u0026#34;); trigger.setGroup(Scheduler.DEFAULT_GROUP); trigger.setJobName(\u0026#34;testJobDetail\u0026#34;); scheduler.rescheduleJob(\u0026#34;testJobTrigger\u0026#34;, Scheduler.DEFAULT_GROUP, trigger); } catch (SchedulerException | ParseException e) { e.printStackTrace(); } }   å…¶è¿è¡Œç»“æœå’Œå‰é¢çš„ä¸€è‡´ã€‚\né€šè¿‡Springè·å–Triggerå¯¼è‡´çš„é‡å¤æ‰§è¡Œé—®é¢˜ å°†ä¸Šè¿°ä»£ç ä¸­çš„CronTriggerBeanåˆå§‹åŒ–ä»new*å…³é”®å­—å®ç°å˜ä¸ºé€šè¿‡Schdulerè·å–åŸæœ‰çš„ä»»åŠ¡åé‡æ–°æ›´æ–°ï¼Œä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  public void resetJob(String expression){ ApplicationContext applicationContext = WebApplicationContextUtils.getRequiredWebApplicationContext(context); Scheduler scheduler = (Scheduler) applicationContext.getBean(\u0026#34;testScheduler\u0026#34;); try { CronTriggerBean trigger = (CronTriggerBean) scheduler.getTrigger(\u0026#34;testJobTrigger\u0026#34;, Scheduler.DEFAULT_GROUP);//é€šè¿‡schedulerè·å–  trigger.setCronExpression(expression); trigger.setName(\u0026#34;testJobTrigger\u0026#34;); scheduler.rescheduleJob(\u0026#34;testJobTrigger\u0026#34;, Scheduler.DEFAULT_GROUP, trigger); } catch (SchedulerException | ParseException e) { e.printStackTrace(); } }   å®é™…è¿è¡Œæ—¶ä¼šå‘ç°æ¯æ¬¡åŠ¨æ€åˆ‡æ¢ Quartz çš„æ‰§è¡Œæ—¶é—´æ—¶éƒ½ä¼šå¯¼è‡´è¯¥å®šæ—¶ä»»åŠ¡è¢«æ‰§è¡Œä¸¤æ¬¡æˆ–é”™è¯¯æ‰§è¡Œçš„ç°è±¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nåˆæ­¥ä¸Šè¿°é—®é¢˜äº§ç”Ÿçš„åŸå› ä¸ºé€šè¿‡Schedulerè·å–çš„æ˜¯å·²æœ‰çš„Triggerè€Œå¯¼è‡´é‡å¤æ‰§è¡Œï¼ˆä¸è®º Quartz æ–°æ—§ç‰ˆæœ¬å‡æœ‰æ­¤é—®é¢˜ )ï¼Œå¦‚æœé‡‡ç”¨newå…³é”®å­—é‡æ–°åˆ›å»ºä¸€ä¸ªTriggeråˆ™æ­¤é—®é¢˜ä¼šæ¶ˆå¤±ï¼Œè‡³äºä¸ºä½•é‡‡ç”¨æ—§çš„Triggerä¼šå¯¼è‡´å®šæ—¶ä»»åŠ¡é”™è¯¯æ‰§è¡Œï¼Œè¿˜æœ‰å¾…è¿›ä¸€æ­¥åˆ†æã€‚\n","permalink":"http://isouthrain.github.io/post/quartz/update-quartz-scheduler-dynamic/","tags":["Quartz","Spring","SpringMVC"],"title":"åœ¨Quartzä¸­åŠ¨æ€è®¾ç½®å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´"},{"categories":["Javaç¼–ç¨‹"],"contents":"è¿™å‡ å¤©å·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªåˆ©ç”¨dom4jæ›´æ–°XMLæ–‡ä»¶çš„ä»»åŠ¡ï¼Œç”±äºXMLæ–‡ä»¶ä¸­éƒ¨åˆ†å±æ€§åŒ…å«æœ‰æ¢è¡Œç¬¦ï¼Œåˆ©ç”¨dom4j(1.6.1)é»˜è®¤çš„æ–¹æ³•æ›´æ–°XMLæ–‡ä»¶åæ¢è¡Œç¬¦ä¼šä¸¢å¤±ã€‚ å„ç§Googleã€StackOverflowæŠ˜è…¾å¥½ä¹…åç»ˆäºè§£å†³è¯¥é—®é¢˜ï¼Œç®€å•è®°å½•ä¸‹ã€‚\nå¯¹äºä¿®æ”¹XMLæ–‡ä»¶ï¼Œè‡ªå·±å¾ˆè‡ªç„¶çš„æƒ³åˆ°åˆ©ç”¨dom4jå’Œ XPathæ¥å®ç°åŠŸèƒ½ï¼Œä½¿ç”¨çš„ä»£ç ç±»ä¼¼å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  public static void updateXML() { SAXReader saxReader = new SAXReader(); File oldFile = new File(\u0026#34;D:\\\\test\\\\old_test.xml\u0026#34;); File newFile = new File(\u0026#34;D:\\\\test\\\\new_test.xml\u0026#34;); try { Document oldDoc = saxReader.read(oldFile); Element oldRoot = oldDoc.getRootElement(); Element oldEle = (Element) oldRoot.selectSingleNode(\u0026#34;//book[@id=\u0026#39;01001\u0026#39;]/name\u0026#34;); System.out.println(oldEle.attributeValue(\u0026#34;description\u0026#34;)); OutputFormat format = OutputFormat.createPrettyPrint(); format.setEncoding(\u0026#34;UTF-8\u0026#34;); format.setNewLineAfterDeclaration(false); //å†™å…¥æ–°æ–‡ä»¶ \tXMLWriter writer = new XMLWriter(new FileWriter(newFile), format); writer.write(oldDoc); writer.flush(); writer.close(); System.out.println(\u0026#34;\\n================åˆ†éš”ç¬¦==================\\n\u0026#34;); //ä»æ–°æ–‡ä»¶ä¸­è¯»å–æ•°æ® \tDocument newDoc = saxReader.read(newFile); Element newRoot = newDoc.getRootElement(); Element newEle = (Element) newRoot.selectSingleNode(\u0026#34;//book[@id=\u0026#39;01001\u0026#39;]/name\u0026#34;); System.out.println(newEle.attributeValue(\u0026#34;description\u0026#34;)); } catch (DocumentException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); } }   å¯¹åº”çš„XMLæ–‡ä»¶ç±»ä¼¼å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;books\u0026gt; \u0026lt;book id=\u0026#34;01001\u0026#34;\u0026gt; \u0026lt;name description=\u0026#34;New coverage includes:\u0026amp;#xD;\u0026amp;#xA;\u0026amp;#xD;\u0026amp;#xA;Functional interfaces, lambda expressions, method references, and streams\u0026amp;#xD;\u0026amp;#xA;Default and static methods in interfaces\u0026amp;#xD;\u0026amp;#xA;Type inference, including the diamond operator for generic types\u0026amp;#xD;\u0026amp;#xA;The @SafeVarargs annotation\u0026amp;#xD;\u0026amp;#xA;The try-with-resources statement\u0026#34;\u0026gt;Effective Java\u0026lt;/name\u0026gt; \u0026lt;price\u0026gt;50.6\u0026lt;/price\u0026gt; \u0026lt;author\u0026gt;Joshua Bloch\u0026lt;/author\u0026gt; \u0026lt;publishDate\u0026gt;2017-12-08\u0026lt;/publishDate\u0026gt; \u0026lt;/book\u0026gt; \u0026lt;/books\u0026gt;   ä¸Šè¿°ä»£ç çš„é€»è¾‘å¾ˆç®€å•ï¼šé¦–å…ˆä»XMLæ‰“å¼€ä¸€ä¸ªXMLæ–‡ä»¶ï¼Œç„¶åè¾“å‡ºæŸä¸ªä¹¦æœ¬çš„æè¿°ä¿¡æ¯ï¼Œå°†å…¶å†™å…¥æ–°çš„XMLæ–‡ä»¶ï¼Œç„¶ååœ¨æ–°XMLæ–‡ä»¶ä¸­è¯»å–ç›¸åŒçš„ä¿¡æ¯ã€‚ç†è®ºä¸Šå‰åä¸¤æ¬¡è¾“å‡ºçš„ç»“æœåº”è¯¥ä¸€æ ·ï¼Œä½†å®é™…è¿è¡Œåå‘ç°ä»æ–°çš„XMLæ–‡ä»¶ä¸­è¯»å–å‡ºçš„æè¿°ä¿¡æ¯æ¢è¡Œç¬¦éƒ½ä¸¢å¤±äº†ï¼Œå‰åä¸¤æ¬¡è¾“å‡ºçš„ç»“æœä¸ä¸€è‡´ï¼\nå¯¹æ¯”æ–°æ—§XMLæ–‡ä»¶åå‘ç°ï¼Œäº§ç”Ÿæ­¤ç°è±¡çš„åŸå› æ˜¯: dom4j è‡ªä½œä¸»å¼ çš„åœ¨å†™å…¥XMLæ–‡ä»¶æ—¶å°† \u0026amp;#xD;\u0026amp;#xA; æ›¿æ¢ä¸ºäº† \\r\\n ï¼Œè€ŒXMLæ–‡ä»¶ä¸­æ ‡å‡†çš„å›è½¦æ¢è¡Œç¬¦æ˜¯ç”¨ \u0026amp;#xD;\u0026amp;#xA; æ¥è¡¨ç¤ºçš„ ï¼Œå°†å®ƒä»¬æ›¿æ¢åå†æ¬¡è¯»å–çš„ç»“æœå¾ˆæ˜¾ç„¶ä¸ç¬¦åˆè¦æ±‚ã€‚\näº†è§£åˆ°é—®é¢˜äº§ç”Ÿçš„æ ¹æºåï¼Œåˆ™å…¶è§£å†³æ€è·¯ä¹Ÿå¾ˆæ˜ç¡®ï¼š å†™å…¥XMLæ–‡ä»¶æ—¶ï¼Œå°† \\r\\n å†æ¬¡æ›¿æ¢ä¸º \u0026amp;#xD;\u0026amp;#xA; å³å¯ã€‚æœ€å¼€å§‹è‡ªå·±æƒ³é‡‡ç”¨å¦‚ä¸‹çš„æ–¹æ³•æ¥ç®€å•æ›¿æ¢ï¼Œè¿è¡Œå®Œæ¯•åå‘ç°ç»“æœå’Œå‰é¢çš„ä¸€è‡´ï¼Œé—®é¢˜ä¾æ—§ã€‚\n1 2 3  String description = oldEle.attributeValue(\u0026#34;description\u0026#34;); description = description.replaceAll(\u0026#34;\\r\\n\u0026#34;,\u0026#34;\u0026amp;#xD;\u0026amp;#xA;\u0026#34;); oldEle.attributeValue(\u0026#34;description\u0026#34;,description);   è¿›ä¸€æ­¥åˆ†æåå‘ç°dom4jä¸ä»…ä¼šåœ¨è¯»å–XMLæ–‡ä»¶æ—¶å¯¹\u0026amp;#xD;\u0026amp;#xA;è¿›è¡Œè½¬ä¹‰ï¼Œè€Œä¸”åœ¨å†™å…¥XMLæ–‡ä»¶æ—¶ä¹Ÿä¼šå¯¹\u0026amp;#xD;\u0026amp;#xA;è¿›è¡Œè½¬ä¹‰ï¼Œå‰é¢çš„æ–¹æ³•åªæ˜¯è§£å†³äº†è¯»å–çš„é—®é¢˜ï¼Œå†™å…¥æ—¶æ²¡æœ‰å¤„ç†ï¼Œæ‰€ä»¥é—®é¢˜ä¾æ—§ã€‚\nå†™å…¥æ—¶ä¸»è¦çš„æ“ä½œç±»æ˜¯OutputFormatå’ŒXMLWriterï¼Œè‡ªå·±ä¸€å¼€å§‹ä»¥ä¸ºå¯ä»¥é€šè¿‡OutputFormatè¿›è¡Œå“åº”çš„è®¾ç½®å®ç°ï¼Œå°†ä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼Œç„¶å¹¶åµï¼Œé—®é¢˜ä¾æ—§ï¼\n1 2 3 4 5  OutputFormat format = OutputFormat.createPrettyPrint(); format.setNewlines(true); format.setLineSeparator(\u0026#34;\\r\\n\u0026#34;); format.setEncoding(\u0026#34;UTF-8\u0026#34;); format.setNewLineAfterDeclaration(false);   OutputFormatä¸å¥½ä½¿ï¼Œåªèƒ½ä»XMLWriterç€æ‰‹ï¼Œè°ƒç”¨writer.setEscapeText(false)æ–¹æ³•ä¹Ÿä¸èƒ½è§£å†³é—®é¢˜ï¼Œçœ‹æ¥åªèƒ½æ”¾å‡ºå¤§æ‹›ï¼Œè‡ªå·±å®šä¹‰å®ç°ä¸€ä¸ª XMLWriterç±»ï¼Œå°†ä»¥åŠè½¬ä¹‰åçš„å›è½¦æ¢è¡Œç¬¦åˆæ¢å›å»ï¼Œä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  public class HRXMLWriter extends XMLWriter { public HRXMLWriter(Writer wr, OutputFormat format) { super(wr, format); } @Override protected String escapeAttributeEntities(String text) { text = super.escapeAttributeEntities(text); if (text.indexOf(\u0026#34;\\r\\n\u0026#34;) \u0026gt; -1) { text = text.replaceAll(\u0026#34;\\r\\n\u0026#34;, \u0026#34;\u0026amp;#xD;\u0026amp;#xA;\u0026#34;); } return text; } }   ç„¶åå°†å†™å…¥æ—¶çš„ä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š\n1 2 3 4 5  //æ¡ç”¨å®šä¹‰å†™å…¥ç±»HRXMLWriter XMLWriter writer = new HRXMLWriter(new FileWriter(newFile), format); writer.write(oldDoc); writer.flush(); writer.close();   è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œé—®é¢˜é¡ºåˆ©è§£å†³ï¼\nå‘çˆ¹å•Šï¼\n","permalink":"http://isouthrain.github.io/post/java-core/update-xml-file-has-line-breaks-using-dom4j/","tags":["Java","XML"],"title":"åˆ©ç”¨dom4jä¿®æ”¹å«æœ‰å›è½¦æ¢è¡Œç¬¦çš„XMLæ–‡ä»¶"},{"categories":["ä¸ªäººåšå®¢"],"contents":"è¶Šæ¥è¶Šå¤šçš„ç½‘ç«™å’Œä¸ªäººåšå®¢éƒ½å˜æˆ HTTPS ï¼Œè€Œè‡ªå·±çš„åšå®¢ä¸€ç›´éƒ½æ˜¯ç”¨çš„æ˜¯ HTTP åè®®ï¼Œä½œä¸ºä¸€ä¸ªå…·æœ‰å¼ºè¿«ç—‡çš„äººï¼Œæ¯æ¬¡ç”¨ Chrome æµè§ˆå™¨æ‰“å¼€ä¸ªäººåšå®¢æ—¶çœ‹è§æµè§ˆå™¨åœ°å€æ æ˜¾ç¤ºçš„éƒ½æ„Ÿè§‰å¾ˆä¸èˆ’æœã€‚è¶ç€å‰æ®µæ—¶é—´ä¸å¤ªå¿™ï¼Œå°†ä¸ªäººåšå®¢ä»HTTPè¿ç§»åˆ°äº†HTTPS ï¼Œå…ˆè®°å½•ä¸‹ã€‚\nä¸€å¼€å§‹æˆ‘æƒ³ç›´æ¥é€šè¿‡åœ¨ GoDaddy ä¸Šç›´æ¥è´­ä¹°HTTPS æœåŠ¡æ¥å®ç°ï¼Œå»å®˜ç½‘æŸ¥çœ‹åå‘ç°è´¹ç”¨å¤ªé«˜ï¼Œä¸€å¹´å¤§çº¦100ç¾åˆ€ï¼Œæœæ–­å¼ƒä¹‹ã€‚ Googleåå‘ç°å¾ˆå¤šäººéƒ½ç”¨Cloudflareé€šè¿‡è½¬å‘è¯·æ±‚æ¥å®ç°HTTPSè®¿é—®ï¼Œæ“ä½œèµ·æ¥ä¹Ÿå¾ˆå¿«ï¼Œè‡ªå·±ä¾¿ä¹Ÿé‡‡ç”¨Cloudflareå®ç°ï¼Œ æœ¬æ–‡ä¸»è¦æ˜¯åŸºäºCloudflare çš„å®ç°è¯´æ˜ã€‚\næ“ä½œè¿‡ç¨‹ ç»™åšå®¢æ·»åŠ è‡ªå®šä¹‰åŸŸå æœ¬äººä½¿ç”¨çš„æ˜¯GoDaddyæ¥è®¾ç½®è‡ªå®šä¹‰åŸŸåï¼Œå…·ä½“æ“ä½œè¯·å‚è§ åˆ©ç”¨GoDaddyé…ç½®è‡ªå®šä¹‰åŸŸåï¼Œ æ ¸å¿ƒçš„æ“ä½œå°±æ˜¯ç»™CNAME æ–‡ä»¶æ·»åŠ Github Pagesç»™å‡ºçš„ä¸¤æ¡Aè®°å½•IPåœ°å€ï¼Œæ­¤å¤„ä¸å†è¯¦è¿°ã€‚\nåˆ©ç”¨Cloudflareä¿®æ”¹DNSæœåŠ¡å™¨  æ‰“å¼€Cloudflareå®˜ç½‘æ³¨å†Œä¸€ä¸ªCloudflare è´¦æˆ·ã€‚æ³¨å†ŒæˆåŠŸä¹‹åï¼Œç‚¹å‡»é¡µé¢å³ä¸Šè§’çš„add site é“¾æ¥ï¼Œæ·»åŠ ä¸€ä¸ªç½‘ç«™ï¼Œåœ¨ä¸‹å›¾è¾“å…¥æ¡†ä¸­è¾“å…¥è‡ªå·±çš„åŸŸåï¼Œç‚¹å‡» Begin Scan æŒ‰é’®å¼€å§‹æ‰«æã€‚\n æ‰«æå®Œæ¯•åç‚¹å‡» Contiue Setup ï¼Œåœ¨ç±»ä¼¼å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç•Œé¢ä¸­é€‰æ‹©Free Websiteï¼Œç„¶åç‚¹å‡»é¡µé¢åº•éƒ¨çš„ContinueæŒ‰é’®ã€‚\n åœ¨ä¸‹å›¾æ‰€ç¤ºçš„Cloudflare Nameserversè¯´æ˜ç•Œé¢ä¸­æ ¹æ®è¦æ±‚æ¥ä¿®æ”¹è‡ªå®šä¹‰åŸŸåçš„DNSæœåŠ¡å™¨ã€‚  ç™»å½•GoDaddyï¼Œæ‰“å¼€å“åº”åŸŸåçš„Manage DNSç•Œé¢ï¼Œå°†Nameserversä»Defaultä¿®æ”¹ä¸ºCustom ç„¶åæ·»åŠ å‰ä¸€ä¸ªæ­¥éª¤ä¸­çš„ä¸¤ä¸ªå€¼åˆ†åˆ«åŠ ä¸Šå¹¶ç‚¹å‡»ä¿å­˜ã€‚\n å›åˆ°Cloudflareç½‘ç«™ï¼Œç‚¹å‡»OverviewæŒ‰é’®ï¼ŒæŸ¥çœ‹åŸŸåçš„çŠ¶æ€æ˜¯å¦ä¸ºå¦‚ä¸‹æ‰€ç¤ºçš„Activeï¼Œè‹¥æ˜¯åˆ™è¡¨ç¤ºDNSæœåŠ¡å™¨ä¿®æ”¹æˆåŠŸï¼Œè‹¥ä¸æ˜¯ Activeè¯·ç­‰å¾…å‡ åˆ†é’Ÿã€‚\n  Cloudflareä¸­å¼€å¯HTTPSè®¾ç½®  åœ¨Cloudflareç½‘ç«™ä¸Šç‚¹å‡»é¡¶éƒ¨çš„CryptoæŒ‰é’®ï¼Œå°†çŠ¶æ€ä¿®æ”¹ä¸ºFullã€‚\n åœ¨é¡¶éƒ¨åˆ‡æ¢åˆ°Page Rulesç•Œé¢ï¼Œç‚¹å‡»Create Page Rule ï¼Œæ·»åŠ è§„åˆ™http://lucumt.info/* å¹¶é€‰æ‹©Always Use HTTPSæ¥å¼ºåˆ¶è¯¥åŸŸåä¸‹çš„æ‰€æœ‰è¯·æ±‚éƒ½æ˜¯ç”¨HTTPSå®ç°ï¼Œç„¶åç‚¹å‡»Save and Deployæ¥éƒ¨ç½²è¯¥è§„åˆ™ï¼Œæ³¨æ„æ­¤å¤„çš„è§„åˆ™æ˜¯HTTP è€Œä¸æ˜¯HTTPS ã€‚\næ‰§è¡Œå®Œè¿™ä¸€æ­¥åç†è®ºä¸Šé€šè¿‡HTTPSå¯ä»¥æ­£å¸¸çš„è®¿é—®ä¸ªäººåšå®¢ï¼Œä½†è¿˜éœ€å¯¹åšå®¢æºç åšä¸€äº›ä¿®æ”¹ã€‚  å°†ä»£ç ä¸­æ‰€æœ‰HTTPä¿®æ”¹ä¸ºHTTPS åœ¨æ‰§è¡Œå®Œå‰é¢çš„æ­¥éª¤åï¼Œåœ¨æµè§ˆå™¨ä¸­ç”¨HTTPSè®¿é—®ä¸ªäººåšå®¢æ—¶ï¼Œå¯èƒ½çœ‹åˆ°çš„è¿˜æ˜¯è€Œä¸æ˜¯è‡ªå·±æœŸæœ›ä¸­çš„å°ç»¿é”ï¼ŒåŒæ—¶æµè§ˆå™¨æ§åˆ¶å°å¯èƒ½ä¼šå‡ºç°ç±»ä¼¼Mixed Content,The page at ...,The request has been blocked,the content must be serverd over HTTPSçš„é”™è¯¯ä¿¡æ¯ã€‚å…¶åŸå› æ˜¯ç”±äºæŸäº›é¡µé¢ä¸­å­˜åœ¨æ··åˆå†…å®¹ï¼Œå³éƒ¨åˆ†è¯·æ±‚è¿˜æ˜¯ä»¥HTTPæ–¹å¼å®ç°çš„ï¼Œå¦‚åŠ è½½ JavaScript ,CSS ç­‰ï¼Œè§£å†³æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°†æ‰€æœ‰çš„HTTPè¯·æ±‚éƒ½æ”¹ä¸ºHTTPSå³å¯ ã€‚\nä»¥æˆ‘ä¸ªäººåŸºäºHugoçš„åšå®¢ä¸ºä¾‹ï¼Œè¦è¿›è¡Œå¦‚ä¸‹å‡ æ­¥æ“ä½œï¼š\n  å°†ä¸ªäººHugoæºä»£ç ä¸­æ‰€æœ‰çš„HTTP è¯·æ±‚éƒ½ä¿®æ”¹ä¸ºHTTP,åŒ…æ‹¬é¡µé¢ä¸­çš„ç›´æ¥è¯·æ±‚å’Œ JavaScript ã€CSSç­‰æ–‡ä»¶ä¸­çš„é—´æ¥è¯·æ±‚ã€‚\n  åˆ©ç”¨ hugo server -D --baseUrl=\u0026quot;https://lucumt.info\u0026quot; --appendPort=false é‡æ–°ç”ŸæˆåŸºäºHTTPSçš„æºæ–‡ä»¶é¡µé¢ã€‚\nå°†ç”Ÿæˆçš„åšå®¢æºä»£ç é‡æ–°ä¸Šä¼ åˆ° Github ä»“åº“ä¸­ï¼Œç»è¿‡1åˆ†é’Ÿå·¦å³ä»¥HTTPSçš„æ–¹å¼åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä¸ªäººåšå®¢ï¼ŒæœŸå¾…ä¸­çš„å°ç»¿é”å…¥æ„¿å‡ºç°ï¼Œä¸–ç•Œç»ˆäºå’Œè°äº†ï¼\n  æ³¨æ„äº‹é¡¹ é€šè¿‡Cloudflareè™½ç„¶å¯ä»¥å¿«é€Ÿçš„å°†è‡ªå·±çš„ä¸ªäººåšå®¢è¿ç§»åˆ°HTTPSï¼Œä½†åŸºäºä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢çš„åŸå› ï¼Œåœ¨æ¡ä»¶è®¸å¯çš„æƒ…å†µä¸‹è¿˜æ˜¯åº”è¯¥ä½¿ç”¨å…¶ä»–æ–¹å¼å®ç°HTTPS:\n å…è´¹è®¡åˆ’ä¸‹çš„Cloudflareå®é™…ä¸Šç›¸å½“äºä¸€ä¸ªä¸­ä»‹ï¼Œæˆ‘ä»¬çš„è®¿é—®è¯·æ±‚å…ˆè¢«Cloudflareä»£ç†å®ç°HTTPS æ¥æ”¶åˆ°ç„¶åå°†å…¶è½¬å‘ç»™åŸå§‹çš„æœåŠ¡å™¨ï¼ˆå¦‚ Github Pages æœåŠ¡å™¨ï¼‰ã€‚è™½ç„¶æµè§ˆå™¨ä¸Cloudflareä¹‹é—´çš„é€šä¿¡æ˜¯HTTPSåŠ å¯†ï¼Œä½†æ˜¯Cloudflareä¸å®é™…æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ä¸ä¸€å®šæ˜¯åŠ å¯†çš„ï¼Œå­˜åœ¨è¢«æŒŸæŒå’Œç¯¡æ”¹çš„å¯èƒ½ã€‚Cloudflareä¹‹å‰ä¹Ÿè¢«çˆ†å‡ºè¿‡ å®‰å…¨æ¼æ´å’Œæ•æ„Ÿæ•°æ®æ³„éœ²ï¼Œæ•…å•†ä¸šç½‘ç«™é€šå¸¸ä¸ç”¨Cloudflareå…è´¹è®¡åˆ’ï¼Œä½†ä¸ªäººåšå®¢å‡ºäºå¢åŠ æœç´¢å¼•æ“æ”¶å½•å’Œçœé’±ç­‰åŸå› ï¼Œå¯ä»¥ä½¿ç”¨Cloudflareå…è´¹è®¡åˆ’ã€‚\n ç”±äºç»è¿‡Cloudflareè¿™å±‚ä»£ç ï¼Œè®¿é—®é€Ÿåº¦è‚¯å®šæ²¡æœ‰ç›´æ¥è®¿é—®åŸå§‹æœåŠ¡å™¨é‚£ä¹ˆå¿«ï¼Œå¯¹äºå“åº”é€Ÿåº¦è¦æ±‚é«˜çš„ç”¨æˆ·ä¸åˆé€‚ã€‚ ç”±äºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œåœ¨å¤©æœCloudflareè®¿é—®é€Ÿåº¦æ¯”å›½å†…æ…¢ï¼Œè€Œä¸”æŒ‡ä¸å®šå“ªå¤©å°±è¢«banäº†ã€‚  åˆ©ç”¨Github PageåŸç”ŸHTTPS Githubä»2018å¹´5æœˆä»½å¼€å§‹æ”¯æŒè‡ªå®šä¹‰åŸŸåä½¿ç”¨HTTPS1ï¼Œå…·ä½“æ“ä½œè¯´æ˜è¯·å‚è§securing-your-github-pages-site-with-httpsï¼Œé€šè¿‡æ­¤ç§æ–¹å¼å¯ä»¥ç»•è¿‡Cloudflareä½œä¸ºä¸­é—´å±‚çš„é—®é¢˜ï¼Œä½†æ˜¯ä»ç„¶æ— æ³•è§£å†³ç”±äºqiangå­˜åœ¨å¯¼è‡´çš„è®¿é—®ç¼“æ…¢çš„é—®é¢˜ã€‚\nç”±äºè‡ªå·±ä¹‹å‰é‡‡ç”¨çš„æ˜¯Cloudflareï¼ŒæŒ‰ç…§Githubçš„å®˜æ–¹æ–‡æ¡£è¿›è¡Œæ“ä½œæ—¶ï¼Œåœ¨è¿›è¡ŒDNSæ£€æŸ¥æ—¶ä¸€å¼€å§‹ä¼šæç¤ºå¦‚ä¸‹ä¿¡æ¯\nåˆ©ç”¨digå‘½ä»¤æ£€æŸ¥åç»“æœå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  [root@vm-16-6-centos ~]# dig +noall +answer lucumt.info lucumt.info. 60 IN A 185.199.110.153 lucumt.info. 60 IN A 185.199.111.153 lucumt.info. 60 IN A 185.199.108.153 lucumt.info. 60 IN A 185.199.109.153 [root@vm-16-6-centos ~]# dig www.lucumt.info +nostats +nocomments +nocmd ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.9 \u0026lt;\u0026lt;\u0026gt;\u0026gt; www.lucumt.info +nostats +nocomments +nocmd ;; global options: +cmd ;www.lucumt.info. IN A www.lucumt.info. 2280 IN CNAME lucumt.github.io. lucumt.github.io. 2280 IN A 185.199.109.153 lucumt.github.io. 2280 IN A 185.199.111.153 lucumt.github.io. 2280 IN A 185.199.110.153 lucumt.github.io. 2280 IN A 185.199.108.153 [root@vm-16-6-centos ~]#   å‘ç°å·²ç»åˆ‡æ¢è¿‡æ¥ï¼Œå¹¶ä¸”é€šè¿‡æµè§ˆå™¨ä¹Ÿèƒ½ä»¥HTTPSçš„æ–¹å¼æ­£å¸¸è®¿é—®ï¼Œå°±æ˜¯DNSæ£€æŸ¥ç»“æœä¸€ç›´å¤±è´¥ï¼Œè™½ç„¶ä¸å½±å“ä½¿ç”¨ï¼Œä½†å¯¹äºä¸€ä¸ªæœ‰å¼ºè¿«ç—‡çš„äººæ¥è¯´é¡µé¢ä¸Šæœ‰ä¸€é¡¹æ£€æŸ¥å¤±è´¥è¿˜æ˜¯å¾ˆéš¾å—çš„ã€‚\nç»™Githubå®˜æ–¹å‘é€Support Requeståå¾ˆå¿«æ”¶åˆ°äº†å›å¤2ï¼ŒåŸå› ä¸ºCloudflareçš„ç¼“å­˜è¿˜æ²¡æœ‰æ¸…é™¤å¹²å‡€ï¼Œç­‰å¾…2-3åå³å¯æ¢å¤æ­£å¸¸ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  $ dig NS lucumt.info ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.10.3-P4-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; NS lucumt.info ;; global options: +cmd ;; Got answer: ;; -\u0026gt;\u0026gt;HEADER\u0026lt;\u0026lt;- opcode: QUERY, status: NOERROR, id: 9195 ;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 4096 ;; QUESTION SECTION: ;lucumt.info. IN NS ;; ANSWER SECTION: lucumt.info. 23305 IN NS anirban.ns.cloudflare.com. lucumt.info. 23305 IN NS angela.ns.cloudflare.com. ;; Query time: 0 msec ;; SERVER: 10.127.5.10#53(10.127.5.10) ;; WHEN: Thu Jan 19 18:28:08 PST 2023 ;; MSG SIZE rcvd: 100   æ ¹æ®å®˜æ–¹äººå‘˜çš„åé¦ˆç­‰å¾…2-3å¤©åå†æ¬¡æ£€æŸ¥ï¼Œå‘ç°DNSæ£€æŸ¥é€šè¿‡!\nå‚è€ƒ:\n https://bakumon.me/blog/p/github-pages-https-ssl.html https://help.github.com/articles/securing-your-github-pages-site-with-https/    https://github.blog/2018-05-01-github-pages-custom-domains-https/\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n https://support.github.com/ticket/personal/0/1974028\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n  ","permalink":"http://isouthrain.github.io/post/hugo/migrate-github-blog-from-http-to-https/","tags":["Github Pages","HTTPS"],"title":"å°†åŸºäºGithub Pagesçš„è‡ªå®šä¹‰åŸŸååšå®¢è¿ç§»åˆ°HTTPS"},{"categories":["ç¼–ç¨‹æ‚æƒ³"],"contents":"å·¥ä½œä¸­æœ‰æ—¶å€™ä¼šé‡åˆ°æŸäº›å¤§æ®µå¤æ‚ä»£ç å‡ºç°Bugçš„æƒ…å†µï¼Œä¸åŒäºä¸€èˆ¬è¡Œæ•°è¾ƒå°æˆ–é€»è¾‘è¾ƒç®€å•çš„ä»£ç ï¼Œå¯¹äºå¤§æ®µå¤æ‚çš„ä»£ç è¿›è¡Œåˆ†æå¯èƒ½ä¼šå¾ˆè€—æ—¶ï¼Œæœ¬æ–‡ä»‹ç»å‡ ç§ä¸ªäººåœ¨å·¥ä½œä¸­ç”¨åˆ°çš„æ–¹æ³•ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚\nå°†Logçº§åˆ«å¼€å¯åˆ°Debug å°†Logçš„çº§åˆ«å˜ä¸ºDebugåï¼Œä¼šæ¯”INFOçŠ¶æ€ä¸‹çœ‹åˆ°æ›´å¤šçš„è¯¦ç»†æ—¥å¿—ä¿¡æ¯ï¼Œä»”ç»†åˆ†æè¿™äº›è¾“å‡ºä¿¡æ¯ï¼Œæœ‰æ—¶å€™å¯ä»¥å‘ç°æ˜¯å“ªä¸€æ­¥ä¸èƒ½æŒ‰ç…§é¢„æœŸå·¥ä½œï¼Œæ®æ­¤ç¼©å°æŸ¥æ‰¾èŒƒå›´ï¼Œä»è€Œè§£å†³ç¼ºé™·ã€‚\nå®é™…ä½¿ç”¨ä¸­ç”±äºDebugçº§åˆ«çš„logè¾“å‡ºä¿¡æ¯åºå¤§ï¼ŒæŸ¥çœ‹è¾“å‡ºlogå¾ˆè€—æ—¶ï¼Œåœ¨å®é™…å¼€å‘ä¸­ç”¨å¾—ä¸å¤šï¼Œå¸¸ç”¨çš„åœºæ™¯å¦‚ä¸‹ï¼š\n çŸ¥é“å¤§è‡´çš„ä»£ç èŒƒå›´ï¼Œé€šè¿‡è§‚å¯Ÿlogè¾“å‡ºæ¥ç¡®å®šå…·ä½“çš„åŸå›  å‹æ ¹ä¸çŸ¥é“é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Œé€šè¿‡è§‚å¯Ÿlogè¾“å‡ºæ¥è·å–æœ‰ç”¨ä¿¡æ¯ï¼Œè¾…åŠ©ä»¥å…¶å®ƒæ‰‹æ®µæ¥åˆ†æ å¤šçº¿ç¨‹ç­‰æ— æ³•åˆ©ç”¨Debugè°ƒè¯•çš„ç¯å¢ƒ  åˆ©ç”¨IDEè¿›è¡ŒDebug åœ¨IDEä¸­å¼€å¯Debugæ¨¡å¼è¿›è¡Œè°ƒè¯•æ˜¯å¼€å‘è¿‡ç¨‹ä¸­æœ€å¸¸ç”¨çš„ä¸€ç§æ‰‹æ®µï¼Œé€šè¿‡Debugè°ƒè¯•å¯ä»¥æ‰¾å‡ºå“ªäº›ä»£ç è¢«æ‰§è¡Œï¼Œå“ªäº›æ²¡æœ‰è¢«æ‰§è¡Œï¼Œä»¥åŠåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ç›¸å…³å˜é‡çš„å€¼ã€‚Debugè°ƒè¯•åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½å¯ä»¥å¸®æˆ‘ä»¬æ‰¾å‡ºç¼ºé™·ï¼Œä½†åœ¨å¤šçº¿ç¨‹åº”ç”¨ã€ HTMLé¡µé¢æ ·å¼è°ƒè¯•ç­‰åœºæ™¯ä¸‹å¹¶ä¸é€‚ç”¨Debugæ–¹å¼ã€‚\nåœ¨ä»£ç ä»“åº“ä¸­è¿›è¡Œç‰ˆæœ¬å›æº¯ è‹¥å·²çŸ¥å‡ºé—®é¢˜çš„ä»£ç åœ¨ä»¥å‰æ²¡æœ‰é—®é¢˜ï¼Œåªæ˜¯æœ€è¿‘çš„æ›´æ”¹æ‰å‡ºç°é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä»ä»£ç ä»“åº“ä¸­æ‰¾å‡ºå†å²ç‰ˆæœ¬ä¸ç›®å‰çš„ç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”ï¼Œçœ‹çœ‹æœ‰å“ªäº›å·®å¼‚ï¼Œé€šå¸¸é—®é¢˜éƒ½å‘ç”Ÿåœ¨è¿™äº›æœ‰å·®å¼‚çš„åœ°æ–¹ã€‚\nä¸å…¶å®ƒæ–¹å¼ç›¸æ¯”æ­¤ç§æ–¹æ³•è€—æ—¶æœ€å°‘ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ‰¾å‡ºçš„bugä¸€èˆ¬éƒ½æ˜¯æŸäº›å…³é”®é…ç½®å†™é”™äº†æˆ–ä»£ç è¯­æ³•ä¸æ­£ç¡®æ—¶æ§åˆ¶å°æ²¡æœ‰è¾“å‡ºå®Œæ•´çš„é”™è¯¯ä¿¡æ¯ï¼Œå¦‚åœ¨Ajaxæ–¹æ³•ä¸­åœ¨æŸäº›é…ç½®é¡¹åé¢å°‘å†™äº†ä¸€ä¸ª ,æ—¶ï¼Œåœ¨æŸäº›æµè§ˆå™¨ä¸­è¿›è¡Œè°ƒè¯•æ—¶åªä¼šå‡ºç° Uncaught SyntaxError: Unexpected identifier è¿™ç§é”™è¯¯æ¶ˆæ¯ï¼Œæ— æ³•æ ¹æ®é”™è¯¯ä¿¡æ¯å…·ä½“å®šä½åˆ°å“ªä¸€è¡Œä»£ç å‡ºé”™ã€‚\né€šè¿‡äºŒåˆ†æŸ¥æ‰¾å®šä½ æˆ‘æœ€å–œæ¬¢ç”¨çš„æ–¹æ³•ä¹‹ä¸€ï¼ŒäºŒåˆ†æŸ¥æ‰¾å®šä½çš„æ“ä½œå’ŒäºŒåˆ†æŸ¥æ‰¾ç®—æ³•ç±»ä¼¼ï¼Œå…ˆå°†ä¸€éƒ¨ä»£ç æ³¨æ„æ‰æˆ–æ’å…¥è¯•æ¢æ€§ä»£ç ï¼Œç¡®å®šé—®é¢˜æ˜¯åœ¨è¿™ä¸€è¾¹æˆ–é‚£ä¸€è¾¹ï¼Œç¡®å®šå®Œå¤§è‡´çš„åŒºåŸŸåï¼Œå¯¹è¯¥é—®é¢˜åŒºåŸŸå†æ¬¡é‡‡ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥å®šä½ï¼Œç›´åˆ°æ‰¾åˆ°é—®é¢˜åŸå› ä¸ºæ­¢ã€‚æ­¤ç§æ–¹æ³•å’ŒäºŒåˆ†æŸ¥æ‰¾ç®—æ³•ä¸€æ ·è€—æ—¶è¾ƒå°‘ã€‚ æ­¤æ–¹æ³•å¸¸ç”¨çš„åœºæ™¯å¦‚ä¸‹ï¼š\n ä¸æ–¹ä¾¿åˆ©ç”¨Debugæ—¥å¿—æˆ–Debugè°ƒè¯•çš„åœ°æ–¹ HTML ã€JSPç­‰Viewå±‚çš„ä»£ç  åˆšä¸Šæ‰‹æŸé¡¹æŠ€æœ¯ï¼Œå¯¹å…¶åŸç†äº†è§£ä¸æ·±å…¥  é‡æ–°ç¼–å†™ä»£ç å®ç° è‹¥å‰é¢å‡ ç§æ–¹æ³•å‡ä¸èƒ½å‡‘æ•ˆï¼Œå¯ä»¥é‡‡å–ç»ˆæå¤§æ³•ï¼š é‡æ–°ç¼–ç å®ç°ï¼ ï¼Œä¸è¯†åºå±±çœŸé¢ç›®ï¼Œåªç¼˜èº«åœ¨æ­¤å±±ä¸­ ï¼Œæœ‰äº›ä»£ç çš„å®ç°é€»è¾‘æœ¬èº«å°±æœ‰é—®é¢˜ï¼Œè‹¥ç›´æ¥å¯¹å…¶è¿›è¡ŒDebugè°ƒè¯•æˆ–åˆ†æï¼Œå¯èƒ½ä¼šé™·å…¥è¯¥ä»£ç é”™è¯¯çš„é™·é˜±ä¸­ã€‚å¦‚æˆ‘ä»¬å¯èƒ½è®¤ä¸ºæŸæ®µä»£ç ä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œç„¶ååŸºäºè¯¥ä»£ç è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†æè°ƒè¯•ï¼Œå´æ— è®ºå¦‚ä½•éƒ½å¾—ä¸åˆ°è‡ªå·±æƒ³è¦çš„ç»“æœï¼Œé—®é¢˜çš„åŸå› å°±åœ¨äºè¯¥æ®µä»£ç æœ¬èº«å°±æ˜¯é”™è¯¯çš„ã€‚èµ·å§‹ç‚¹é€‰é”™äº†ï¼Œæ— è®ºåé¢æ€ä¹ˆåšï¼Œéƒ½æ— æµäºäº‹ã€‚\næ ¹æ®åŸå§‹çš„éœ€æ±‚ï¼Œåœ¨ä¸å‚ç…§ç°æœ‰ä»£ç å®ç°æ–¹å¼çš„åŸºç¡€ä¸Šï¼Œä»¥ç™½æ¿çš„æ–¹å¼é‡æ–°ç¼–ç¨‹å®ç°åŠŸèƒ½ï¼Œåœ¨å¯¹æ¯”æ—§çš„ä»£ç ï¼Œå°±èƒ½å‘ç°é—®é¢˜äº§ç”Ÿçš„åŸå› ã€‚è‹¥è¿™ç§æ–¹å¼è¿˜ä¸èƒ½å‡‘æ•ˆï¼Œå¯ä»¥è®©å…¶ä»–åŒäº‹ååŠ©å®¡æŸ¥è‡ªå·±çš„ä»£ç ï¼Œæˆ–è€…å®¡æ ¸åŸæœ‰çš„éœ€æ±‚æœ¬èº«æ˜¯å¦æœ‰é—®é¢˜ï¼Œé€šå¸¸è¿™ç§æƒ…å½¢æ„å‘³ç€æˆ‘ä»¬çš„ä»£ç å¿…é¡»è¦é‡æ„ã€‚\næ€»ç»“ å¥½çš„ä»£ç ä¼šè‡ªå·±è¯´è¯ï¼Œå¹³æ—¶ç¼–ç æ—¶è¦æ³¨æ„ç»†èŠ‚ã€ç¬¦åˆè§„èŒƒï¼Œå¿…è¦æ—¶å¯¹ä»£ç è¿›è¡Œé‡æ„ï¼Œå°†å¤æ‚çš„ä»£ç è¿›è¡ŒæŠ½å–ç®€åŒ–ã€‚ä»£ç é‡æ„è™½ç„¶å¯¹æˆ‘ä»¬çš„å·¥ä½œäº§å‡ºä¸ä¼šæœ‰ç«‹ç«¿è§å½±çš„æ•ˆæœï¼Œä½†ä¹Ÿç»ä¸æ˜¯ç™½ç™½æµªè´¹æˆ‘ä»¬çš„æ—¶é—´ï¼Œä¸æ–­é‡æ„åçš„å®ç°è‰¯å¥½çš„ä»£ç ï¼Œä¸ä»…æœ‰åˆ©äºè°ƒè¯•åˆ†æï¼Œä¹Ÿæœ‰åˆ©äºä»–äººé¡ºåˆ©æ¥æ‰‹ã€‚\nåœ¨ä¸€äº›æˆç«‹æ—¶é—´è¾ƒé•¿çš„å…¬å¸æˆ–å¤šæˆ–å°‘éƒ½ä¼šå­˜åœ¨ä¸€äº›ç‚¸å¼¹ä»£ç ï¼Œæ­¤å¤„è¯´çš„ç‚¸å¼¹ä»£ç æ˜¯æŒ‡é‚£äº›åŠŸèƒ½å¾ˆé‡è¦å®ç°åˆå¾ˆå¤æ‚çš„ä»£ç ï¼Œæœ€å¼€å§‹å¼€å‘è¯¥åŠŸèƒ½çš„äººç¦»èŒåï¼Œåé¢æ¥æ‰‹çš„äººçœ‹ä¸æ‡‚è¯¥ä»£ç ï¼Œç”±äºå„ç§åŸå› æ— æ³•å¯¹å…¶è¿›è¡Œé‡æ„ï¼Œåœ¨åç»­å¼€å‘æ—¶ï¼Œåªèƒ½ä¸æ–­çš„åœ¨å…¶åé¢æ·»åŠ æ–°çš„ä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸æ•¢ä¿®æ”¹å·²æœ‰çš„ï¼Œå¯¼è‡´ä»£ç é‡è¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œè¶Šè‡ƒè‚¿å°±è¶Šçœ‹ä¸æ‡‚ï¼Œé™·å…¥æ¶æ€§å¾ªç¯ã€‚è¿™æ ·çš„ä»£ç åœ¨åç»­æ¯æ¬¡è°ƒè¯•åˆ†ææ—¶éƒ½æ˜¯å¤§å‘ï¼Œè€Œå¦‚æœä¸€å¼€å§‹å°±è¿›è¡Œé€‚å½“çš„é‡æ„ï¼Œæˆ–è®¸ä¸ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚\nOrz~ æˆ‘æ‰¿è®¤ç‚¸å¼¹ä»£ç  è¿™ä¸ªè¯æ˜¯æˆ‘è‡ªå·±å‘æ˜çš„ï¼\n","permalink":"http://isouthrain.github.io/post/other/different-ways-find-bug-in-complex-code/","tags":null,"title":"ä»å¤æ‚ä»£ç ä¸­æ‰¾å‡ºBugçš„å‡ ç§æ–¹æ³•"},{"categories":["Javaç¼–ç¨‹","MyBatisç³»åˆ—"],"contents":"é¡¹ç›®ä¸­ORMæ¡†æ¶ç”¨çš„æ˜¯ MyBatisï¼Œæœ€è¿‘ç”±äºä¸šåŠ¡ä¸Šçš„éœ€æ±‚å°†MyBatisä»3.1.1å‡çº§åˆ°3.4.5ï¼Œå‘ç°å‡çº§åé€šè¿‡Log4jæ˜¾ç¤ºSQLçš„é…ç½®æ–¹å¼å‘ç”Ÿäº†å˜åŒ–ï¼Œç”±äºå˜åŒ–è¾ƒå¤§ï¼Œæ•…å…ˆè®°å½•ä¸‹ã€‚\nå‡è®¾æˆ‘ä»¬æµ‹è¯•çš„sqlæ–‡ä»¶ä¸ºUserMapper.xml ï¼Œ å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼Œå…¶å‘½åç©ºé—´ä¸ºcom.lucumt.mapper.UserMappper\n1 2 3 4 5 6 7 8  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; ?\u0026gt; \u0026lt;!DOCTYPE mapper PUBLIC \u0026#34;-//mybatis.org//DTD Mapper 3.0//EN\u0026#34; \u0026#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd\u0026#34;\u0026gt; \u0026lt;mapper namespace=\u0026#34;com.lucumt.mapper.UserMappper\u0026#34;\u0026gt; \u0026lt;select id=\u0026#34;getUsers\u0026#34; parameterType=\u0026#34;String\u0026#34; resultType=\u0026#34;com.lucumt.model.UserModel\u0026#34;\u0026gt; SELECT id,username,password,create_time AS createTime FROM system_users WHERE username!=#{username} \u0026lt;/select\u0026gt; \u0026lt;/mapper\u0026gt;   å¯¹åº”çš„æ‰§è¡Œä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13  @Test public void testMybatis(){ String resource = \u0026#34;mybatis-config.xml\u0026#34;; InputStream is = AppTest.class.getClassLoader().getResourceAsStream(resource); SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(is); SqlSession session = sessionFactory.openSession(); String statement = \u0026#34;com.lucumt.mapper.UserMappper.getUsers\u0026#34;; List\u0026lt;UserModel\u0026gt; userList = session.selectList(statement, \u0026#34;admin\u0026#34;); for(UserModel u:userList){ System.out.println(u.toString()); } }   æœ¬æ–‡ä¼šåŸºäºä¸Šè¿°ä»£ç è¯´æ˜ä¸åŒç‰ˆæœ¬ä¸‹å¦‚ä½•åˆ©ç”¨Log4jåœ¨MyBatisä¸­é…ç½®æ‰“å°æ—¥å¿—ä»¥åŠå…¶å®ç°åŸç†ã€‚\nMyBatis3.1.1åˆ†æ Log4jç›¸å…³é…ç½® åœ¨MyBatis3.1.1åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­è‹¥æˆ‘ä»¬æƒ³é€šè¿‡Log4jé…ç½®æ¥æ‰“å°å®é™…æ‰§è¡Œçš„SQLï¼Œlog4j.propertiesçš„é…ç½®é€šå¸¸ç±»ä¼¼å¦‚ä¸‹\n1 2 3 4 5  # åœ¨ä¸å¼€å¯log4j DEBUGæ¨¡å¼ä¸‹æ˜¾ç¤ºmybatisä¸­è¿è¡Œçš„SQLè¯­å¥ log4j.logger.java.sql.Connection=DEBUG log4j.logger.java.sql.Statement=DEBUG log4j.logger.java.sql.PreparedStatement=DEBUG log4j.logger.java.sql.ResultSet=DEBUG   åŸç†åˆ†æ ä»¥log4j.logger.java.sql.Connection=DEBUGè¿™ä¸ªé…ç½®ä¸ºä¾‹ï¼Œåˆ†ææºç å¯çŸ¥å…¶sqlæ—¥å¿—æ¥æºäºConnectionLoggerï¼ŒæŸ¥çœ‹ ConnectionLoggerçš„ä»£ç å¯çŸ¥ConnectionLoggerä»¥ç¡¬ç¼–ç çš„æ–¹å¼ç”Ÿæˆäº†ä¸€ä¸ªlogå¯¹è±¡,å½“DEBUGæ¨¡å¼å¼€å¯æ—¶è¯¥logå¯¹è±¡ä¼šæ‰“å°sqlè¯­å¥ç­‰ä¿¡æ¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  public final class ConnectionLogger extends BaseJdbcLogger implements InvocationHandler { //ç”Ÿæˆä¸€ä¸ªConnectionçš„log  private static final Log log = LogFactory.getLog(Connection.class); private Connection connection; private ConnectionLogger(Connection conn, Log statementLog) { super(statementLog); this.connection = conn; if (isDebugEnabled()) { debug(\u0026#34;ooo Using Connection [\u0026#34; + conn + \u0026#34;]\u0026#34;); } } public Object invoke(Object proxy, Method method, Object[] params) throws Throwable { try { if (\u0026#34;prepareStatement\u0026#34;.equals(method.getName())) { if (isDebugEnabled()) {//æ‰“å°æ‰§è¡Œçš„SQLè¯­å¥  debug(\u0026#34;==\u0026gt; Preparing: \u0026#34; + removeBreakingWhitespace((String) params[0])); } PreparedStatement stmt = (PreparedStatement) method.invoke(connection, params); stmt = PreparedStatementLogger.newInstance(stmt, getStatementLog()); return stmt; } //... other code  } catch (Throwable t) { throw ExceptionUtil.unwrapThrowable(t); } } //... other code  }   è¿è¡Œç»“æœå¦‚ä¸‹\nä»ä¸Šè¿°ä»£ç å¯çŸ¥åœ¨Mybatis3.1.1ä¸­é€šè¿‡Log4jå®ç°æ‰“å°æ‰§è¡ŒSQLçš„æ“ä½œå¾ˆç®€å•ï¼Œå®ç°åŸç†ä¹Ÿæ˜“æ‡‚ï¼Œä½†å…¶å­˜åœ¨çš„ä¸€ä¸ªç¼ºç‚¹: å½“å¼€å¯æ‰“å°SQLæ—¥å¿—åï¼Œä¼šæ‰“å°æ‰€æœ‰æ­£åœ¨æ‰§è¡Œçš„SQLè¯­å¥ï¼Œä¸èƒ½å®ç°é’ˆå¯¹ç‰¹å®šSQLçš„æ‰“å° ï¼ŒåŸºäºæ­¤MyBatisä»3.2.0ç‰ˆæœ¬ä¹‹åé‡æ–°å®ç°äº†ç›¸å…³åŠŸèƒ½ã€‚\nMyBatis3.4.5åˆ†æ Log4jç›¸å…³é…ç½® åœ¨MyBatis3.2.0åŠä»¥åçš„ç‰ˆæœ¬ä¸­è‹¥æˆ‘ä»¬æƒ³é€šè¿‡Log4jé…ç½®æ¥æ‰“å°å®é™…æ‰§è¡Œçš„SQLï¼Œlog4j.propertiesçš„é…ç½®é€šå¸¸ç±»ä¼¼å¦‚ä¸‹\n1 2  # åœ¨ä¸å¼€å¯log4j DEBUGæ¨¡å¼ä¸‹æ˜¾ç¤ºmybatisä¸­è¿è¡Œçš„SQLè¯­å¥ log4j.logger.com.lucumt.mapper=DEBUG   åœ¨æœ¬æ–‡å†™ä½œæ—¶ï¼Œmybatiså®˜ç½‘ä¸Šå·²æœ‰å…³äºè¿™æ–¹é¢æ›´ è¯¦ç»†çš„è¯´æ˜ ã€‚\nåŸç†åˆ†æ åŒæ ·ä»¥log4j.logger.java.sql.Connection=DEBUGä¸ºä¾‹ï¼Œå…¶sqlæ—¥å¿—æ¥æºäºConnectionLoggerï¼Œå¯¹åº”ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  public final class ConnectionLogger extends BaseJdbcLogger implements InvocationHandler { private final Connection connection; //é€šè¿‡æ³¨å…¥çš„æ–¹å¼ç”Ÿæˆlogå¯¹è±¡  private ConnectionLogger(Connection conn, Log statementLog, int queryStack) { super(statementLog, queryStack); this.connection = conn; } @Override public Object invoke(Object proxy, Method method, Object[] params) throws Throwable { try { if (Object.class.equals(method.getDeclaringClass())) { return method.invoke(this, params); } if (\u0026#34;prepareStatement\u0026#34;.equals(method.getName())) { if (isDebugEnabled()) { debug(\u0026#34; Preparing: \u0026#34; + removeBreakingWhitespace((String) params[0]), true); } } //... other code  } catch (Throwable t) { throw ExceptionUtil.unwrapThrowable(t); } } //... other code  }   ä»ä¸Šè¿°ä»£ç å¯çŸ¥ï¼Œå…¶æ—¥å¿—ç”Ÿæˆæ˜¯è°ƒç”¨BaseJdbcLoggerçš„æ„é€ æ–¹æ³•ç”Ÿæˆçš„ï¼ŒBaseJdbcLogger ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  public abstract class BaseJdbcLogger { protected Log statementLog; protected int queryStack; public BaseJdbcLogger(Log log, int queryStack) { this.statementLog = log; if (queryStack == 0) { this.queryStack = 1; } else { this.queryStack = queryStack; } } //... other code }   DEBUGæ¨¡å¼ä¸‹æŸ¥çœ‹ConnectionLoggerçš„è°ƒç”¨å †æ ˆå¦‚ä¸‹\nä»å…¶è°ƒç”¨å †æ ˆå¯çŸ¥logå¯¹è±¡æ˜¯é€šè¿‡MappedStatementç”Ÿæˆçš„ï¼Œå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  public class SimpleExecutor extends BaseExecutor { //... other code  @Override public \u0026lt;E\u0026gt; List\u0026lt;E\u0026gt; doQuery(MappedStatement ms,Object parameter, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql) throws SQLException { Statement stmt = null; try { Configuration configuration = ms.getConfiguration(); StatementHandler handler = configuration.newStatementHandler(wrapper, ms, parameter, rowBounds, resultHandler, boundSql); //logå¯¹è±¡é€šè¿‡MappedStatementç”Ÿæˆ  stmt = prepareStatement(handler, ms.getStatementLog()); return handler.\u0026lt;E\u0026gt;query(stmt, resultHandler); } finally { closeStatement(stmt); } } }   æŸ¥çœ‹MappedStatementçš„æºç ï¼Œå‘ç°logçš„ç”Ÿæˆæ˜¯åœ¨Builderæ–¹æ³•ä¸­ï¼Œå¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  public final class MappedStatement { public static class Builder { private MappedStatement mappedStatement = new MappedStatement(); public Builder(Configuration configuration, String id, SqlSource sqlSource, SqlCommandType sqlCommandType) { mappedStatement.configuration = configuration; mappedStatement.id = id; mappedStatement.sqlSource = sqlSource; mappedStatement.statementType = StatementType.PREPARED; mappedStatement.parameterMap = new ParameterMap.Builder(configuration, \u0026#34;defaultParameterMap\u0026#34;, null, new ArrayList\u0026lt;ParameterMapping\u0026gt;()).build(); mappedStatement.resultMaps = new ArrayList\u0026lt;ResultMap\u0026gt;(); mappedStatement.sqlCommandType = sqlCommandType; mappedStatement.keyGenerator = configuration.isUseGeneratedKeys() \u0026amp;\u0026amp; SqlCommandType.INSERT.equals(sqlCommandType) ? Jdbc3KeyGenerator.INSTANCE : NoKeyGenerator.INSTANCE; String logId = id; //å¯ä»¥é€šè¿‡è®¾ç½®logPrefixçš„æ–¹æ³•æ¥ç”Ÿæˆlogå¯¹è±¡  if (configuration.getLogPrefix() != null) { logId = configuration.getLogPrefix() + id; } //é€šè¿‡logIdç”Ÿæˆlogå¯¹è±¡  mappedStatement.statementLog = LogFactory.getLog(logId); mappedStatement.lang = configuration.getDefaultScriptingLanguageInstance(); } }   é€šè¿‡ä¸Šé¢çš„ä»£ç å¯çŸ¥logå¯¹è±¡æ˜¯ç”±logIdç”Ÿæˆçš„ï¼Œè¿›ä¸€æ­¥debugå‘ç°logIdæ˜¯ç”± namespace+æ–¹æ³•id ç»„æˆï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºcom.lucumt.mapper.UserMappper.getUsersï¼Œè€Œå‰é¢çš„é…ç½®ä¸ºlog4j.logger.com.lucumt.mapper=DEBUG ï¼Œç”±äºLog4jä¸­çš„logç¤ºä¾‹çš„ç»§æ‰¿å…³ç³»ï¼Œç›¸å½“äºcom.lucumt.mapper.UserMappper.getUserä¹Ÿå¼€å¯äº†DEBUGæ¨¡å¼ï¼Œæ•…åœ¨å®é™…æ‰§è¡Œæ—¶å¯ä»¥æ˜¾ç¤ºæ‰“å°SQLè¯­å¥ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹\nåˆ©ç”¨æ–°ç‰ˆMyBatisçš„è¿™ä¸€ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ç±»ä¼¼å¦‚ä¸‹çš„ä¸åŒç²’åº¦sqlæ‰“å°\n1 2 3  log4j.logger.com.xxx.mapper=DEBUG #æ‰“å°xxxåŒ…ä¸‹æ‰€æœ‰çš„æ‰§è¡ŒSQL log4j.logger.com.yyy.mapper.PersonMapper=DEBUG #æ‰“å°PersonMapperä¸‹æ‰€æœ‰çš„æ‰§è¡ŒSQL log4j.logger.com.zzz.mapper.GroupMapper.getGroups=DEBUG #åªæ‰“å°getGroupså¯¹åº”çš„æ‰§è¡ŒSQL   ç”±å‰é¢çš„ä»£ç å¯çŸ¥MappedStatementçš„Buildæ–¹æ³•åœ¨ç”Ÿæˆlogå¯¹è±¡æ—¶ä¼šæ£€æµ‹æ˜¯å¦æœ‰logPrefixé…ç½®ï¼Œè‹¥æœ‰åˆ™ç”¨logPrefixæ¥ç”Ÿæˆlogå¯¹è±¡ï¼Œäºæ˜¯å¯ä»¥é€šè¿‡è®¾ç½®logPrefixä»¥å¦å¤–ä¸€ç§æ–¹å¼é…ç½®æ‰“å°sqlã€‚ å¯åœ¨MyBatisé…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®\n1 2 3 4  \u0026lt;settings\u0026gt; \u0026lt;setting name=\u0026#34;logPrefix\u0026#34; value=\u0026#34;dao.\u0026#34;/\u0026gt; \u0026lt;!-- è®¾ç½®å‰ç¼€ä¸ºdao --\u0026gt; \u0026lt;setting name=\u0026#34;logImpl\u0026#34; value=\u0026#34;log4j\u0026#34;/\u0026gt; \u0026lt;!-- è®¾ç½®ä½¿ç”¨log4jä¸ºæ—¥å¿—å®ç°ç±» --\u0026gt; \u0026lt;/settings\u0026gt;   ç„¶åå°† log4j.propertiesçš„é…ç½®ä¿®æ”¹ä¸º\n1  log4j.logger.dao=DEBUG   æ‰§è¡Œç»“æœä¸å‰é¢ç›¸åŒï¼Œé€šè¿‡ logPrefixå¯ä»¥åœ¨æœ‰äº›æ—¶å€™ç®€åŒ–sqlæ‰“å°é…ç½®ã€‚\nå¾…åˆ†æé—®é¢˜ è‹¥å°†MyBatisçš„ç‰ˆæœ¬å˜3.3.0æ—¶ï¼Œé€šè¿‡Log4jé…ç½®æ‰“å°SQLæ—¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºçš„é…ç½®æ–¹å¼åªæœ‰éƒ¨åˆ†ç”Ÿæ•ˆï¼ŒåŸå› å¾…åˆ†æ\n1 2 3 4  log4j.logger.com.xxx=DEBUG #å¯ä»¥æ‰“å°SQL log4j.logger.com.xxx.mapper=DEBUG #å¯ä»¥æ‰“å°SQL log4j.logger.com.xxx.mapper.UserMapper=DEBUG #ä¸èƒ½æ‰“å°SQL log4j.logger.com.xxx.mapper.UserMapper.getUsers=DEBUG #ä¸èƒ½æ‰“å°SQL   ","permalink":"http://isouthrain.github.io/post/mybatis/print-sql-in-different-mybatis-version/","tags":["Java","MyBatis"],"title":"åœ¨ä¸åŒç‰ˆæœ¬çš„MyBatisä¸­é€šè¿‡Log4jæ‰“å°å®é™…æ‰§è¡Œçš„SQL"},{"categories":["Javaç¼–ç¨‹"],"contents":"Javaç¨‹åºå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯Javaæ–‡ä»¶ç¼–è¯‘åçš„Classæ–‡ä»¶ï¼Œè¿™æ˜¯ä»»ä½•ä¸€ä¸ªJavaå¼€å‘äººå‘˜éƒ½äº†è§£çš„åŸºæœ¬çŸ¥è¯†ã€‚è‹¥Javaç¨‹åºæ‰§è¡Œçš„ç»“æœä¸ç¬¦åˆè¦æ±‚ï¼Œé€šå¸¸çš„è§£å†³æ–¹æ³•æ˜¯å…ˆä¿®æ”¹Javaæ–‡ä»¶ï¼Œé‡æ–°ç¼–è¯‘æˆClassæ–‡ä»¶åå†æ¬¡æ‰§è¡Œã€‚ä½†æœ‰æ—¶å€™æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä¿®æ”¹Javaæ–‡ä»¶ï¼ˆå¦‚åªæœ‰åŒ…å«classæ–‡ä»¶çš„jaråŒ…ï¼‰ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±åªèƒ½ç›´æ¥ä¿®æ”¹Classæ–‡ä»¶ï¼Œæœ¬æ–‡å°†å±•ç¤ºåœ¨åŸºäºä¸åŒçš„éœ€æ±‚é€šè¿‡å¯è§†åŒ–å·¥å…·å’ŒJavassiståº“æ¥ç›´æ¥å¯¹Classæ–‡ä»¶è¿›è¡Œä¿®æ”¹çš„æ–¹æ³•ã€‚\næ³¨ï¼šç”±äºç›´æ¥ä¿®æ”¹classæ–‡ä»¶ä¼šæ¶‰åŠåˆ°classæ–‡ä»¶ç»“æ„çš„ç›¸å…³çŸ¥è¯†ï¼Œæ‰€ä»¥åˆ©ç”¨æ­¤ç§æ–¹å¼æ—¶æœ€å¥½å¯¹classæ–‡ä»¶ç»“æ„æœ‰ä¸€å®šçš„äº†è§£\nä¿®æ”¹Classæ–‡ä»¶ä¸­çš„å˜é‡ ä¸‹é¢çš„ä»£ç ä¸ºä¸€ä¸ªå…¸å‹çš„è¾“å‡ºHello Worldçš„Javaå°ç¨‹åº\n1 2 3 4 5 6 7 8 9 10 11 12  package com.lucumt; public class Test { public static String language = \u0026#34;Java\u0026#34;; public static void main(String[] args) { sayHello(); } public static void sayHello() { System.out.println(\u0026#34;=====Hello \u0026#34;+language+\u0026#34; World!======\u0026#34;); } }   åœ¨cmdå‘½ä»¤è¡Œä¸­è¿è¡Œè¯¥ç¨‹åºçš„ç»“æœå¦‚ä¸‹\nè‹¥æƒ³å°†è¿è¡Œç»“æœä»Hello Java Worldä¿®æ”¹ä¸ºHello Golang Chinaï¼Œé™¤äº†é€šè¿‡ä¿®æ”¹æºä»£ç é‡æ–°ç¼–è¯‘è¿è¡Œè¿™ä¸ªæ–¹æ³•ä¹‹å¤–æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨å·¥å…·ç›´æ¥ä¿®æ”¹åŸæœ‰çš„classæ–‡ä»¶æ¥å®ç°ã€‚\né¦–å…ˆä» JBEä¸‹è½½ JBE(Java Bytecode Editor),JBEæ˜¯ä¸€ä¸ªç”¨äºæµè§ˆå’Œä¿®æ”¹Java Classæ–‡ä»¶çš„å¼€æºè½¯ä»¶ï¼Œåœ¨å…¶å®˜ç½‘ä¸Šå¯ä»¥çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è¯´æ˜ä¿¡æ¯\nä¸‹è½½å®Œè¯¥è½¯ä»¶åï¼Œåœ¨è¯¥è½¯ä»¶ä¸­æ‰“å¼€æˆ‘ä»¬è¦ä¿®æ”¹çš„Classæ–‡ä»¶\né¦–å…ˆæˆ‘ä»¬éœ€è¦å°†é™æ€å˜é‡languageçš„å€¼ä»Javaä¿®æ”¹ä¸ºGolang, ç”±äºlanguageæ˜¯ä¸€ä¸ªé™æ€å˜é‡ï¼Œæ•…æˆ‘ä»¬éœ€è¦åœ¨classæ–‡ä»¶çš„clinitæ–¹æ³•ä¸­æ‰¾åˆ°è¯¥å˜é‡å¹¶ä¿®æ”¹å…¶å€¼ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå±•å¼€clinitå¹¶åˆ‡æ¢åˆ°Code Editoré¡µï¼Œå¯ä»¥çœ‹åˆ°languageçš„å€¼ä¸ºJava ï¼Œåœ¨Code Editoréƒ¨åˆ†å°†Javaä¿®æ”¹ä¸ºGolangç„¶åç‚¹å‡»Save methodå³å¯å®Œæˆé™æ€å˜é‡å€¼çš„ä¿®æ”¹ã€‚\næ¥ç€å±•å¼€sayHelloæ–¹æ³•ï¼ŒåŒæ ·åˆ‡æ¢åˆ°Code Editoré¡µï¼Œå°†Worldä¿®æ”¹ä¸ºChinaåç‚¹å‡»Save methodï¼Œè‡³æ­¤æ•´ä¸ªä¿®æ”¹æ“ä½œå®Œæˆã€‚\nåœ¨å‘½ä»¤è¡Œä¸­é‡æ–°æ‰§è¡Œè¯¥ç¨‹åºï¼Œè¾“å‡ºç»“æœä¸ºHello Golang Chinaï¼Œç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ã€‚\nä¿®æ”¹Classæ–‡ä»¶ä¸­çš„æ–¹æ³• å¯¹äºè¾ƒä¸ºç®€å•çš„ä¿®æ”¹éœ€æ±‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨JBEç­‰å·¥å…·æ¥ç›´æ¥ä¿®æ”¹ï¼Œè‹¥è¦å¯¹classæ–‡ä»¶è¿›è¡Œè¾ƒä¸ºå¤æ‚çš„ä¿®æ”¹ï¼Œå¦‚å¢åŠ æ–°æ–¹æ³•ï¼Œä¿®æ”¹å·²æœ‰æ–¹æ³•çš„å®ç°é€»è¾‘ç­‰ï¼Œå¯¹äºæ­¤ç§éœ€æ±‚è™½ç„¶ä¹Ÿå¯ä»¥ç”¨JBEå®ç°ç›®çš„ï¼Œä½†å·¥ä½œé‡å¾ˆå¤§ï¼Œå®¹æ˜“å‡ºé”™ï¼Œæ­¤æ—¶JBEå·²ç»ä¸å¤ªé€‚åˆä½¿ç”¨ï¼Œéœ€è¦å¯»æ‰¾å…¶å®ƒæ›´å¿«æ·çš„æ–¹æ³•ã€‚\nç”±äºJavaæ–‡ä»¶åç”Ÿæˆçš„classæ–‡ä»¶æ˜¯ä¸€ä¸ªåŒ…å«Javaå­—èŠ‚ç çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç¨‹åºæœ€ç»ˆæ‰§è¡Œçš„å°±æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„å­—èŠ‚ç ï¼Œæˆ‘ä»¬çš„éœ€æ±‚å¯ä»¥å½’çº³ä¸ºå¦‚ä½•ä¿®æ”¹Javaå­—èŠ‚ç æ–‡ä»¶ã€‚å‰ä¸€éƒ¨åˆ†é€šè¿‡JBEæ¥ä¿®æ”¹classæ–‡ä»¶åªä¸è¿‡æ˜¯å°†è¿™ä¸ªè¿‡ç¨‹è¿›è¡Œäº†å›¾å½¢åŒ–å°è£…ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°æ›´åº•å±‚çš„å®ç°æ–¹æ³•æ¥é€‚åº”æˆ‘ä»¬çš„éœ€æ±‚ã€‚\næ­¤æ—¶Javassisté—ªäº®ç™»åœºï¼åœ¨Javassitå®˜ç½‘å…³äºå…¶çš„ç¬¬ä¸€å¥ä»‹ç»ä¸ºJavassist (Java Programming Assistant) makes Java bytecode manipulation simple. It is a class library for editing bytecodes in Java ã€‚Javassistå¤©ç”Ÿå°±æ˜¯ä¸ºä¿®æ”¹Javaå­—èŠ‚ç è€Œæ¥çš„ï¼Œå®ƒæä¾›äº†æºä»£ç å’Œå­—èŠ‚ç ä¸¤ç§çº§åˆ«çš„APIæ¥å£ï¼Œä¸ºäº†å®ç°çš„ç®€ä¾¿æ€§ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»åˆ©ç”¨æºä»£ç APIæ¥ä¿®æ”¹classæ–‡ä»¶ã€‚\nä¸‹é¢çš„ä»£ç ä¸ºä¸€ä¸ªè®¡ç®—ä¸¤ä¸ªæ•´æ•°ç›¸åŠ çš„ç¨‹åº\n1 2 3 4 5 6 7 8 9 10 11 12 13  package com.lucumt; public class Test1 { public static void main(String[] args) { Test1 t1 = new Test1(); int result = t1.addNumber(3, 5); System.out.println(\u0026#34;result is: \u0026#34;+result); } public int addNumber(int a,int b){ return a+b; } }   æ­£å¸¸æƒ…å†µä¸‹ï¼Œå…¶è¾“å‡ºç»“æœå¦‚ä¸‹\nè‹¥æˆ‘ä»¬æƒ³å°†addNumberçš„è¿”å›ç»“æœä»ä¸¤ä¸ªæ•°ä¹‹å’Œå˜ä¸ºä¸¤ä¸ªæ•°ç«‹æ–¹åæ±‚å’Œï¼Œåˆ™å¯ä»¥åˆ©ç”¨Javassistæä¾›çš„APIé€šè¿‡Javaç¨‹åºæ¥ç›´æ¥ä¿®æ”¹classæ–‡ä»¶ã€‚å…³äºå¦‚ä½•ä½¿ç”¨Javassistè¯·ç›´æ¥å‚çœ‹ç›¸åº”çš„ å…¥é—¨æ•™ç¨‹ï¼Œæœ¬æ–‡ä¸å†è¯¦ç»†è¯´æ˜ï¼Œåˆ©ç”¨Javassistä¿®æ”¹ addNumberçš„Javaä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  package com.lucumt.test; import java.io.IOException; import javassist.CannotCompileException; import javassist.ClassPool; import javassist.CtClass; import javassist.CtMethod; import javassist.NotFoundException; public class UpdateMethod { public static void main(String[] args) { updateMethod(); } public static void updateMethod(){ try { ClassPool cPool = new ClassPool(true); //å¦‚æœè¯¥æ–‡ä»¶å¼•å…¥äº†å…¶å®ƒç±»ï¼Œéœ€è¦åˆ©ç”¨ç±»ä¼¼å¦‚ä¸‹æ–¹å¼å£°æ˜ \t//cPool.importPackage(\u0026#34;java.util.List\u0026#34;); \t//è®¾ç½®classæ–‡ä»¶çš„ä½ç½® \tcPool.insertClassPath(\u0026#34;D:\\\\Java\\\\eclipse\\\\newworkspace\\\\test\\\\bin\u0026#34;); //è·å–è¯¥classå¯¹è±¡ \tCtClass cClass = cPool.get(\u0026#34;com.lucumt.Test1\u0026#34;); //è·å–åˆ°å¯¹åº”çš„æ–¹æ³• \tCtMethod cMethod = cClass.getDeclaredMethod(\u0026#34;addNumber\u0026#34;); //æ›´æ”¹è¯¥æ–¹æ³•çš„å†…éƒ¨å®ç° \t//éœ€è¦æ³¨æ„çš„æ˜¯å¯¹äºå‚æ•°çš„å¼•ç”¨è¦ä»¥$å¼€å§‹ï¼Œä¸èƒ½ç›´æ¥è¾“å…¥å‚æ•°åç§° \tcMethod.setBody(\u0026#34;{ return $1*$1*$1+$2*$2*$2; }\u0026#34;); //æ›¿æ¢åŸæœ‰çš„æ–‡ä»¶ \tcClass.writeFile(\u0026#34;D:\\\\Java\\\\eclipse\\\\newworkspace\\\\test\\\\bin\u0026#34;); System.out.println(\u0026#34;=======ä¿®æ”¹æ–¹æ³•å®Œ=========\u0026#34;); } catch (NotFoundException e) { e.printStackTrace(); } catch (CannotCompileException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); } } }   è¿è¡Œè¯¥ä»£ç åé‡æ–°æ‰§è¡Œåçš„ç»“æœå¦‚ä¸‹ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºè¿è¡Œç»“æœç¬¦åˆé¢„æœŸ\nå…³äºUpdateMethodå·¥å…·ç±»æœ‰å¦‚ä¸‹å‡ ç‚¹è¯´æ˜ï¼š\n  å¦‚æœè¦ä¿®æ”¹çš„classæ–‡ä»¶ä¸­å¼•å…¥äº†å…¶å®ƒç±»ï¼Œéœ€è¦è°ƒç”¨ClassPoolä¸­çš„importPackageæ–¹æ³•å¼•å…¥è¯¥ç±»ï¼Œå¦åˆ™ç¨‹åºä¼šæŠ¥é”™\n  ä¿®æ”¹å®Œåï¼Œä¸€å®šè¦è°ƒç”¨CtClassä¸­çš„ writeFileæ–¹æ³•è¦†ç›–åŸæœ‰çš„classæ–‡ä»¶ï¼Œå¦åˆ™ä¿®æ”¹ä¸ç”Ÿæ•ˆ\n  åœ¨ä¿®æ”¹æ–¹æ³•çš„è¿‡ç¨‹ä¸­è‹¥è¦å¼•ç”¨æ–¹æ³•å‚æ•°ï¼Œä¸èƒ½åœ¨ä¿®æ”¹ç¨‹åºä»£ç ä¸­ç›´æ¥å†™è¯¥å‚æ•°ï¼Œå¦åˆ™ç¨‹åºä¼šæŠ›å‡ºjavassist.CannotCompileException: [source error] no such field:å¼‚å¸¸ã€‚åœ¨æœ¬ä¾‹ä¸­addNumberçš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸ºaå’Œ bï¼Œåœ¨ä¿®æ”¹æ—¶ä¸èƒ½å†™æˆcMethod.setBody(\u0026quot;{ return a*a*a+b*b*b; }\u0026quot;)éœ€è¦ä¿®æ”¹ä¸ºcMethod.setBody(\u0026quot;{ return $1*$1*$1+$2*$2*$2; }\u0026quot;)\n  åœ¨Javassistçš„ Introspection and customizationéƒ¨åˆ†æœ‰å¦‚ä¸‹ä¸€æ®µè¯\n The parameters passed to the target method are accessible with $1, $2, \u0026hellip; instead of the original parameter names. $1 represents the first parameter, $2 represents the second parameter, and so on. The types of those variables are identical to the parameter types. $0 is equivalent to this. If the method is static, $0 is not available.\n   ä»ä¸­å¯çŸ¥ï¼Œæ–¹æ³•ä¸­çš„å‚æ•°ä»$1å¼€å§‹ï¼Œè‹¥è¯¥æ–¹æ³•ä¸ºéstaticæ–¹æ³•ï¼Œå¯ä»¥ç”¨$0æ¥è¡¨ç¤ºè¯¥æ–¹æ³•å®ä¾‹è‡ªèº«ï¼Œè‹¥è¯¥æ–¹æ³•ä¸ºstaticæ–¹æ³•ï¼Œåˆ™ $0 ä¸å¯ç”¨\nåœ¨Classæ–‡ä»¶ä¸­å¢åŠ æ–¹æ³• Javassistä¸ä»…å¯ä»¥ä¿®æ”¹å·²æœ‰çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥ç»™classæ–‡ä»¶å¢åŠ æ–°çš„æ–¹æ³•ã€‚ä»ä»¥å‰é¢çš„ Test1 Javaä»£ç ä¸­ä¸ºä¾‹ï¼Œç°è¦æ±‚å¢åŠ ä¸€ä¸ªåä¸ºshowParameterçš„æ–¹æ³•å¹¶åœ¨addNumberæ–¹æ³•ä¸­è°ƒç”¨ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯è¾“å‡ºaddNumberä¸­ä¼ å…¥çš„å‚æ•°ã€‚åˆ©ç”¨Javassistä¿®æ”¹classæ–‡ä»¶å®ç°è¯¥åŠŸèƒ½çš„ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48  package com.lucumt.test; import java.io.IOException; import javassist.CannotCompileException; import javassist.ClassPool; import javassist.CtClass; import javassist.CtMethod; import javassist.CtNewMethod; import javassist.NotFoundException; public class AddMethod { public static void main(String[] args) { addMethod(); } public static void addMethod(){ try { ClassPool cPool = new ClassPool(true); cPool.insertClassPath(\u0026#34;D:\\\\Java\\\\eclipse\\\\newworkspace\\\\test\\\\bin\u0026#34;); CtClass cClass = cPool.get(\u0026#34;com.lucumt.Test1\u0026#34;); CtMethod cMethod = cClass.getDeclaredMethod(\u0026#34;addNumber\u0026#34;); //å¢åŠ ä¸€ä¸ªæ–°æ–¹æ³• \tString methodStr =\u0026#34;public void showParameters(int a,int b){\u0026#34; +\u0026#34; System.out.println(\\\u0026#34;First parameter: \\\u0026#34;+a);\u0026#34; +\u0026#34; System.out.println(\\\u0026#34;Second parameter: \\\u0026#34;+b);\u0026#34; +\u0026#34;}\u0026#34;; CtMethod newMethod = CtNewMethod.make(methodStr, cClass); cClass.addMethod(newMethod); //è°ƒç”¨æ–°å¢çš„æ–¹æ³• \tcMethod.setBody(\u0026#34;{ showParameters($1,$2);return $1*$1*$1+$2*$2*$2; }\u0026#34;); cClass.writeFile(\u0026#34;D:\\\\Java\\\\eclipse\\\\newworkspace\\\\test\\\\bin\u0026#34;); } catch (NotFoundException e) { e.printStackTrace(); } catch (CannotCompileException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); } } }   è¿è¡Œè¯¥ä»£ç åé‡æ–°æ‰§è¡ŒTest1åçš„ç»“æœå¦‚ä¸‹ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºè¿è¡Œç»“æœç¬¦åˆé¢„æœŸ ä»ä¸Šè¿°ä»£ç å¯ä»¥çœ‹å‡ºï¼Œåˆ©ç”¨Javassistå¢åŠ æ–¹æ³•æ¯”ä¿®æ”¹æ–¹æ³•æ›´ç®€å•ï¼Œå…ˆå°†è¦æ–°å¢çš„æ–¹æ³•å†…å®¹èµ‹å€¼åˆ°å­—ç¬¦ä¸²ï¼Œç„¶ååˆ†åˆ«è°ƒç”¨ç›¸å…³ç±»çš„makeå’Œ addMethodæ–¹æ³•å³å¯ã€‚\nåè®° åˆ©ç”¨JBEæˆ–Javassistè™½ç„¶å¯ä»¥å®ç°ç›´æ¥ä¿®æ”¹classæ–‡ä»¶çš„å†…å®¹ï¼Œä½†æ¯•ç«Ÿå±äºä¸æ­£è§„çš„åšæ³•ï¼Œå¯èƒ½ä¼šå¯¼è‡´åç»­ç‰ˆæœ¬ä¸ä¸€è‡´ç­‰é—®é¢˜ï¼Œåœ¨æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹è¿˜æ˜¯è¦å°½é‡é€šè¿‡ä¿®æ”¹Javaæ–‡ä»¶ç„¶åé‡æ–°ç¼–è¯‘çš„æ–¹å¼æ¥å®ç°ç›®çš„ã€‚\n","permalink":"http://isouthrain.github.io/post/java-core/modify-java-class-file-content-directly/","tags":["Java","JVM"],"title":"åœ¨ä¸é‡æ–°ç¼–è¯‘çš„æƒ…å†µä¸‹ç›´æ¥ä¿®æ”¹Java Classæ–‡ä»¶ä¸­çš„å†…å®¹"},{"categories":["Webç¼–ç¨‹"],"contents":"ç›¸å¯¹äºä¼ ç»Ÿçš„ç”¨HTMLä¸­TABLEå®ç°çš„è¡¨æ ¼ï¼Œåˆ©ç”¨EasyUIä¸­çš„DataGridå®ç°çš„è¡¨æ ¼å…·æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œå¦‚å¯ä»¥å¯¹åˆ—å®½è¿›è¡Œæ‹–åŠ¨è°ƒæ•´ã€åˆ—å†»ç»“ã€è¡Œå†»ç»“ã€è‡ªå®šä¹‰æ ¼å¼åŒ–ç­‰åŠŸèƒ½ï¼Œæ•…è€Œåœ¨Webå¼€å‘ä¸­å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚æœ€è¿‘è‡ªå·±åœ¨ä½¿ç”¨DataGridçš„åˆ—å†»ç»“åŠŸèƒ½æ—¶é‡åˆ°äº†ç”±äºæŸäº›å•å…ƒæ ¼ä¸­çš„å†…å®¹è¾ƒå¤šå¯¼è‡´è¯¥è¡Œæ— æ³•å¯¹é½çš„é—®é¢˜ï¼Œç”±äºå½“å‰åœ¨EasyUIå®˜ç½‘ä¸­æ— æ³•æ‰¾åˆ°è¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œè‡ªå·±ç ”ç©¶DataGridçš„å®ç°åŸç†åï¼Œæ‰¾åˆ°äº†å˜é€šçš„è§£å†³æ–¹æ¡ˆï¼Œæ•…å…ˆè®°å½•ä¸‹ã€‚\nEasyUI DataGridæ­£å¸¸æƒ…å†µä¸‹çš„åˆ—å†»ç»“ ä¸‹å›¾ä¸ºä¸€ä¸ªå¸¸è§çš„DataGridä½¿ç”¨ç¤ºä¾‹ï¼Œè¯¥å›¾å±•ç¤ºäº†æˆ‘ä»¬åœ¨ä½¿ç”¨EasyUI DataGridæ—¶ç»å¸¸ä¼šé‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šç”±äºæŸä¸ªåˆ—çš„é•¿åº¦å¾ˆé•¿å¯¼è‡´è¡¨æ ¼å‡ºç°æ»šåŠ¨æ¡\nå¯¹åº”çš„ä»£ç ä¸º\n1 2 3 4 5 6 7 8  \u0026lt;thead\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th data-options=\u0026#34;field:\u0026#39;name\u0026#39;\u0026#34;\u0026gt;\u0026lt;b\u0026gt;ä¹¦å\u0026lt;/b\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th data-options=\u0026#34;field:\u0026#39;price\u0026#39;,align:\u0026#39;center\u0026#39;,width:70\u0026#34;\u0026gt;\u0026lt;b\u0026gt;ä»·æ ¼\u0026lt;/b\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th data-options=\u0026#34;field:\u0026#39;pubdate\u0026#39;,align:\u0026#39;center\u0026#39;,width:90\u0026#34;\u0026gt;\u0026lt;b\u0026gt;å‡ºç‰ˆæ—¥æœŸ\u0026lt;/b\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th data-options=\u0026#34;field:\u0026#39;description\u0026#39;,width:800\u0026#34;\u0026gt;\u0026lt;b\u0026gt;ç®€è¦ä»‹ç»\u0026lt;/b\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt;   å¾—ç›ŠäºEasyUI DataGridå¼ºå¤§çš„åŠŸèƒ½ï¼Œå½“è¡¨æ ¼ä¸­åˆ—çš„å®½åº¦å¤ªé•¿æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åŠ ä¸Šæ¨ªå‘æ»šåŠ¨æ¡ï¼Œé¿å…åƒä¼ ç»Ÿçš„HTML TABLEè¡¨æ ¼åœ¨å†…å®¹è¿‡å¤šæ—¶ä¼šè‡ªå·±æŒ¤æˆä¸€å›¢ï¼Œé€šè¿‡æ‹–åŠ¨æ»šåŠ¨æ¡ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŸ¥çœ‹è¡¨æ ¼ä¸­å„åˆ—çš„å†…å®¹ã€‚\nä½†æœ‰æ—¶å€™æˆ‘ä»¬ä¼šè¿åˆ°å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œæ‹–åŠ¨æ»šåŠ¨æ¡æ—¶å‰é¢çš„æŸäº›åˆ—å°±ä¸è§äº†ï¼Œå¦‚æœ¬ä¾‹ä¸­çš„ä¹¦åï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¹æˆ‘ä»¬çš„ä½¿ç”¨å¸¦æ¥ä¸ä¾¿ã€‚\næ­¤æ—¶DataGridçš„åˆ—å†»ç»“åŠŸèƒ½å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ï¼Œåªéœ€è¦å°†éœ€è¦å›ºå®šçš„åˆ—å†»ç»“å³å¯ï¼Œåœ¨æœ¬ä¾‹ä¸­æˆ‘æƒ³æŠŠä¹¦ååˆ—å†»ç»“ï¼Œåœ¨éœ€è¦ä¿®æ”¹ä»£ç å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12  \u0026lt;thead frozen=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th data-options=\u0026#34;field:\u0026#39;name\u0026#39;\u0026#34;\u0026gt;\u0026lt;b\u0026gt;ä¹¦å\u0026lt;/b\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt; \u0026lt;thead\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th data-options=\u0026#34;field:\u0026#39;price\u0026#39;,align:\u0026#39;center\u0026#39;,width:70\u0026#34;\u0026gt;\u0026lt;b\u0026gt;ä»·æ ¼\u0026lt;/b\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th data-options=\u0026#34;field:\u0026#39;pubdate\u0026#39;,align:\u0026#39;center\u0026#39;,width:90\u0026#34;\u0026gt;\u0026lt;b\u0026gt;å‡ºç‰ˆæ—¥æœŸ\u0026lt;/b\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;th data-options=\u0026#34;field:\u0026#39;description\u0026#39;,width:800\u0026#34;\u0026gt;\u0026lt;b\u0026gt;ç®€è¦ä»‹ç»\u0026lt;/b\u0026gt;\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/thead\u0026gt;   å…¶å¯¹åº”çš„è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š\nEasyUI DataGridéæ­£å¸¸æƒ…å½¢ä¸‹çš„åˆ—å†»ç»“æ•ˆæœ å¤§å¤šæ•°æƒ…å†µä¸‹è¿™ç§åˆ—å†»ç»“éƒ½èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œä½†ä¸Šè¿°å†»ç»“åˆ—æ­£å¸¸æ˜¾ç¤ºæœ‰ä¸€ä¸ªå‰æï¼šè¡¨æ ¼ä¸­æ¯ä¸€è¡Œå„åˆ—çš„é«˜åº¦ä¸€è‡´ï¼Œè‹¥è¡¨æ ¼ä¸­æŸäº›è¡Œä¸­å­˜åœ¨åˆ—é«˜è¶…å‡ºDataGridæ­£å¸¸é«˜åº¦çš„æƒ…å½¢(25px)ï¼Œåœ¨è¿›è¡Œåˆ—å†»ç»“æ—¶å°±ä¼šå‡ºç°å†»ç»“è¡Œå’Œéå†»ç»“è¡Œæ— æ³•å¯¹é½çš„é—®é¢˜ã€‚\nä¸‹å›¾ä¸ºä¸€ä¸ªåˆ—è¶…å‡ºæ­£å¸¸é«˜åº¦çš„DataGridæ˜¾ç¤ºæ•ˆæœï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºç”±äºæè¿°ä¿¡æ¯ä¸­çš„æ–‡å­—è¾ƒå¤šï¼Œå¯¼è‡´æ­£å¸¸çš„é«˜åº¦éƒ½æ¯”DataGridé»˜è®¤çš„é«˜åº¦è¦å¾ˆå¤šï¼Œç›´è§‚çš„æ˜¾ç¤ºå°±æ˜¯ä¸åŒè¡Œçš„é«˜åº¦ä¸ä¸€è‡´ã€‚ æ­¤æ—¶è‹¥å¯¹è¯¥è¡¨æ ¼è¿›åˆ—å†»ç»“ï¼ŒåŒæ ·ä¼šå‡ºç°å‡ºç°å¦‚å‰æ‰€è¿°çš„å†»ç»“æ•ˆæœï¼Œä½†å¦‚æœæˆ‘ä»¬åœ¨ä¸€å¼€å§‹å°±å°†æè¿°ä¿¡æ¯è¿™åˆ—éšè—æ‰ï¼Œä¹‹åé€šè¿‡ç‚¹å‡»ç­‰æ–¹å¼è®©è¯¥åˆ—æ˜¾ç¤ºï¼Œåˆ™ä¼šå‡ºç°å†»ç»“è¡Œå’Œéå†»ç»“è¡Œæ— æ³•å¯¹é½çš„æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º å¯¹åº”çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»jsfiddle.net/wch9rnr2/8/æŸ¥çœ‹å®Œæ•´çš„ä»£ç \n1 2 3 4 5 6 7 8 9 10  \u0026lt;button type=\u0026#34;button\u0026#34; onclick=\u0026#34;toggleDescription()\u0026#34;\u0026gt;éšè—æˆ–æ˜¾ç¤ºæè¿°ä¿¡æ¯\u0026lt;/button\u0026gt; function toggleDescription(){ var colOptions = $(\u0026#34;#dg\u0026#34;).datagrid(\u0026#34;getColumnOption\u0026#34;,\u0026#34;description\u0026#34;); var isHidden = !!colOptions.hidden; if(isHidden){ $(\u0026#34;#dg\u0026#34;).datagrid(\u0026#34;showColumn\u0026#34;,\u0026#34;description\u0026#34;); }else{ $(\u0026#34;#dg\u0026#34;).datagrid(\u0026#34;hideColumn\u0026#34;,\u0026#34;description\u0026#34;); } }   ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºæ­¤æ—¶ä¹¦ååˆ—å’Œå…¶ä½™åˆ—å·²ç»æ— æ³•å¯¹é½ï¼Œä¸¥é‡å°è±¡äº†æˆ‘ä»¬çš„ä½¿ç”¨æ•ˆæœã€‚\nè§£å†³æ–¹æ¡ˆ è¦æƒ³è§£å†³è¯¥é—®é¢˜ï¼Œé¦–å…ˆéœ€è¦æ‰¾å‡ºè¯¥é—®é¢˜äº§ç”Ÿçš„æ ¹æºï¼Œåˆ©ç”¨Chromeæˆ–å…¶å®ƒæµè§ˆå™¨è°ƒè¯•å·¥å…·å¯çŸ¥ï¼Œå½“æœ‰éƒ¨åˆ†åˆ—å†»ç»“æ—¶ï¼ŒDataGridè¡¨æ ¼è¢«åˆ†æˆäº†ä¸¤ä¸ªä¸åŒçš„è¡¨æ ¼ï¼Œä¸€ä¸ªæ˜¯å†»ç»“çš„è¡¨æ ¼ï¼Œä¸€ä¸ªæ˜¯æœªå†»ç»“çš„è¡¨æ ¼ã€‚è¿›ä¸€æ­¥åˆ†æå‘ç°å¯¼è‡´æ— æ³•å¯¹é½çš„é—®é¢˜æ ¹æºä¸º ç”±äºä¸¤ä¸ªè¡¨æ ¼ä¸­åŒä¸€è¡Œçš„é«˜åº¦ä¸åŒï¼Œå¯¼è‡´å®é™…æ˜¾ç¤ºæ—¶çœ‹èµ·æ¥è¡¨æ ¼è¡Œæ²¡æœ‰å¯¹é½ã€‚\næ‰¾åˆ°é—®é¢˜æ ¹æºåï¼Œè¦è§£å†³è¯¥é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦è®©è¡¨æ ¼ä¸­æ¯ä¸€è¡Œé«˜åº¦ä¿æŒä¸€è‡´å³å¯ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯ è¦åœ¨EasyUI DataGridæ¸²æŸ“è¡¨æ ¼ä¹‹å‰å°†åŒä¸€è¡Œçš„æ¯ä¸€ä¸ªå•å…ƒæ ¼çš„é«˜åº¦ä¿æŒä¸€è‡´å³å¯ã€‚é—®é¢˜è½¬åŒ–ä¸ºå¯»æ‰¾é€‚å½“çš„æ–¹æ³•åˆ‡å…¥ç‚¹æ¥ä¿®æ”¹å•å…ƒæ ¼é«˜åº¦ï¼Œå³å¯¹å•å…ƒæ ¼çš„é«˜åº¦è¿›è¡Œæ ¡éªŒã€‚\nä¸ºäº†ä¿®æ­£å•å…ƒæ ¼çš„é«˜åº¦ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆæ‰¾å‡ºç‰¹å®šè¡Œå·²å†»ç»“å•å…ƒæ ¼å’Œæœªå†»ç»“å•å…ƒæ ¼çš„é«˜åº¦ï¼Œè€Œè¦æ‰¾å‡ºå®ƒä»¬çš„é«˜åº¦å¿…é¡»è¦ç­‰EasyUI DataGridæ¸²æŸ“å®Œæ¯•ä¹‹åæ‰èƒ½è·å–åˆ°å…¶å®é™…é«˜åº¦ã€‚æœ¬åˆ—ä¸­ç”±äºç‚¹å‡»æŒ‰é’®æ—¶ä¼šå¯¹æœ€åä¸€åˆ—è¿›è¡Œéšè—æˆ–æ˜¾ç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨toggleDescriptionæ–¹æ³•çš„æœ€åæ‰§è¡Œç›¸åº”çš„æ ¡éªŒé€»è¾‘ã€‚\nè¿›ä¸€æ­¥è°ƒè¯•åˆ†æåå‘ç°ï¼Œå¯¹äºDataGridä¸­çš„æŸä¸€ä¸ªæ•°æ®è¡Œè€Œè¨€ï¼Œå†»ç»“åˆ—çš„å•å…ƒæ ¼é«˜åº¦éƒ½ä¸€æ ·ï¼Œéå†»ç»“åˆ—çš„å•å…ƒæ ¼é«˜åº¦ä¹Ÿä¸€æ ·ï¼Œä¸ºäº†ä¿æŒæ•´è¡Œå¯¹é½ï¼Œæˆ‘ä»¬åªéœ€è¦é«˜åº¦è¾ƒå°çš„å•å…ƒæ ¼çš„é«˜åº¦è®¾ç½®ä¸ºé«˜åº¦è¾ƒé«˜çš„å•å…ƒæ ¼çš„é«˜åº¦å³å¯ã€‚è€ƒè™‘åˆ°æœ‰äº›å½±å“åˆ—ï¼ŒåŒæ—¶ä¸ºäº†ç®€åŒ–å®ç°ï¼Œå¯ä»¥å°†åŠè§£å†³æ–¹æ¡ˆä»è®¾ç½®å•å…ƒæ ¼çš„é«˜åº¦æ›´æ”¹ä¸ºè®¾ç½®ç‰¹å®šè¡Œåœ¨å†»ç»“å’Œéå†»ç»“éƒ¨åˆ†çš„è¡Œé«˜å³å¯ã€‚è‡³äºå¦‚ä½•è®¾ç½®EasyUI DataGridä¸­æ•°æ®è¡Œçš„é«˜åº¦ï¼Œè¯·å‚è§EasyUIä½œè€…stworthyå¤§ç¥åœ¨datagrid dynamically set / reset row heightä¸­çš„å›å¤ï¼Œåœ¨è¯¥é—®é¢˜ä¸­stworthyç»™å‡ºçš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š\n1 2 3 4 5  var dg = $(\u0026#39;#dg\u0026#39;); dg.datagrid(\u0026#39;options\u0026#39;).rowHeight = 40; for(var i=0; i\u0026lt;dg.datagrid(\u0026#39;getRows\u0026#39;).length; i++){ dg.datagrid(\u0026#39;refreshRow\u0026#39;, i); }   åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†toggleDescriptionæ–¹æ³•æ”¹è¿›å¦‚ä¸‹ï¼Œå®Œæ•´çš„ä»£ç è¯·å‚è§jsfiddle.net/wch9rnr2/9/\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  function toggleDescription(){ var dg = $(\u0026#34;#dg\u0026#34;); var colOptions = dg.datagrid(\u0026#34;getColumnOption\u0026#34;,\u0026#34;description\u0026#34;); var isHidden = !!colOptions.hidden; if(isHidden){ dg.datagrid(\u0026#34;showColumn\u0026#34;,\u0026#34;description\u0026#34;); }else{ dg.datagrid(\u0026#34;hideColumn\u0026#34;,\u0026#34;description\u0026#34;); } var dgOptions = dg.datagrid(\u0026#34;options\u0026#34;); var rows = dg.datagrid(\u0026#34;getRows\u0026#34;); var row = null; var tr = null; var height1 =0; var height2 =0; for(var i in rows){ row = rows[i]; tr = dgOptions.finder.getTr(dg[0],i); height1 = $(tr[0]).height();//å†»ç»“è¡Œçš„é«˜åº¦ \theight2 = $(tr[1]).height();//éå†»ç»“è¡Œçš„é«˜åº¦ \tif((isHidden\u0026amp;\u0026amp;height2\u0026gt;height1)||(!isHidden\u0026amp;\u0026amp;height1\u0026gt;height2)){ //å†»ç»“éƒ¨åˆ†åœ¨æ˜¾ç¤ºæ—¶çš„é«˜åº¦å–è¾ƒå¤§çš„é‚£ä¸ª  $(tr[0]).css(\u0026#34;height\u0026#34;,height2+\u0026#34;px\u0026#34;); } } }   æ­¤æ—¶å½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®æ¥æ˜¾ç¤ºæè¿°ä¿¡æ¯æ—¶ï¼ŒDataGridä¸­çš„æ¯ä¸€è¡Œéƒ½å·²ç»å¯¹é½ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè‡³æ­¤é—®é¢˜è·å¾—è§£å†³ï¼\nåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘å‘ç°æœ‰æ—¶å€™ä¸Šè¿°JavaScriptæ ¡éªŒä»£ç è¿˜æ˜¯ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œå…¶åŸå› ä¸ºåœ¨æ‰§è¡Œæ ¡éªŒä»£ç æ—¶ï¼ŒEasyUI DataGridè¿˜æ²¡æœ‰å®Œå…¨æ¸²æŸ“å®Œæ¯•ï¼Œæ­¤æ—¶å¯ä»¥åˆ©ç”¨setTimeoutå‡½æ•°æ¥å»¶åæ ¡éªŒä»£ç çš„æ‰§è¡Œï¼Œä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  function toggleDescription(){ var dg = $(\u0026#34;#dg\u0026#34;); var colOptions = dg.datagrid(\u0026#34;getColumnOption\u0026#34;,\u0026#34;description\u0026#34;); var isHidden = !!colOptions.hidden; if(isHidden){ dg.datagrid(\u0026#34;showColumn\u0026#34;,\u0026#34;description\u0026#34;); }else{ dg.datagrid(\u0026#34;hideColumn\u0026#34;,\u0026#34;description\u0026#34;); } var dgOptions = dg.datagrid(\u0026#34;options\u0026#34;); var rows = dg.datagrid(\u0026#34;getRows\u0026#34;); var row = null; var tr = null; var height1 =0; var height2 =0; setTimeout(function(){ for(var i in rows){ row = rows[i]; tr = dgOptions.finder.getTr(dg[0],i); height1 = $(tr[0]).height();//å†»ç»“è¡Œçš„é«˜åº¦  height2 = $(tr[1]).height();//éå†»ç»“è¡Œçš„é«˜åº¦  if((isHidden\u0026amp;\u0026amp;height2\u0026gt;height1)||(!isHidden\u0026amp;\u0026amp;height1\u0026gt;height2)){ //å†»ç»“éƒ¨åˆ†åœ¨æ˜¾ç¤ºæ—¶çš„é«˜åº¦å–è¾ƒå¤§çš„é‚£ä¸ª  $(tr[0]).css(\u0026#34;height\u0026#34;,height2+\u0026#34;px\u0026#34;); } } },1000);//å»¶åä¸€ç§’æ‰§è¡Œ }   è€ƒè™‘åˆ°å®é™…ä½¿ç”¨ä¸­EasyUI DataGridçš„æ¸²æŸ“æ—¶é—´æ— æ³•ç¡®å®šï¼Œç”¨setTimeoutå¹¶éæœ€ä¼˜è§£ï¼Œå¸Œæœ›EasyUIå®˜æ–¹åç»­èƒ½ä¸ºè¯¥é—®é¢˜æä¾›æ›´åˆç†çš„è§£å†³æ–¹æ¡ˆ!\n","permalink":"http://isouthrain.github.io/post/web/easyui-datagrid-row-not-align-when-column-frozen/","tags":["JavaScript","EasyUI"],"title":"è§£å†³EasyUI DataGridä¸­çš„è¡Œåœ¨åˆ—å†»ç»“æ—¶æ— æ³•å¯¹é½çš„é—®é¢˜"},{"categories":["Javaç¼–ç¨‹","ç¿»è¯‘"],"contents":"æœ¬æ–‡ç¿»è¯‘è‡ªJava Concurrency / Concurrency Models\nå¹¶å‘ç³»ç»Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„å¹¶å‘æ¨¡å‹æ¥å®ç°ï¼Œå¹¶å‘æ¨¡å‹æ˜¯æŒ‡çº¿ç¨‹åœ¨ç³»ç»Ÿä¸­å¦‚ä½•å†™ä½œæ¥å®Œæˆç»™å®šçš„ä»»åŠ¡ã€‚ä¸åŒçš„å¹¶å‘æ¨¡å‹ä»¥ä¸åŒçš„æ–¹å¼æ‹†åˆ†ä»»åŠ¡ï¼Œçº¿ç¨‹é—´ä»¥ä¸åŒçš„æ–¹å¼åä½œå’Œé€šä¿¡ï¼Œæœ¬æ–‡å°†æ·±å…¥ç ”ç©¶åœ¨æ’°å†™æœ¬æ–‡æ—¶æœ€æµè¡Œå¹¶å‘æ¨¡å‹(2015å¹´)ã€‚\nå¹¶å‘æ¨¡å‹å’Œåˆ†å¸ƒå¼ç³»ç»Ÿç›¸ä¼¼ä¹‹å¤„ æœ¬æ–‡ä¸­æè¿°çš„å¹¶å‘æ¨¡å‹ä¸åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä½¿ç”¨çš„æ¶æ„ç±»ä¼¼ï¼Œåœ¨ä¸€ä¸ªå¹¶å‘ç³»ç»Ÿä¸­ï¼Œä¸åŒçš„çº¿ç¨‹ä¹‹é—´äº’ç›¸é€šä¿¡ï¼Œåœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸åŒçš„è¿›ç¨‹é—´å½¼æ­¤é€šä¿¡ï¼ˆè¿™äº›è¿›ç¨‹å¯èƒ½åœ¨ä¸åŒçš„ç”µè„‘ä¸Šï¼‰ã€‚çº¿ç¨‹å’Œè¿›ç¨‹åœ¨æœ¬è´¨ä¸Šæ—¶éå¸¸ç›¸ä¼¼çš„ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸åŒçš„å¹¶å‘æ¨¡å‹ä¸ä¸åŒçš„åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„é€šå¸¸çœ‹èµ·æ¥ç›¸ä¼¼ã€‚\nè™½ç„¶åˆ†å¸ƒå¼ç³»ç»Ÿè¿˜æœ‰é¢å¤–çš„æŒ‘æˆ˜ï¼Œå¦‚ç½‘ç»œæ•…éšœã€è¿œç¨‹è®¡ç®—æœºæˆ–è¿›ç¨‹å…³é—­ç­‰ï¼Œä½†ä¸€ä¸ªè¿è¡Œåœ¨å¤§å‹æœåŠ¡å™¨ä¸Šçš„å¹¶å‘ç³»ç»Ÿä¹Ÿå¯èƒ½ä¼šé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œå¦‚CPUæ•…éšœã€ç½‘å¡æ•…éšœã€ç¡¬ç›˜æ•…éšœç­‰ï¼Œè™½ç„¶å…¶å‘ç”Ÿçš„æ¦‚ç‡è¾ƒä½ï¼Œä½†ç†è®ºä¸Šä»ç„¶å¯ä»¥å‘ç”Ÿã€‚\nç”±äºå¹¶å‘æ¨¡å‹å’Œåˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ç±»ä¼¼ï¼Œå®ƒä»¬é€šå¸¸å¯ä»¥ç›¸äº’å€Ÿé‰´ï¼Œæ¯”å¦‚åœ¨çº¿ç¨‹ä¸­åˆ†é…å·¥ä½œçš„æ¨¡å‹é€šå¸¸ä¸åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è´Ÿè½½å‡è¡¡ç±»ä¼¼ï¼Œå®ƒä»¬çš„é”™è¯¯å¤„ç†æ‰‹æ®µä¹Ÿç±»ä¼¼ï¼Œä¾‹å¦‚æ—¥å¿—ï¼ˆloggingï¼‰ã€æ•…éšœåˆ‡æ¢ï¼ˆfail-overï¼‰å’Œç­‰å¹‚æ€§ä»»åŠ¡ï¼ˆidempotency of jobsï¼‰ç­‰ã€‚\nå¹¶è¡Œå·¥ä½œè€…æ¨¡å‹(Parallel Workers model) å¹¶è¡Œå·¥ä½œè€…æ¨¡å‹æ˜¯æœ¬æ–‡è¦è¯´æ˜çš„ç¬¬ä¸€ä¸ªå¹¶å‘æ¨¡å‹ï¼Œè¯¥æ¨¡å‹ä¼šå°†ç³»ç»Ÿä¸­åˆ°æ¥çš„ä»»åŠ¡åˆ†é…ç»™ä¸åŒçš„å·¥ä½œè€…ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nå¹¶å‘æ¨¡å‹ä¸­æœ‰ä¸€ä¸ªâ€œå§”æ‰˜è€…â€å°†åˆ°æ¥çš„ä»»åŠ¡åˆ†é…ç»™ä¸åŒçš„å·¥ä½œè€…ï¼Œæ¯ä¸ªå·¥ä½œè€…å®Œæˆæ•´ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªå·¥ä½œè€…åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­ï¼ˆä¹Ÿæœ‰å¯èƒ½åœ¨ä¸åŒçš„CPUï¼‰å¹¶è¡Œå·¥ä½œã€‚\nå¦‚æœä¸€ä¸ªæ±½è½¦å‚é‡‡ç”¨äº†å¹¶è¡Œå·¥ä½œè€…æ¨¡å‹ï¼Œé‚£ä¹ˆæ¯è¾†æ±½è½¦å°†ç”±ä¸€ä¸ªå·¥äººæ ¹æ®è¯´æ˜ä¹¦ä»å¤´åˆ°å°¾æ¥åˆ¶é€ ã€‚\nå¹¶è¡Œå·¥ä½œè€…æ¨¡å‹æ˜¯Javaåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„å¹¶å‘æ¨¡å‹ï¼ˆå°½ç®¡è¿™ç§æƒ…å½¢æ­£åœ¨å‘ç”Ÿå˜åŒ–ï¼‰ï¼Œjava.util.concurrent ä¸­çš„è®¸å¤šåŒ…éƒ½è¢«è®¾è®¡ç”¨äºæ­¤æ¨¡å‹ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨Javaä¼ä¸šçº§æœåŠ¡å™¨çš„è®¾è®¡ä¸­æ‰¾åˆ°æ­¤æ¨¡å‹çš„åº”ç”¨è¸ªè¿¹ã€‚\nå¹¶è¡Œå·¥ä½œè€…æ¨¡å‹çš„ä¼˜ç‚¹ å¹¶è¡Œå·¥ä½œè€…æ¨¡å‹çš„ä¼˜ç‚¹æ˜¯ç†è§£å®¹æ˜“ï¼Œå½“è¦å¢åŠ åº”ç”¨ç¨‹åºçš„å¹¶è¡Œèƒ½åŠ›æ—¶æˆ‘ä»¬åªéœ€æ·»åŠ æ›´å¤šçš„å·¥ä½œè€…å³å¯ã€‚\nä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³å®ç°ä¸€ä¸ªç½‘ç»œçˆ¬è™«ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸åŒæ•°é‡çš„å·¥ä½œè€…çº¿ç¨‹æ¥çˆ¬å–åˆ¶å®šæ•°é‡çš„é¡µé¢ï¼Œæ ¹æ®ç»“æœæ¥å†³å®šä½¿ç”¨å¤šå°‘ä¸ªå·¥ä½œè€…çº¿ç¨‹å…·æœ‰æœ€çŸ­çš„æŠ“å–æ—¶é—´ï¼ˆåŒæ—¶æ„å‘³ç€æœ€ä¼˜æ€§èƒ½ï¼‰ã€‚ç”±äºç½‘ç»œçˆ¬è™«æ˜¯IOå¯†é›†å‹å·¥ä½œï¼Œåœ¨ç­‰å¾…ä¸‹è½½æ•°æ®æ—¶ä¼šæµªè´¹å¤§é‡æ—¶é—´ï¼Œè‹¥æ¯ä¸ªCPUåªè¿è¡Œä¸€ä¸ªçº¿ç¨‹æ—¶æ•ˆç‡ä¸é«˜ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»“æœå¯èƒ½ä¼šæ˜¯åœ¨ç”µè„‘ä¸­ä¸€ä¸ªCPU/å†…æ ¸è¿è¡Œå¤šä¸ªçº¿ç¨‹ã€‚\nå¹¶è¡Œå·¥ä½œè€…æ¨¡å‹çš„ç¼ºç‚¹ å¹¶è¡Œå·¥ä½œè€…æ¨¡å¼åœ¨å…¶ç®€å•å¤–è¡¨ä¹‹ä¸‹è¿˜æœ‰è‹¥å¹²ç¼ºç‚¹ï¼Œæˆ‘å°†åœ¨ä»¥ä¸‹éƒ¨åˆ†è¯´æ˜å…¶ä¸­æœ€ä¸ºæ˜æ˜¾çš„å‡ ä¸ªã€‚\nçŠ¶æ€å…±äº«å°†ä½¿å¤æ‚æ€§å¢åŠ  å®é™…ä¸Šå¹¶è¡Œå·¥ä½œè€…æ¨¡å‹æ¯”ä¸Šé¢è¯´æ˜çš„è¿˜è¦å¤æ‚ä¸€äº›ï¼Œå¹¶è¡Œå·¥ä½œè€…é€šå¸¸éœ€è¦è®¿é—®ä¸€äº›å…±äº«æ•°æ®ï¼Œå®ƒä»¬å¯èƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ä¹Ÿå¯èƒ½å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œä¸‹é¢çš„å›¾æ ‡å±•ç¤ºäº†è¿™ç§æƒ…å½¢æ˜¯å¦‚ä½•æ˜¯çš„å¹¶è¡Œå·¥ä½œè€…æ¨¡å‹å˜å¾—å¤æ‚çš„ã€‚\nå…¶ä¸­çš„ä¸€äº›å…±äº«çŠ¶æ€å¯èƒ½åœ¨ç±»ä¼¼äºä»»åŠ¡é˜Ÿåˆ—çš„é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œä½†æ˜¯å¦å¤–ä¸€äº›å…±äº«çŠ¶æ€å¯èƒ½æ˜¯å•†ä¸šæ•°æ®ã€ç¼“å­˜æ•°æ®ã€æ•°æ®åº“çš„è¿æ¥æ± ç­‰ã€‚ä¸€æ—¦å…±äº«çŠ¶æ€å¼•å…¥åˆ°äº†å¹¶è¡Œå·¥ä½œè€…æ¨¡å‹ï¼Œé—®é¢˜å°±å¼€å§‹å˜å¾—å¤æ‚ã€‚çº¿ç¨‹éœ€è¦ä¸€ç§æ–¹å¼æ¥è®¿é—®å…±äº«æ•°æ®ä»¥ç¡®ä¿ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«æ•°æ®çš„æ›´æ”¹å¯¹å…¶å®ƒçº¿ç¨‹æ˜¯å¯è§çš„ï¼ˆå°†å…¶æ¨é€åˆ°ä¸»å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯ä»…åœç•™åœ¨æ‰§è¡Œçº¿ç¨‹çš„CPUç¼“å­˜ä¸­ï¼‰ã€‚çº¿ç¨‹é—´éœ€è¦é¿å…ç«äº‰æ¡ä»¶ã€æ­»é”å’Œå…¶å®ƒå…±äº«çŠ¶æ€ç›¸å…³çš„é—®é¢˜ã€‚\nå¦å¤–ï¼Œå½“çº¿ç¨‹é—´åœ¨ç­‰å¾…å½¼æ­¤è®¿é—®å…±äº«æ•°æ®ç»“æ„æ—¶ï¼Œä¼šé™ä½åº”ç”¨ç¨‹åºçš„å¹¶è¡Œæ€§ã€‚è®¸å¤šå¹¶å‘æ•°æ®ç»“æ„éƒ½æ˜¯é˜»å¡å¼çš„ï¼Œè¿™æ„å‘³ç€åœ¨ç»™å®šæ—¶é—´åªæœ‰ä¸€ä¸ªæˆ–ä¸€ç»„æœ‰é™çš„çº¿ç¨‹å¯ä»¥è®¿é—®å®ƒä»¬ï¼Œè¿™å¯èƒ½å¯¼è‡´çº¿ç¨‹å¯¹è¿™äº›å…±äº«æ•°æ®çš„ç«äº‰ï¼Œé«˜åº¦ç«äº‰å°†ä¼šå¯¼è‡´è®¿é—®å…±äº«æ•°æ®çš„ä»£ç ä»æœ¬è´¨ä¸Šå˜ä¸ºä¸²è¡Œæ‰§è¡Œã€‚\nç°ä»£çš„éé˜»å¡å¹¶è¡Œç®—æ³•(non-blocking concurrency algorithms )å¯èƒ½ä¼šå‡å°‘ç«äº‰å’Œæé«˜æ€§èƒ½ï¼Œä½†æ˜¯éé˜»å¡ç®—æ³•å¾ˆéš¾å®ç°ã€‚\næŒä¹…åŒ–æ•°æ®ç»“æ„æ˜¯å¦å¤–ä¸€ç§é€‰æ‹©ï¼Œä¸€ä¸ªæŒä¹…åŒ–æ•°æ®åœ¨è‡ªèº«è¢«ä¿®æ”¹æ—¶ä¼šå§‹ç»ˆä¿ç•™ä¹‹å‰çš„å€¼ã€‚å› æ­¤ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªæŒä¹…åŒ–æ•°æ®å¹¶ä¸”å…¶ä¸­ä¸€ä¸ªä¿®æ”¹äº†è¯¥æ•°æ®ï¼Œè¯¥çº¿ç¨‹ä¼šå¾—åˆ°æ–°æ•°æ®çš„å¼•ç”¨ï¼Œè€Œå…¶å®ƒçº¿ç¨‹åœ¨åˆ™ä¿æŒç€å¯¹æœªä¿®æ”¹çš„æ—§æ•°æ®çš„å¼•ç”¨ï¼Œä»è€Œä¾æ—§ä¿æŒä¸€è‡´ã€‚åœ¨Scalaç¼–ç¨‹ä¸­åŒ…å«è‹¥å¹²ä¸ªæŒä¹…åŒ–çš„æ•°æ®ç»“æ„ã€‚\nè™½ç„¶æŒä¹…åŒ–æ•°æ®ç»“æ„æ˜¯å¹¶å‘ä¿®æ”¹å…±äº«æ•°æ®çš„ä¸€ç§çœ‹ä¼¼ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼Œä½†å…¶æ‰§è¡Œæ€§èƒ½å¹¶ä¸ç†æƒ³ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæŒä¹…åŒ–çš„åˆ—è¡¨ä¼šæŠŠæ–°å…ƒç´ åŠ å…¥å…¶é¦–éƒ¨å¹¶ä¸”è¿”å›å¯¹è¯¥æ–°å¢å…ƒç´ çš„å¼•ç”¨ï¼ˆå®ƒå°†ä¼šæŒ‡å‘åˆ—è¡¨çš„å…¶ä½™å…ƒç´ ï¼‰ã€‚æ‰€æœ‰å…¶å®ƒçš„çº¿ç¨‹ä»ç„¶ä¿æŒç€å¯¹å…ˆå‰åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œå¯¹è¿™äº›çº¿ç¨‹è€Œè¨€è¯¥åˆ—è¡¨å¹¶æ²¡æœ‰å‘ç”Ÿä¿®æ”¹ï¼Œå®ƒä»¬çœ‹ä¸è§æ–°å¢åŠ çš„å…ƒç´ ã€‚\nè¿™ç§æŒä¹…åŒ–çš„åˆ—è¡¨å¯ä»¥ç”¨é“¾è¡¨æ¥å®ç°ï¼Œä¸å¹¸çš„æ˜¯ï¼Œç°åœ¨çš„ç¡¬ä»¶å¹¶ä¸èƒ½å¾ˆå¥½çš„æ”¯æŒé“¾è¡¨ï¼Œé“¾è¡¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡å¯ä»¥éå¸ƒè®¡ç®—æœºçš„å†…å­˜ã€‚ç°åœ¨çš„CPUåœ¨è®¿é—®è¿ç»­çš„å†…å­˜åœ°å€æ—¶é€Ÿåº¦æ›´å¿«ï¼Œå› æ­¤å®ç°ä¸ºæ•°ç»„(Array)ç»“æ„ä¼šè·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚å¯¹äºä¸€ä¸ªä»¥æ•°ç»„æ–¹å¼å­˜å‚¨çš„æ•°æ®è€Œè¨€ï¼ŒCPUç¼“å­˜å¯ä»¥ä¸€æ¬¡å°†æ›´å¤§çš„æ•°ç»„å—åŠ è½½åˆ°ç¼“å­˜ä¸­ï¼Œä¸€æ—¦æ•°æ®åŠ è½½å®Œæ¯•ï¼ŒCPUå¯ä»¥ç›´æ¥åœ¨ç¼“å­˜ä¸­è®¿é—®è¿™äº›æ•°æ®ï¼Œè€Œè¿™å¯¹äºå…ƒç´ åˆ†æ•£åœ¨RAMä¸­çš„é“¾è¡¨è€Œè¨€æ˜¯ä¸å¤ªå¯èƒ½å®ç°çš„ã€‚\næ— çŠ¶æ€çš„å·¥ä½œè€… å…±äº«çŠ¶æ€å¯ä»¥è¢«ç³»ç»Ÿä¸­çš„å…¶å®ƒçº¿ç¨‹ä¿®æ”¹ï¼Œå› æ­¤å·¥ä½œè€…(workers)åœ¨æ¯æ¬¡éœ€è¦å®ƒä»¬æ—¶éƒ½å¿…é¡»é‡æ–°è¯»å–è¯¥çŠ¶æ€ï¼Œä»¥ç¡®ä¿å®ƒåœ¨æœ€æ–°çš„å‰¯æœ¬ä¸Šå·¥ä½œï¼Œæ— è®ºå…±äº«çŠ¶æ€æ˜¯ä¿å­˜åœ¨å†…å­˜è¿˜æ˜¯å¤–éƒ¨æ•°æ®åº“ä¸­ï¼Œéƒ½æ˜¯å¦‚æ­¤ã€‚ä¸€ä¸ªå·¥ä½œè€…ä¸åœ¨å…¶å†…éƒ¨ä¿å­˜çŠ¶æ€ï¼ˆè€Œæ˜¯åœ¨æ¯æ¬¡éœ€è¦æ—¶éƒ½é‡æ–°è¯»å–ï¼‰ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ— çŠ¶æ€ã€‚\nä»»åŠ¡é¡ºåºçš„ä¸ç¡®å®š å¹¶è¡Œå·¥ä½œè€…æ¨¡å‹çš„å¦ä¸€ä¸ªç¼ºç‚¹æ˜¯ä»»åŠ¡æ‰§è¡Œçš„é¡ºåºæ— æ³•ç¡®å®šã€‚æ²¡æœ‰åŠæ³•æ¥ç¡®ä¿æŸä¸ªä»»åŠ¡æœ€å…ˆæ‰§è¡Œæˆ–æœ€åæ‰§è¡Œï¼Œä»»åŠ¡Aåœ¨ä»»åŠ¡Bä¹‹å‰åˆ†é…ç»™ä¸€ä¸ªå·¥ä½œè€…ï¼Œä½†æ˜¯ä»»åŠ¡Bå¯èƒ½å…ˆäºä»»åŠ¡Aæ‰§è¡Œã€‚\nå¹¶èƒ½å·¥ä½œè€…æ¨¡å‹çš„ä¸ç¡®å®šæ€§ä½¿å¾—å¾ˆéš¾åœ¨ä»»ä½•ç»™å®šçš„æ—¶é—´ç‚¹æ¨ç†ç³»ç»Ÿçš„çŠ¶æ€ï¼Œå®ƒåŒæ ·ä½¿å¾—ç¡®ä¿ä¸€ä¸ªä»»åŠ¡åœ¨å¦å¤–ä¸€ä¸ªä»»åŠ¡ä¹‹å‰æ‰§è¡Œå˜å¾—æ›´éš¾ï¼ˆå¦‚æœå¯èƒ½ï¼‰ã€‚\næµæ°´çº¿æ¨¡å‹ï¼ˆAssembly Lineï¼‰ ç¬¬äºŒç§å¹¶å‘æ¨¡å‹æˆ‘ç§°ä¹‹ä¸ºæµæ°´çº¿æ¨¡å‹ï¼Œæˆ‘é€‰æ‹©åç§°ä»¥ç¬¦åˆæ—©æœŸâ€œå¹¶è¡Œå·¥ä½œè€…â€çš„å«ä¹‰ã€‚åœ¨ä¸åŒçš„å¹³å°/ç¤¾åŒºä¸­ï¼Œå…¶ä»–çš„å¼€å‘äººå‘˜æˆ–è®¸ä½¿ç”¨å…¶å®ƒçš„åç§°ï¼Œå¦‚ååº”å¼ç³»ç»Ÿ(reactive systems)ï¼Œæˆ–äº‹ä»¶é©±åŠ¨ç³»ç»Ÿ(event driven systems)ï¼Œä¸‹å›¾æ˜¯æµæ°´çº¿å¹¶å‘æ¨¡å‹çš„ä¸€ä¸ªå±•ç¤º\nè¿™äº›å·¥ä½œè€…å°±åƒå·¥å‚é‡Œçš„å·¥äººä¸€æ ·ç»„ç»‡èµ·æ¥ï¼Œæ¯ä¸ªå·¥ä½œè€…åªå®Œæˆæ•´ä¸ªä»»åŠ¡çš„ä¸€éƒ¨åˆ†ï¼Œå½“è¯¥éƒ¨åˆ†ä»»åŠ¡å®Œæˆæ—¶ï¼Œè¯¥å·¥ä½œè€…å°†ä»»åŠ¡è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªå·¥ä½œè€…ã€‚æ¯ä¸ªå·¥ä½œè€…éƒ½åœ¨è‡ªå·±çš„çº¿ç¨‹ä¸­è¿è¡Œï¼Œå¹¶ä¸”æ²¡æœ‰ä¸å…¶å®ƒçš„å·¥ä½œè€…å…±äº«çŠ¶æ€ï¼Œå› æ­¤æµæ°´çº¿æ¨¡å‹æœ‰æ—¶ä¹Ÿè¢«ç§°ä¹‹ä¸ºæ— å…±äº«çš„å¹¶å‘æ¨¡å‹ã€‚\næµæ°´çº¿æ¨¡å‹é€šå¸¸ç”¨äºç³»ç»Ÿä¸­çš„éé˜»å¡IOæ“ä½œï¼Œéé˜»å¡IOæ„å‘³ç€å½“ä¸€ä¸ªå·¥ä½œè€…(worker)å¼€å§‹ä¸€ä¸ªIOæ“ä½œæ—¶(å¦‚ä»ç½‘ç»œè¯»å–æ–‡ä»¶æˆ–æ•°æ®)ï¼Œè¯¥å·¥ä½œè€…(worker)ä¸å¿…ç­‰å¾…IOæ“ä½œç»“æŸã€‚IOæ“ä½œé€šå¸¸è¾ƒæ…¢ï¼Œå› æ­¤ç­‰å¾…IOæ“ä½œå®Œæˆæ˜¯å¯¹CPUæ—¶é—´çš„æµªè´¹ï¼ŒCPUå¯ä»¥åœ¨æ­¤æ—¶åšä¸€äº›å…¶å®ƒäº‹æƒ…ã€‚å½“IOæ“ä½œå®Œæˆæ—¶ï¼ŒIOæ“ä½œçš„ç»“æœï¼ˆå¦‚æ•°æ®çŠ¶æ€è¯»å–æˆ–è¾“å…¥å†™å…¥ï¼‰ä¼šä¼ ç»™ä¸‹ä¸€ä¸ªå·¥ä½œè€…(worker)ã€‚\nä½¿ç”¨éé˜»å¡IOæ—¶ï¼ŒIOæ“ä½œçš„ç»“æœå†³å®šäº†å·¥ä½œè€…(worker)ä¹‹é—´çš„è¾¹ç•Œï¼Œä¸€ä¸ªå·¥ä½œè€…(worker)åœ¨ä¸å¾—ä¸å¼€å§‹IOæ“ä½œä¹‹å‰å¯ä»¥å°½å¯èƒ½çš„å®Œæˆä»»åŠ¡ï¼Œç„¶åæ”¾å¼ƒå¯¹è¯¥ä»»åŠ¡çš„æ§åˆ¶ï¼Œå½“IOæ“ä½œç»“æŸæ—¶ï¼Œåœ¨æµæ°´çº¿ä¸Šçš„å¦ä¸€ä¸ªå·¥ä½œè€…(worker)ä»¥ç±»ä¼¼çš„æ–¹å¼ç»§ç»­å®Œæˆè¯¥ä»»åŠ¡ï¼Œç›´åˆ°å®ƒä¸å¾—ä¸å¼€å§‹IOæ“ä½œã€‚\nå®é™…ä¸­ï¼Œä¸Šè¿°è¿™äº›ä»»åŠ¡å¯èƒ½ä¸ä¼šæ²¿ç€ä¸€æ¡æµæ°´çº¿æµåŠ¨ï¼Œå› ä¸ºå¤§å¤šæ•°æ“ä½œç³»ç»Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡æ ¹æ®å®é™…éœ€æ±‚æ²¿ç€æµæ°´çº¿é€ä¸ªçš„è¢«å·¥ä½œè€…å¤„ç†ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­å¯èƒ½ä¼šæœ‰å¤šä¸ªè™šæ‹Ÿæµæ°´çº¿åŒæ—¶è¿è¡Œï¼Œä¸‹å›¾å±•ç¤ºäº†åœ¨å®é™…ä½¿ç”¨ä¸­ä»»åŠ¡å¦‚ä½•åœ¨è¿™ç§æµæ°´çº¿ä¸Šæµè½¬ã€‚\nä»»åŠ¡ç”šè‡³å¯ä»¥è½¬å‘ç»™å¤šä¸ªå·¥ä½œè€…è¿›è¡Œå¹¶å‘å¤„ç†ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªä»»åŠ¡å¯ä»¥è¢«åŒæ—¶è½¬å‘ç»™ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå™¨å’Œä¸€ä¸ªä»»åŠ¡æ—¥å¿—è®°å½•å™¨ã€‚ä¸‹å›¾å±•ç¤ºäº†å¦‚ä½•å°†ä¸‰æ¡è£…é…çº¿çš„ä¸­ä»»åŠ¡è½¬å‘ç»™åŒä¸€ä¸ªå·¥ä½œè€…å®Œæˆï¼ˆä¸­é—´è£…é…çº¿ä¸Šçš„æœ€åä¸€ä¸ªå·¥äººï¼‰ï¼š\næµæ°´çº¿ç”šè‡³å¯ä»¥åšçš„æ¯”ä¸Šé¢å±•ç¤ºçš„æ›´å¤æ‚ã€‚\nå“åº”å¼ã€äº‹ä»¶é©±åŠ¨ç³»ç»Ÿ ä½¿ç”¨æµæ°´çº¿å¹¶å‘æ¨¡å‹çš„ç³»ç»Ÿæœ‰æ—¶å€™ä¹Ÿè¢«ç§°ä¹‹ä¸º å“åº”å¼ç³»ç»Ÿ æˆ– äº‹ä»¶é©±åŠ¨ç³»ç»Ÿ ã€‚ç³»ç»Ÿå·¥ä½œè€…åœ¨äº‹ä»¶å‘ç”Ÿæ—¶åšå‡ºå¯¹åº”çš„å“åº”ï¼šä»å¤–éƒ¨æ¥æ”¶æ¶ˆæ¯æˆ–è½¬å‘ç»™å…¶å®ƒå·¥ä½œè€…ç­‰ã€‚äº‹ä»¶é©±åŠ¨çš„ä¾‹å­å¯èƒ½æ˜¯ä¼ å…¥çš„HTTPè¯·æ±‚ï¼Œä¹Ÿå¯èƒ½æ˜¯æŸä¸ªæ–‡ä»¶å®ŒæˆåŠ è½½åˆ°å†…å­˜ä¸­ç­‰ã€‚\nåœ¨å†™ä½œæœ¬æ–‡æ—¶ï¼Œå·²ç»æœ‰ä¸€äº›æœ‰è¶£çš„å“åº”å¼/äº‹ä»¶é©±åŠ¨å¹³å°å¯ä»¥ä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨å°†æ¥ä¼šå‡ºç°æ›´å¤šçš„ã€‚å…¶ä¸­ä¸€äº›æ¯”è¾ƒå—æ¬¢è¿çš„å¦‚ä¸‹ï¼š\n Vert.x Akka Node.JS (JavaScript)  å¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘å‘ç°Vert.xååˆ†æœ‰è¶£(å°¤å…¶æ˜¯åƒæˆ‘è¿™ç§å¯¹Java/JVMè½ä¼çš„äºº)ã€‚\nå‚ä¸è€…(Actors)ä¸ç®¡é“(Channels)å¯¹æ¯” å‚ä¸è€…ï¼ˆActorsï¼‰å’Œç®¡é“ï¼ˆChannelsï¼‰æ˜¯ä¸¤ç§ç±»ä¼¼çš„æµæ°´çº¿ï¼ˆå“åº”å¼/äº‹ä»¶é©±åŠ¨ï¼‰æ¨¡å‹ã€‚\nåœ¨å‚ä¸è€…æ¨¡å‹ä¸­ï¼Œæ¯ä¸ªå·¥ä½œè€…è¢«ç§°ä¹‹ä¸ºä¸€ä¸ªå‚ä¸è€…ï¼Œå‚ä¸è€…ä¹‹é—´å¯ä»¥ç›´æ¥å‘æ¶ˆæ¯ç»™å¯¹æ–¹ï¼Œè¿™äº›æ¶ˆæ¯ä»¥å¼‚æ­¥æ–¹å¼æ¥å‘é€å’Œå¤„ç†ã€‚å‚ä¸è€…å¯ä»¥ç”¨äºå¤„ç†å¦‚å‰æ‰€è¿°çš„ä¸€ä¸ªæˆ–å¤šä¸ªæµæ°´çº¿ä»»åŠ¡ï¼Œä¸‹å›¾å±•ç¤ºäº†è¿™ç§æ¨¡å‹ï¼š\nåœ¨ç®¡é“(Channel)æ¨¡å‹ä¸­ï¼Œå·¥ä½œè€…ä¹‹é—´ä¸ç›´æ¥äº’ç›¸æ²Ÿé€šï¼Œç›¸ååœ°ï¼Œä»–ä»¬ä¼šå°†æ¶ˆæ¯å‘å¸ƒåˆ°ä¸åŒçš„ç®¡é“ä¸­ï¼Œå…¶ä»–çš„å·¥ä½œè€…å¯ä»¥åœ¨è¿™äº›ç®¡é“ä¸Šæ”¶å¬æ¶ˆæ¯ï¼ŒåŒæ—¶æ¶ˆæ¯å‘é€è€…ä¸å¿…çŸ¥é“è°åœ¨æ”¶å¬æ¶ˆæ¯ã€‚ä¸‹å›¾å±•ç¤ºäº†è¯¥æ¨¡å‹ï¼š\nåœ¨å†™ä½œæœ¬æ–‡æ—¶ï¼Œç®¡é“æ¨¡å‹å¯¹æˆ‘è€Œè¨€ä¼¼ä¹æ›´çµæ´»ï¼šä¸€ä¸ªå·¥ä½œè€…ä¸å¿…çŸ¥é“åœ¨æµæ°´çº¿ä¸Šçš„å“ªä¸ªå·¥ä½œè€…è¦å¤„ç†æ¥ä¸‹æ¥çš„ä»»åŠ¡ï¼Œå®ƒåªéœ€è¦çŸ¥é“éœ€è¦å°†ä»»åŠ¡è½¬å‘åˆ°å“ªä¸ªç®¡é“ï¼ˆæˆ–å‘é€æ¶ˆæ¯å“ªä¸ªç®¡é“ç­‰ï¼‰ï¼Œåœ¨ç®¡é“ä¸­çš„æ”¶å¬è€…å¯ä»¥è®¢é˜…å’Œå–æ¶ˆè®¢é˜…è€Œä¸ä¼šå½±å“åˆ°å¾€ç®¡é“ä¸­æ­£åœ¨å†™å…¥çš„å·¥ä½œè€…ï¼Œè¿™å…è®¸å·¥ä½œè€…ä¹‹é—´æœ‰æŸç§ç¨‹åº¦çš„ä½è€¦åˆã€‚\næµæ°´çº¿æ¨¡å‹ï¼ˆAssembly Lineï¼‰çš„ä¼˜ç‚¹ ç›¸å¯¹äºå¹¶è¡Œå·¥ä½œè€…æ¨¡å‹ï¼Œæµæ°´çº¿æ¨¡å‹æœ‰ä¸€äº›ä¼˜ç‚¹ï¼Œåœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†ï¼Œæˆ‘ä¼šå™è¿°å…¶ä¸­æœ€çªå‡ºçš„å‡ ä¸ªä¼˜ç‚¹ã€‚\næ— å…±äº«çŠ¶æ€ å·¥ä½œè€…ä¹‹é—´ä¸å…±äº«çŠ¶æ€çš„æƒ…å½¢æ„å‘³ç€å®ƒä»¬å¯ä»¥åœ¨å®ç°æ—¶ä¸å¿…è€ƒè™‘åœ¨çŠ¶æ€å…±äº«æ—¶æ‰€é‡åˆ°çš„å„ç§å¹¶å‘é—®é¢˜ï¼Œè¿™è®©å·¥ä½œè€…çš„å®ç°å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œåœ¨å®ç°å·¥ä½œè€…æ—¶å¯ä»¥å‡è®¾åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å¤„ç†è¯¥å·¥ä½œï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå•çº¿ç¨‹å®ç°ã€‚\næœ‰çŠ¶æ€çš„å·¥ä½œè€… ç”±äºå·¥ä½œè€…çŸ¥é“æ²¡æœ‰å…¶å®ƒçº¿ç¨‹ä¿®æ”¹å®ƒä»¬çš„æ•°æ®ï¼Œè¿™äº›å·¥ä½œè€…å¯ä»¥å…·æœ‰çŠ¶æ€ã€‚åœ¨è¯´æœ‰çŠ¶æ€æ—¶æˆ‘çš„æ„æ€æ˜¯å®ƒä»¬å¯ä»¥ä¿ç•™åœ¨å†…å­˜ä¸­æ“ä½œæ‰€éœ€çš„æ•°æ®ï¼Œåªæœ‰å†™å…¥æ‰ä¼šæ”¹å˜æœ€ç»ˆçš„å¤–éƒ¨å­˜å‚¨ç³»ç»Ÿã€‚å› æ­¤ï¼Œä¸€ä¸ªæœ‰çŠ¶æ€çš„å·¥ä½œè€…é€šå¸¸æ¯”æ— çŠ¶æ€çš„å·¥ä½œè€…æ‰§è¡Œæ›´å¿«ã€‚\næ›´å¥½çš„ç¡¬ä»¶ååŒ å•çº¿ç¨‹ä»£ç çš„ä¼˜ç‚¹åœ¨äºå®ƒé€šå¸¸æ›´ç¬¦åˆåº•å±‚ç¡¬ä»¶çš„å·¥ä½œåŸç†ã€‚é¦–å…ˆä½ é€šå¸¸å¯ä»¥åˆ›å»ºæ›´ä¼˜åŒ–çš„æ•°æ®ç»“æ„å’Œç®—æ³•å½“ä½ èƒ½å‡å®šä»£ç ä¼šä»¥å•çº¿ç¨‹æ¨¡å¼æ‰§è¡Œã€‚\nå…¶æ¬¡,å¦‚å‰æ‰€è¿°å•çº¿ç¨‹æœ‰çŠ¶æ€çš„å·¥ä½œè€…å¯ä»¥åœ¨å†…å­˜ä¸­ç¼“å­˜æ•°æ®ï¼Œå½“æ•°æ®åœ¨å†…å­˜ä¸­ç¼“å­˜æ—¶ï¼Œæœ‰å¾ˆå¤§çš„æ¦‚ç‡è¯¥æ•°æ®ä¹Ÿä¼šè¢«ç¼“å­˜åˆ°CPUç¼“å­˜ä¸­ï¼Œè¿™æ ·æ•°æ®è·å–å˜å¾—æ›´å¿«ã€‚\nå½“ä»£ç ä»¥ä¸€ç§è‡ªç„¶å—ç›Šäºåº•å±‚ç¡¬ä»¶å·¥ä½œåŸç†çš„æ–¹å¼ç¼–å†™æ—¶ï¼Œæˆ‘ç§°ä¹‹ä¸º ç¡¬ä»¶åè°ƒï¼Œæœ‰äº›å¼€å‘è€…ç§°ä¹‹ä¸ºmechanical sympathyï¼Œæˆ‘æ›´å€¾å‘äºç¡¬ä»¶ååŒå› ä¸ºè®¡ç®—æœºåªæœ‰å¾ˆå°‘çš„æœºæ¢°éƒ¨ä»¶ï¼ŒåŒæ—¶å•è¯sympathyåœ¨è¿™ç§æƒ…å†µä¸‹è¢«ç”¨ä½œæ¯”å–»â€œæ›´é«˜çš„åŒ¹é…â€ï¼Œè€Œæˆ‘è®¤ä¸ºå•è¯conformèƒ½æ›´é«˜çš„ä¼ è¾¾å…¶å«ä¹‰ã€‚ä¸ç®¡æ€ä¹ˆè¯´ï¼Œè¿™äº›éƒ½æ˜¯å¹æ¯›æ±‚ç–µï¼Œå¯ä»¥ä½¿ç”¨ä½ å–œæ¬¢çš„ä»»ä½•æœ¯è¯­æ¥æè¿°ã€‚\nä»»åŠ¡å¯æ’åº æ ¹æ®æµæ°´çº¿æ¨¡å‹å®ç°çš„å¹¶å‘ç³»ç»Ÿä½¿å¾—æ’åºå˜å¾—å¯èƒ½ï¼Œä»»åŠ¡æ’åºä½¿å¾—åœ¨ä»»ä½•ç»™å®šæ—¶é—´ç‚¹æ›´å®¹æ˜“ç†è§£ç³»ç»Ÿçš„çŠ¶æ€ã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥å°†æ‰€æœ‰ä¼ å…¥çš„ä»»åŠ¡å†™å…¥æ—¥å¿—ï¼Œå¦‚æœç³»ç»Ÿçš„ä»»ä½•éƒ¨åˆ†å‘ç”Ÿæ•…éšœï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¯¥æ—¥å¿—ä»å¤´é‡å»ºç³»ç»Ÿçš„çŠ¶æ€ã€‚è¿™äº›ä»»åŠ¡ä»¥æŸç§é¡ºåºå†™å…¥æ—¥å¿—ï¼Œè¿™ä¸ªé¡ºåºç§°ä¸ºè¯¥ä»»åŠ¡é¡ºåºï¼Œä¸‹å›¾å±•ç¤ºäº†è¿™ç§è®¾ç½®å¦‚ä½•å®ç°ï¼š ç¡®ä¿ä¸€ä¸ªä»»åŠ¡çš„é¡ºåºå®ç°èµ·æ¥ä¸ä¸€å®šå®¹æ˜“ï¼Œä½†é€šå¸¸æ˜¯å¯èƒ½çš„ã€‚å¦‚æœä½ å¯ä»¥å®ç°çš„è¯ï¼Œå®ƒå°†ä¼šå¤§å¤§ç®€åŒ–ç±»ä¼¼äºæ•°æ®å¤‡ä»½ã€æ¢å¤æ•°æ®ã€å¤åˆ¶æ•°æ®ç­‰çš„ä»»åŠ¡ï¼Œè¿™äº›éƒ½å¯ä»¥é€šè¿‡æ—¥å¿—æ–‡ä»¶æ¥å®Œæˆã€‚\næµæ°´çº¿æ¨¡å‹ï¼ˆAssembly Lineï¼‰çš„ç¼ºç‚¹ æµæ°´çº¿æ¨¡å‹çš„æœ€ä¸»è¦ç¼ºç‚¹æ˜¯é€šå¸¸å°†æ‰§è¡Œä¸€ä¸ªä»»åŠ¡åˆ†é…åˆ°å¤šä¸ªå·¥ä½œè€…ï¼Œå› æ­¤ï¼Œå½“é¡¹ç›®ä¸­æœ‰å¤šä¸ªç±»æ—¶ï¼Œå°†éš¾ä»¥å‡†ç¡®çš„çœ‹å‡ºå“ªæ®µä»£ç åœ¨æ‰§è¡Œç»™å®šçš„ä»»åŠ¡ã€‚\nä»£ç ç¼–å†™ä¹Ÿå¯èƒ½ä¼šå˜å¾—æ›´éš¾ï¼Œå·¥ä½œè€…ä»£ç æœ‰æ—¶å€™è¢«å†™ä½œå›è°ƒå¤„ç†å™¨(callback handlers)ã€‚åœ¨ä»£ç ä¸­æœ‰å¤ªå¤šåµŒå¥—çš„å›è°ƒå¤„ç†å™¨æ—¶å¯èƒ½ä¼šå¯¼è‡´æŸäº›å¼€å‘äººå‘˜æ‰€è°“çš„ å›è°ƒé™·é˜±(callback hell) ã€‚å›è°ƒé™·é˜±ç®€å•çš„è¯´å°±æ˜¯åœ¨æ‰€æœ‰çš„å›è°ƒä¸­å¾ˆéš¾è¿½è¸ªä»£ç çœŸæ­£åœ¨å¹²å•¥ä»¥åŠç¡®ä¿æ¯ä¸ªå›è°ƒéƒ½å¯ä»¥è®¿é—®å®ƒéœ€è¦çš„æ•°æ®ã€‚\nè€Œä½¿ç”¨å¹¶è¡Œå·¥ä½œè€…æ¨¡å‹ï¼Œè¿™å¾€å¾€å¾ˆå®¹æ˜“ã€‚ä½ å¯ä»¥æ‰“å¼€å¯¹åº”çš„å·¥ä½œè€…ä»£ç ï¼Œå¹¶ä»å¤´åˆ°å°¾è¯»å–è¦æ‰§è¡Œçš„ä»£ç ã€‚å½“ç„¶ï¼Œå¹¶è¡Œå·¥ä½œè€…æ¨¡å‹ä¹Ÿå¯èƒ½ä¼ æ’­åˆ°ä¸åŒçš„ç±»ä¸­ï¼Œä½†æ˜¯è¦æ‰§è¡Œçš„åºåˆ—é€šå¸¸æ›´å®¹æ˜“ä»ä»£ç ä¸­è¯»å–ã€‚\nåŠŸèƒ½å¹¶è¡Œ(Functional Parallelism)æ¨¡å‹ åŠŸèƒ½\\å‡½æ•°å¹¶è¡Œæ¨¡å‹æ˜¯ç¬¬ä¸‰ç§å¹¶å‘æ¨¡å‹ï¼Œæœ€è¿‘è°ˆè®ºå¾—å¾ˆå¤š(2015)ã€‚\nåŠŸèƒ½\\å‡½æ•°å¹¶è¡Œæ€§çš„åŸºæœ¬æ€æƒ³æ˜¯é€šè¿‡å‡½æ•°è°ƒç”¨å®ç°ç¨‹åºï¼ŒåŠŸèƒ½å¯ä»¥è¢«çœ‹ä½œæ˜¯å‘é€æ¶ˆæ¯åˆ°å½¼æ­¤çš„â€œä»£ç†â€æˆ–â€œè§’è‰²â€ï¼Œå°±åƒæµæ°´çº¿å¹¶å‘æ¨¡å‹ï¼ˆAKAååº”æˆ–äº‹ä»¶é©±åŠ¨ç³»ç»Ÿï¼‰ä¸€æ ·ï¼Œå½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œç±»ä¼¼äºæ¶ˆæ¯å‘é€ã€‚\nä¼ é€’ç»™å‡½æ•°çš„æ‰€æœ‰å‚æ•°éƒ½è¢«å¤åˆ¶ï¼Œæ‰€ä»¥åœ¨æ¥æ”¶å‡½æ•°ä¹‹å¤–æ²¡æœ‰ä»»ä½•å®ä½“å¯ä»¥æ“çºµæ•°æ®ï¼Œè¿™ç§å¤åˆ¶å¯¹äºå¯¹äºé¿å…å…±äº«æ•°æ®çš„æ¡ä»¶ç«äº‰è‡³å…³é‡è¦ï¼Œå®ƒä½¿å¾—å‡½æ•°æ‰§è¡Œç±»ä¼¼äºåŸå­æ“ä½œï¼Œæ¯ä¸ªå‡½æ•°è°ƒç”¨éƒ½å¯ä»¥ç‹¬ç«‹äºä»»ä½•å…¶ä»–å‡½æ•°è°ƒç”¨æ‰§è¡Œã€‚\nå½“æ¯ä¸ªå‡½æ•°è°ƒç”¨å¯ä»¥ç‹¬ç«‹æ‰§è¡Œæ—¶ï¼Œå¯ä»¥åœ¨å•ç‹¬çš„CPUä¸Šæ‰§è¡Œæ¯ä¸ªå‡½æ•°è°ƒç”¨ï¼Œè¿™æ„å‘³ç€ï¼Œåœ¨å¤šä¸ªCPUä¸Šå¯ä»¥å¹¶è¡Œæ‰§è¡ŒåŠŸèƒ½å®ç°çš„ç®—æ³•ã€‚\nä½¿ç”¨Java 7ï¼Œæˆ‘ä»¬å¾—åˆ°äº†åŒ…å«ForkJoinPoolæ¨¡å‹çš„ java.util.concurrent åŒ…ï¼Œå¯ä»¥å¸®åŠ©æ‚¨å®ç°ç±»ä¼¼äºåŠŸèƒ½å¹¶è¡Œæ€§çš„åŠŸèƒ½ï¼Œè€Œä½¿ç”¨Java 8ï¼Œæˆ‘ä»¬å°†å¾—åˆ°å¹¶è¡Œæµï¼Œå¯ä»¥å¸®åŠ©æ‚¨å¹¶è¡ŒåŒ–å¤§å‹é›†åˆçš„è¿­ä»£ã€‚è¯·è®°ä½ï¼Œæœ‰å¼€å‘äººå‘˜æ‰¹è¯„ForkAndJoinPoolæ¨¡å‹ï¼ˆæ‚¨å¯ä»¥åœ¨æˆ‘çš„ForkAndJoinPoolæ•™ç¨‹ä¸­æ‰¾åˆ°ä¸€ä¸ªç›¸åº”çš„æ‰¹è¯„é“¾æ¥ï¼‰ã€‚\nå…³äºåŠŸèƒ½\\å‡½æ•°å¹¶è¡Œçš„éš¾ç‚¹åœ¨äºçŸ¥é“å“ªä¸ªå‡½æ•°è°ƒç”¨éœ€è¦å¹¶è¡ŒåŒ–ï¼Œè·¨CPUçš„åè°ƒåŠŸèƒ½è°ƒç”¨å¸¦æ¥äº†ä¸€å®šçš„å¼€é”€ã€‚åªæœ‰ç”±åŠŸèƒ½/å‡½æ•°å®Œæˆçš„å·¥ä½œå•ä½å…·æœ‰ä¸€å®šçš„å¤§å°ï¼Œæ‰èƒ½å€¼å¾—è¿™ä¸ªå¼€é”€ï¼Œå¦‚æœå‡½æ•°è°ƒç”¨éå¸¸å°ï¼Œå°è¯•å¹¶è¡ŒåŒ–å®ƒä»¬å¯èƒ½æ¯”å•ä¸ªçº¿ç¨‹çš„å•ä¸ªCPUæ‰§è¡Œæ›´æ…¢ã€‚\nä»æˆ‘çš„ç†è§£ï¼ˆäº‹å®ä¸Šæ ¹æœ¬ä¸å®Œç¾ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨äº‹ä»¶å“åº”é©±åŠ¨æ¨¡å‹æ¥å®ç°å®ç°ç®—æ³•ï¼Œå¹¶å®ç°ä¸åŠŸèƒ½å¹¶è¡Œæ€§ç›¸ä¼¼çš„å·¥ä½œåˆ†è§£ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œé€šè¿‡äº‹ä»¶å“åº”é©±åŠ¨æ¨¡å‹ï¼Œä½ å¯ä»¥æŒæ¡å¦‚ä½•æ¥å®ç°å¹¶è¡ŒåŒ–ã€‚\nå¦å¤–ï¼Œåªæœ‰å½“å‰ä»»åŠ¡æ˜¯ç¨‹åºæ‰§è¡Œçš„å”¯ä¸€ä»»åŠ¡æ—¶ï¼Œå°†ä»»åŠ¡åˆ†é…ç»™å¤šä¸ªCPUï¼Œåè°ƒå¼€é”€æ‰æœ‰æ„ä¹‰ã€‚ç„¶è€Œï¼Œå¦‚æœç³»ç»ŸåŒæ—¶æ‰§è¡Œå¤šä¸ªå…¶ä»–ä»»åŠ¡ï¼ˆå¦‚WebæœåŠ¡å™¨ï¼Œæ•°æ®åº“æœåŠ¡å™¨å’Œè®¸å¤šå…¶å®ƒç³»ç»Ÿï¼‰ï¼Œåˆ™æ— éœ€å°è¯•å¹¶è¡ŒåŒ–å•ä¸ªä»»åŠ¡ã€‚è®¡ç®—æœºä¸­çš„å…¶å®ƒCPUå¯èƒ½æ­£åœ¨å¿™äºå¤„ç†å…¶å®ƒä»»åŠ¡ï¼Œæ‰€ä»¥æ²¡æœ‰ç†ç”±è¯•å›¾ç”¨è¾ƒæ…¢çš„åŠŸèƒ½å¹¶è¡Œä»»åŠ¡æ¥æ‰“æ‰°ä»–ä»¬ã€‚å¦‚æœ‰å¯èƒ½ï¼Œä½ æœ€å¥½ä½¿ç”¨æµæ°´çº¿å¹¶å‘æ¨¡å‹ï¼Œå› ä¸ºå®ƒåœ¨ä»¥å•çº¿ç¨‹æ¨¡å¼é¡ºåºæ‰§è¡Œçš„ç¨‹åºä¸­å…·æœ‰æ›´å°‘çš„å¼€é”€ï¼Œå¹¶ä¸”æ›´å¥½çš„ç¬¦åˆåº•å±‚ç¡¬ä»¶çš„å·¥ä½œåŸç†ã€‚\nå­°ä¼˜å­°åŠ£ é‚£ä¹ˆï¼Œå“ªç§å¹¶å‘æ¨¡å‹æ›´å¥½å‘¢ï¼Ÿ\né€šå¸¸æƒ…å†µä¸‹ï¼Œç­”æ¡ˆå–å†³äºä½ çš„ç³»ç»Ÿåº”è¯¥åšä»€ä¹ˆã€‚ å¦‚æœä½ çš„å·¥ä½œè‡ªç„¶å¹¶è¡Œï¼Œç‹¬ç«‹ï¼Œæ— éœ€å…±äº«çŠ¶æ€ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¹¶è¡Œå·¥ä½œæ¨¡å‹æ¥å®ç°ç³»ç»Ÿã€‚ä½†è®¸å¤šä»»åŠ¡ä¸æ˜¯è‡ªç„¶å¹¶è¡Œå’Œç‹¬ç«‹çš„ï¼Œå¯¹äºè¿™äº›ç±»å‹çš„ç³»ç»Ÿï¼Œæˆ‘ç›¸ä¿¡æµæ°´çº¿å¹¶å‘æ¨¡å‹æ¯”ç¼ºç‚¹æœ‰æ›´å¤šçš„ä¼˜ç‚¹ï¼Œæ¯”å¹¶è¡Œå·¥ä½œæ¨¡å‹æ›´æœ‰ä¼˜åŠ¿ã€‚ä½ ç”šè‡³ä¸éœ€è¦è‡ªå·±ç¼–å†™æ‰€æœ‰çš„æµæ°´çº¿è·¯åŸºç¡€è®¾æ–½ï¼ŒåƒVert.xè¿™æ ·çš„ç°ä»£å¹³å°ä¸ºä½ å·²ç»å®ç°äº†å¾ˆå¤šã€‚ å°±ä¸ªäººè€Œè¨€ï¼Œæˆ‘å°†æ¢ç´¢åœ¨Vert.xç­‰å¹³å°ä¸Šè¿è¡Œçš„è®¾è®¡ï¼Œä»¥ä¾¿æˆ‘çš„ä¸‹ä¸€ä¸ªé¡¹ç›®ã€‚æˆ‘ä¸ªäººæ„Ÿè§‰JavaEEæ²¡æœ‰å°½å¤´ã€‚\n\u0026lt;â€“ç¿»è¯‘ç»“æŸ!â€“\u0026gt;\n","permalink":"http://isouthrain.github.io/post/translate/java-concurrency/concurrency-models/","tags":["Java","Java Concurrency"],"title":"4. [è¯‘]å¹¶å‘çš„æ¨¡å‹"},{"categories":["Webç¼–ç¨‹","å·¥å…·ä½¿ç”¨"],"contents":"ç”±äºä¸šåŠ¡è¦æ±‚ï¼Œéœ€è¦åœ¨åˆ©ç”¨MyEclipseä¸­å¼€å‘çš„Webé¡¹ç›®ä¸­æ·»åŠ BirtæŠ¥è¡¨ç»Ÿè®¡åŠŸèƒ½ï¼Œæ–°å»ºå®Œä¸€ä¸ªreport.rptdesignæ–‡ä»¶ååŒå‡»è¯¥æ–‡ä»¶å‡ºç°å¦‚ä¸‹é”™è¯¯:\né”™è¯¯ä¿¡æ¯æç¤ºMyEclipseæ— æ³•æ‰“å¼€BirtæŠ¥è¡¨ç¼–è¾‘å™¨ï¼Œå¯¹äºæ­¤ç§æƒ…å†µï¼Œç½‘ä¸Šæœç´¢ç›¸åº”çš„è§£å†³æ–¹æ¡ˆåä¸€èˆ¬éƒ½è®©æˆ‘ä»¬ç»™è¯¥é¡¹ç›®æ·»åŠ æŠ¥è¡¨æ”¯æŒï¼Œå³é€‰ä¸­è¯¥é¡¹ç›®ï¼Œç„¶åå³é”®MyEclipse -\u0026gt; Add Report Capabilitiesæ¥å¯¹è¯¥é¡¹ç›®æ·»åŠ BirtæŠ¥è¡¨æ”¯æŒã€‚æ­¤ç§æ–¹å¼è™½èƒ½è§£å†³é—®é¢˜ï¼Œä½†å´åŒæ—¶é¢å¤–çš„å¼•å…¥äº†ç³»ç»Ÿå†…ç½®çš„Birt jaråŒ…å’Œç›¸åº”çš„reportæ–‡ä»¶å¤¹ï¼Œç»™æˆ‘ä»¬çš„é¡¹ç›®é€ æˆäº†ä¸€å®šçš„å¹²æ‰°ã€‚\nåˆ†æä¸Šè¿°æ·»åŠ å®ŒBirtæŠ¥è¡¨æ”¯æŒçš„é¡¹ç›®æ–‡ä»¶åï¼Œå¯å‘ç°ä¸æ™®é€šçš„Java Webé¡¹ç›®ç›¸æ¯” .projectæ–‡ä»¶åœ¨naturesä¸‹é¢å¤šäº†ä¸€ä¸ª com.genuitec.eclipse.reporting.reportnatureçš„é…ç½®é¡¹ï¼Œè€Œè¯¥é…ç½®é¡¹æ­£æ˜¯ç”¨äºåœ¨é¡¹ç›®ä¸­æ”¯æŒBirtæŠ¥è¡¨æ“ä½œã€‚æ®æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¦å¤–ä¸€ä¸ªæ–¹å¼æ¥è§£å†³åœ¨MyEclipseä¸­æ— æ³•æ‰“å¼€BirtæŠ¥è¡¨çš„é—®é¢˜ï¼š\n å°† com.genuitec.eclipse.reporting.reportnatureé…ç½®é¡¹æ·»åŠ åˆ°å½“å‰é¡¹ç›®.projectæ–‡ä»¶çš„naturesé…ç½®é¡¹ä¸‹é¢\n å¦‚ä¸‹æ‰€ç¤º:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;projectDescription\u0026gt; \u0026lt;name\u0026gt;teq\u0026lt;/name\u0026gt; \u0026lt;comment\u0026gt;\u0026lt;/comment\u0026gt; \u0026lt;projects\u0026gt; \u0026lt;/projects\u0026gt; \u0026lt;buildSpec\u0026gt; ... \u0026lt;/buildSpec\u0026gt; \u0026lt;natures\u0026gt; \u0026lt;!--æ·»åŠ æŠ¥è¡¨æ”¯æŒ --\u0026gt; \u0026lt;nature\u0026gt;com.genuitec.eclipse.reporting.reportnature\u0026lt;/nature\u0026gt; \u0026lt;nature\u0026gt;com.genuitec.eclipse.j2eedt.core.webnature\u0026lt;/nature\u0026gt; \u0026lt;nature\u0026gt;org.eclipse.jdt.core.javanature\u0026lt;/nature\u0026gt; \u0026lt;nature\u0026gt;org.eclipse.wst.jsdt.core.jsNature\u0026lt;/nature\u0026gt; \u0026lt;/natures\u0026gt; \u0026lt;/projectDescription\u0026gt;   åˆ©ç”¨æ­¤ç§æ–¹å¼æ—¢å¯è§£å†³æ— æ³•æ‰“å¼€BirtæŠ¥è¡¨é—®é¢˜ï¼Œåˆèƒ½é¿å…æ·»åŠ å†—ä½™çš„jaræ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œç»™æˆ‘ä»¬çš„å¼€å‘çœå»ä¸å¿…è¦çš„éº»çƒ¦ã€‚\n","permalink":"http://isouthrain.github.io/post/web/cannot-open-birt-report-in-myeclipse-project/","tags":["Birt"],"title":"åœ¨MyEclipseé¡¹ç›®ä¸­ä¸èƒ½æ‰“å¼€birtæŠ¥è¡¨çš„è§£å†³æ–¹æ³•"},{"categories":["Javaç¼–ç¨‹","ç¿»è¯‘"],"contents":"æœ¬æ–‡ç¿»è¯‘è‡ªJava Concurrency / Multithreading Costs\nä»ä¸€ä¸ªå•çº¿ç¨‹ç¨‹åºåˆ‡æ¢ä¸ºå¤šçº¿ç¨‹ç¨‹åºåœ¨ç»™æˆ‘ä»¬å¸¦æ¥å¥½å¤„çš„åŒæ—¶ä¹Ÿä¼šäº§ç”Ÿä¸€äº›é¢å¤–çš„æˆæœ¬ï¼Œä¸è¦å› ä¸ºä¼šä½¿ç”¨å¤šçº¿ç¨‹å°±å°†ä¸€ä¸ªç¨‹åºå˜ä¸ºå¤šçº¿ç¨‹å®ç°ã€‚åœ¨å‡†å¤‡ä½¿ç”¨å¤šçº¿ç¨‹æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥æœ‰ä¸€ä¸ªæ¸…æ¥šçš„è®¤è¯†ï¼šä½¿ç”¨å¤šçº¿ç¨‹å¸¦æ¥çš„å¥½å¤„å¤§äºå…¶æˆæœ¬ï¼Œå½“æœ‰ä¸ç¡®å®šæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å°è¯•åº¦é‡åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œå“åº”æ€§æ¥å†³å®šæ˜¯å¦é‡‡ç”¨å¤šçº¿ç¨‹ï¼Œè€Œä¸æ˜¯é çŒœæ¥å†³å®šã€‚\næ›´å¤æ‚çš„è®¾è®¡ å°½ç®¡å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºçš„æŸäº›éƒ¨åˆ†æ¯”å•çº¿ç¨‹åº”ç”¨ç¨‹åºæ›´ç®€å•ï¼Œä½†å…¶å®ƒéƒ¨åˆ†å´æ›´ä¸ºå¤æ‚ã€‚åœ¨æ‰§è¡Œé€šè¿‡å¤šçº¿ç¨‹è®¿é—®å…±äº«æ•°æ®æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼ŒåŒæ—¶å¤šçº¿ç¨‹é—´çš„äº¤äº’ä¹Ÿä¸æ˜¯é‚£ä¹ˆç®€å•,ç”±ä¸æ­£ç¡®çš„çº¿ç¨‹åŒæ­¥å¼•èµ·çš„é”™è¯¯å¯èƒ½ä¼šéå¸¸éš¾ä»¥æ£€æµ‹ã€å¤ç°å’Œä¿®å¤ã€‚\nä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ å½“CPUä»æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹åˆ‡æ¢åˆ°æ‰§è¡Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼ŒCPUéœ€è¦ä¿å­˜å½“å‰çº¿ç¨‹çš„æœ¬åœ°æ•°æ®ï¼Œç¨‹åºæŒ‡é’ˆç­‰ï¼Œå¹¶åŠ è½½ä¸‹ä¸€ä¸ªçº¿ç¨‹çš„æœ¬åœ°æ•°æ®ï¼Œç¨‹åºæŒ‡é’ˆç­‰æ¥æ‰§è¡Œçº¿ç¨‹ï¼Œè¿™ç§åˆ‡æ¢è¢«ç§°ä½œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒCPUä»ä¸€ä¸ªçº¿ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œåˆ‡æ¢åˆ°åœ¨å¦ä¸€ä¸ªçº¿ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚\nä¸Šä¸‹æ–‡åˆ‡æ¢çš„ä»£ä»·å¹¶ä¸ä¾¿å®œï¼Œåœ¨çº¿ç¨‹é—´è¦é¿å…ä¸å¿…è¦çš„åˆ‡æ¢ã€‚å¯ä»¥åœ¨ç»´åŸºç™¾ç§‘ä¸Šé˜…è¯» Context switchæ¥äº†è§£æ›´å¤šå…³äºä¸Šä¸‹æ–‡åˆ‡æ¢çš„çŸ¥è¯†ã€‚\nåŠ é‡èµ„æºæ¶ˆè€— çº¿ç¨‹éœ€è¦è®¡ç®—æœºçš„ä¸€äº›èµ„æºæ‰èƒ½è¿è¡Œï¼Œé™¤äº†CPUæ—¶é—´ä¹‹å¤–ï¼Œçº¿ç¨‹éœ€è¦ä¸€äº›å†…å­˜æ¥ç»´æŠ¤å…¶æœ¬åœ°å †æ ˆï¼Œå®ƒä¹Ÿå¯èƒ½ä¼šå ç”¨æ“ä½œç³»ç»Ÿçš„ä¸€äº›èµ„æºæ¥ç®¡ç†è¯¥çº¿ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•åˆ›å»º100ä¸ªä»€ä¹ˆæ“ä½œä¹Ÿæ²¡æœ‰çš„ç­‰å¾…çº¿ç¨‹æ¥çœ‹çœ‹åœ¨è¿è¡Œè¿™äº›çº¿ç¨‹æ—¶åº”ç”¨ç¨‹åºéœ€è¦å¤šå°‘å†…å­˜ã€‚\n\u0026lt;â€“ç¿»è¯‘ç»“æŸ!â€“\u0026gt;\n","permalink":"http://isouthrain.github.io/post/translate/java-concurrency/multithreading-costs/","tags":["Java","Java Concurrency"],"title":"3. [è¯‘]å¤šçº¿ç¨‹çš„æˆæœ¬"},{"categories":["Javaç¼–ç¨‹","ç¿»è¯‘"],"contents":"æœ¬æ–‡ç¿»è¯‘è‡ªJava Concurrency / Multithreading Benefits\nå°½ç®¡å¤šçº¿ç¨‹ç»™ç¨‹åºå®ç°å¸¦æ¥äº†æŒ‘æˆ˜ï¼Œä½†ç”±äºå¤šçº¿ç¨‹çš„ä¸€äº›ä¼˜ç‚¹æˆ‘ä»¬ä»ç„¶åœ¨ä½¿ç”¨å®ƒï¼Œå…¶ä¸­çš„ä¸€äº›ä¼˜ç‚¹å¦‚ä¸‹ï¼š\n æ›´å¥½çš„èµ„æºåˆ©ç”¨ åœ¨æŸäº›åœºæ™¯å¯ä»¥ç®€åŒ–ç¨‹åºè®¾è®¡ æé«˜ç¨‹åºå“åº”  æ›´å¥½çš„èµ„æºåˆ©ç”¨ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¨‹åºä»æœ¬åœ°ç£ç›˜ä¸­è¯»å–å’Œå¤„ç†æ–‡ä»¶ï¼Œè‹¥è¯»å–å’Œå¤„ç†ä¸€ä¸ªæ–‡ä»¶çš„è€—æ—¶åˆ†åˆ«ä¸º5ç§’é’Ÿå’Œ2ç§’é’Ÿï¼Œåˆ™è¯»å–å¤„ç†2ä¸ªæ–‡ä»¶çš„è€—æ—¶å¦‚ä¸‹ï¼š\n1 2 3 4 5 6  5 seconds reading file A 2 seconds processing file A 5 seconds reading file B 2 seconds processing file B ----------------------- 14 seconds total//ä¸²è¡Œè¯»å–æ—¶æ€»å…±è€—æ—¶14ç§’   å½“ä»ç£ç›˜è¯»å–æ–‡ä»¶æ—¶CPUçš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±è´¹åœ¨ç­‰å¾…ä»ç£ç›˜è¯»å–æ•°æ®ï¼Œåœ¨æ­¤æœŸé—´CPUå¤§éƒ¨åˆ†æ—¶é—´éƒ½å¤„äºç©ºé—²çŠ¶æ€ã€‚è¿™äº›ç©ºé—²æ—¶é—´å¯ä»¥åšä¸€äº›å…¶å®ƒçš„äº‹æƒ…ï¼Œé€šè¿‡æ”¹å˜æ“ä½œé¡ºåºï¼ŒCPUå¯ä»¥è¢«æ›´å¥½çš„åˆ©ç”¨ï¼Œå¦‚ä¸‹é¢çš„åˆ—å­ï¼š\n1 2 3 4 5  5 seconds reading file A 5 seconds reading file B + 2 seconds processing file A 2 seconds processing file B ----------------------- 12 seconds total//å¹¶è¡Œè¯»å–æ—¶æ€»å…±è€—æ—¶12ç§’   åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒCPUå…ˆç­‰å¾…è¯»å–ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå¼€å§‹è¯»å–ç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œåœ¨è¯»å–ç¬¬äºŒä¸ªæ–‡ä»¶çš„åŒæ—¶ï¼ŒCPUå¯ä»¥åŒæ—¶å¤„ç†ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚è¯·è®°ä½ï¼Œå½“ç­‰å¾…ä»ç£ç›˜è¯»å–æ•°æ®æ—¶ï¼ŒCPUå¤§éƒ¨åˆ†æ—¶é—´å¤„äºç©ºé—²çŠ¶æ€ï¼\né€šå¸¸æƒ…å†µä¸‹ï¼ŒCPUåœ¨ç­‰å¾…IOå“åº”æ—¶å¯ä»¥åšä¸€äº›å…¶å®ƒäº‹æƒ…ï¼Œè¿™ä¸ä»…é€‚ç”¨äºç£ç›˜IOæ“ä½œï¼Œä¹Ÿé€‚ç”¨äºç½‘ç»œIOæ“ä½œï¼Œæˆ–è€…è¯»å–ç”¨æˆ·è¾“å…¥,ç½‘ç»œå’Œç£ç›˜IOæ“ä½œé€šå¸¸æ¯”CPUå’Œå†…å­˜IOæ“ä½œæ…¢å¾ˆå¤šã€‚\nç®€åŒ–ç¨‹åºè®¾è®¡ å¦‚æœåœ¨å•çº¿ç¨‹åº”ç”¨ç¨‹åºä¸­ç¼–ç¨‹å®ç°ä¸Šè¿°è¯»å–å’Œå¤„ç†æ–‡ä»¶çš„åŠŸèƒ½ï¼Œå°±å¿…é¡»è·Ÿè¸ªæ¯ä¸ªæ–‡ä»¶çš„è¯»å–å’Œå¤„ç†çŠ¶æ€ã€‚ç›¸åçš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­æˆ‘ä»¬å¯ä»¥å¼€å¯ä¸¤ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹è¯»å–å’Œå¤„ç†åŒä¸€ä¸ªæ–‡ä»¶ã€‚æ¯ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…ä»ç£ç›˜è¯»å–æ–‡ä»¶æ—¶éƒ½ä¼šè¢«é˜»å¡ï¼Œä½†åœ¨ç­‰å¾…çš„åŒæ—¶ï¼Œå…¶å®ƒçº¿ç¨‹å¯ä»¥åˆ©ç”¨CPUæ¥å¤„ç†å·²ç»è¯»å–çš„æ–‡ä»¶ã€‚è¿™æ ·èƒ½å¤Ÿæ˜¯çš„CPUå’Œç£ç›˜éƒ½è¢«æ›´å¥½çš„ä½¿ç”¨ï¼Œè€Œä¸”ç”±äºæ¯ä¸ªçº¿ç¨‹åªéœ€è¦è·Ÿè¸ªä¸€ä¸ªæ–‡ä»¶ï¼Œç¼–ç¨‹å®ç°ä¹Ÿä¼šå˜å¾—æ›´ç®€å•ã€‚\næé«˜ç¨‹åºå“åº” å°†å•çº¿ç¨‹åº”ç”¨å˜ä¸ºå¤šçº¿ç¨‹åº”ç”¨çš„å¦ä¸€ä¸ªå¸¸è§ç›®çš„æ˜¯è·å¾—æ›´å¿«çš„å“åº”ã€‚å‡è®¾æœ‰ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºåœ¨æŸä¸ªç«¯å£ç›‘å¬è¯·æ±‚ï¼Œå½“æ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚åï¼ŒæœåŠ¡å™¨å¤„ç†è¯¥è¯·æ±‚ï¼Œå¤„ç†å®Œåå†ç»§ç»­ç›‘å¬ï¼Œè¯¥å¾ªç¯ç›‘å¬æœåŠ¡å™¨çš„è®¾è®¡è‰å›¾å¦‚ä¸‹ï¼š\n1 2 3 4  while(server is active){ listen for request //ç›‘å¬è¯·æ±‚  process request//å¤„ç†è¯·æ±‚ }   å¦‚æœæŸä¸ªè¯·æ±‚éœ€è¦èŠ±è´¹å¾ˆé•¿çš„æ—¶é—´æ¥å¤„ç†ï¼Œé‚£ä¹ˆåœ¨æ­¤æœŸé—´å…¶å®ƒçš„å®¢æˆ·ç«¯å°±ä¸èƒ½å‘æ­¤æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œåªæœ‰å½“æœåŠ¡å™¨å¤„äºç›‘å¬çŠ¶æ€æ—¶æ‰èƒ½å¤Ÿæ¥æ”¶è¯·æ±‚ã€‚\nä¸€ç§æ›¿ä»£æ–¹æ¡ˆæ˜¯è®©ç›‘å¬çº¿ç¨‹å°†æ¥æ”¶åˆ°çš„è¯·æ±‚å‘é€ç»™workerçº¿ç¨‹å¤„ç†ï¼Œç„¶åç«‹å³æ¢å¤ç›‘å¬ï¼Œworkerçº¿ç¨‹å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†å¹¶ç»™å®¢æˆ·ç«¯å‘é€å›å¤ï¼Œæ­¤ç§æœåŠ¡å™¨çš„è®¾è®¡è‰å›¾å¦‚ä¸‹ï¼š\n1 2 3 4  while(server is active){ listen for request //ç›‘å¬è¯·æ±‚  hand request to worker thread//å°†æ¥æ”¶åˆ°çš„è¯·æ±‚å‘é€ç»™workerçº¿ç¨‹å¤„ç† }   åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼ŒæœåŠ¡å™¨çº¿ç¨‹ä¼šè¿…é€Ÿè¿”å›ç›‘å¬ï¼Œå› è€Œæ›´å¤šçš„å®¢æˆ·ç«¯å¯ä»¥ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨çš„å“åº”ä¹Ÿå¾—ä»¥æé«˜ã€‚\nè¯¥æ–¹æ³•åŒæ ·é€‚ç”¨äºæ¡Œé¢åº”ç”¨ç¨‹åºï¼Œå¦‚æœä½ ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ¥å¼€å¯ä¸€ä¸ªé•¿ä»»åŠ¡ï¼Œè€Œæ‰§è¡Œè¯¥ä»»åŠ¡çš„çº¿ç¨‹æ˜¯æ›´æ–°çª—å£ã€æŒ‰é’®ç­‰éƒ¨ä»¶çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆåœ¨è¯¥ä»»åŠ¡è¿è¡ŒæœŸé—´ï¼Œè¯¥æ¡Œé¢ç¨‹åºå°†æ— æ³•å“åº”å…¶å®ƒæ“ä½œã€‚ç›¸åçš„ï¼Œå¯ä»¥å°†è¯¥ä»»åŠ¡ç§»äº¤ç»™ä¸€ä¸ªworkerçº¿ç¨‹ï¼Œå½“workerçº¿ç¨‹å¤„ç†è¯¥ä»»åŠ¡æ—¶ï¼Œæ›´æ–°çª—å£çš„çº¿ç¨‹å¤„äºç©ºé—²çŠ¶æ€ï¼Œå¯ä»¥å“åº”å…¶å®ƒç”¨æˆ·è¯·æ±‚ï¼Œå½“workerçº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡æ—¶é€šçŸ¥æ›´æ–°çª—å£çº¿ç¨‹ï¼Œè¯¥çª—å£çº¿ç¨‹æ ¹æ®æ‰§è¡Œç»“æœæ¥æ›´æ–°ç¨‹åºã€‚å› è€Œåˆ©ç”¨workerçº¿ç¨‹è®¾è®¡å®ç°çš„ç¨‹åºå¯¹ç”¨æˆ·æ›´å…·æœ‰å“åº”æ€§ã€‚\n\u0026lt;â€“ç¿»è¯‘ç»“æŸ!â€“\u0026gt;\n","permalink":"http://isouthrain.github.io/post/translate/java-concurrency/multithreading-benefits/","tags":["Java","Java Concurrency"],"title":"2. [è¯‘]å¤šçº¿ç¨‹çš„ä¼˜ç‚¹"},{"categories":["Javaç¼–ç¨‹","ç¿»è¯‘"],"contents":"æœ¬æ–‡ç¿»è¯‘è‡ªJava Concurrency / Multithreading Tutorial\næœ€å¼€å§‹ä¸€å°ç”µè„‘åªæœ‰å•ä¸ªCPUï¼Œåªèƒ½ä¸€æ¬¡è¿è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œä¹‹åå‡ºç°çš„å¤šä»»åŠ¡å¤„ç†åˆ™æ„å‘³ç€è®¡ç®—æœºåœ¨åŒä¸€æ—¶é—´å¯ä»¥å¤„ç†å¤šä¸ªç¨‹åºï¼ˆä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºä»»åŠ¡æˆ–è¿›ç¨‹ï¼‰ï¼Œè™½ç„¶å®ƒä»¬å¹¶ä¸æ˜¯çœŸæ­£çš„å¹¶å‘ã€‚ç”±äºå•ä¸ªCPUè¢«ä¸åŒçš„ç¨‹åºå…±ç”¨ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸åœåœ°åˆ‡æ¢CPUï¼Œåœ¨çŸ­æš‚çš„æ‰§è¡Œä¸€ä¸ªç¨‹åºåå°±ç«‹å³åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªç¨‹åºã€‚\nå¤šä»»åŠ¡å¤„ç†ç»™è½¯ä»¶å¼€å‘äººå‘˜æå‡ºäº†æ–°çš„æŒ‘æˆ˜ï¼Œç¨‹åºä¸èƒ½å†å‡å®šæ‹¥æœ‰CPUæ‰€æœ‰çš„å¯ç”¨æ—¶é—´ã€å†…å­˜å’Œå…¶å®ƒè®¡ç®—æœºèµ„æºï¼Œä¸€ä¸ªå¥½çš„ç¨‹åºåº”è¯¥åŠæ—¶é‡Šæ”¾æ‰€æœ‰ä¸éœ€è¦ä½¿ç”¨çš„èµ„æºï¼Œä»¥ä¾¿å…¶å®ƒç¨‹åºå¯ä»¥ä½¿ç”¨å®ƒä»¬ã€‚ ä¹‹åå‡ºç°çš„å¤šçº¿ç¨‹åˆ™æ„å‘³ç€å¯ä»¥åœ¨åŒä¸€ä¸ªç¨‹åºé‡Œé¢æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œæ¯ä¸€ä¸ªæ‰§è¡Œçš„çº¿ç¨‹å¯ä»¥è¢«è®¤ä¸ºæ˜¯CPUåœ¨æ‰§è¡Œå½“å‰ç¨‹åºï¼Œå½“åœ¨åŒä¸€ä¸ªç¨‹åºé‡Œé¢æ‰§è¡Œå¤šä¸ªçº¿ç¨‹æ—¶ï¼Œçœ‹èµ·æ¥åƒæ˜¯æ‹¥æœ‰å¤šä¸ªCPUåœ¨æ‰§è¡Œè¯¥ç¨‹åºã€‚\nå¤šçº¿ç¨‹è™½ç„¶æ˜¯æé«˜æŸäº›ç±»å‹ç¨‹åºæ€§èƒ½çš„è‰¯æ–¹ï¼Œä½†æ˜¯å¤šçº¿ç¨‹æ¯”å¤šä»»åŠ¡æ›´å…·æœ‰æŒ‘æˆ˜æ€§ã€‚ç”±äºè¿™äº›çº¿ç¨‹æ‰§è¡Œçš„æ˜¯ç›¸åŒçš„ç¨‹åºï¼Œå› æ­¤å®ƒä»¬åŒæ—¶è¯»å†™ç›¸åŒçš„å†…å­˜ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´åœ¨å•çº¿ç¨‹ä¸­ä¸ä¼šå‡ºç°çš„é”™è¯¯ç»“æœã€‚æŸäº›é”™è¯¯ç»“æœä¸ä¼šå‡ºç°åœ¨å•CPUä¸­æœºå™¨ä¸­æ˜¯ç”±äºä¸¤ä¸ªçº¿ç¨‹ä¸å¯èƒ½åŒæ—¶æ‰§è¡Œã€‚ç°åœ¨çš„ç”µè„‘å¤§éƒ½æ‹¥æœ‰å¤šæ ¸ç”šè‡³å¤šCPUï¼Œè¿™æ„å‘³ç€å¤šä¸ªä¸åŒçš„çº¿ç¨‹å¯ä»¥è¢«ä¸åŒçš„å†…æ ¸æˆ–CPUåŒæ—¶æ‰§è¡Œã€‚\nå¦‚æœä¸€ä¸ªçº¿ç¨‹è¯»å–ä¸€ä¸ªå†…å­˜åœ°å€åŒæ—¶å¦ä¸€ä¸ªçº¿ç¨‹å‘å…¶å†™å…¥ä¿¡æ¯ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹åœ¨è¯»å–å®Œæˆæ—¶ä¼šå¾—åˆ°ä»€ä¹ˆå€¼å‘¢ï¼Ÿæ—§çš„å€¼è¿˜æ˜¯è¢«ç¬¬äºŒä¸ªçº¿ç¨‹å†™å…¥çš„æ–°å€¼ï¼Ÿäº¦æˆ–æ˜¯è¿™ä¸¤ä¸ªå€¼å¾—æ··åˆï¼Ÿè‹¥ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å‘ä¸€ä¸ªå†…å­˜åœ°å€å†™å…¥ä¿¡æ¯ï¼Œå½“è¿™ä¸¤ä¸ªçº¿ç¨‹è¿è¡Œå®Œæ¯•æ—¶ï¼Œæœ€ç»ˆçš„å€¼ä¼šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯ç¬¬ä¸€ä¸ªçº¿ç¨‹å†™å…¥çš„å€¼è¿˜æ˜¯ç¬¬äºŒä¸ªçº¿ç¨‹å†™å…¥çš„å€¼ï¼Ÿäº¦æˆ–æ˜¯è¿™ä¸¤ä¸ªçº¿ç¨‹å†™å…¥å€¼çš„æ··åˆï¼Ÿ\nåœ¨ç¼ºå°‘é€‚å½“æªæ–½çš„æƒ…å†µä¸‹ï¼Œä¸Šè¿°çš„ä»»æ„ä¸€ç§ç»“æœéƒ½å¯èƒ½å‡ºç°ï¼Œç¨‹åºçš„è¿è¡Œç»“æœç”šè‡³ä¸å¯é¢„æµ‹ï¼Œæ¯ä¸€æ¬¡çš„æ‰§è¡Œç»“æœå¯èƒ½éƒ½ä¸åŒã€‚å› æ­¤æ€ä¹ˆå¤„ç†å¤šçº¿ç¨‹å¯¹äºè½¯ä»¶å¼€å‘äººå‘˜å¾ˆé‡è¦ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦å­¦ä¹ å¦‚ä½•æ§åˆ¶çº¿ç¨‹æ¥è®¿é—®å…±äº«èµ„æºå¦‚å†…å­˜ã€æ–‡ä»¶ã€æ•°æ®åº“ç­‰ï¼Œè€Œè¿™æ­£æ˜¯æœ¬ç³»åˆ—æ•™ç¨‹æ‰€è¦é˜è¿°çš„ä¸»é¢˜ä¹‹ä¸€ã€‚\nJavaä¸­çš„å¤šçº¿ç¨‹å’Œå¹¶å‘ Javaæ˜¯æœ€å…ˆè®©å¤šçº¿ç¨‹å¯¹å¼€å‘äººå‘˜å˜å¾—ç®€å•çš„ç¨‹åºè¯­è¨€ä¹‹ä¸€ï¼ŒJavaåœ¨æœ€å¼€å§‹çš„æ—¶å€™å°±å·²ç»å…·å¤‡äº†å¤šçº¿ç¨‹çš„èƒ½åŠ›ï¼Œå› æ­¤Javaå¼€å‘äººå‘˜ç»å¸¸é¢ä¸´ä¸Šæ–‡æ‰€è¿°çš„å¹¶å‘é—®é¢˜ã€‚è¿™æ­£æ˜¯æˆ‘ç¼–å†™æœ¬ç³»åˆ—Javaå¹¶å‘æ•™ç¨‹çš„åŸå› ï¼Œä½œä¸ºè‡ªå·±çš„ç¬”è®°ä»¥åŠå…¶ä»–å¯èƒ½ä»ä¸­è·ç›Šçš„Javaå¼€å‘äººå‘˜ã€‚\næœ¬æ•™ç¨‹å°†ä¸»è¦å…³æ³¨äºJavaä¸­çš„å¤šçº¿ç¨‹ï¼Œä½†å…¶ä¸­çš„ä¸€äº›å¤šçº¿ç¨‹é—®é¢˜ä¸å¤šä»»åŠ¡å’Œåˆ†å¸ƒå¼ç³»ç»Ÿç³»ç»Ÿä¸­å‡ºç°çš„é—®é¢˜ç±»ä¼¼ï¼Œå› æ­¤åœ¨æœ¬æ•™ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°å¯¹å¤šä»»åŠ¡å’Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼•ç”¨ã€‚å¹¶å‘ä¸ç­‰äºå¤šçº¿ç¨‹ï¼Œå®ƒä»¬æ˜¯ä¸åŒçš„æ¦‚å¿µã€‚\nJavaå¹¶å‘åœ¨2015çš„ç°çŠ¶å’Œå±•æœ› è‡ªä»ç¬¬ä¸€æœ¬Javaå¹¶å‘ä¹¦ç±é—®ä¸–ä¹‹åï¼Œå…³äºå¹¶å‘æ¶æ„å’Œè®¾è®¡é¢†åŸŸå·²ç»å‘ç”Ÿäº†å¾ˆå¤šå˜åŒ–ï¼ŒJava5ç”šè‡³æä¾›äº†concurrencyå·¥å…·åŒ…ã€‚æ–°çš„ç±»ä¼¼äºVert.xã€Play/Akkaå’ŒQbitçš„å¼‚æ­¥æ— å…±äº«å¹³å°å’ŒAPIå·²ç»å‡ºç°ã€‚è¿™äº›å¹³å°ä½¿ç”¨äº†ä¸€ä¸ªä¸åŒäºæ ‡å‡†Java/JEEå¹¶å‘çš„æ¨¡å‹æ¥å¤„ç†çº¿ç¨‹ã€å…±äº«å†…å­˜å’Œé”ã€‚æ–°çš„æ— é˜»å¡å¹¶å‘ç®—æ³•å·²ç»å…¬å¼€ï¼Œç±»ä¼¼äºLMax Disrupterè¿™æ ·çš„éé˜»å¡å·¥å…·ä¹Ÿå·²ç»æ·»åŠ åˆ°æˆ‘ä»¬çš„å·¥å…·ç®±ã€‚åœ¨Java7ä¸­é€šè¿‡Forkå’ŒJoinæ¡†æ¶å¼•å…¥äº†å¹¶è¡Œæ€§åŠŸèƒ½ç¼–ç¨‹ï¼Œå¹¶åœ¨Java8ä¸­å¼•å…¥äº†æµç›¸å…³çš„APIã€‚\næ‰€æœ‰è¿™äº›æ–°çš„è¿›å±•è®©æˆ‘è§‰å¾—æ˜¯æ—¶å€™ç¼–æ›´æ–°æœ¬ç³»åˆ—çš„Javaå¹¶å‘æ•™ç¨‹ï¼Œå› æ­¤æœ¬æ•™ç¨‹å†ä¸€æ¬¡å¤„äºç¼–å†™ä¸­çŠ¶æ€ï¼Œæ–°çš„æ•™ç¨‹ä¼šåœ¨æ—¶é—´å…è®¸ç¼–å†™æ—¶å‘å¸ƒã€‚\n\u0026lt;â€“ç¿»è¯‘ç»“æŸ!â€“\u0026gt;\n","permalink":"http://isouthrain.github.io/post/translate/java-concurrency/java-concurrency-multithreading-tutorial/","tags":["Java","Java Concurrency"],"title":"1. [è¯‘]Javaå¤šçº¿ç¨‹ä¸å¹¶å‘æ•™ç¨‹"},{"categories":["Goç¼–ç¨‹","å·¥å…·ä½¿ç”¨"],"contents":"åœ¨å­¦ä¹ Golangæ—¶ï¼Œè‡ªå·±æœ€å¼€å§‹ç”¨çš„æ˜¯Eclipseä¸­çš„goclipseæ’ä»¶æ¥è¿›è¡ŒGolangç¼–ç¨‹ï¼Œä½†å…¶å¯¹Golangçš„æ”¯æŒä¸æ˜¯å¤ªå¥½ï¼Œå¦‚ä»£ç æ ¼å¼åŒ–ã€è‡ªåŠ¨å¯¼å…¥å¼•ç”¨åŒ…ç­‰éƒ½æ— æ³•ç›´æ¥åœ¨Eclipseä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”å…¶è‡ªåŠ¨æç¤ºåŠŸèƒ½ä¹Ÿæ²¡æœ‰åƒJavaé‚£ä¹ˆå¼ºï¼Œäºæ˜¯è½¬ç”¨Intellij IDEAå®‰è£…Golangæ’ä»¶æ¥æ›¿ä»£ä½¿ç”¨ï¼Œå®‰è£…å®Œæ’ä»¶åçš„Intellij IDEAå¯¹Golangçš„æ”¯æŒåœ¨å„æ–¹é¢éƒ½å¾ˆä»¤äººæ»¡æ„ï¼Œå”¯ç‹¬å¼•å…¥æœ¬åœ°åŒ…çš„æ”¯æŒä¸å¤ªå¥½ç”¨ã€‚ç»è¿‡ä¸€é˜µæ‘¸ç´¢è‡ªå·±æ‰¾å‡ºäº†è§£å†³æ–¹æ¡ˆï¼Œå…ˆè®°å½•ä¸‹ã€‚\nåœ¨Eclipseä¸­å¼•ç”¨Golangæœ¬åœ°åŒ… è‹¥æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯goclipseæ¥å¼€å‘Golang ,åˆ™åœ¨å…¶ä¸­å¼•ç”¨æœ¬åœ°åŒ…å¾ˆç®€å•ï¼Œå’Œå¼•ç”¨JavaåŒ…ç±»ä¼¼ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡è®¾ srcæ˜¯æºä»£ç æ‰€åœ¨çš„ç›®å½•ï¼Œåœ¨srcçš„secæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ªåä¸ºcalculate.goçš„æ–‡ä»¶ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªåä¸ºAddçš„å‡½æ•°ç”¨äºè®¡ç®—ä¸¤ä¸ªæ•´æ•°çš„ç›¸åŠ ä¹‹å’Œã€‚\nè‹¥è¦åœ¨ä¸»ç¨‹åºmainæ–¹æ³•ä¸­è°ƒç”¨Addæ–¹æ³•ï¼Œå…ˆé€šè¿‡importå¼•å…¥è¯¥æ–‡ä»¶çš„åŒ…åimport serviceï¼Œç„¶åé€šè¿‡åŒ…åè°ƒç”¨è¯¥æ–¹æ³•service.Add(1,2)ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹å‡ºåœ¨eclipseä¸­å¼•ç”¨Golangæœ¬åœ°åŒ…ä¸å¼•ç”¨JavaåŒ…æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œéƒ½æ˜¯å°†åŒ…æ–‡ä»¶æ”¾åˆ°srcæºæ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åé€šè¿‡åŒ…åæ¥å¼•ç”¨ã€‚\nä¹Ÿå¯ä»¥é€šè¿‡ç›´æ¥å¯¼å…¥è¯¥åŒ…æ‰€åœ¨çš„æ–‡ä»¶å¤¹çš„åç§°æ¥è°ƒç”¨è¯¥æ–¹æ³•ï¼Œæ­¤æ—¶éœ€è¦å°†import serviceæ”¹ä¸ºimport secï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\nå¯ä»¥çœ‹å‡ºåœ¨Eclipseä¸­å¯¼å…¥Golangæœ¬åœ°åŒ…æ—¶æœ‰ä¸¤ç§æ–¹æ³•ï¼š é€šè¿‡importå¯¼å…¥åŒ…åæˆ–é€šè¿‡importå¯¼å…¥è¯¥åŒ…å¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œè¿™ä¸¤ç§æ–¹æ³•å‡å¯ä½¿ç¨‹åºæ­£å¸¸è¿è¡Œã€‚\nåœ¨Intellij IDEAä¸­å¼•ç”¨Golangæœ¬åœ°åŒ… ä¸‹é¢2å¼ å›¾ä¸ºåœ¨IDEAä¸­å»ºç«‹çš„å¯¹åº”é¡¹ç›®ï¼Œå›¾ä¸­gprojectæ˜¯ä¸€ä¸ªé¡¹ç›®ï¼Œgotestæ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬åœ¨gotestä¸‹å»ºç«‹ç›¸å…³çš„æµ‹è¯•æ–‡ä»¶ã€‚\nåœ¨ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬æ˜¯é€šè¿‡import serviceçš„æ–¹å¼æ¥å¯¼å…¥ç›¸åº”åŒ…çš„ï¼Œç”±äºIDEAå¯¹Golangå¾ˆå¼ºï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºserviceçš„é¢œè‰²ä¸å…¶å®ƒå¯¼å…¥åŒ…çš„é¢œè‰²ä¸ä¸€è‡´ï¼Œå½“æŠŠé¼ æ ‡ç§»åŠ¨åˆ°serviceä¸Šæ—¶ä¼šæç¤ºCannot resolve file 'service' ï¼Œç›´æ¥è¿è¡Œæ—¶ï¼Œä¼šå‡ºç°å¦‚ä¸‹å›¾æ‰€ç¤ºcannot find packageé”™è¯¯ï¼Œå°†import serviceä¿®æ”¹ä¸ºimport secæ—¶ï¼Œä¼šå‡ºç°åŒæ ·çš„é”™è¯¯ï¼Œå¯ä»¥çœ‹å‡ºåœ¨ideaä¸­é»˜è®¤ä¸æ”¯æŒç›´æ¥å¯¼å…¥æœ¬åœ° GolangåŒ…ã€‚ ä»æŠ¥é”™ä¿¡æ¯å¯ä»¥çœ‹å‡ºï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶å…ˆå» GOROOT å»æœç´¢å¯¼å…¥åŒ…ï¼Œç„¶åå» GOPATH å¯»æ‰¾å¯¼å…¥åŒ…ï¼Œæœ€ååœ¨å½“å‰é¡¹ç›®æ¨¡å—ä¸‹å¯»æ‰¾å¯¼å…¥åŒ…ï¼Œä½†å®é™…ä¸Šä¸å­˜åœ¨D:\\program\\IntelliJ IDEA 2016.2.1\\workspace\\gproject\\gotest\\src\\serviceè¿™ä¸ªç›®å½•ï¼Œæ•…è€Œç¨‹åºæŠ¥é”™ï¼Œä¸èƒ½æ­£å¸¸è¿è¡Œã€‚\nè§£å†³è¯¥é—®é¢˜çš„å…³é”®æ˜¯æ˜ç™½GOROOTå’ŒGOPATHçš„ä½œç”¨ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£çš„è§£é‡ŠGOPATHçš„ä¸»è¦ä½œç”¨æ˜¯å­˜æ”¾æ–‡ä»¶ä»¥ä¾¿Golangç¨‹åºç¼–è¯‘æ—¶å¯ä»¥è¿›è¡Œæœç´¢å¼•ç”¨ï¼ŒGOPATHå¯ä»¥è®¾ç½®ä¸€ä¸ªå€¼æˆ–å¤šä¸ªå€¼ï¼Œå¤šä¸ªå€¼ä¹‹é—´ä»¥åˆ†å·éš”å¼€ã€‚å¾ˆæ˜æ˜¾åªè¦æˆ‘ä»¬å°†æœ¬åœ°GolangåŠ å…¥åˆ°GOPATHä¸­å³å¯åœ¨IDEAä¸­æ­£å¸¸è¿è¡Œè¯¥ç¨‹åºã€‚\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨IDEAä¸­ä¾æ¬¡é€‰æ‹© File-\u0026gt;Settings-\u0026gt;Language\u0026amp;Frameworks-\u0026gt;Go-\u0026gt;Go Libraries ï¼Œä¼šå‡ºç°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„é…ç½®Golang åº“çš„ç•Œé¢ï¼Œåœ¨è¯¥ç•Œé¢å¯ä»¥æ·»åŠ Golangæœ¬åœ°åŒ…æ‰€åœ¨çš„è·¯å¾„ï¼Œè¯¥ç•Œé¢åŒ…å«3ä¸ªä¸åŒä½œç”¨èŒƒå›´çš„é…ç½®æ–¹å¼ï¼šGlobal librariesã€Project librarieså’Œ Module librariesï¼Œå…¶ä¸­Global librariesçš„é…ç½®å¯¹æ‰€æœ‰é¡¹ç›®ç”Ÿæ•ˆä¸ºå…¨å±€é…ç½®ï¼ŒProject librariesçš„é…ç½®å¯¹æ•´ä¸ªé¡¹ç›®ç”Ÿæ•ˆï¼ŒModule librariesçš„é…ç½®åªå¯¹æ¨¡å—ç”Ÿæ•ˆï¼Œå¯ä»¥çœ‹å‡ºåœ¨Global librariesé»˜è®¤åŒ…å«äº†GOPATHã€‚æ ¹æ®å®é™…ä½¿ç”¨çš„éœ€æ±‚æˆ‘ä»¬å¯Zé€‰æ‹©æŠŠæœ¬åœ°åŒ…è®¾ç½®åœ¨Project librariesè¿˜æ˜¯Module librariesä¸­ã€‚\næœ¬æ–‡çš„ç¨‹åºéƒ½æ˜¯åœ¨gotestæ¨¡å—ä¸‹ï¼Œæ•…å°†å…¶æ·»åŠ åˆ°Module librariesä¸‹ï¼Œæ·»åŠ å®Œçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š\nå°†æœ¬åœ°åŒ…æ·»åŠ åˆ°æ¨¡å—åº“ä¹‹åï¼Œè¿˜éœ€è¦åœ¨goæ–‡ä»¶ä¸­å°†å¯¼å…¥åŒ…çš„è¯­å¥è®¾ç½®ä¸ºimport secï¼Œä¸èƒ½è®¾ç½®ä¸ºimport serviceï¼Œç„¶åè¯¥Golangç¨‹åºå³å¯æ­£å¸¸è¿è¡Œã€‚\nå¯ä»¥çœ‹å‡ºï¼Œä¸åŒäºgoclipseï¼Œåœ¨IDEAä¸­åªèƒ½ä½¿ç”¨é€šè¿‡importå¯¼å…¥è¯¥åŒ…å¯¹åº”çš„æ–‡ä»¶å¤¹æ¥å¯¼å…¥æœ¬åœ°GolangåŒ…ï¼Œè‡³äºåŸå› è¿˜éœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ã€‚\nåˆ©ç”¨Goclipseæ—¶æ— æ³•è¿è¡Œç¨‹åºçš„è§£å†³æ–¹æ³• åœ¨ä½¿ç”¨goclipseè¿è¡Œ Golangç¨‹åºæ—¶ï¼Œå¶å°”ä¼šå‡ºç°ç¨‹åºæ— æ³•ç¼–è¯‘å’Œè¿è¡Œçš„æƒ…å†µï¼Œè¿™ç§æƒ…å½¢ä¸€èˆ¬éƒ½æ˜¯srcæ²¡æœ‰è¢«è®¾ç½®æˆæºä»£ç ç›®å½•é€ æˆçš„ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ–¹æ³•ï¼Œå°†srcç›®å½•æ·»åŠ æºä»£ç ç›®å½•ã€‚åœ¨Eclipseä¸­é€‰ä¸­è¯¥é¡¹ç›®ç„¶åç‚¹å‡» Properties ï¼Œä¼šå‡ºç°é¡¹ç›®å±æ€§é…ç½®ç•Œé¢ï¼Œç‚¹å‡» Go Project Configuration ï¼Œé€šè¿‡ Add Folder å¯ä»¥å°†srcæ·»åŠ åˆ°æºä»£ç ä¸­ï¼Œä¹‹åç¨‹åºå³å¯æ­£å¸¸è¿è¡Œã€‚\næ›´æ–° åœ¨æœ¬æ–‡å†™ä½œçš„æ—¶(2017å¹´3æœˆä»½)ï¼Œjetbrainå®˜æ–¹å‡ºç‰ˆäº†GoLandï¼Œå»ºè®®åœ¨æ¡ä»¶è®¸å¯çš„æƒ…å†µä¸‹ä¼˜å…ˆä½¿ç”¨GoLand\næ”¯æŒæ­£ç‰ˆï¼Œä»æˆ‘åšèµ·ï¼\n","permalink":"http://isouthrain.github.io/post/golang/import-local-package-in-intellij-idea/","tags":["Go","Intellij IDEA"],"title":"åœ¨Intellij IDEAä¸­å¼•ç”¨Golangæœ¬åœ°åŒ…"},{"categories":["ç®—æ³•","Javaç¼–ç¨‹"],"contents":"ä¹‹å‰é¢è¯•æ—¶é‡åˆ°ä¸€ä¸ªç®—æ³•é¢˜:\n å‡å®šä¸¤ä¸ªçŸ©å½¢å„æ¡è¾¹éƒ½æ˜¯å¹³è¡Œäºåæ ‡è½´ï¼Œå·²çŸ¥kã€lã€mã€nåˆ†åˆ«ä¸ºå…¶ä¸­ä¸€ä¸ªçŸ©å½¢å·¦ä¸‹è§’å’Œå³ä¸Šè§’xè½´ã€yè½´åæ ‡ï¼Œpã€qã€rã€såˆ†åˆ«ä¸ºå¦ä¸€ä¸ªçŸ©å½¢çš„å·¦ä¸‹è§’å’Œå³ä¸Šè§’xè½´ã€yè½´åæ ‡ï¼Œæ±‚è¿™ä¸¤ä¸ªçŸ©å½¢çš„æ€»é¢ç§¯ï¼Œå½“çŸ©å½¢ç›¸äº¤æ—¶è¦å‡å»ç›¸äº¤çš„é¢ç§¯ã€‚\n æ­¤é¢˜åˆ©ç”¨å¸¸è§„çš„æšä¸¾æ³•å¾ˆå¤æ‚ï¼Œä½†åˆ©ç”¨æ’é™¤æ³•å’Œå½’çº³æ³•å´èƒ½å¾ˆå¿«è§£å†³ï¼Œæ•…å…ˆè®°å½•ä¸‹ã€‚\nå¾ˆæ˜æ˜¾ï¼Œæ­¤é¢˜çš„é‡ç‚¹åœ¨äºå¦‚ä½•åˆ¤æ–­çŸ©å½¢æ˜¯å¦ç›¸äº¤ä»¥åŠæ£€æµ‹ç›¸äº¤å½¢æˆçš„æ–°çŸ©å½¢é¢ç§¯ï¼Œå½“ä¸ç›¸äº¤æ—¶æ€»é¢ç§¯ç›´æ¥ä¸ºä¸¤ä¸ªçŸ©å½¢çš„é¢ç§¯ä¹‹å’Œï¼Œå½“ç›¸äº¤æ—¶éœ€è¦å‡å»ç›¸äº¤çŸ©å½¢çš„é¢ç§¯ï¼Œç”±äºé¢˜ç›®å·²ç»å‘Šè¯‰äº†çŸ©å½¢çš„å·¦ä¸‹è§’å’Œå³ä¸Šè§’åæ ‡å·²çŸ¥ï¼Œé—®é¢˜åˆè½¬åŒ–ä¸ºåœ¨ç›¸äº¤æ—¶å¦‚ä½•è®¡ç®—ç›¸äº¤çŸ©å½¢çš„å·¦ä¸‹è§’å’Œå³ä¸Šè§’çš„åæ ‡ã€‚\næœ€å¼€å§‹æˆ‘æƒ³é€šè¿‡å¸¸è§„çš„æšä¸¾æ³•æŠŠçŸ©å½¢ç›¸äº¤çš„æ‰€æœ‰æƒ…å†µéƒ½åˆ—å‡ºæ¥ï¼Œåœ¨ç¨¿çº¸ä¸Šç®€å•çš„æ¯”åˆ’åï¼Œå‘ç°é‡‡ç”¨æšä¸¾çš„æ–¹å¼å¤ªå¤æ‚ï¼ŒçŸ©å½¢ç›¸äº¤ç†è®ºä¸Šæœ‰ä¸‹å›¾æ‰€ç¤ºçš„16ç§ç»„åˆæ–¹å¼ï¼ŒçŸ­æ—¶é—´å†…å¾ˆéš¾ä¸€ä¸€åˆ—ä¸¾å‡ºæ¥ï¼Œå®é™…ç¼–ç¨‹ä¸­ä¸ä»…ä»£ç é‡å¤§è¿˜å¾ˆå®¹æ˜“äº§ç”Ÿé—æ¼:\n  ä¸¤ä¸ªçŸ©å½¢è¾¹è§’ç›¸äº¤ä»¥åŠå®Œå…¨åŒ…å«\n  çŸ©å½¢æ¨ªå‘ç›¸äº¤\n  çŸ©å½¢çºµå‘ç›¸äº¤\n  çŸ©å½¢è¢«å®Œå…¨åŒ…å«\n  æ’é™¤æšä¸¾æ–¹æ³•ä¹‹åï¼Œåªèƒ½å¯¹å…¶è¿›è¡Œåˆ†ææ‰¾å‡ºé€šç”¨çš„å¤„ç†æ–¹å¼ã€‚ä¸‹å›¾å±•ç¤ºäº†åœ¨ç›¸äº¤çŸ©å½¢çš„å·¦ä¸‹è§’å’Œå³ä¸Šè§’çš„ä½ç½®ï¼Œä»”ç»†åˆ†æåä¾¿å¯å‘ç°ç›¸äº¤çŸ©å½¢çš„å·¦ä¸‹è§’x,yåæ ‡æ˜¯ä¸¤ä¸ªçŸ©å½¢å·¦ä¸‹è§’x,yåæ ‡ä¸­å–è¾ƒå¤§å€¼ï¼Œç›¸äº¤çŸ©å½¢çš„å³ä¸Šè§’x,yåæ ‡æ˜¯ä¸¤ä¸ªçŸ©å½¢å³ä¸Šè§’x,yåæ ‡ä¸­å–è¾ƒå°å€¼ã€‚\né€šè¿‡åˆ†æå½’çº³ä¹‹åï¼Œæˆ‘ä»¬å°†ä¹‹å‰çš„16ç§ç›¸äº¤æƒ…å†µç»Ÿä¸€ä¸º1ä¸ªè¡¨è¾¾å¼ï¼Œè€Œè¿™ä¸ªè¡¨è¾¾å¼åœ¨ç¼–ç¨‹æ—¶æ˜¯å¾ˆå®¹æ˜“å®ç°çš„ï¼Œä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¯¥è¡¨è¾¾å¼è®¡ç®—ç›¸äº¤çŸ©å½¢çš„åæ ‡ä»¥åŠå…¶é¢ç§¯ã€‚\n1 2 3 4 5 6 7 8  public static int calculateIntersectArea(int k, int l, int m, int n, int p,int q, int r, int s) { int leftDownX = 0, leftDownY = 0, rightUpX = 0, rightUpY = 0; leftDownX = k \u0026gt; p ? k : p; leftDownY = l \u0026gt; q ? l : q; rightUpX = m \u0026lt; r ? m : r; rightUpY = n \u0026lt; s ? n : s; return (rightUpX - leftDownX) * (rightUpY - leftDownY); }   å¯»æ‰¾å‡ºå¦‚ä½•è®¡ç®—ç›¸äº¤çŸ©å½¢çš„é¢ç§¯ä¹‹åï¼Œè¿˜éœ€è¦è§£å†³ä¸€ä¸ªé—®é¢˜:ä¸Šè¿°å®ç°åªæœ‰åœ¨çŸ©å½¢ç›¸äº¤æ—¶æ‰æ­£ç¡®ï¼Œå½“çŸ©å½¢ä¸ç›¸äº¤æ—¶è®¡ç®—ç»“æœé”™è¯¯ï¼Œä¸ºæ­¤éœ€è¦æ‰¾å‡ºä¸€ä¸ªæ–¹æ³•åˆ¤å®šä¸¤ä¸ªçŸ©å½¢æ˜¯å¦ç›¸äº¤ã€‚è‹¥åˆ©ç”¨æšä¸¾æ–¹æ³•åŒæ ·ä¼šæœ‰å‰è¿°çš„16ç§æƒ…å½¢éœ€è¦è€ƒè™‘ï¼ŒåŒæ ·å¾ˆå¤æ‚ï¼Œæ˜¾ç„¶æšä¸¾æ–¹æ³•ä¸é€‚åˆä½¿ç”¨ã€‚æ¢ä¸€ç§æ€è·¯ï¼šå¦‚æœæŠŠçŸ©å½¢ä¸ç›¸äº¤çš„æƒ…å½¢æ’é™¤æ‰ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„æƒ…å½¢å°±æ˜¯çŸ©å½¢ç›¸äº¤äº†ï¼ï¼Œè€ŒçŸ©å½¢ä¸ç›¸äº¤åˆ™ç›¸å¯¹å®¹æ˜“å¤šäº†ï¼Œå‡è®¾è¿™ä¸¤ä¸ªçŸ©å½¢åˆ†åˆ«ä¸ºAå’ŒBï¼Œåˆ™å®ƒä»¬ä¸ç›¸äº¤ä¸€å…±æœ‰å¦‚ä¸‹å›¾æ‰€ç¤ºçš„4ç§æƒ…å†µï¼š\nç›¸åº”çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  public static boolean isIntersect(int k, int l, int m, int n, int p, int q, int r, int s) { boolean nointersect = false; // Båœ¨Açš„ä¸Šé¢ \tnointersect = q \u0026gt; n; // Båœ¨Açš„ä¸‹é¢ \tnointersect = l \u0026gt; s; // Båœ¨Açš„å·¦ä¾§ \tnointersect = r \u0026lt; k; // Båœ¨Açš„å³ä¾§ \tnointersect = m \u0026lt; p; return !nointersect; }   åˆ©ç”¨ä¸Šè¿°2ä¸ªåˆ¤æ–­æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿å‡†ç¡®çš„è®¡ç®—å‡ºä¸¤ä¸ªçŸ©å½¢åœ¨ç›¸äº¤æ—¶çš„æ€»é¢ç§¯ï¼Œç›¸åº”çš„ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  public static int solution(int k, int l, int m, int n, int p, int q, int r, int s) { int widthA = m - k; int heightA = n - l; int areaA = widthA * heightA; int widthB = r - p; int heightB = s - q; int areaB = widthB * heightB; int totalArea = areaA + areaB; boolean hasIntersect = isIntersect(k, l, m, n, p, q, r, s); if (hasIntersect) { totalArea -= calculateIntersectArea(k, l, m, n, p, q, r, s); } return totalArea; }   åˆ†æè§£å†³è¿™ä¸ªé—®é¢˜ç»™æˆ‘æœ€æ·±çš„æ„Ÿè§¦æ˜¯ï¼šæœ‰æ—¶å€™è‹¥æŸä¸€ç±»é—®é¢˜ç”¨æšä¸¾å®ç°å¾ˆå¤æ‚æ—¶ï¼Œå°è¯•å»åˆ†æå…¶ä¸­çš„è§„å¾‹ï¼Œæ‰¾å‡ºé€šç”¨çš„è§£å†³æ–¹æ³•ï¼Œä¸ä»…åœ¨ç®—æ³•æ–¹é¢ï¼Œæˆ–è®¸åœ¨ç”Ÿæ´»ä¸­å…¶å®ƒæ–¹é¢ä¹Ÿé€‚ç”¨å§ï¼\n","permalink":"http://isouthrain.github.io/post/algorithm/calculate-total-area-of-two-rectangles/","tags":null,"title":"è®¡ç®—ä¸¤ä¸ªå¹³è¡Œäºåæ ‡è½´çš„çŸ©å½¢ç›¸äº¤çš„é¢ç§¯"},{"categories":["Webç¼–ç¨‹"],"contents":"ç”±äºé¡¹ç›®éœ€è¦ï¼Œæœ€è¿‘ä½¿ç”¨äº†åœ¨html5ä¸­æ’­æ”¾è§†é¢‘çš„åŠŸèƒ½ï¼ŒæœŸé—´é‡åˆ°äº†å‡ ä¸ªå‘ï¼Œå…ˆç®€å•è®°å½•ä¸‹ã€‚\nåœ¨html5é¡µé¢ä¸­æ’­æ”¾è§†é¢‘ å¦‚ä½•åœ¨html5é¡µé¢ä¸­åµŒå…¥è§†é¢‘çš„ä»£ç åœ¨ç½‘ä¸Šå¾ˆå®¹æ˜“ç›´æ¥æœç´¢åˆ°ï¼Œå…¸å‹çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4  \u0026lt;video width=\u0026#34;320\u0026#34; height=\u0026#34;240\u0026#34; controls=\u0026#34;controls\u0026#34;\u0026gt; \u0026lt;source src=\u0026#34;movie.mp4\u0026#34; type=\u0026#34;video/mp4\u0026#34;/\u0026gt; Your browser does not support the video tag. \u0026lt;/video\u0026gt;   ä¹‹åçš„æ•ˆæœæ˜¾ç¤ºå¦‚ä¸‹ï¼Œä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¯¥è§†é¢‘æ’­æ”¾ç•Œé¢åŒ…å«å¿«è¿› ã€éŸ³é‡è°ƒæ•´ å’Œå…¨å±æ’­æ”¾è¿™å‡ ä¸ªæŒ‰é’®\nåœ¨iframeä¸­ä¸èƒ½å…¨å±æ’­æ”¾è§†é¢‘ é¡¹ç›®ä¸­å¥½å¤šåœ°æ–¹éƒ½ç”¨iframeæ¥åµŒå¥—htmlé¡µé¢ï¼Œæœ€å¼€å§‹æˆ‘æ˜¯ç”¨ç±»ä¼¼å¦‚ä¸‹ä»£ç åœ¨è¢«iframeåŒ…å«çš„é¡µé¢ä¸­åµŒå…¥å‰é¢çš„è§†é¢‘æ’­æ”¾ä»£ç ï¼Œ å‘ç°æ˜¾ç¤ºå‡ºæ¥çš„è§†é¢‘æ’­æ”¾å™¨æ²¡æœ‰å…¨å±æ’­æ”¾æŒ‰é’®ï¼Œé€šè¿‡å‡çº§æµè§ˆå™¨ç‰ˆæœ¬å’Œæ¸…é™¤ç¼“å­˜ç­‰æ–¹æ³•ä¾ç„¶ä¸å¥æ•ˆã€‚æœç´¢stackoverflowæ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼çš„é—®é¢˜How to make a video fullscreen when it is placed inside an iframe?ï¼Œé˜…è¯»åå‘ç°åªéœ€è¦å°†iframeä¿®æ”¹æˆ\u0026lt;iframe â€¦ allowfullscreen=\u0026quot;true\u0026quot; webkitallowfullscreen=\u0026quot;true\u0026quot; mozallowfullscreen=\u0026quot;true\u0026quot;\u0026gt;å³å¯\n1 2 3 4 5 6 7 8 9 10 11 12  \u0026lt;iframe\u0026gt; \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head /\u0026gt; \u0026lt;body\u0026gt; \u0026lt;video width=\u0026#34;320\u0026#34; height=\u0026#34;240\u0026#34; controls=\u0026#34;controls\u0026#34;\u0026gt; \u0026lt;source src=\u0026#34;movie.mp4\u0026#34; type=\u0026#34;video/mp4\u0026#34;/\u0026gt; Your browser does not support the video tag. \u0026lt;/video\u0026gt; \u0026lt;body\u0026gt; \u0026lt;/html\u0026gt; \u0026lt;/iframe\u0026gt;   éšè—å£°éŸ³è°ƒæ•´æŒ‰é’® æœ‰äº›æ¼”ç¤ºè§†é¢‘åªæœ‰å›¾åƒæ²¡æœ‰å£°éŸ³ï¼Œä¸ºäº†é¿å…å¯¹ä½¿ç”¨è€…é€ æˆä¸å¿…è¦çš„å¹²æ‰°ï¼Œå¯ä»¥å°†å£°éŸ³æ’­æ”¾æŒ‰é’®å±è”½æ‰ï¼Œç”±äºè‡ªå·±é¡¹ç›®åªæ”¯æŒåŸºäºwebkitå†…æ ¸çš„Chromeæµè§ˆå™¨è®¿é—®ï¼Œé€šè¿‡Googleä¹‹ååœ¨ stackoverflowæ‰¾åˆ° Why do no user-agents implement the CSS cursor style for video elementsè¿™ç¯‡æ–‡ç« ï¼Œå…¶ä¸­åˆ—å‡ºäº†æ’­æ”¾è§†é¢‘æ—¶ç›¸å…³æ§åˆ¶æŒ‰é’®çš„cssç±»ï¼š\n video::-webkit-media-controls-panel video::-webkit-media-controls-play-button video::-webkit-media-controls-volume-slider-container video::-webkit-media-controls-volume-slider video::-webkit-media-controls-mute-button video::-webkit-media-controls-timeline video::-webkit-media-controls-current-time-display video::-webkit-full-page-media::-webkit-media-controls-panel video::-webkit-media-controls-timeline-container video::-webkit-media-controls-time-remaining-display video::-webkit-media-controls-seek-back-button video::-webkit-media-controls-seek-forward-button video::-webkit-media-controls-fullscreen-button video::-webkit-media-controls-rewind-button video::-webkit-media-controls-return-to-realtime-button video::-webkit-media-controls-toggle-closed-captions-button  ä¸ºäº†å±è”½æ‰å£°éŸ³æ’­æ”¾æŒ‰é’®ï¼Œæˆ‘ä»¬åªéœ€ä½¿ç”¨video::-webkit-media-controls-volume-sliderå’Œvideo::-webkit-media-controls-mute-buttonè¿™ä¸¤ä¸ªå±æ€§å³å¯ï¼Œç›¸åº”çš„cssä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9  /**éšè—è§†é¢‘éŸ³é‡å¤§å°è°ƒæ•´æ§ä»¶**/ .no_sound_style\u0026gt;video::-webkit-media-controls-volume-slider{ display:none; } /**éšè—è§†é¢‘éŸ³é‡å–‡å­**/ .no_sound_style\u0026gt;video::-webkit-media-controls-mute-button{ display:none; }   å¯¹åº”çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°éŸ³é‡å–‡å­å’ŒéŸ³é‡è°ƒæ•´ç©ºé—´éƒ½æ¶ˆå¤±ä¸è§\n","permalink":"http://isouthrain.github.io/post/web/show-video-in-html5-page/","tags":["html5"],"title":"åœ¨iframeåµŒå¥—çš„html5ä¸­æ’­æ”¾è§†é¢‘æ—¶å…¨å±æ˜¾ç¤ºå’Œå–æ¶ˆéŸ³é‡è°ƒæ•´"},{"categories":["ç®—æ³•","Javaç¼–ç¨‹","ä½è¿ç®—"],"contents":"å˜é‡äº¤æ¢æ˜¯ç¼–ç¨‹ä¸­ç»å¸¸ä½¿ç”¨çš„åŠŸèƒ½ï¼Œæœ¬æ–‡è®°å½•å‡ ç§ä¸é€šè¿‡ä¸æ·»åŠ ç¬¬ä¸‰æ–¹å˜é‡æ¥äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å®ç°æ–¹å¼ã€‚\näº¤æ¢å˜é‡é€šå¸¸é‡‡ç”¨ç±»ä¼¼å¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6  int a = 3, b = 4, temp; temp = a; a = b; b = temp; System.out.println(a); System.out.println(b);   ä¸Šè¿°ä»£ç å®ç°å’Œç†è§£èµ·æ¥éƒ½å¾ˆå®¹æ˜“ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰å…¶å®ƒçš„å®ç°æ–¹å¼ï¼Œæœ¬æ–‡ä»¥é0çš„intå˜é‡ä¸ºä¾‹ï¼Œç®€å•è®°å½•ä¸‹è‡ªå·±äº†è§£çš„ç›¸å…³å®ç°ã€‚\nåŠ å‡æ³•å®ç° 1 2 3 4 5 6  int a = 3, b = 4; a = a + b; b = a - b; a = a - b; System.out.println(a); System.out.println(b);   ä¸Šè¿°ä»£ç å¯ä»¥è¿›ä¸€æ­¥ç²¾ç®€å¦‚ä¸‹:\n1 2 3 4  int a = 3, b = 4; a = a + b - (b = a); System.out.println(a); System.out.println(b);   ä¹˜é™¤æ³•å®ç° 1 2 3 4 5 6  int a = 3, b = 4; a = a * b; b = a / b; a = a / b; System.out.println(a); System.out.println(b);   ä½è¿ç®—å®ç° 1 2 3 4 5 6  int a = 3, b = 4; a = a ^ b; b = a ^ b; a = a ^ b; System.out.println(a); System.out.println(b);   ","permalink":"http://isouthrain.github.io/post/algorithm/swap-two-variables-without-temp-variable/","tags":["bit"],"title":"ä¸é€šè¿‡ç¬¬ä¸‰æ–¹å˜é‡æ¥äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼"},{"categories":["Javaç¼–ç¨‹","MyBatisç³»åˆ—"],"contents":"åœ¨åˆ©ç”¨ MyBatisè¿›è¡Œå¤šæ¡æ•°æ®æ’å…¥æ—¶ï¼Œä¸ºäº†æé«˜æ€§èƒ½æˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨æ‰¹é‡æ’å…¥çš„åŠŸèƒ½æ¥å®ç°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹:\nSQLé…ç½®æ–‡ä»¶:\n1 2 3 4 5 6 7  \u0026lt;insert id=\u0026#34;addAuthorityRoleBatch\u0026#34; parameterType=\u0026#34;List\u0026#34;\u0026gt; INSERT INTO system_authority_role(role_id,authority_id) VALUES \u0026lt;foreach collection=\u0026#34;list\u0026#34; item=\u0026#34;authRole\u0026#34; separator=\u0026#34;,\u0026#34;\u0026gt; (#{authRole.roleId},#{authRole.authorityId}) \u0026lt;/foreach\u0026gt; \u0026lt;/insert\u0026gt;   Javaä»£ç :\n1 2 3 4 5 6 7 8 9  public void adjustRoleAuth(String roleId, String authIdsStr) { authRoleDao.deleteAuthorityRoleByRole(roleId); String[] authIds=authIdsStr.split(\u0026#34;;\u0026#34;); List\u0026lt;AuthorityRoleModel\u0026gt; authRoleList=new ArrayList\u0026lt;AuthorityRoleModel\u0026gt;(); for(String authId:authIds){ authRoleList.add(new AuthorityRoleModel(roleId,authId)); } authRoleDao.addAuthorityRoleBatch(authRoleList); }   ä¸Šé¢çš„ä»£ç å¤§å¤šæ•°æ—¶å€™å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯å¶å°”ä¼šå‡ºç°å¦‚ä¸‹å¼‚å¸¸ï¼š\n1 2 3 4  ### SQL: INSERT INTO system_authority_role(role_id,authority_id) VALUES ### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \u0026#39;\u0026#39; at line 2 ; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \u0026#39;\u0026#39; at line 2 at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:233   ä¸Šé¢çš„å¼‚å¸¸å †æ ˆä¿¡æ¯æ˜¾ç¤ºç°åœ¨æ‰§è¡Œçš„MySQLè¯­å¥å‘ç”Ÿäº†è¯­æ³•é”™è¯¯ï¼ŒINSERT VALUEåé¢çš„å€¼ä¸ºç©ºï¼Œç”±äºè¯¥é—®é¢˜æœ‰æ—¶å€™å‘ç”Ÿï¼Œæœ‰æ—¶å€™ä¸å‘ç”Ÿï¼Œç»™æˆ‘ä»¬åˆ†æè¯¥é—®é¢˜é€ æˆäº†ä¸€å®šçš„å›°æ‰°ã€‚è¯¥é—®é¢˜äº§ç”Ÿçš„æ ¹æºä¸ºæ‰¹é‡æ’å…¥æ—¶çš„é›†åˆæ•°æ®ä¸ºç©ºï¼Œä½¿å¾—SQLé…ç½®æ–‡ä»¶ä¸­çš„foreachå¾ªç¯æ²¡æœ‰æ‰§è¡Œï¼Œä»è€Œå¯¼è‡´SQLè¯­å¥ä¸å®Œæ•´ï¼Œè¿›è€Œäº§ç”Ÿè¯¥å¼‚å¸¸ã€‚ ä¸ºäº†è§£å†³è¯¥é—®é¢˜æˆ‘ä»¬å¯ä»¥æ‰¹é‡æ’å…¥ä¹‹å‰å…ˆæ£€æŸ¥Listæ•°æ®é›†åˆæ˜¯å¦ä¸ºç©ºï¼Œåªæœ‰åœ¨ä¸ä¸ºç©ºçš„æƒ…å†µä¸‹æ‰è¿›è¡Œæ’å…¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11  public void adjustRoleAuth(String roleId, String authIdsStr) { authRoleDao.deleteAuthorityRoleByRole(roleId); String[] authIds=authIdsStr.split(\u0026#34;;\u0026#34;); List\u0026lt;AuthorityRoleModel\u0026gt; authRoleList=new ArrayList\u0026lt;AuthorityRoleModel\u0026gt;(); for(String authId:authIds){ authRoleList.add(new AuthorityRoleModel(roleId,authId)); } if(authRoleList.size()\u0026gt;0){//åªæœ‰åœ¨Listä¸ä¸ºç©ºæ—¶æ‰è¿›è¡Œæ’å…¥ \tauthRoleDao.addAuthorityRoleBatch(authRoleList);\t} }   ","permalink":"http://isouthrain.github.io/post/mybatis/mybatis-batch-insert-exception/","tags":["Java","MyBatis"],"title":"mybatis batch insert exceptionçš„è§£å†³æ–¹æ³•"},{"categories":["Javaç¼–ç¨‹","Springç³»åˆ—"],"contents":"æ–‡ä»¶çš„ä¸Šä¼ å’Œä¸‹è½½æ˜¯Webç³»ç»Ÿä¸­çš„ä¸€ä¸ªå¾ˆæ™®é€šçš„åŠŸèƒ½ï¼Œå®ç°çš„æ–¹å¼ä¹Ÿæœ‰å¾ˆå¤šç§ï¼Œå¦‚åˆ©ç”¨ java.ioä¸‹é¢çš„å„ç§IOç±»è‡ªå·±å®ç°ï¼Œæˆ–è€…åˆ©ç”¨ Commons IOåŒ…ä¸­çš„FileUtilsã€ IOUtils ç±»ä¸­å°è£…å¥½çš„æ–¹æ³•ç›´æ¥è°ƒç”¨ã€‚ç”±äºç›®å‰æˆ‘æ‰€å¼€å‘çš„ç³»ç»Ÿé‡‡ç”¨äº† SpringMVCæ¥ä½œä¸ºé¡¹ç›®çš„MVCå®ç°ï¼Œæ‰€ä»¥å¾ˆè‡ªç„¶çš„é‡‡ç”¨ SpringMVCå†…ç½®çš„APIè¿›è¡Œæ–‡ä»¶çš„ä¸‹è½½ï¼Œä½†åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å…¶å¯¹å¤§æ–‡ä»¶çš„ä¸‹è½½æ”¯æŒä¸å¤ªå¥½ï¼Œç°æŠŠè§£å†³æ–¹æ¡ˆè®°å½•å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13  @RequestMapping(\u0026#34;downloadRequireDocument\u0026#34;) public ResponseEntity\u0026lt;byte[]\u0026gt; downloadRequireDocument(String fileId,String fileName,String fileType, HttpServletRequest request) throws IOException{ String filePath=fileName+fileId+\u0026#34;.\u0026#34;+fileType; HttpHeaders headers=new HttpHeaders(); headers.setContentType(MediaType.APPLICATION_OCTET_STREAM); headers.setContentDispositionFormData(\u0026#34;attachment\u0026#34;,URLEncoder.encode(fileName,\u0026#34;UTF-8\u0026#34;)+\u0026#34;.\u0026#34;+fileType); File downloadFile=new File(request.getSession().getServletContext().getRealPath(File.separator)+filePath); return new ResponseEntity\u0026lt;byte[]\u0026gt;(FileUtils.readFileToByteArray(downloadFile),headers,HttpStatus.CREATED); }   è¯¥æ®µä»£ç åœ¨ä¸‹è½½å°æ–‡ä»¶æ—¶å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯å½“è¦ä¸‹è½½çš„æ–‡ä»¶å¾ˆå¤§æ—¶ï¼ˆå¦‚å‡ ç™¾Mæˆ–ä¸ŠGï¼‰ï¼Œå°±ä¼šå‘ç”Ÿå¦‚ä¸‹é”™è¯¯ï¼š\n1 2 3 4  java.lang.OutOfMemoryError: Java heap space at org.apache.commons.io.output.ByteArrayOutputStream.toByteArray(ByteArrayOutputStream.java:271) at org.apache.commons.io.IOUtils.toByteArray(IOUtils.java:219) at org.apache.commons.io.FileUtils.readFileToByteArray(FileUtils.java:1136)   å»ç½‘ä¸Šæœç´¢java.lang.OutOfMemoryError: Java heap space è¿™ä¸ªé”™è¯¯æ—¶ï¼Œä¸€èˆ¬éƒ½å»ºè®®æˆ‘ä»¬åœ¨tomcatä¸­æ·»åŠ å¦‚ä¸‹ç±»ä¼¼è®¾ç½®æ¥æé«˜JVMçš„é…ç½®:\nset JAVA_OPTS=%JAVA_OPTS% -server -Xms800m -Xmx800m -XX:MaxNewSize=256m -XX:MaxPermSize=256m\nä½†å³ä½¿æŒ‰ç…§æŠŠä¸Šé¢çš„å‚æ•°é…ç½®éƒ½æ‰©å¤§ä¸€å€ï¼Œåœ¨ä¸‹è½½æ›´å¤§çš„æ–‡ä»¶æ—¶è¿˜æ˜¯ä¼šé‡åˆ°java.lang.OutOfMemoryError: Java heap spaceè¿™ä¸ªé”™è¯¯ï¼Œä¸Šé¢çš„è§£å†³æ–¹æ³•æ²»æ ‡ä¸æ²»æœ¬ã€‚åˆ†æä¸‹å¼‚å¸¸å †æ ˆå¯ä»¥å‘ç°é—®é¢˜äº§ç”Ÿçš„æ ¹æºåœ¨äºat org.apache.commons.io.FileUtils.readFileToByteArray(FileUtils.java:1136)è¿™è¡Œä»£ç ï¼ŒFileUtils.readFileToByteArrayä¼šæŠŠæ–‡ä»¶ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜ä¸­ï¼Œè¦ä¸‹è½½çš„æ–‡ä»¶è¶Šå¤§ï¼Œéœ€è¦å ç”¨çš„å†…å­˜ä¹Ÿè¶Šå¤§ï¼Œå½“æ–‡ä»¶çš„å¤§å°è¶…è¿‡JVMå’ŒTomcatçš„å†…å­˜é…ç½®æ—¶ï¼ŒOutOfMemoryErrorè¿™ä¸ªé—®é¢˜å°±ä¼šä¸å¯é¿å…çš„å‘ç”Ÿã€‚\nå¼„æ¸…äº§ç”Ÿè¯¥é—®é¢˜çš„åŸå› ä¹‹åï¼Œè§£å†³çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼šä¸åˆ©ç”¨Commons IOæŠŠæ–‡ä»¶ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜ï¼Œè€Œæ˜¯åˆ©ç”¨æ™®é€šçš„æ–‡ä»¶è¾“å‡ºæµæŒ‰å­—èŠ‚åˆ†æ®µå†™å…¥æ–‡ä»¶ï¼ŒæŠŠå ç”¨çš„å†…å­˜å›ºå®šåœ¨ä¸€ä¸ªæŒ‡å®šçš„èŒƒå›´å†…ï¼Œä»æ ¹æœ¬ä¸Šé¿å…å†…å­˜å ç”¨è¿‡é«˜çš„é—®é¢˜,æ›¿ä»£çš„ä»£ç å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  @RequestMapping(\u0026#34;downloadRequireDocument\u0026#34;) public void downloadRequireDocument(String fileId,String fileName,String fileType, HttpServletRequest request,HttpServletResponse response) throws IOException { String filePath = request.getSession().getServletContext().getRealPath(File.separator)+fileName+\u0026#34;.\u0026#34;+fileType; fileName = URLEncoder.encode(fileName.trim(),\u0026#34;UTF-8\u0026#34;)+\u0026#34;.\u0026#34;+fileType; response.setHeader(\u0026#34;Content-Disposition\u0026#34;,\u0026#34;attachment;filename=\u0026#34;+fileName); InputStream is = new FileInputStream(filePath); int read =0; byte[] bytes = new byte[2048]; OutputStream os = response.getOutputStream(); while((read = is.read(bytes))!=-1){//æŒ‰å­—èŠ‚é€ä¸ªå†™å…¥ï¼Œé¿å…å†…å­˜å ç”¨è¿‡é«˜ \tos.write(bytes, 0, read); } os.flush(); os.close(); is.close(); }   ","permalink":"http://isouthrain.github.io/post/spring/spring-mvc/download-big-file-using-springmvc/","tags":["Java","Spring","SpringMVC"],"title":"åˆ©ç”¨SpringMVCä¸‹è½½å¤§æ–‡ä»¶æ—¶å†…å­˜æº¢å‡ºçš„å¤„ç†"},{"categories":["Javaç¼–ç¨‹","Springç³»åˆ—","å•å…ƒæµ‹è¯•"],"contents":"åœ¨è¿›è¡ŒJavaç¨‹åºå¼€å‘æ—¶ï¼Œæˆ‘ä»¬å¶å°”ä¼šè¢«è¦æ±‚ä½¿ç”¨JUnitè¿›è¡Œå•å…ƒæµ‹è¯•æ¥ç¡®ä¿æˆ‘ä»¬æ‰€å†™çš„ç¨‹åºé€»è¾‘æ˜¯æ­£ç¡®çš„ã€‚ä¸€ä¸ªè‰¯å¥½çš„å•å…ƒæµ‹è¯•åº”è¯¥å…·å¤‡ è¦†ç›–åº¦é«˜ï¼Œå¯é‡å¤æ‰§è¡Œ,å•ä¸€æ€§ç­‰ç‰¹ç‚¹ã€‚æœ¬æ–‡ä¸»è¦å…³æ³¨å¯é‡å¤æ‰§è¡Œï¼Œåœ¨Webå¼€å‘ä¸­ï¼Œå¤§éƒ¨åˆ†æ–¹æ³•éƒ½ä¼šä½¿æ•°æ®åº“çš„è®°å½•å‘ç”Ÿå˜åŒ–ï¼Œä¸ºäº†èƒ½å¤Ÿé‡å¤æ‰§è¡Œï¼Œå¿…é¡»åˆ©ç”¨æ•°æ®åº“äº‹åŠ¡æ¥è¿›è¡Œå›æ»šä»è€Œè¾¾åˆ°é‡å¤æ‰§è¡Œçš„ç›®çš„ã€‚æœ€åŸå§‹çš„æ–¹æ³•æ˜¯åˆ©ç”¨ java.sql.Connectionç±»çš„ commit() æˆ– rollback() æ–¹æ³•æ¥åœ¨æ¯ä¸ªå•å…ƒæµ‹è¯•æ–¹æ³•ä¸­æ‰‹åŠ¨çš„è¿›è¡Œæäº¤æˆ–å›æ»šï¼Œæ­¤ç§æ–¹å¼ä½¿å¾—å•å…ƒæµ‹è¯•ä»£ç åµŒå…¥äº†ä¸å®é™…ä¸šåŠ¡é€»è¾‘æ— å…³çš„æ•°æ®åº“æ“ä½œäº‹åŠ¡æ§åˆ¶ä»£ç ã€‚åˆ©ç”¨Springå’ŒJUnité€šè¿‡æ³¨è§£çš„æ–¹å¼æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å¯¹å•å…ƒæµ‹è¯•ä¸­çš„æ•°æ®åº“æ“ä½œè¿›è¡Œäº‹åŠ¡æ§åˆ¶ã€‚\næ‰€æœ‰æ–¹æ³•éƒ½å›æ»š åœ¨è¯¥å•å…ƒæµ‹è¯•ç±»çš„å¼€å¤´åŠ ä¸Š @TransactionConfiguration(defaultRollback=true) å¯ä»¥ç¡®ä¿è¯¥ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•åœ¨æ‰§è¡Œå®Œæ¯•ä¹‹åé»˜è®¤éƒ½è¿›è¡Œå›æ»šã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45  package com.hirain.testmanagement.service.test; import static org.junit.Assert.assertEquals; import java.util.Date; import javax.inject.Inject; import org.junit.Test; import org.junit.runner.RunWith; import org.springframework.test.context.ContextConfiguration; import org.springframework.test.context.junit4.SpringJUnit4ClassRunner; import org.springframework.test.context.transaction.TransactionConfiguration; import org.springframework.transaction.annotation.Transactional; import com.hirain.testmanagement.common.util.StringUtil; import com.hirain.testmanagement.model.ProjectModel; import com.hirain.testmanagement.service.IProjectService; @RunWith(SpringJUnit4ClassRunner.class) @Transactional @TransactionConfiguration(defaultRollback=true) @ContextConfiguration(\u0026#34;classpath:spring/spring-context-*.xml\u0026#34;) public class ProjectServiceTest{ @Inject private IProjectService projectService; @Test @Transactional public void testAddProject(){ ProjectModel pModel=new ProjectModel(); String projectId=StringUtil.getUUID(); pModel.setId(projectId); pModel.setName(\u0026#34;æ±½è½¦ç”µå­æµ‹è¯•ç®¡ç†ç³»ç»Ÿ\u0026#34;); pModel.setAlias(\u0026#34;INTA\u0026#34;); pModel.setLastModifyTime(new Date()); pModel.setLastModifyUser(\u0026#34;6e518d0819d14148ae489f76dad80967\u0026#34;); pModel.setCreateTime(new Date()); pModel.setCreateUser(\u0026#34;cface18d5fac11e28c68c89cdca4c015\u0026#34;); projectService.addProject(pModel); assertEquals(\u0026#34;Add project failed!\u0026#34;,projectService.getProject(projectId).getName(),pModel.getName()); } }   æŒ‡å®šæ–¹æ³•å›æ»š è‹¥æƒ³åªå¯¹æŸä¸ªç‰¹å®šçš„æ–¹æ³•è¿›è¡Œå›æ»šï¼Œéœ€è¦åœ¨è¯¥å•å…ƒæµ‹è¯•ç±»çš„å¼€å¤´å»æ‰ @TransactionConfiguration(defaultRollback=true) ï¼ŒåŒæ—¶åœ¨å¯¹åº”çš„æ–¹æ³•ä¸ŠåŠ ä¸Šæ³¨è§£å£°æ˜ @Rollback(true) å³å¯è¾¾åˆ°ç›®çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  package com.hirain.testmanagement.service.test; import static org.junit.Assert.assertEquals; import java.util.Date; import javax.inject.Inject; import org.junit.Test; import org.junit.runner.RunWith; import org.springframework.test.annotation.Rollback; import org.springframework.test.context.ContextConfiguration; import org.springframework.test.context.junit4.SpringJUnit4ClassRunner; import org.springframework.transaction.annotation.Transactional; import com.hirain.testmanagement.common.util.StringUtil; import com.hirain.testmanagement.model.ProjectModel; import com.hirain.testmanagement.service.IProjectService; @RunWith(SpringJUnit4ClassRunner.class) @Transactional @ContextConfiguration(\u0026#34;classpath:spring/spring-context-*.xml\u0026#34;) public class ProjectServiceTest{ @Inject private IProjectService projectService; @Test @Rollback(true) public void testAddProject(){ ProjectModel pModel=new ProjectModel(); String projectId=StringUtil.getUUID(); pModel.setId(projectId); pModel.setName(\u0026#34;æ±½è½¦ç”µå­æµ‹è¯•ç®¡ç†ç³»ç»Ÿ\u0026#34;); pModel.setAlias(\u0026#34;INTA\u0026#34;); pModel.setLastModifyTime(new Date()); pModel.setLastModifyUser(\u0026#34;6e518d0819d14148ae489f76dad80967\u0026#34;); pModel.setCreateTime(new Date()); pModel.setCreateUser(\u0026#34;cface18d5fac11e28c68c89cdca4c015\u0026#34;); projectService.addProject(pModel); assertEquals(\u0026#34;Add project failed!\u0026#34;,projectService.getProject(projectId).getName(),pModel.getName()); } }   ","permalink":"http://isouthrain.github.io/post/spring/spring-core/using-junit-in-spring/","tags":["Java","JUnit"],"title":"åˆ©ç”¨Springå’ŒJUnitå¯¹æ•°æ®åº“æ“ä½œè¿›è¡Œå•å…ƒæµ‹è¯•"},{"categories":["Javaç¼–ç¨‹","Springç³»åˆ—"],"contents":"åˆ©ç”¨Spring Securityæ¥ç®¡ç†æˆ‘ä»¬çš„webç¨‹åºæ—¶ï¼Œé€šå¸¸éœ€è¦åœ¨UserDetailsServiceæ¥å£ä¸­çš„loadUserByUsernameæ–¹æ³•ä¸­æ¥åˆå§‹åŒ–æƒé™ä¿¡æ¯,ä½†UserDetailsServiceä¸€èˆ¬ç”¨äºç™»å½•éªŒè¯ï¼Œè¿™ä¹Ÿæ„å‘³ç€ç”¨æˆ·çš„æƒé™åœ¨ç™»å½•è¿‡ç¨‹ä¸­å°±ä¼šè¢«è®¡ç®—å‡ºæ¥ã€‚é€šå¸¸æƒ…å†µä¸‹ç”±äºç”¨æˆ·çš„æƒé™å¾ˆå°‘å‘ç”Ÿå˜åŒ–ï¼Œåœ¨ç™»å½•è¿‡ç¨‹ä¸­è®¡ç®—å‡ºç”¨æˆ·æƒé™æ˜¯åˆç†çš„ï¼Œä½†æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸­é€”æ¥åŠ¨æ€çš„æ”¹å˜ç”¨æˆ·çš„æƒé™ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Spring Securityæä¾›çš„APIæ¥å®ç°ã€‚\nä»¥æˆ‘è‡ªå·±çš„é¡¹ç›®ä¸ºä¾‹ï¼ŒUserDetailsServiceæ¥å£ä¸­çš„loadUserByUsernameå…·ä½“å®ç°å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  @Override public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException { UserModel userModel=userDao.getUserByUsername(username); if(userModel==null){ throw new UsernameNotFoundException(username+\u0026#34; not exist!\u0026#34;); } List\u0026lt;GrantedAuthority\u0026gt; userAuthList=new ArrayList\u0026lt;GrantedAuthority\u0026gt;(); //æŸ¥è¯¢å‡ºç”¨æˆ·ç›¸å…³çš„æ‰€æœ‰æƒé™å¹¶æ”¾å…¥Listä¸­ \tList\u0026lt;AuthorityVO\u0026gt; authList=authorityDao.queryAuthorityByUserId(userModel.getId()); for(AuthorityVO authVO:authList){ userAuthList.add(new SimpleGrantedAuthority(authVO.getAuthName())); } //å°†æŸ¥è¯¢å‡ºæ¥çš„æƒé™èµ‹äºˆç”¨æˆ· \tUserDetails userDetails=new User(userModel.getUsername(),userModel.getPassword(),true,true,true,true,userAuthList); return userDetails; }   ä¸Šè¿°ä»£ç ä¼šä¸€æ¬¡æ€§çš„æŠŠç”¨æˆ·æƒé™æŸ¥è¯¢å‡ºæ¥ç„¶åæ”¾å…¥ç‰¹å®šçš„sessionä¸­ï¼Œä½†æ˜¯UserDetailServiceæ–¹æ³•ä¸€èˆ¬åªåœ¨ç”¨æˆ·ç™»å½•webç³»ç»ŸæˆåŠŸæ—¶æ‰ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œä½¿ç”¨èŒƒå›´è¾ƒä¸ºå±€é™ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨ç”¨æˆ·ä½¿ç”¨çš„è¿‡ç¨‹ä¸­åŠ¨æ€çš„æ”¹å˜ç”¨æˆ·çš„æƒé™ï¼ˆè­¬å¦‚åœ¨æˆ‘è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œå½“ç”¨æˆ·é€‰ä¸­ä¸åŒçš„é¡¹ç›®ä¹‹åï¼Œä¸åŒçš„é¡¹ç›®å¯¹åº”ä¸åŒçš„æƒé™ï¼‰ã€‚åˆ©ç”¨ Spring Securityæ¥ç®¡ç†æƒé™ä¿¡æ¯æ—¶ï¼Œç”¨æˆ·çš„æƒé™æœ¬è´¨ä¸Šæ˜¯å­˜å‚¨åœ¨ä¸€ä¸ª sessionä¸­ï¼Œåªä¸è¿‡è¢«Spring Securityè¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…è€Œå·²ã€‚æ‰€ä»¥è‹¥æƒ³åŠ¨æ€çš„æ”¹å˜ç”¨æˆ·çš„æƒé™ï¼Œæˆ‘ä»¬åªéœ€è¦å°†ç”¨æˆ·çš„ä¿¡æ¯é‡æ–°å­˜å‚¨åˆ° sessionä¸­å³å¯ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10  List\u0026lt;GrantedAuthority\u0026gt; authList=new ArrayList\u0026lt;GrantedAuthority\u0026gt;();//ç”¨äºå­˜å‚¨ä¿®æ”¹ä¹‹åçš„æƒé™åˆ—è¡¨ authList.add(new SimpleGrantedAuthority(\u0026#34;addUser\u0026#34;)); authList.add(new SimpleGrantedAuthority(\u0026#34;editUser\u0026#34;)); SecurityContext context=SecurityContextHolder.getContext(); UserDetails userDetails=(UserDetails) context.getAuthentication().getPrincipal(); Authentication auth=new UsernamePasswordAuthenticationToken(userDetails,userDetails.getPassword(),authList); context.setAuthentication(auth); //é‡æ–°è®¾ç½®ä¸Šä¸‹æ–‡ä¸­å­˜å‚¨çš„ç”¨æˆ·æƒé™   ","permalink":"http://isouthrain.github.io/post/spring/update-authority-dynamic-using-spring-security/","tags":["Java","Spring","Spring Security"],"title":"åˆ©ç”¨Spring SecurityåŠ¨æ€æ”¹å˜ç™»å½•ç”¨æˆ·çš„æƒé™"},{"categories":["Javaç¼–ç¨‹","Springç³»åˆ—","å•å…ƒæµ‹è¯•"],"contents":"ç¼–å†™å•å…ƒæµ‹è¯•æ—¶çš„æ³¨æ„äº‹é¡¹ æ ¹æ®è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„TDDç†è®ºï¼Œåœ¨æˆ‘ä»¬ç¼–å†™è‡ªå·±çš„ä»£ç æ—¶ï¼Œè¦å°½é‡ä½¿å¾—è¯¥ä»£ç èƒ½å¤Ÿè¿›è¡Œå•å…ƒæµ‹è¯•ã€‚ä¸ºäº†èƒ½å¤Ÿä½¿å¾—ä»£ç å¯ä»¥è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œæˆ‘ä»¬åœ¨ç»™æ¥å£æˆ–æ–¹æ³•ä¼ å…¥å‚æ•°æ—¶è¦å°½é‡ä¼ å…¥ç®€å•å‚æ•°ï¼Œé¿å…ä¼ å…¥HttpServletRequest , ServletContextç­‰å’Œwebä¸Šä¸‹æ–‡ç›¸å…³çš„å¤æ‚å¯¹è±¡ã€‚ä½†ä»æœ‰éƒ¨åˆ†æƒ…å†µä¸‹åŸºäºä»£ç ç®€æ´æ€§å’Œå¯ç»´æŠ¤æ€§çš„è€ƒè™‘ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥HttpServletRequestå¯¹è±¡ï¼Œæ­¤æ—¶å¯¹æ­¤ç±»æ–¹æ³•è¿›è¡ŒJUnitå•å…ƒæµ‹è¯•æ—¶ä¼šè¾ƒä¸ºå›°éš¾ï¼Œæœ¬æ–‡ä»‹ç»ä¸€ç§åœ¨Springä¸­é€šè¿‡Mockæ¥æ¨¡æ‹ŸHttpServletRequestå¯¹è±¡è¿›è¡ŒJUnitå•å…ƒæµ‹è¯•çš„æ–¹æ³•ã€‚\nå‡è®¾åœ¨HttpServletRequestä¸­æœ‰ä¸€ä¸ªuserIdå­—ç¬¦ä¸²å¯¹è±¡ï¼Œæˆ‘ä»¬æƒ³åœ¨queryUserByIdæ–¹æ³•ä¸­è°ƒç”¨è¯¥å‚æ•°æ¥è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œåˆ™æ­£ç¡®çš„åšæ³•åº”å¦‚ä¸‹æ‰€ç¤º:\n1 2 3 4 5 6 7  String userId = request.getAttribute(\u0026#34;userId\u0026#34;).toString();//å…ˆè·å–userIdå¯¹è±¡ queryUserById(userId);//ç„¶åå°†è·å–çš„userIdä¼ å…¥å¯¹åº”æ–¹æ³•  public User queryUserById(String userId){//ç›¸å…³è¯¥æ–¹æ³•  User userModel = userDao.findById(userId); return userModel; }   è¯·å°½é‡é¿å…ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼\n1 2 3 4 5 6 7 8  queryUserById(request);//ç›´æ¥ä¼ å…¥requestå¯¹è±¡  public User queryUserById(HttpServletRequest request){//ç›¸å…³æ–¹æ³•  String userId = request.getAttribute(\u0026#34;userId\u0026#34;).toString();//åœ¨è¯¥æ–¹æ³•å†…éƒ¨è·å–userId  User userModel = userDao.findById(userId); return userModel; }   è‹¥é‡‡ç”¨ç¬¬ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„è‡ªå·±åˆ¶é€ ä¸€ä¸ªStringå­—ç¬¦ä¸²æ¥ä»£è¡¨userIdè¿›è¡Œæµ‹è¯•ï¼Œä½†å½“é‡‡ç”¨ç¬¬äºŒç§æ–¹æ³•åï¼Œåœ¨è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶æˆ‘ä»¬æ˜¯æ¯”è¾ƒéš¾ä»¥æ¨¡æ‹Ÿä¸€ä¸ªHttpServletRequestå¯¹è±¡ï¼Œä»è€Œå½±å“æˆ‘ä»¬çš„æµ‹è¯•ã€‚\nSpringå’ŒMockåœ¨å•å…ƒæµ‹è¯•ä¸­çš„ä½¿ç”¨ åœ¨æŸäº›æ–¹æ³•ä¸­ï¼Œä¸ºäº†å‡å°‘ä»£ç é‡å’Œæé«˜ç¨‹åºçš„å¯è¯»æ€§ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦ç›´æ¥ä¼ å…¥HttpServletRequestæˆ–ServletContextå¯¹è±¡ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¯¹è¿™ç§æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼Œå¯ä»¥åˆ©ç”¨Mockæ¥æ¨¡æ‹Ÿç›¸å…³çš„å¯¹è±¡ã€‚\nç”±äºSpringè‡ªèº«å·²ç»æ•´åˆäº†Mockç›¸å…³çš„ç±»ï¼Œæ•…åœ¨æ­¤å¤„å±•ç¤ºä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œä»¥ä¾›å‚è€ƒ:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  import java.io.File; import org.junit.Test; import org.springframework.mock.web.MockHttpServletRequest; import org.springframework.mock.web.MockServletContext; public class SpringMockTest { @Test public void testHttpServletRequest(){ String realPath =\u0026#34;file:D:\\\\Java\\\\apache-tomcat-7.0.23\\\\webapps\\\\tmn\u0026#34;; //æ¨¡æ‹ŸServletContext,åŒæ—¶åˆå§‹åŒ–realPathï¼Œæ³¨æ„è¦æœ‰file:å‰ç¼€å¦åˆ™ä¼šæŠ¥é”™ \tMockServletContext context = new MockServletContext(realPath); //è·å–realPath \tSystem.out.println(context.getRealPath(File.separator)); //æ¨¡æ‹ŸHttpServletRequest \tMockHttpServletRequest request = new MockHttpServletRequest(context); //é€šè¿‡HttpServletRequestæ¥è·å–realPath \tSystem.out.println(request.getSession().getServletContext().getRealPath(File.separator)); } }   æ³¨æ„:è¯·åœ¨ä¸Šä¸‹æ–‡è·¯å¾„çš„å­—ç¬¦ä¸²å‰é¢åŠ ä¸Šfile:å‰ç¼€ï¼Œå¦åˆ™ç¨‹åºä¼šæŠ¥é”™ã€‚å¦‚ä¸Šé¢çš„ç¨‹åºï¼ŒrealPathçš„å€¼åº”ä¸º file:D:\\Java\\apache-tomcat-7.0.23\\webapps\\tmn ï¼Œè‹¥å»æ‰file:å‰ç¼€ï¼Œæ”¹ä¸º D:\\Java\\apache-tomcat-7.0.23\\webapps\\tmn ï¼Œåˆ™ç¨‹åºä¼šæŠ¥é”™ã€‚\n","permalink":"http://isouthrain.github.io/post/spring/spring-mvc/using-mock-test-http-servlet-request/","tags":["Java","Spring","SpringMVC","JUnit"],"title":"åœ¨Springä¸­åˆ©ç”¨Mockå¯¹HttpServletRequestè¿›è¡Œå•å…ƒæµ‹è¯•"},{"categories":["å…¶å®ƒ"],"contents":"Mediawikiæ˜¯ç»´åŸºç™¾ç§‘ç³»ç»Ÿæ‰€é‡‡ç”¨çš„æ¡†æ¶ï¼Œé€‚åˆäºéœ€è¦å¿«é€Ÿæ­å»ºçŸ¥è¯†åˆ†äº«çš„åœºåˆã€‚é‡‡ç”¨Mediawikiç”Ÿæˆçš„çŸ¥è¯†å…±äº«å¹³å°å’Œç»´åŸºç™¾ç§‘çš„æ“ä½œä¸ä½¿ç”¨ç±»ä¼¼ï¼Œéƒ½æ”¯æŒé‡‡ç”¨Markdownè¯­æ³•æ¥ç¼–è¾‘ã€‚åœ¨æœ‰äº›æ—¶å€™ï¼ŒæŸäº›è¯æ¡çš„å†…å®¹å¾ˆé•¿ï¼Œä½¿å¾—æµè§ˆå™¨å‡ºç°äº†æ»šåŠ¨æ¡ï¼Œå¦‚æœèƒ½ä»¿ç…§å¾®åšç­‰ç½‘ç«™æ·»åŠ ä¸€ä¸ªå›åˆ°é¡¶éƒ¨çš„åŠŸèƒ½ï¼Œå°†ä¼šç»™æˆ‘ä»¬çš„ä½¿ç”¨å¸¦æ¥å¾ˆå¤§çš„ä¾¿åˆ©ï¼Œæœ¬æ–‡ä»‹ç»ä¸€ç§å®ç°æ–¹æ³•ï¼š\n  ä»¥ Mediawiki ç®¡ç†å‘˜èº«ä»½ç™»å½•mediawiki,åœ¨æœç´¢æ è¾“å…¥MediaWiki:Common.js,ç„¶åè¾“å…¥å¦‚ä¸‹ä»£ç å¹¶ä¿å­˜ï¼š\n1 2 3 4 5 6 7 8  /* æ­¤å¤„çš„JavaScriptå°†åŠ è½½äºæ‰€æœ‰ç”¨æˆ·æ¯ä¸€ä¸ªé¡µé¢ã€‚ */ $(window).scroll(function(){ if($(window).scrollTop()\u0026gt;100){ $(\u0026#34;.back-to-top\u0026#34;).fadeIn(1000); }else{ $(\u0026#34;.back-to-top\u0026#34;).fadeOut(1000); } });     åœ¨mediawiki\\skins\\Vector.phpä¸­çš„ç¬¬252è¡Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š\n1 2 3  \u0026lt;div class=\u0026#34;back-to-top\u0026#34; onClick=\u0026#34;$(\u0026#39;html,body\u0026#39;).animate({scrollTop:0},500);\u0026#34;\u0026gt; \u0026lt;span\u0026gt;è¿”å›é¡¶éƒ¨\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt;     åœ¨mediawiki\\skins\\vector\\screen.cssçš„æœ€åæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  .back-to-top { position: fixed; bottom: 6em; right: 3em; background-color: rgba(46, 46, 46, 0.8); text-align: center; padding: 5px 6px; color: #eee; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; cursor: pointer; display: none; } .back-to-top:hover { background: rgba(0, 221, 255, 0.8); }     å½“é¡µé¢çš„é«˜åº¦è¶…å‡ºé™åˆ¶æ—¶ï¼Œå°±ä¼šå‡ºç°â€œè¿”å›é¡¶éƒ¨â€çš„æ‚¬æµ®æ¡†ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š\n ","permalink":"http://isouthrain.github.io/post/web/mediawiki-back-to-top/","tags":["Mediawiki"],"title":"Mediawikiæ·»åŠ å›åˆ°é¡¶éƒ¨çš„æ–¹æ³•"},{"categories":["Javaç¼–ç¨‹","ç¿»è¯‘"],"contents":"æœ¬æ–‡ç¿»è¯‘è‡ª Java Volatile Keyword\nJavaå…³é”®å­—volatileç”¨äºå°†ä¸€ä¸ªJavaå˜é‡æ ‡è®°ä¸ºåœ¨ä¸»å†…ä¸­å­˜å‚¨ï¼Œæ›´å‡†ç¡®çš„è§£é‡Šä¸ºï¼šæ¯æ¬¡è¯»å–ä¸€ä¸ªvolatileå˜é‡æ—¶å°†ä»ç”µè„‘çš„ä¸»å†…å­˜ä¸­è¯»å–è€Œä¸æ˜¯ä»CPUç¼“å­˜ä¸­è¯»å–ï¼Œæ¯æ¬¡å¯¹ä¸€ä¸ªvolatileå˜é‡è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œå°†ä¼šå†™å…¥åˆ°ä¸»å†…å­˜ä¸­è€Œä¸æ˜¯å†™å…¥åˆ°CPUç¼“å­˜ä¸­ã€‚\näº‹å®ä¸Šï¼Œä»Java5ä¹‹åï¼Œvolatileå…³é”®å­—ä¸ä»…ä»…å¯ä»¥ç”¨æ¥ç¡®ä¿volatileå˜é‡æ˜¯å†™å…¥åˆ°ä¸»å†…å­˜å’Œä»ä¸»å†…å­˜è¯»å–æ•°æ®ï¼Œæˆ‘ä¼šåœ¨ä¸‹é¢çš„ç« èŠ‚è¿›è¡Œè¯¦ç»†çš„ä»‹ç»ï¼š\nVolatileå˜é‡å¯è§æ€§ä¿è¯ Javaä¸­çš„volatileå…³é”®å­—ç¡®ä¿äº† volatileå˜é‡çš„ä¿®æ”¹åœ¨å¤šçº¿ç¨‹ä¸­æ˜¯å¯è§çš„ã€‚è¿™å¬èµ·æ¥æœ‰äº›æŠ½è±¡ï¼Œæ¥ä¸‹æ¥æˆ‘å°†è¯¦ç»†è¯´æ˜ã€‚\nåœ¨ä¸€ä¸ªå¯¹évolatileå˜é‡è¿›è¡Œæ“ä½œçš„å¤šçº¿ç¨‹åº”ç”¨ï¼Œç”±äºæ€§èƒ½çš„å…³ç³»ï¼Œå½“å¯¹è¿™äº›å˜é‡è¿›è¡Œè¯»å†™æ—¶ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½å¯èƒ½ä»ä¸»çº¿ç¨‹ä¸­æ‹·è´å˜é‡åˆ°CPUç¼“å­˜ä¸­ã€‚å¦‚æœä½ çš„ç”µè„‘ä¸æ­¢ä¸€ä¸ªCPUï¼Œæ¯ä¸ªçº¿ç¨‹å¯èƒ½ä¼šåœ¨ä¸åŒçš„CPUä¸Šè¿è¡Œã€‚è¿™æ„å‘³ç€ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½å¯èƒ½å°†å˜é‡æ‹·è´åˆ°ä¸åŒçš„CPUçš„CPUç¼“å­˜ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nå¯¹äºévolatileå˜é‡è€Œè¨€ï¼ŒJavaè™šæ‹Ÿæœº(JVM)ä¸èƒ½ç¡®ä¿ä»€ä¹ˆæ—¶å€™å°†æ•°æ®ä»ä¸»å†…å­˜è¯»å–åˆ°CPUç¼“å­˜ä»¥åŠä»€ä¹ˆæ—¶å€™å°†CPUç¼“å­˜çš„æ•°æ®å†™å…¥åˆ°ä¸»å†…å­˜ä¸­ã€‚è€Œè¿™å¯èƒ½ä¼šå¼•èµ·ä¸€äº›é—®é¢˜ï¼Œæˆ‘å°†ç¨åè§£é‡Šã€‚\nå‡è®¾ä¸¤ä¸ªæˆ–æ›´å¤šçš„çº¿ç¨‹å¯¹ä¸‹é¢è¿™ä¸ªåŒ…å«ä¸€ä¸ªè®¡æ•°å™¨çš„å…±äº«å˜é‡æ‹¥æœ‰è®¿é—®æƒé™ï¼š\n1 2 3  public class SharedObject { public int counter = 0; }   å†æ¬¡å‡è®¾ï¼Œåªæœ‰Thread1ä¼šå¢åŠ counterå˜é‡çš„å€¼ï¼Œä½†æ˜¯Thread1å’ŒThread2éƒ½èƒ½åœ¨ä»»æ„æ—¶åˆ»è¯»å–counterå˜é‡çš„å€¼ã€‚\nå¦‚æœcounerå˜é‡æ²¡æœ‰å£°æ˜ä¸ºvolatileå°†æ— æ³•ä¿è¯åœ¨ä½•æ—¶æŠŠCPUç¼“å­˜ä¸­çš„å€¼å†™å…¥ä¸»å†…å­˜ä¸­ã€‚è¿™æ„å‘³ç€counterå˜é‡åœ¨CPUç¼“å­˜ä¸­çš„å€¼å¯èƒ½ä¼šä¸ä¸»å†…å­˜ä¸­çš„å€¼ä¸ä¸€æ ·ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\né€ æˆçº¿ç¨‹ä¸èƒ½è·å–å˜é‡æœ€æ–°å€¼å¾—åŸå› ä¸ºå˜é‡å€¼æ²¡æœ‰è¢«å…¶å®ƒçº¿ç¨‹åŠæ—¶å†™å›ä¸»å†…å­˜ä¸­ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å¯è§æ€§é—®é¢˜ã€‚æŸä¸ªçº¿ç¨‹çš„æ›´æ–°å¯¹å…¶å®ƒçº¿ç¨‹ä¸å¯è§ã€‚\nå°†counterå˜é‡å£°æ˜ä¸ºvolatileä¹‹åï¼Œæ‰€æœ‰å¯¹counterå˜é‡çš„å†™æ“ä½œä¼šç«‹å³å†™å…¥ä¸»å†…å­˜ä¸­ï¼ŒåŒæ ·ï¼Œæ‰€æœ‰å¯¹counterå˜é‡çš„è¯»æ“ä½œéƒ½ä¼šä»ä¸»å†…å­˜ä¸­è¯»å–æ•°æ®ã€‚ä¸‹é¢çš„ä»£ç å—å±•ç¤ºäº†å¦‚ä½•å°†counterå˜é‡å£°æ˜ä¸ºvolatile ï¼š\n1 2 3  public class SharedObject { public volatile int counter = 0; }   å› æ­¤å®šä¹‰ä¸€ä¸ªvolatileå˜é‡å¯ä»¥ä¿è¯å†™å˜é‡çš„æ“ä½œå¯¹äºå…¶å®ƒçº¿ç¨‹å¯è§ã€‚\nVolatileå…ˆè¡Œå‘ç”ŸåŸåˆ™ ä»Java5ä¹‹åvolatileå…³é”®å­—ä¸ä»…èƒ½ç”¨äºç¡®ä¿å˜é‡ä»ä¸»å†…å­˜ä¸­è¯»å–å’Œå†™å…¥ï¼Œäº‹å®ä¸Švolatileå…³é”®å­—è¿˜æœ‰å¦‚ä¸‹ä½œç”¨ï¼š\n å¦‚æœçº¿ç¨‹Aå†™å…¥äº†ä¸€ä¸ªvolatileå˜é‡ç„¶åçº¿ç¨‹Bè¯»å–äº†è¿™ä¸ªç›¸åŒçš„volatileå˜é‡ï¼Œé‚£ä¹ˆæ‰€æœ‰åœ¨çº¿ç¨‹Aå†™ä¹‹å‰å¯¹å…¶å¯è§çš„å˜é‡ï¼Œåœ¨çº¿ç¨‹Bè¯»å–è¿™ä¸ª volatileä¹‹åä¹Ÿä¼šå¯¹å…¶å¯è§ã€‚ volatileå˜é‡çš„è¯»å†™æŒ‡ä»¤ä¸èƒ½è¢«JVMé‡æ’åºï¼ˆå‡ºäºæ€§èƒ½çš„è€ƒè™‘ï¼ŒJVMå¯èƒ½ä¼šå¯¹æŒ‡ä»¤é‡æ’åºå¦‚æœJVMæ£€æµ‹åˆ°æŒ‡ä»¤æ’åºä¸ä¼šå¯¹ç¨‹åºè¿è¡Œäº§ç”Ÿå˜åŒ–ï¼‰ã€‚å‰åçš„æŒ‡ä»¤å¯ä»¥é‡æ’åºï¼Œä½†æ˜¯volatileå˜é‡çš„è¯»å’Œå†™ä¸èƒ½ä¸è¿™äº›é‡æ’åºæŒ‡ä»¤æ··åœ¨ä¸€èµ·ã€‚ä»»ä½•è·Ÿéšåœ¨volatileå˜é‡è¯»å†™ä¹‹åçš„æŒ‡ä»¤éƒ½ä¼šç¡®ä¿åªæœ‰åœ¨å˜é‡çš„è¯»å†™æ“ä½œä¹‹åæ‰èƒ½æ‰§è¡Œã€‚  ä¸Šè¿°è¯´æ˜éœ€è¦æ›´è¿›ä¸€æ­¥çš„è§£é‡Šã€‚\nå½“ä¸€ä¸ªçº¿ç¨‹å‘ä¸€ä¸ªvolatileå˜é‡å†™æ“ä½œï¼Œæ­¤æ—¶ä¸ä»…è¿™ä¸ªvolatileå˜é‡è‡ªèº«ä¼šå†™å…¥ä¸»å†…å­˜ï¼Œæ‰€æœ‰è¿™ä¸ªvolatileå˜é‡å†™å…¥ä¹‹å‰å—å½±å“å‘ç”Ÿæ”¹å˜çš„å˜é‡ä¹Ÿä¼šåˆ·å†™å…¥ä¸»å†…å­˜ã€‚å½“ä¸€ä¸ªçº¿ç¨‹å‘ä¸€ä¸ªvolatileå˜é‡è¯»æ“ä½œæ—¶å®ƒåŒæ ·ä¹Ÿä¼šä»ä¸»å†…å­˜ä¸­è¯»å–æ‰€æœ‰å’Œè¿™ä¸ªvolatileå˜é‡ä¸€èµ·åˆ·å†™å…¥ä¸»å†…å­˜çš„å˜é‡ã€‚\nçœ‹çœ‹ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7  Thread A: sharedObject.nonVolatile = 123; sharedObject.counter = sharedObject.counter + 1; Thread B: int counter = sharedObject.counter; int nonVolatile = sharedObject.nonVolatile;   ç”±äºçº¿ç¨‹Aåœ¨å†™æ“ä½œvolatileå˜é‡sharedObject.counterä¹‹å‰å†™æ“ä½œévolatileå˜é‡sharedObject.nonVolatileï¼Œå› è€Œå½“çº¿ç¨‹Aå†™æ“ä½œå˜é‡sharedObject.counterå,å˜é‡sharedObject.nonVolatileå’ŒsharedObject.counteréƒ½è¢«å†™å…¥ä¸»å†…å­˜ã€‚\nç”±äºçº¿ç¨‹Bä»¥è¯»å–volatileå˜é‡sharedObject.counterå¼€å§‹ï¼Œå› è€Œå˜é‡sharedObject.counterå’Œå˜é‡sharedObject.nonVolatileéƒ½ä¼šè¢«å†™å…¥çº¿ç¨‹Bæ‰€ä½¿ç”¨çš„CPUç¼“å­˜ä¸­ã€‚å½“çº¿ç¨‹Bè¯»å–sharedObject.nonVolatileå˜é‡æ—¶ï¼Œå®ƒå°†èƒ½çœ‹è§è¢«çº¿ç¨‹Aå†™å…¥çš„å˜é‡ã€‚\nå¼€å‘äººå‘˜å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ‰©å±•çš„å¯è§æ€§æ¥ä¼˜åŒ–çº¿ç¨‹ä¹‹é—´å˜é‡çš„å¯è§æ€§ã€‚ä¸åŒäºæŠŠæ¯ä¸ªå˜é‡éƒ½è®¾ç½®ä¸ºvolatile ï¼Œæ­¤æ—¶åªæœ‰å°‘éƒ¨åˆ†å˜é‡éœ€è¦å£°æ˜ä¸ºvolatile ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ©ç”¨æ­¤è§„åˆ™ç¼–å†™çš„ç®€å•ç¤ºä¾‹ç¨‹åºExchanger ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  public class Exchanger { private Object object = null; private volatile hasNewObject = false; public void put(Object newObject) { while(hasNewObject) { //ç­‰å¾…ï¼Œä¸è¦†ç›–å·²ç»å­˜åœ¨çš„æ–°å¯¹è±¡  } object = newObject; hasNewObject = true; //volatileå†™å…¥  } public Object take(){ while(!hasNewObject){ //volatileè¯»å–  //ç­‰å¾…ï¼Œä¸è·å–æ—§çš„å¯¹è±¡ï¼ˆæˆ–nullå¯¹è±¡ï¼‰  } Object obj = object; hasNewObject = false; //volatileå†™å…¥  return obj; } }   çº¿ç¨‹Aéšæ—¶å¯èƒ½ä¼šé€šè¿‡è°ƒç”¨put()æ–¹æ³•å¢åŠ å¯¹è±¡ï¼Œçº¿ç¨‹Béšæ—¶å¯èƒ½ä¼šé€šè¿‡è°ƒç”¨ take()æ–¹æ³•è·å–å¯¹è±¡ã€‚åªè¦çº¿ç¨‹Aåªè°ƒç”¨ put() ï¼Œçº¿ç¨‹Båªè°ƒç”¨take() ,è¿™ä¸ªExchangerå°±å¯ä»¥é€šè¿‡ä¸€ä¸ªvolatileå˜é‡æ­£å¸¸å·¥ä½œï¼ˆæ’é™¤ synchronizedä»£ç å—çš„ä½¿ç”¨ï¼‰ã€‚\nç„¶è€Œï¼ŒJVMå¯èƒ½ä¼šé‡æ’åºJavaæŒ‡ä»¤æ¥ä¼˜åŒ–æ€§èƒ½ï¼Œå¦‚æœJVMå¯ä»¥é€šè¿‡ä¸æ”¹å˜è¿™äº›é‡æ’åºæŒ‡ä»¤çš„è¯­ä¹‰æ¥å®ç°æ­¤åŠŸèƒ½ã€‚å¦‚æœJVMè°ƒæ¢äº†put()å’Œ take()ä¸­çš„è¯»å’Œå†™çš„æŒ‡ä»¤ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœput()çœŸçš„åƒä¸‹é¢è¿™æ ·æ‰§è¡Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ\n1 2 3 4 5  while(hasNewObject) { //ç­‰å¾…ï¼Œä¸è¦†ç›–å·²ç»å­˜åœ¨çš„æ–°å¯¹è±¡ } hasNewObject = true; //volatileå†™å…¥ object = newObject;   è¯·æ³¨æ„æ­¤æ—¶å¯¹äºvolatileå˜é‡hasNewObjectçš„å†™æ“ä½œä¼šåœ¨æ–°å˜é‡çš„å®é™…è®¾ç½®å‰å…ˆæ‰§è¡Œï¼Œè€Œè¿™åœ¨JVMçœ‹æ¥å¯èƒ½ä¼šå®Œå…¨åˆæ³•ã€‚ä¸¤ä¸ªå†™æ“ä½œæŒ‡ä»¤çš„å€¼ä¸å†ä¾èµ–äºå¯¹æ–¹ã€‚\nä½†æ˜¯ï¼Œå¯¹äºæ‰§è¡ŒæŒ‡ä»¤é‡æ’åºå¯èƒ½ä¼šæŸå®³objectå˜é‡çš„å¯è§æ€§ã€‚é¦–å…ˆï¼Œçº¿ç¨‹Bå¯èƒ½ä¼šåœ¨çº¿ç¨‹Aå¯¹objectçœŸå®çš„å†™å…¥ä¸€ä¸ªå€¼åˆ°objectä¹‹å‰è¯»å–åˆ°hasNewObjectçš„å€¼ä¸ºtrueã€‚å…¶æ¬¡,ç°åœ¨ç”šè‡³ä¸èƒ½ä¿è¯ä»€ä¹ˆæ—¶å€™å†™å…¥objectçš„æ–°å€¼ä¼šåˆ·å†™å…¥ä¸»å†…å­˜ï¼ˆå¥½å§ï¼Œä¸‹æ¬¡çº¿ç¨‹Aåœ¨å…¶å®ƒåœ°æ–¹å†™å…¥ volatileå˜é‡ã€‚ã€‚ã€‚ï¼‰\nä¸ºäº†é˜»æ­¢ä¸Šé¢æ‰€è¿°çš„è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œvolatileå…³é”®å­—æä¾›äº†ä¸€ä¸ª å…ˆè¡Œå‘ç”ŸåŸåˆ™ã€‚å…ˆè¡Œå‘ç”Ÿä¿è¯ç¡®ä¿å¯¹äºvolatileå˜é‡çš„è¯»å†™æŒ‡ä»¤ä¸ä¼šè¢«é‡æ’åºã€‚ç¨‹åºè¿è¡Œä¸­å‰åçš„æŒ‡ä»¤å¯èƒ½ä¼šè¢«é‡æ’åºï¼Œä½†æ˜¯volatileè¯»å†™æŒ‡ä»¤ä¸èƒ½å’Œå®ƒå‰åçš„ä»»ä½•æŒ‡ä»¤é‡æ–°æ’åºã€‚\nçœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9  sharedObject.nonVolatile1 = 123; sharedObject.nonVolatile2 = 456; sharedObject.nonVolatile3 = 789; sharedObject.volatile = true; //a volatile variable  int someValue1 = sharedObject.nonVolatile4; int someValue2 = sharedObject.nonVolatile5; int someValue3 = sharedObject.nonVolatile6;   JVMå¯èƒ½ä¼šé‡æ–°æ’åºå‰3æ¡æŒ‡ä»¤ï¼Œåªè¦å®ƒä»¬éƒ½å…ˆå‘ç”Ÿäºvolatileå†™æŒ‡ä»¤ï¼ˆå®ƒä»¬éƒ½å¿…é¡»åœ¨volatileå†™æŒ‡ä»¤ä¹‹å‰æ‰§è¡Œï¼‰ã€‚\nåŒæ ·çš„ï¼ŒJVMå¯èƒ½ä¼šé‡æ–°æ’åºæœ€å3æ¡æŒ‡ä»¤ï¼Œåªè¦volatileå†™æŒ‡ä»¤å…ˆè¡Œå‘ç”Ÿäºå®ƒä»¬ï¼Œè¿™3æ¡æŒ‡ä»¤éƒ½ä¸èƒ½è¢«é‡æ–°æ’åºåˆ°volatileæŒ‡ä»¤çš„å‰é¢ã€‚\nè¿™å°±æ˜¯volatileå…ˆè¡Œå‘ç”ŸåŸåˆ™çš„åŸºæœ¬å«ä¹‰ã€‚\nVolatileå¹¶ä¸æ˜¯ä¸‡èƒ½çš„ å°½ç®¡volatileå…³é”®å­—ç¡®ä¿äº†æ‰€æœ‰å¯¹äºvolatileå˜é‡çš„è¯»æ“ä½œéƒ½æ˜¯ç›´æ¥ä»ä¸»å†…å­˜ä¸­è¯»å–çš„ï¼Œæ‰€æœ‰å¯¹äºvolatileå˜é‡çš„å†™æ“ä½œéƒ½æ˜¯ç›´æ¥å†™å…¥ä¸»å†…å­˜çš„ï¼Œä½†ä»æœ‰ä¸€äº›æƒ…å†µåªå®šä¹‰ä¸€ä¸ªvolatileå˜é‡æ˜¯ä¸å¤Ÿçš„ã€‚\nåœ¨å‰é¢çš„åœºæ™¯ä¸­ï¼Œçº¿ç¨‹1å¯¹å…±äº«å˜é‡counterå†™å…¥æ“ä½œï¼Œå£°æ˜counterå˜é‡ä¸ºvolatileä¹‹åå°±èƒ½å¤Ÿç¡®ä¿çº¿ç¨‹2æ€»æ˜¯å¯ä»¥çœ‹è§æœ€æ–°çš„å†™å…¥å€¼ã€‚\näº‹å®ä¸Šï¼Œå¦‚æœå†™å…¥è¯¥å˜é‡çš„å€¼ä¸ä¾èµ–äºå®ƒå‰é¢çš„å€¼ï¼Œå¤šä¸ªçº¿ç¨‹ç”šè‡³å¯ä»¥åœ¨å†™å…¥ä¸€ä¸ªå…±äº«çš„volatileå˜é‡æ—¶ä»ç„¶èƒ½å¤ŸæŒæœ‰åœ¨ä¸»å†…å­˜ä¸­å­˜å‚¨çš„æ­£ç¡®å€¼ã€‚æ¢å¥è¯è§£é‡Šä¸ºï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨å†™å…¥volatileå…±äº«å˜é‡æ—¶ï¼Œä¸éœ€è¦å…ˆè¯»å–è¯¥å˜é‡çš„å€¼ä»¥è®¡ç®—ä¸‹ä¸€ä¸ªå€¼ã€‚\nä¸€æ—¦ä¸€ä¸ªçº¿ç¨‹éœ€è¦é¦–å…ˆè¯»å–ä¸€ä¸ªvolatileå˜é‡çš„å€¼ï¼Œç„¶ååŸºäºè¯¥å€¼äº§ç”Ÿvolatileå…±äº«å˜é‡çš„ä¸‹ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆè¯¥ volatile å˜é‡å°†ä¸å†èƒ½å¤Ÿå®Œå…¨ç¡®ä¿æ­£ç¡®çš„å¯è§æ€§ã€‚åœ¨è¯»å–volatileå˜é‡å’Œå†™å…¥å®ƒçš„æ–°å€¼è¿™ä¸ªå¾ˆçŸ­çš„æ—¶é—´é—´éš”å†…ï¼Œäº§ç”Ÿäº†ä¸€ä¸ª ç«äº‰æ¡ä»¶ :å¤šä¸ªçº¿ç¨‹å¯èƒ½ä¼šè¯»å– volatileå˜é‡çš„ç›¸åŒå€¼ï¼Œç„¶åäº§ç”Ÿæ–°å€¼å¹¶å†™å…¥ä¸»å†…å­˜ï¼Œè¿™æ ·å°†ä¼šè¦†ç›–äº’ç›¸çš„å€¼ã€‚\nè¿™ç§å¤šä¸ªçº¿ç¨‹åŒæ—¶å¢åŠ ç›¸åŒè®¡æ•°å™¨çš„åœºæ™¯æ­£æ˜¯volatileå˜é‡ä¸é€‚ç”¨çš„åœ°æ–¹ï¼Œæ¥ä¸‹æ¥çš„éƒ¨åˆ†è¿›è¡Œäº†æ›´è¯¦ç»†çš„è§£é‡Šã€‚\nå‡è®¾çº¿ç¨‹1è¯»å–ä¸€ä¸ªå€¼ä¸º0çš„å…±äº«å˜é‡counteråˆ°å®ƒçš„CPUç¼“å­˜ä¸­ï¼Œå°†å®ƒåŠ 1ä½†æ˜¯å¹¶æ²¡æœ‰å°†å¢åŠ åçš„å€¼å†™å…¥ä¸»å†…å­˜ä¸­ã€‚çº¿ç¨‹2å¯èƒ½ä¼šä»ä¸»å†…å­˜ä¸­è¯»å–åŒä¸€ä¸ªcounterå˜é‡ï¼Œå…¶å€¼ä»ç„¶ä¸º0ï¼ŒåŒæ ·ä¸å°†å…¶å†™å…¥ä¸»å†…å­˜ä¸­ï¼Œå°±å¦‚ä¸‹é¢çš„å›¾ç‰‡æ‰€å±•ç¤ºçš„é‚£æ ·ï¼š\nçº¿ç¨‹1å’Œçº¿ç¨‹2ç°åœ¨éƒ½æ²¡æœ‰åŒæ­¥ï¼Œå…±äº«å˜é‡counterçš„çœŸå®å€¼åº”è¯¥æ˜¯2ï¼Œä½†æ˜¯åœ¨æ¯ä¸ªçº¿ç¨‹çš„CPUç¼“å­˜ä¸­ï¼Œå…¶å€¼éƒ½ä¸º1ï¼Œå¹¶ä¸”ä¸»å†…å­˜ä¸­çš„å€¼ä»ç„¶æ˜¯0ã€‚å®ƒæˆäº†ä¸€ä¸ªçƒ‚æ‘Šå­ï¼Œå³ä½¿è¿™äº›çº¿ç¨‹ç»ˆäºå®ƒä»¬å¯¹å…±äº«å˜é‡counterçš„è®¡ç®—å€¼å†™å…¥åˆ°ä¸»å†…å­˜ä¸­ï¼Œcounterçš„å€¼ä»ç„¶æ˜¯é”™çš„ã€‚\nVolatileçš„é€‚ç”¨åœºæ™¯ å°±å¦‚åœ¨å‰é¢æåˆ°çš„é‚£æ ·ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¯¹ä¸€ä¸ªå…±äº«å˜é‡è¿›è¡Œè¯»å’Œå†™ï¼Œé‚£ä¹ˆä»…ç”¨volatileå˜é‡æ˜¯ä¸å¤Ÿçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦ä½¿ç”¨ synchronizedæ¥ç¡®ä¿å…³äºè¯¥å˜é‡çš„è¯»å’Œå†™éƒ½æ˜¯åŸå­æ“ä½œã€‚è¯»æˆ–å†™ä¸€ä¸ªvolatileå˜é‡æ—¶å¹¶ä¸ä¼šé˜»å¡å…¶å®ƒçº¿ç¨‹å¯¹è¯¥å˜é‡çš„è¯»å’Œå†™ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹å¿…é¡»ç”¨synchronziedå…³é”®å­—æ¥ä¿®é¥°ä½ çš„å…³é”®ä»£ç ã€‚\né™¤äº†ä½¿ç”¨synchronziedä¹‹å¤–ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ java.util.concurrentåŒ…ä¸­çš„ä¸€äº›åŸå­æ•°æ®ç±»å‹ï¼Œå¦‚ AtomicLong ï¼Œ AtomicReferenceç­‰ã€‚\nå½“åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹ä¸€ä¸ªvolatileå˜é‡è¿›è¡Œè¯»å†™è€Œå…¶å®ƒçº¿ç¨‹åªè¯»å–è¯¥å˜é‡æ—¶ï¼Œ volatileå¯ä»¥ç¡®ä¿è¿™äº›è¯»çº¿ç¨‹è¯»å–åˆ°çš„æ˜¯è¯¥å˜é‡çš„æœ€æ–°å†™å…¥å€¼ã€‚å¦‚æœä¸å£°æ˜è¯¥å˜é‡ä¸ºvolatile ï¼Œåˆ™ä¸èƒ½è¿™äº›è¯»çº¿ç¨‹ä¿è¯è¯»å–çš„æ˜¯æœ€æ–°å†™å…¥å€¼ã€‚\nvolatileå…³é”®å­—é€‚ç”¨äº32ä½å˜é‡å’Œ64ä½å˜é‡ã€‚\nVolatileæ€§èƒ½æ€è€ƒ ç”±äºvolatileå˜é‡çš„è¯»å’Œå†™éƒ½æ˜¯ç›´æ¥ä»ä¸»å†…å­˜ä¸­è¿›è¡Œçš„ï¼Œç›¸å¯¹äºCPUç¼“å­˜ï¼Œç›´æ¥å¯¹ä¸»å†…å­˜è¿›è¡Œè¯»å†™ä»£ä»·æ›´é«˜ï¼Œ è®¿é—®ä¸€ä¸ªvolatileå˜é‡ä¹Ÿä¼šé˜»æ­¢æŒ‡ä»¤é‡æ–°æ’åºï¼Œè€ŒæŒ‡ä»¤æ’åºä¹Ÿæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ€§èƒ½å¢å¼ºæŠ€æœ¯ã€‚å› æ­¤ï¼Œä½ åº”è¯¥åœ¨åªæœ‰å½“ä½ ç¡®å®éœ€è¦ç¡®ä¿å˜é‡å¯è§æ€§çš„æ—¶å€™æ‰ä½¿ç”¨volatileå˜é‡ã€‚\n\u0026lt;\u0026ndash;ç»ˆäºç¿»è¯‘å®Œäº†!\u0026ndash;\u0026gt;\n","permalink":"http://isouthrain.github.io/post/java-concurrency/java-volatile-keyword/","tags":["Java","Java Concurrency"],"title":"[è¯‘] Java Volatile å…³é”®å­—è¯¦è§£"},{"categories":["Javaç¼–ç¨‹","æ•°æ®åº“"],"contents":"é¡¹ç›®ä¸­ç”¨åˆ°äº†MySQLæ•°æ®åº“çš„å¤‡ä»½åŠŸèƒ½ï¼Œé€šè¿‡è°ƒç”¨Javaç¨‹åºä¸­çš„Runtimeæ¥æ‰§è¡Œmysqldumpå‘½ä»¤è‡ªåŠ¨çš„ç”Ÿæˆç›¸å…³çš„MySQLæ•°æ®åº“æ–‡ä»¶ä»¥ä¾›æ¢å¤ä¹‹ç”¨ã€‚ç›¸å…³çš„ä»£ç å¦‚ä¸‹:\n1 2 3 4  Runtime runtime = Runtime.getRuntime(); String mysqlCmd = \u0026#34;mysqldump\u0026#34; + \u0026#34; -u\u0026#34; + username + \u0026#34; -p\u0026#34; + password + \u0026#34; -h \u0026#34; + databaseAddress + \u0026#34; \u0026#34; +databaseName; Process process = runtime.exec(mysqlCmd);   ä½†æ˜¯åœ¨å®¢æˆ·é‚£é‡Œå®é™…ä½¿ç”¨æ—¶ï¼Œæœ‰æ—¶å€™ä¼šå‡ºç°åœ¨cmdä¸­MySQLå‘½ä»¤å¯ä»¥æ­£å¸¸è¯†åˆ«ä½†æ˜¯ç¨‹åºä¸èƒ½æ­£å¸¸æ‰§è¡Œçš„æƒ…å†µï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹:\n1 2 3 4 5  java.io.IOException: Cannot run program \u0026#34;mysqldump\u0026#34;: CreateProcess error=2, The system cannot find the file specified at java.lang.ProcessBuilder.start(ProcessBuilder.java:460) at java.lang.Runtime.exec(Runtime.java:593) at java.lang.Runtime.exec(Runtime.java:431) at java.lang.Runtime.exec(Runtime.java:328)   Googleä¹‹åï¼Œåœ¨Stackoverflowå‘ç°ä¸¤ä¸ªç›¸å…³çš„é—®é¢˜ï¼š\n Error when backing up MYSQL database backup mysql database java code  é˜…è¯»ä¹‹åï¼Œå‘ç°ä¸Šé¢è¯´é—®é¢˜äº§ç”Ÿçš„åŸå› æ˜¯mysqldumpå‘½ä»¤æ— æ³•è¯†åˆ«ï¼ŒæŠŠmysqldumpå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„åŠ å…¥PATHç¯å¢ƒå˜é‡ä¸­å³å¯è§£å†³é—®é¢˜ã€‚ä½†å½“æˆ‘åœ¨cmdä¸­æ— è®ºæ‰§è¡Œmysqlæˆ–mysqldumpå‘½ä»¤æ—¶ï¼Œéƒ½æ˜¾ç¤ºè¿™ä¸¤ä¸ªå‘½ä»¤å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼š\nåœ¨cmdä¸­è¾“å‡ºPATHç¯å¢ƒå˜é‡æ—¶ï¼Œä¹Ÿæ˜¾ç¤ºMySQLçš„binç›®å½•å·²ç»æ·»åŠ :\nå³ä½¿é‡å¯ç”µè„‘ï¼Œä¸Šè¿°é€šè¿‡Javaå¤‡ä»½MySQLçš„ä»£ç è¿˜æ˜¯ä¸èƒ½æ­£å¸¸æ‰§è¡Œï¼Œä½†å½“åœ¨cmdä¸­æ‰§è¡Œmysqlã€mysqldumpå‘½ä»¤æˆ–è¾“å‡ºPATHç¯å¢ƒå˜é‡æ—¶ï¼Œç»“æœä»»ä½•ä¸Šé¢å›¾ç‰‡ä¸­æ˜¾ç¤ºçš„ä¸€è‡´ã€‚\nè¿™ä¸‹è®©æˆ‘æ„Ÿåˆ°å¾ˆå›°æƒ‘:\nÂ é€šè¿‡Javaä»£ç æ¥æ‰§è¡Œmysqldumpå¯¼å‡ºæ“ä½œæ—¶å»ä¸èƒ½æ­£å¸¸æ‰§è¡ŒåŸå› æ˜¯MySQLçš„æ‰§è¡Œè·¯å¾„æ²¡æœ‰åŠ åˆ°PATHç¯å¢ƒå˜é‡ä¸­,ä½†å®é™…æ£€æŸ¥å‘ç°MySQLçš„ç¯å¢ƒå˜é‡è®¾ç½®æ­£å¸¸ï¼Œåœ¨å‘½ä»¤è¡Œé€šè¿‡mysqldumpå¯¼å‡ºsqlæ–‡ä»¶å¯ä»¥æˆåŠŸæ“ä½œ!\nç»§ç»­åœ¨ç½‘ä¸Šæœç´¢è¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œå¾—åˆ°çš„ç­”æ¡ˆä¹Ÿéƒ½æ˜¯MySQLçš„æ‰§è¡Œè·¯å¾„æ²¡æœ‰åŠ åˆ°PATHç¯å¢ƒå˜é‡ä¸­å»ï¼Œé—®é¢˜ä¾æ—§ã€‚ã€‚ã€‚\næ­£å½“æˆ‘åœ¨ä¸ºè¿™ä¸ªé—®é¢˜å‘æ„æ—¶ï¼Œæµ‹è¯•éƒ¨é—¨æœ‰ä¸ªåŒäº‹çš„æ–°Win7ç”µè„‘ä¸Šåˆ©ç”¨æˆ‘ä»¬çš„è½¯ä»¶æ‰§è¡ŒMySQLå¤‡ä»½æ—¶ä¹Ÿå‡ºç°äº†ç±»ä¼¼çš„é—®é¢˜ï¼Œä¹‹å‰æˆ‘è¿˜çŒœæœ‰å¯èƒ½æ˜¯ç”±äºå®¢æˆ·æœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿç‰ˆæœ¬å¤ªä½æˆ–æŸäº›DLLæ–‡ä»¶ä¸å­˜åœ¨å¯¼è‡´çš„ã€‚ä½†ç°åœ¨å±…ç„¶åœ¨åˆšè£…å¥½çš„Win7ç”µè„‘ä¸Šä¹Ÿå‡ºç°æ­¤é—®é¢˜ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤æ“ä½œç³»ç»Ÿçš„é—®é¢˜ã€‚ç”±äºåœ¨æˆ‘è‡ªå·±çš„ç¬”è®°æœ¬å’Œå°å¼ç ”å‘æœºä¸Šéƒ½æ²¡å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œæ— å¥ˆä¹‹ä¸‹æˆ‘åªå¥½æŠŠåŒäº‹çš„ç”µè„‘æ‹¿è¿‡æ¥å’Œæˆ‘è‡ªå·±çš„ç”µè„‘è¿›è¡Œå¯¹æ¯”ï¼Œçœ‹çœ‹å“ªé‡Œè®¾ç½®ä¸ä¸€æ ·ã€‚é€šè¿‡Win7ä¸­é«˜çº§ç³»ç»Ÿè®¾ç½®æŸ¥çœ‹PATHç¯å¢ƒå˜é‡ï¼Œå¾ˆå¿«å°±å‘ç°äº†é—®é¢˜çš„æ ¹æºï¼š\nMySQLçš„æ‰§è¡Œè·¯å¾„è¢«è®¾ç½®åˆ°äº†ç”¨æˆ·å˜é‡ä¸­çš„PATHå˜é‡é‡Œï¼Œç³»ç»Ÿå˜é‡ä¸­çš„PATHå˜é‡é‡Œå´æ²¡æœ‰MySQLçš„æ‰§è¡Œè·¯å¾„ï¼Œè€ŒJavaä»£ç æ˜¯åŒ¿åæ‰§è¡Œçš„ï¼Œæ— æ³•è·å–åˆ°ç”¨æˆ·å˜é‡ï¼Œåªèƒ½å»ç³»ç»Ÿå˜é‡ä¸­å¯»æ‰¾ç›¸å…³çš„å¯æ‰§è¡Œå‘½ä»¤,å› è€Œç¨‹åºä¼šå‡ºé”™ï¼\nè¿™ä¸‹é—®é¢˜åŸå› å˜å¾—å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘ä»¬åœ¨cmdä¸­æ‰§è¡Œmysqlå’Œmysqldumpå‘½ä»¤ä»¥åŠè¾“å‡ºPATHç¯å¢ƒå˜é‡æ—¶ï¼Œç³»ç»Ÿä¼šæŠŠå½“å‰ç”¨æˆ·çš„ç”¨æˆ·å˜é‡ä¸­çš„PATHå’Œæ“ä½œç³»ç»Ÿçš„ç³»ç»Ÿå˜é‡ä¸­çš„PATHå˜é‡æ•´åˆåˆ°ä¸€å—ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨cmdä¸­æ“ä½œæ—¶ä¸€åˆ‡æ­£å¸¸ã€‚ä½†æ˜¯å½“æˆ‘ä»¬åœ¨Javaç¨‹åºä¸­æ‰§è¡Œmysqldumpå‘½ä»¤æ—¶ï¼Œç”±äºJavaç¨‹åºçš„è¿è¡Œå’Œç”¨æˆ·æ— å…³ï¼Œæ— æ³•è·å–åˆ°ç”¨æˆ·å˜é‡ä¸­çš„PATHå€¼ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬åœ¨Javaç¨‹åºä¸­æ‰§è¡Œmysqldumpå‘½ä»¤æ—¶ä¼šå‡ºé”™ã€‚è¿™ä¹Ÿæ­£å¥½å’ŒStackoverflowä¸­è¯´æ˜çš„åŸå› ä¸€è‡´ã€‚\nç”±äºæœ‰çš„ç”µè„‘ä¸Šä¼šå‡ºç°æ­¤é—®é¢˜ï¼Œæœ‰çš„ç”µè„‘ä¸Šæ²¡æœ‰æ­¤é—®é¢˜ï¼Œè¿›ä¸€æ­¥çš„æ·±ç©¶é—®é¢˜çš„æ ¹æºï¼Œå‘ç°å‘ç”Ÿé—®é¢˜çš„ç”µè„‘å’ŒæœåŠ¡å™¨åœ¨å®‰è£…MySQLæ•°æ®åº“æ—¶éƒ½æ˜¯é€šè¿‡æˆ‘ä»¬è‡ªå·±å†™çš„batè„šæœ¬æ¥å®‰è£…çš„ã€‚è€Œbatè„šæœ¬ä¸­è®¾ç½®ç¯å¢ƒå˜é‡çš„ä»£ç å¦‚ä¸‹:\n1 2 3  @echo %Path% setx PATH \u0026#34;%Path%;C:\\INTA\\Database\\bin;\u0026#34; @echo %Path%   é—®é¢˜çš„å…³é”®å°±åœ¨äºsetx PATH \u0026quot;%Path%;C:\\INTA\\Database\\bin;\u0026quot;è¿™è¡Œä»£ç ï¼Œè¿™æ ·å†™çš„è¯åªä¼šæŠŠMySQLçš„æ‰§è¡Œè·¯å¾„åŠ å…¥åˆ°å½“å‰æ‰§è¡Œè¯¥è„šæœ¬çš„ç”¨æˆ·å˜é‡ä¸­ï¼Œä¸ä¼šåŠ å…¥åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚è€Œé‚£äº›æ²¡æœ‰å‡ºé—®é¢˜çš„ç”µè„‘éƒ½æ˜¯æˆ‘è‡ªå·±æ‰‹åŠ¨åœ¨ç³»ç»Ÿå˜é‡ä¸­è®¾ç½®MySQLæ‰§è¡Œè·¯å¾„çš„ï¼è¯¥é—®é¢˜çš„è§£å†³æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨setxåé¢åŠ ä¸Š-må³å¯ï¼Œè¿™æ ·batè„šæœ¬æ‰§è¡Œæ—¶ä¼šæŠŠMySQLçš„æ‰§è¡Œè·¯å¾„å†™å…¥ç³»ç»Ÿå˜é‡çš„PATHå˜é‡ä¸­ï¼Œä¸ä¼šå†™å…¥ç”¨æˆ·å˜é‡çš„PATHå˜é‡ä¸­ï¼š\n1 2 3  @echo %Path% setx -m PATH \u0026#34;%Path%;C:\\INTA\\Database\\bin;\u0026#34; @echo %Path%   Orz~\næƒ³ä¸åˆ°ç”±äºä¸€ä¸ª-mè€Œè®©è‡ªå·±éƒé—·äº†è¿™ä¹ˆä¹…!\n","permalink":"http://isouthrain.github.io/post/mysql/can-not-run-program-mysqldump/","tags":["MySQL","Java"],"title":"Cannot run program \"mysqldump\": CreateProcess error=2, The system cannot find the file specified"},{"categories":["Goç¼–ç¨‹","ä¸ªäººåšå®¢"],"contents":"ä¸€ç›´ä»¥æ¥éƒ½æƒ³æ‹¥æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„åšå®¢ï¼Œå‰æ®µæ—¶é—´åœ¨å­¦ä¹ Go ï¼Œäºæ˜¯åˆ©ç”¨Hugo å’ŒGithub Pages æ­å»ºäº†ä¸€ä¸ªç®€æ˜“çš„ä¸ªäººåšå®¢ï¼Œå…ˆç®€å•è®°å½•ä¸‹ã€‚\nç¯å¢ƒå‡†å¤‡  Go1.18.3+ Hugov0.100+ Githubè´¦å· GoDaddyåŸŸå  è¿‡ç¨‹æ¦‚è¦ åœ¨Githubä¸Šåˆ›å»ºä¸€ä¸ªè‡ªå·±çš„é¡¹ç›®  åœ¨Githubä¸Šåˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæœ¬æ–‡ä¸­è¯¥é¡¹ç›®åä¸ºblog\n ç”±äºGithub Pageså¼ºåˆ¶è¦æ±‚åœ¨æ‰˜ç®¡åšå®¢æ—¶è¯¥é¡¹ç›®å¿…é¡»æœ‰ä¸€ä¸ªåä¸ºgh-pagesçš„åˆ†æ”¯ï¼Œæ‰€ä»¥è¦é¢„å…ˆç»™è¯¥é¡¹ç›®åˆ›å»ºä¸€ä¸ªåä¸ºgh-pagesçš„åˆ†æ”¯ åœ¨Githubä¸­æ‰“å¼€blogé¡¹ç›®ä¸»é¡µé¢ï¼Œç‚¹å‡» SettingsæŒ‰é’®\nåœ¨ Github Pagesè¿™ä¸ªåŒºåŸŸå¯ä»¥çœ‹è§æœ¬é¡¹ç›®çš„å‘å¸ƒé“¾æ¥ä¸ºhttps://fox321.github.io/blog/ ï¼Œç‚¹å‡»è¯¥é“¾æ¥å¯ä»¥è®¿é—®è¯¥é¡¹ç›®å¯¹åº”çš„é™æ€é¡µé¢\n  åˆ©ç”¨Hugoä½œä¸ºåšå®¢ç”Ÿæˆå™¨ ç”±äºGithub Pagesåªæ”¯æŒé™æ€çš„HTMLé¡µé¢æ‰˜ç®¡ï¼Œæ‰€ä»¥éœ€è¦é‡‡ç”¨Jekyll ã€Logdown ç­‰é™æ€åšå®¢ç”Ÿæˆå™¨æ¥å¿«é€Ÿç”ŸæˆHTMLé¡µé¢ï¼Œé¿å…çº¯æ‰‹åŠ¨ç¼–å†™æ—¶çš„è´¹æ—¶è´¹åŠ›ã€‚ç”±äºè‡ªå·±è¿‘æœŸä¸€ç›´åœ¨å­¦ä¹ Goï¼Œä¸ºäº†åŠ æ·±è‡ªå·±å¯¹äºGoçš„è¿ç”¨ï¼Œäºæ˜¯ä¾¿é€‰æ‹© Hugoä½œä¸ºè‡ªå·±çš„åšå®¢ç”Ÿæˆå™¨ã€‚ Hugoæ˜¯ä¸€ä¸ªåŸºäºGoå¼€å‘çš„é™æ€ç”Ÿæˆå™¨ï¼Œå®ƒé‡‡ç”¨Markdownè¯­æ³•æ¥ç¼–å†™åšå®¢ç”Ÿæˆï¼Œç„¶åç”Ÿæˆç›¸åº”çš„HTMLé¡µé¢ã€‚\nå®‰è£…Go è®¿é—®Golangä¸‹è½½é¡µæ ¹æ®è‡ªå·±ç”µè„‘çš„æ“ä½œç³»ç»Ÿé€‰æ‹©æ˜¯Linuxç‰ˆæœ¬æˆ–Windowsç‰ˆæœ¬ï¼ŒåŒæ—¶æ³¨æ„æ˜¯é€‰æ‹©32ä½è¿˜æ˜¯64ä½ï¼Œä¸€å®šè¦ä¸è‡ªå·±çš„æ“ä½œç³»ç»Ÿç›¸åŒ¹é…ã€‚ä»¥æˆ‘è‡ªå·±çš„64ä½win7ç³»ç»Ÿä¸ºä¾‹ï¼Œå®‰è£…è¿‡ç¨‹å¦‚ä¸‹ï¼š\n  ä¸‹è½½Goå®‰è£…æ–‡ä»¶\n  åŒå‡»å®‰è£…ï¼Œé»˜è®¤æ˜¯å®‰è£…åœ¨Cç›˜ä¸‹ï¼Œç”±äºwindowsæ“ä½œç³»ç»Ÿçš„ç‰¹æ€§ï¼Œæˆ‘é€šå¸¸ä¸å€¾å‘äºå®‰è£…åœ¨Cç›˜ï¼Œæ•…éœ€è¦è®¾ç½®PATHã€GOPATHå’ŒGOROOTè¿™ä¸‰ä¸ªç¯å¢ƒå˜é‡ï¼Œæˆ‘è‡ªå·±æŠŠGoå®‰è£…åœ¨D:\\code\\goä¸‹ï¼Œè¿™ä¸‰ä¸ªå˜é‡ç›¸åº”çš„è®¾ç½®ä¸º:\n1 2 3  PATH=\u0026#39;D:\\code\\go\\bin\u0026#39;;%PATH% GOPATH=\u0026#39;D:\\code\\gopath\u0026#39; GOROOT=\u0026#39;D:\\code\\go\u0026#39;ã€     å®‰è£…å®Œæˆä¹‹åï¼Œé‡æ–°æ‰“å¼€cmdçª—å£ï¼Œè¾“å…¥go versionä¹‹åæŒ‰Enteré”®ï¼Œè‹¥å‡ºç°å¦‚ä¸‹ä¿¡æ¯ï¼Œåˆ™è¡¨ç¤ºGoå®‰è£…æˆåŠŸ\n1 2  C:\\Users\\Administrator\u0026gt;go version go version go1.18.3 windows/amd64     å®‰è£…Hugo Hugoçš„å®‰è£…è¿‡ç¨‹ä¸Goçš„ç±»ä¼¼.\n  é¦–å…ˆåœ¨Hugoä¸‹è½½é¡µæ ¹æ®è‡ªå·±æ“ä½œç³»ç»Ÿçš„ç±»å‹å’Œä½æ•°ä¸‹è½½ç›¸åº”çš„å®‰è£…åŒ…ï¼Œç„¶åè®¾ç½®å¯¹åº”çš„PATHç¯å¢ƒå˜é‡å³å¯ã€‚æˆ‘çš„å®‰è£…åœ¨ D:\\program\\hugoæ‰€ä»¥ç›¸åº”çš„ç¯å¢ƒå˜é‡è®¾ç½®ä¸º\n1  PATH=\u0026#39;D:\\program\\hugo\u0026#39;;%PATH%     é‡æ–°æ‰“å¼€cmdçª—å£ï¼Œè¾“å…¥hugo versionï¼Œè‹¥å‡ºç°å¦‚ä¸‹ä¿¡æ¯ï¼Œåˆ™è¡¨ç¤º Hugoå®‰è£…æˆåŠŸ\n1 2  C:\\Users\\Administrator\u0026gt;hugo version hugo v0.100.2-d25cb2943fd94ecf781412aeff9682d5dc62e284+extended windows/amd64 BuildDate=2022-06-08T10:25:57Z VendorInfo=gohugoio     å…³äºHugoçš„åŸºæœ¬æ“ä½œå‘½ä»¤ï¼Œå¯ä»¥å‚è§Hugoå¿«é€Ÿå…¥é—¨ï¼Œæ­¤å¤„ä¸å†è¯¦è¿°ã€‚\nåœ¨Github Pagesä¸Šæ‰˜ç®¡Hugo å®‰è£…å‘½ä»¤ è™½ç„¶å®˜æ–¹æ–‡æ¡£åœ¨Github Pagesä¸Šæ‰˜ç®¡Hugoä¸Šæœ‰ç›¸åº”çš„è¯´æ˜,ä¸ªäººæ€»æ„Ÿè§‰å…¶è¯´æ˜ä¿¡æ¯ä¸å¤Ÿè¯¦ç»†ï¼Œæ•…å°†è‡ªå·±çš„å®ç°è¿‡ç¨‹è®°å½•å¦‚ä¸‹ï¼š\n å°†ä¹‹å‰åœ¨Githubä¸Šåˆ›å»ºçš„blogé¡¹ç›®cloneåˆ°æœ¬åœ°ç›®å½•\n åˆ‡æ¢åˆ°blogç›®å½•å¹¶åˆ©ç”¨hugo new siteå‘½ä»¤åˆ›å»ºä¸€ä¸ªåä¸ºperson_blogçš„Hugoç«™ç‚¹ï¼Œç„¶åå°†å…¶å†…å®¹ç§»å…¥åˆ°blogç›®å½•ä¸‹å¹¶åˆ é™¤ person_blogç›®å½•\n åˆ©ç”¨hugo newå‘½ä»¤åˆ›å»ºä¸€ä¸ªmdæ–‡ä»¶ç”¨äºå­˜å‚¨æˆ‘ä»¬çš„ç¬¬ä¸€ç¯‡åšå®¢\n åœ¨ blog ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºthemesçš„æ–‡ä»¶å¤¹ç”¨äºå­˜å‚¨Hugoæ ·å¼ï¼Œå¹¶å°†è‡ªå·±é€‰ä¸­çš„æ ·å¼ä¸‹è½½åˆ°æœ¬åœ°\n è¾“å…¥hugo server --theme=hugo-redlounge --buildDraftsåœ¨æœ¬åœ°å¯åŠ¨Hugoï¼Œå¯åŠ¨æ­£å¸¸åå‘½ä»¤è¡Œè¾“å‡ºå¦‚ä¸‹\næ­¤æ—¶åœ¨æµè§ˆå™¨ä¸­è¾“å…¥http://127.0.0.1:1313ä¼šçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼Œè¯¥é¡µé¢æ„å‘³ç€æœ¬åœ°åšå®¢åˆ›å»ºæˆåŠŸï¼Œæ¥ä¸‹æ¥è¦å°†å…¶ä¸Šä¼ åˆ°Github Pagesä¸­æ‰˜ç®¡  æˆ‘ä»¬éœ€è¦å°†ç›¸å…³çš„é“¾æ¥åœ°å€ä¿®æ”¹ä¸ºhttps://fox321.github.io/blogï¼ŒåŒæ—¶å°†ç«¯å£å·å»æ‰ï¼Œç›¸å…³çš„å‘½ä»¤ä¸º hugo server -D --theme=hugo-redlounge --baseUrl=\u0026quot;https://fox321.github.io/blog\u0026quot; --appendPort=falseï¼Œè¿è¡Œæˆªå›¾å¦‚ä¸‹  ä¿®æ”¹å®Œé“¾æ¥åœ°å€ä¹‹åï¼Œéœ€è¦å°†ç”Ÿæˆçš„é¡µé¢æäº¤åˆ°Githubä¸­æ‰èƒ½è¢«è®¿é—®ï¼Œé¦–å…ˆéœ€è¦å°†é¡µé¢æäº¤åˆ°masterï¼Œç”±äºæˆ‘æ˜¯åœ¨Windowsæ“ä½œç³»ç»Ÿä¸Šè¿›è¡Œçš„ï¼Œè€ŒCMDå¯¹Gitçš„æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œæ•…ä»æ­¤æ­¥å¼€å§‹åˆ‡æ¢ä¸ºåœ¨Git Bashè¿›è¡Œç›¸å…³æ“ä½œ  åˆ©ç”¨subtreeå‘½ä»¤å°†masterä¸­publicç›®å½•ä¸‹çš„å†…å®¹åŒæ­¥åˆ°gh-pagesç›®å½•ä¸‹\næ­¤æ—¶è®¿é—®è¯¥é¡¹ç›®çš„è®¾ç½®é¡µé¢ï¼Œåœ¨Github Pageséƒ¨åˆ†ä¼šçœ‹è§å¦‚ä¸‹ä¿¡æ¯\n è®¿é—® https://fox321.github.io/blog ï¼Œå‡ºç°å¦‚ä¸‹é¡µé¢ï¼Œè‡³æ­¤Hugoåšå®¢æ‰˜ç®¡åˆ°Github PagesæˆåŠŸï¼\n  ç›¸å…³å‘½ä»¤  ç”Ÿæˆç»‘å®šåˆ°æŒ‡å®šåŸŸåçš„é¡µé¢ hugo server -D --baseUrl=\u0026quot;http://lucumt.info\u0026quot; --appendPort=false æ–°ç‰ˆæœ¬çš„å‘½ä»¤ä¸ºhugo server --baseUrl=\u0026quot;https://lucumt.info/\u0026quot; --watch=false --appendPort=false --renderToDisk --environment production å°† masterçš„publicç›®å½•åŒæ­¥åˆ°åˆ†æ”¯ git subtree push --prefix=public git@github.com:fox321/blog.git gh-pages  åˆ©ç”¨GoDaddyé…ç½®è‡ªå®šä¹‰åŸŸå åœ¨Using a custom domain with GitHub Pagesä¸­æœ‰è¯¦ç»†çš„è¯´æ˜ï¼Œæˆ‘è‡ªå·±é…ç½®çš„æ—¶å€™ä¸»è¦æ˜¯æŒ‰ç…§Setting up an apex domainä¸­çš„è¯´æ˜åœ¨GoDaddyä¸Šçš„è¯´æ˜æ¥è®¾ç½®çš„ã€‚\n åœ¨publicç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º CNAMEçš„æ–‡ä»¶ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶ä¸­å†™å…¥æˆ‘ä»¬è¦è‡ªå®šä¹‰çš„åŸŸåï¼Œæˆ‘è‡ªå·±çš„åŸŸåä¸º http://lucumt.info ï¼Œæ•…å¡«å…¥lucumt.info\n ç™»é™†Godaddyï¼Œç„¶ååœ¨é¡µé¢å³ä¸Šè§’ç‚¹å‡»è‡ªå·±çš„ç”¨æˆ·åï¼Œå‡ºç°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„é¡µé¢ï¼Œé€‰æ‹©Manage My Domains\n é€‰æ‹©å®ŒManage My Domainsä¹‹åä¼šå‡ºç°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç•Œé¢ï¼Œé€‰æ‹©Manage DNS\n é€‰æ‹©å®ŒManage DNSä¹‹åä¼šå‡ºç°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç•Œé¢ï¼Œç‚¹å‡»AddæŒ‰é’®ä¼šå‡ºç°ä¸‹æ‹‰æ¡†è®©æˆ‘ä»¬å¢åŠ Aè®°å½•\n åœ¨Typeéƒ¨åˆ†é€‰æ‹© A ï¼ŒHostéƒ¨åˆ†é€‰æ‹© @ï¼Œ Poinst toæ ¹æ®Setting up an apex domainä¸­çš„è¯´æ˜åœ¨GoDaddyä¸­Configuring A records with your DNS provideréƒ¨åˆ†çš„è¯´æ˜æ·»åŠ  192.30.252.153 ,ç‚¹å‡»Saveå³å®Œæˆä¸€æ¡Aè®°å½•çš„æ·»åŠ \n å†æ¬¡ç‚¹å‡»Addæ·»åŠ ï¼ŒæŒ‰ç…§æ­¥éª¤5æ·»åŠ ç¬¬äºŒæ¡Aè®°å½•ï¼Œé™¤äº†Points toè®¾ç½®ä¸º 192.30.252.154 ä¹‹å¤–ï¼Œå…¶å®ƒçš„é…ç½®éƒ½ç›¸åŒ åœ¨Githubé¡¹ç›®ä¸­ç‚¹å‡»SettingsæŒ‰é’®æŸ¥çœ‹Github PagesåŒºåŸŸçš„è®¾ç½®ä¿¡æ¯ï¼Œè‹¥å‡ºç°ç±»ä¼¼å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è®¾ç½®ä¿¡æ¯ï¼Œåˆ™è¡¨ç¤ºæˆ‘ä»¬è‡ªå®šä¹‰åŸŸåæ·»åŠ æˆåŠŸ\n  è‡³æ­¤åˆ©ç”¨GoDaddyæ¥é…ç½®è‡ªè‡ªå®šä¹‰åŸŸåçš„è¿‡ç¨‹å®Œæˆï¼Œè¾“å…¥ http://lucumt.info å³å¯è®¿é—®è‡ªå·±çš„åšå®¢ï¼\nPS:åæ§½ä¸‹è®©äººè§‰å¾—ä¸çˆ½çš„å‡ ä¸ªåœ°æ–¹ï¼š\n åŸŸåç»­è´¹å‡ ä¹æ²¡æœ‰æŠ˜æ‰£ï¼Œæ‰€ä»¥å»ºè®®ç¬¬ä¸€æ¬¡ä¹°çš„æ—¶é—´é•¿ä¸€ç‚¹ã€‚ å–æ¶ˆè®¢å•åŠŸèƒ½æ¶ˆå¤±äº†ï¼Œç°åœ¨åªèƒ½æ‰“äººå·¥å®¢æœç”µè¯å–æ¶ˆã€‚  å¦‚æœå¤§å®¶æœ‰GoDaddyä¹‹å¤–æ›´å¥½çš„åŸŸåæœåŠ¡ç½‘ç«™ï¼Œæ¬¢è¿ç»™æˆ‘ç•™è¨€ï¼Œå½“ç„¶å›½å†…çš„åŸŸåæœåŠ¡å•†é™¤å¤–ï¼\nå¼€å¯è‡ªå®šä¹‰åŸŸåçš„HTTPSè®¿é—® è¯·å‚è§æœ¬äººå†™çš„å¦å¤–ä¸€ç¯‡æ–‡ç«  å°†åŸºäºGithub Pagesçš„è‡ªå®šä¹‰åŸŸååšå®¢è¿ç§»åˆ°Https ï¼Œæ­¤å¤„ä¸å†è¯¦è¿°ã€‚\n\u0026lt;\u0026ndash;å¾…ç»­\u0026ndash;\u0026gt;\n","permalink":"http://isouthrain.github.io/post/hugo/create-website-with-hugo/","tags":["Go","Hugo","Github Pages"],"title":"åˆ©ç”¨Github Pageså’ŒåŸºäºGoçš„Hugoæ­å»ºä¸ªäººåšå®¢"}]