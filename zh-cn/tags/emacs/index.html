<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Emacs | ISouthRain Blog</title>
<meta name=keywords content><meta name=description content="ISouthRain Blog"><meta name=author content="ISouthRain"><link rel=canonical href=https://isouthrain.github.io/zh-cn/tags/emacs/><link crossorigin=anonymous href=/assets/css/stylesheet.b2233f4c3fc2449ebb783dfc40f173ac148c015a2116d82fa2c132788e8c69c6.css integrity="sha256-siM/TD/CRJ67eD38QPFzrBSMAVohFtgvosEyeI6MacY=" rel="preload stylesheet" as=style><link rel=icon href=https://isouthrain.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://isouthrain.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://isouthrain.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://isouthrain.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://isouthrain.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://isouthrain.github.io/zh-cn/tags/emacs/index.xml><link rel=alternate hreflang=zh-cn href=https://isouthrain.github.io/zh-cn/tags/emacs/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Emacs"><meta property="og:description" content="ISouthRain Blog"><meta property="og:type" content="website"><meta property="og:url" content="https://isouthrain.github.io/zh-cn/tags/emacs/"><meta property="og:image" content="https://isouthrain.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="ISouthRain Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://isouthrain.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Emacs"><meta name=twitter:description content="ISouthRain Blog"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://isouthrain.github.io/zh-cn/ accesskey=h title="Home (Alt + H)"><img src=https://isouthrain.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://isouthrain.github.io/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://isouthrain.github.io/zh-cn/life/ title=MyLife><span>MyLife</span></a></li><li><a href=https://isouthrain.github.io/zh-cn/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://isouthrain.github.io/zh-cn/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://isouthrain.github.io/zh-cn/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://github.com/ISouthRain title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://isouthrain.github.io/zh-cn/>Home</a>&nbsp;»&nbsp;<a href=https://isouthrain.github.io/zh-cn/tags/>Tags</a></div><h1>Emacs
<a href=/zh-cn/tags/emacs/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Emacs Issue</h2></header><div class=entry-content><p>Emacs Issue 前言 这个文章是 记录个人使用 Emacs 相关信息/问题
它可能不适用于所有人
这可能会给遇到相同问题时的 Emacser 有所帮助!
如果你遇到了某些 Emacs 相关问题, 并解决了, 可以在下面 评论区 记录下来, 我会尝试添加到文章当中
Issue 1. 让 Minibuffer 支持使用 拼音 查找 例如在 org-mode 中使用 consult-imenu 命令时, 弹出的内容可以使用 拼音 查找 以下方法本人是使用 orderless, vertico, consult, 三个包配合用的 (use-package vertico :ensure t :hook (after-init . vertico-mode)) (use-package consult :ensure t) (use-package orderless :ensure t :config (setq completion-styles '(orderless basic) completion-category-defaults nil completion-category-overrides '((file (styles partial-completion)))) ;; 对 vertico 进行拼音查找, 全拼的第一个字母, 例如找 配置, 输入 pz 两个字母 (defun completion--regex-pinyin (str) (orderless-regexp (pinyinlib-build-regexp-string str))) (add-to-list 'orderless-matching-styles 'completion--regex-pinyin) ) 2. Windows org-mode 使用 GnuPG(GPG) 加密后无法解密, 加密信息出现 ^M 比如使用 org-crypt 这个包进行 GPG 加密时, 却无法解密 原因是 文件换行符 问题, Windows 系统的默认换行符是 CRLF, 只需将 CRLF 改为再加密就不会出现 CRLF 方法一: 添加函数, 删除 ^M 结尾的信息再进行解密 ;; 解决 ^M 解密问题 (defun freedom-org-decrypt-entry () "移除行尾 ^M(CRLF) 并解密 Org-decrypt Replace DOS eolns CR LF with Unix eolns CR" (interactive) (goto-char (point-min)) (while (search-forward "\r" nil t) (replace-match "")) (org-decrypt-entry)) 方法二: 加密之前 将文件的换行符改为 LF , 例如: C-x &lt;RET> f utf-8-unix &lt;RET> 3. Windows Emacs 使用 Daemon 方式打开文件时, 文件名乱码导致无法打开对应文件 我使用添加以下配置修复 (require 'server) ;; 如果没有启动 daemon server 就启动 (unless (server-running-p) (server-start)) ;; 防止 windows 使用 server 打开中文文件名乱名导致无法打开文件 (when (eq system-type 'windows-nt) (setq locale-coding-system 'gb18030) ;此句保证中文字体设置有效 (setq w32-unicode-filenames 'nil) ; 确保file-name-coding-system变量的设置不会无效 (setq file-name-coding-system 'gb18030) ; 设置文件名的编码为gb18030 ) 3. Org-mode 的 Table 表格没有对齐问题 这个是由于 中文字体 和 英文字体宽度不等宽导致, 设置Emacs使用某些 等宽字体 就可以解决 等宽字体, 两个例子 Iosevka(英文) GitHub - be5invis/Iosevka: Versatile typeface for code, from code. 霞鹜文楷(中文) GitHub - lxgw/LxgwWenKai: An open-source Chinese font derived from Fontworks’… 使用以下配置可以解决, 只有对应某个系统, 就能加载对应Emacs的配置, Emacs 自动识别 这个配置也相当于配置了 Emacs字体相关设置 darwin 属于 Mac 系统 Windows-nt 属于 Windows 系统 gnu/Linux 属于 Linux 系统 (when (eq system-type 'darwin) (setq fonts '("SF Mono" "冬青黑体简体中文")) (set-fontset-font t 'unicode "Apple Color Emoji" nil 'prepend) (set-fontset-font t 'unicode "Hack Nerd Font Mono" nil 'append) (set-face-attribute 'default nil :font (format "%s:pixelsize=%d" (car fonts) 16k))) (when (eq system-type 'windows-nt) ;; (setq fonts '("Iosevka" "霞鹜文楷")) (setq fonts '("Iosevka" "微软雅黑")) (set-fontset-font t 'unicode "Segoe UI Emoji" nil 'prepend) (set-fontset-font t 'unicode "Segoe UI Symbol" nil 'append) (set-fontset-font t 'unicode "Hack Nerd Font Mono" nil 'append) (set-face-attribute 'default nil :font (format "%s:pixelsize=%d" (car fonts) 20)));; 只有 双数 才能 对齐 (when (eq system-type 'gnu/linux) (unless IS-Termux (setq fonts '("Iosevka" "微软雅黑")) (set-fontset-font t 'unicode "Segoe UI Emoji" nil 'prepend) (set-fontset-font t 'unicode "Segoe UI Symbol" nil 'append) (set-fontset-font t 'unicode "Hack Nerd Font Mono" nil 'append) (set-face-attribute 'default nil :font (format "%s:pixelsize=%d" (car fonts) 20)))) (if (display-graphic-p) (dolist (charset '(kana han symbol cjk-misc bopomofo)) (set-fontset-font (frame-parameter nil 'font) charset (font-spec :family (car (cdr fonts)))))) 类似方法有 GitHub - tumashu/cnfonts: emacs中文字体配置工具。可以快速方便的的实现中文字体和英文字体等宽（也就是常说的中英文对齐）。 4. Ripgrep 无法搜索中文 例如使用以下命令无法搜索中文: consult-ripgrep ripgrep-regexp ;; 解决 ripgrep 无法搜索中文和 consult-ripgrep 无法搜索中文 (setq default-process-coding-system '(utf-8-unix . gbk)) ;; 默认(utf-8-dos . utf-8-unix)</p></div><footer class=entry-footer><span title='2023-05-19 00:00:00 +0000 UTC'>2023 年 05 月 19 日</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;429 words&nbsp;·&nbsp;ISouthRain</footer><a class=entry-link aria-label="post link to Emacs Issue" href=https://isouthrain.github.io/zh-cn/post/20230519--emacsissue--emacs/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Emacs use-package 包管理器</h2></header><div class=entry-content><p>use-package 源码地址 GitHub - jwiegley/use-package: A use-package declaration for simplifying your…
什么是 use-packaeg use-package 是管理 Emacs 包(插件) 的一个宏管理器 可以管理每个包的设置，并配置和定义
安装 use-package 将以下源码复制到你的 init.el 文件中, 然后重启 Emacs ;; 添加下载包的来源 (eval-and-compile (customize-set-variable 'package-archives '( ("melpa" . "http://melpa.org/packages/") ("org" . "http://orgmode.org/elpa/") ("gnu" . "https://elpa.gnu.org/packages/") ("nongnu" . "https://elpa.nongnu.org/nongnu/") )) (package-initialize) ;; 如果Emacs 检测到你没有安装 use-package, 那么自动安装 use-package (unless (package-installed-p 'use-package) (package-refresh-contents) (package-install 'use-package)) ) 使用 use-package 例如: 安装 doom-themes 主题 ;; 安装 doom-themes 主题，并启用 doom-one 主题 (use-package doom-themes :ensure t :config (load-theme 'doom-one t)) use-package 关键词解释 :ensure t/nil 是否从网络源安装？ t 代表从网络安装，nil 代表从 Emacs 内置包加载(如果Emacs内置了这个包，Emacs如果没有那么将报错) :config 加载/下载 包 之后再加载的配置 :init 加载/下载 包 之前加载的配置 :defer num 懒加载，num 代表数字, 在 Emacs 启动完成 num秒后再加载 :config 的内容, 可以减少 Emacs 启动时间 还有更多关键词使用，可以自己到项目地址查看 比如 bind 自定义按键， commands 调用某个命令后再加载 :config 配置</p></div><footer class=entry-footer><span title='2022-12-15 00:00:00 +0000 UTC'>2022 年 12 月 15 日</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;118 words&nbsp;·&nbsp;ISouthRain</footer><a class=entry-link aria-label="post link to Emacs use-package 包管理器" href=https://isouthrain.github.io/zh-cn/post/20221215-emacs-use-package/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Emacs google-translate 翻译文本</h2></header><div class=entry-content><p>google-translate 源码地址 GitHub - atykhonov/google-translate: Emacs interface to Google Translate 安装 google-translate 安装 use-package , 如果你没有使用 use-package (eval-and-compile (customize-set-variable 'package-archives '( ("melpa" . "http://melpa.org/packages/") ("org" . "http://orgmode.org/elpa/") ("gnu" . "https://elpa.gnu.org/packages/") ("nongnu" . "https://elpa.nongnu.org/nongnu/") )) (package-initialize) (unless (package-installed-p 'use-package) (package-refresh-contents) (package-install 'use-package)) ) 安装 google-translate (use-package google-translate :ensure t :config (setq google-translate-default-source-language "auto" google-translate-default-target-language "zh-CN") (setq google-translate-translation-directions-alist '(("en" . "zh-CN") ("zh-CN" . "en") ("en" . "ru"))) ) 配置解释 语言来源, 默认自动
(setq google-translate-default-source-language "auto") 目标语言，中文简体
(setq google-translate-default-target-language "zh-CN") 翻译方案
英文 -> 中文, 中文 -> 英文, 英文 -> 俄语, 使用 C-n 切换 (setq google-translate-translation-directions-alist '(("en" . "zh-CN") ("zh-CN" . "en") ("en" . "ru"))) 使用 将光标放到你要翻译的文本上 M-x google-translate-smooth-translate 回车 C-n 切换翻译方案 本期视频 &lt;!DOCTYPE HTML></p></div><footer class=entry-footer><span title='2022-12-13 00:00:00 +0000 UTC'>2022 年 12 月 13 日</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;110 words&nbsp;·&nbsp;ISouthRain</footer><a class=entry-link aria-label="post link to Emacs google-translate 翻译文本" href=https://isouthrain.github.io/zh-cn/post/20221213-emacs-google-translate/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Build Emacs in Ubunt</h2></header><div class=entry-content><p>Ubuntu 编译最新 Emacs 克隆 Emacs 源码 GitHub - emacs-mirror/emacs: Mirror of GNU Emacs
安装依赖 sudo apt install build-essential texinfo libx11-dev libxpm-dev libjpeg-dev libpng-dev libgif-dev libtiff-dev libgtk2.0-dev libncurses-dev libgnutls28-dev 检查依赖 ./autogen.sh ./configure 安装 make make install</p></div><footer class=entry-footer><span title='2022-07-06 00:00:00 +0000 UTC'>2022 年 07 月 06 日</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;35 words&nbsp;·&nbsp;ISouthRain</footer><a class=entry-link aria-label="post link to Build Emacs in Ubunt" href=https://isouthrain.github.io/zh-cn/post/2022-07-06-ubuntubuildemacs/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>WSL Emacs</h2></header><div class=entry-content><p>前言 由于 Windows 的某些原因使用 Emacs 总会那么的不方便或者不好用,
有的人是在 MSYS2 下使用, 但由于 MYSYS2 软件包不多, 还是差了点
所以本文借助 Windows WSL 进行使用 Emacs 么, 像在 Linux 下使用, 目前体验基本与Linux下体验一致, 不过 EAF 不支持
效果 安装 WSL, 本文是使用 WSL2 Ubuntu22.04 如果你想把 Ubuntu22.04 安装到自己指定盘符, 可以观看此文章 如何将WSL安装到其它驱动器或者文件夹中 | myfreax 启用 WSL 功能 Win + s 打开搜索, 输入 启用或关闭 Windows 功能, 并打开 将红线两个功能打勾✔, 启用后重启电脑 以 管理员权限 打开 Powershell, 设置默认为 wsl2 wsl --set-default-version 2 安装 Ubuntu22.04, wsl.exe –install -d Ubuntu22.04 如果安装不成功, 请参考文章 如何将WSL安装到其它驱动器或者文件夹中 | myfreax 运行 wsl, 直接在 Powershell 输入 wsl 运行 WSL 文件所在目录 \\wsl$ 安装 GUI 支持 下载并安装 MobaXterm MobaXterm Xserver with SSH, telnet, RDP, VNC and X11 - Download
...</p></div><footer class=entry-footer><span title='2022-07-03 00:00:00 +0000 UTC'>2022 年 07 月 03 日</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;206 words&nbsp;·&nbsp;ISouthRain</footer><a class=entry-link aria-label="post link to WSL Emacs" href=https://isouthrain.github.io/zh-cn/post/2022-07-03-windowsemacsforwsl/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://isouthrain.github.io/zh-cn/tags/emacs/page/2/>&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://isouthrain.github.io/zh-cn/>ISouthRain Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><div class=footer><span class=poem_sentence></span>
<span class=poem_info></span></div><script src=https://sdk.jinrishici.com/v2/browser/jinrishici.js></script><script type=text/javascript>jinrishici.load(function(e){var t=document.querySelector(".poem_sentence"),n=document.querySelector(".poem_info");t.innerHTML=e.data.content,n.innerHTML="---- "+e.data.origin.author})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>